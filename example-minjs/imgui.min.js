const NavWinHighlightDelay=.2,NavWinAppearDelay=.15;class NavMoveResult{constructor(){this.Clear()}Clear(){this.ID=0,this.SelectScopeId=0,this.Window=null,this.DistBox=Number.MAX_VALUE,this.DistCenter=Number.MAX_VALUE,this.DistAxial=Number.MAX_VALUE,this.RectRel=null}}var ImguiNavMixin={isNavInputPressed(n,mode){return 0<this.getNavInputAmount(n,mode)},isNavInputPressedAnyOfTwo(n1,n2,mode){return 0<this.getNavInputAmount(n1,mode)+this.getNavInputAmount(n2,mode)},isNavInputDown(n){return 0<this.guictx.IO.NavInputs[n]},navInitWindow(win,forceReinit){let g=this.guictx;console.assert(win==g.NavWindow);let init_for_nav=!1;win.Flags&WindowFlags.NoNavInputs||win.Flags&WindowFlags.ChildWindow&&!(win.Flags&WindowFlags.Popup)&&0!=win.NavLastIds[0]&&!forceReinit||(init_for_nav=!0),init_for_nav?(this.setNavID(0,g.NavLayer),g.NavInitRequest=!0,g.NavInitRequestFromMove=!1,g.NavInitResultId=0,g.NavInitResultRectRel=new Rect,this.navUpdateAnyRequestFlag()):g.NavId=win.NavLastIds[0]},navMapKey(g,k,navinput){this.IsKeyDown(g.IO.KeyMap[k])&&(g.IO.NavInputs[navinput]=1,g.NavInputSource=InputSource.NavKeyboard)},navUpdate(){let g=this.guictx;g.IO.WantSetMousePos=!1;var activate_down,nav_keyboard_active=0!=(g.IO.ConfigFlags&ConfigFlags.NavEnableKeyboard),parent_window=0!=(g.IO.ConfigFlags&ConfigFlags.NavEnableGamepad)&&0!=(g.IO.BackendFlags&BackendFlags.HasGamepad);parent_window&&(0<g.IO.NavInputs[NavInput.Activate]||0<g.IO.NavInputs[NavInput.Input]||0<g.IO.NavInputs[NavInput.Cancel]||0<g.IO.NavInputs[NavInput.Menu])&&(g.NavInputSource=InputSource.NavGamepad),nav_keyboard_active&&(this.navMapKey(g,Key.Space,NavInput.Activate),this.navMapKey(g,Key.Enter,NavInput.Input),this.navMapKey(g,Key.Escape,NavInput.Cancel),this.navMapKey(g,Key.LeftArrow,NavInput.KeyLeft_),this.navMapKey(g,Key.RightArrow,NavInput.KeyRight_),this.navMapKey(g,Key.UpArrow,NavInput.KeyUp_),this.navMapKey(g,Key.DownArrow,NavInput.KeyDown_),this.navMapKey(g,Key.Tab,NavInput.KeyTab_),g.IO.KeyCtrl&&(g.IO.NavInputs[NavInput.TweakSlow]=1),g.IO.KeyShift&&(g.IO.NavInputs[NavInput.TweakFast]=1),g.IO.KeyAlt&&!g.IO.KeyCtrl&&(g.IO.NavInputs[NavInput.KeyMenu_]=1)),g.IO.NavInputsDownDurationPrev=g.IO.NavInputsDownDuration.slice();for(let i=0;i<g.IO.NavInputs.length;i++)g.IO.NavInputsDownDuration[i]=0<g.IO.NavInputs[i]?g.IO.NavInputsDownDuration[i]<0?0:g.IO.NavInputsDownDuration[i]+g.IO.DeltaTime:-1;0==g.NavInitResultId||g.NavDisableHighlight&&!g.NavInitRequestFromMove||(console.assert(g.NavWindow),g.NavInitRequestFromMove?this.setNavIDWithRectRel(g.NavInitResultId,g.NavLayer,g.NavInitResultRectRel):this.setNavID(g.NavInitResultId,g.NavLayer),g.NavWindow.NavRectRel[g.NavLayer]=g.NavInitResultRectRel),g.NavInitRequest=!1,g.NavInitRequestFromMove=!1,g.NavInitResultId=0,g.NavJustMovedToId=0,g.NavMoveRequest&&this.navUpdateMoveResult(),g.NavMoveRequestForward==NavForward.ForwardActive&&(console.assert(g.NavMoveRequest),0==g.NavMoveResultLocal.ID&&0==g.NavMoveResultOther.ID&&(g.NavDisableHighlight=!1),g.NavMoveRequestForward=NavForward.None),g.NavMousePosDirty&&g.NavIdIsAlive&&(g.IO.ConfigFlags&ConfigFlags.NavEnableSetMousePos&&g.IO.BackendFlags&BackendFlags.HasSetMousePos&&!g.NavDisableHighlight&&g.NavDisableMouseHover&&g.NavWindow&&(g.IO.MousePos=this.navCalcPreferredRefPos(),g.IO.MousePosPrev=g.IO.MousePos.Clone(),g.IO.WantSetMousePos=!0),g.NavMousePosDirty=!1),g.NavIdIsAlive=!1,g.NavJustTabbedId=0,console.assert(0==g.NavLayer||1==g.NavLayer),g.NavWindow&&this.navSaveLastChildNavWindowIntoParent(g.NavWindow),g.NavWindow&&null!=g.NavWindow.NavLastChildNavWindow&&0==g.NavLayer&&(g.NavWindow.NavLastChildNavWindow=null),this.navUpdateWindowing(),g.IO.NavActive=(nav_keyboard_active||parent_window)&&g.NavWindow&&!(g.NavWindow.Flags&WindowFlags.NoNavInputs),g.IO.NavVisible=g.IO.NavActive&&0!=g.NavId&&!g.NavDisableHighlight||null!=g.NavWindowingTarget,this.isNavInputPressed(NavInput.Cancel,InputReadMode.Pressed)&&(0!=g.ActiveId?g.ActiveIdBlockNavInputFlags&1<<NavInput.Cancel||this.clearActiveID():g.NavWindow&&g.NavWindow.Flags&WindowFlags.ChildWindow&&!(g.NavWindow.Flags&WindowFlags.Popup)&&g.NavWindow.ParentWindow?(activate_down=g.NavWindow,parent_window=g.NavWindow.ParentWindow,console.assert(0!=activate_down.ChildId),this.FocusWindow(parent_window),this.setNavID(activate_down.ChildId,0),g.NavIdIsAlive=!1,g.NavDisableMouseHover&&(g.NavMousePosDirty=!0)):0<g.OpenPopupStack.length?g.OpenPopupStack[g.OpenPopupStack.length-1].Window.Flags&WindowFlags.Modal||this.closePopupToLevel(g.OpenPopupStack.length-1,!0):0!=g.NavLayer?this.navRestoreLayer(NavLayer.Main):(!g.NavWindow||!(g.NavWindow.Flags&WindowFlags.Popup)&&g.NavWindow.Flags&WindowFlags.ChildWindow||(g.NavWindow.NavLastIds[0]=0),g.NavId=0)),g.NavActivateId=g.NavActivateDownId=0,(g.NavActivatePressedId=g.NavInputId=0)==g.NavId||g.NavDisableHighlight||g.NavWindowingTarget||!g.NavWindow||g.NavWindow.Flags&WindowFlags.NoNavInputs||(scroll_dir=(activate_down=this.isNavInputDown(NavInput.Activate))&&this.isNavInputPressed(NavInput.Activate,InputReadMode.Pressed),0==g.ActiveId&&scroll_dir&&(g.NavActivateId=g.NavId),0!=g.ActiveId&&g.ActiveId!=g.NavId||!activate_down||(g.NavActivateDownId=g.NavId),0!=g.ActiveId&&g.ActiveId!=g.NavId||!scroll_dir||(g.NavActivatePressedId=g.NavId),0!=g.ActiveId&&g.ActiveId!=g.NavId||!this.isNavInputPressed(NavInput.Input,InputReadMode.Pressed)||(g.NavInputId=g.NavId)),g.NavWindow&&g.NavWindow.Flags&WindowFlags.NoNavInputs&&(g.NavDisableHighlight=!0),0!=g.NavActivateId&&console.assert(g.NavActivateDownId==g.NavActivateId),g.NavMoveRequest=!1,0!=g.NavNextActivateId&&(g.NavActivateId=g.NavActivateDownId=g.NavActivatePressedId=g.NavInputId=g.NavNextActivateId);var scroll_dir=(g.NavNextActivateId=0)==g.ActiveId?-1:g.ActiveIdAllowNavDirFlags;g.NavMoveRequestForward==NavForward.None?(g.NavMoveDir=Dir.None,g.NavMoveRequestFlags=NavMoveFlags.None,!g.NavWindow||g.NavWindowingTarget||!scroll_dir||g.NavWindow.Flags&WindowFlags.NoNavInputs||(scroll_dir&1<<Dir.Left&&this.isNavInputPressedAnyOfTwo(NavInput.DpadLeft,NavInput.KeyLeft_,InputReadMode.Repeat)&&(g.NavMoveDir=Dir.Left),scroll_dir&1<<Dir.Right&&this.isNavInputPressedAnyOfTwo(NavInput.DpadRight,NavInput.KeyRight_,InputReadMode.Repeat)&&(g.NavMoveDir=Dir.Right),scroll_dir&1<<Dir.Up&&this.isNavInputPressedAnyOfTwo(NavInput.DpadUp,NavInput.KeyUp_,InputReadMode.Repeat)&&(g.NavMoveDir=Dir.Up),scroll_dir&1<<Dir.Down&&this.isNavInputPressedAnyOfTwo(NavInput.DpadDown,NavInput.KeyDown_,InputReadMode.Repeat)&&(g.NavMoveDir=Dir.Down)),g.NavMoveClipDir=g.NavMoveDir):(console.assert(g.NavMoveDir!=Dir.None&&g.NavMoveClipDir!=Dir.None),console.assert(g.NavMoveRequestForward==NavForward.ForwardQueued),g.NavMoveRequestForward=NavForward.ForwardActive);let nav_scoring_rect_offset_y=0;if(nav_keyboard_active&&(nav_scoring_rect_offset_y=this.navUpdatePageUpPageDown(scroll_dir)),g.NavMoveDir!=Dir.None&&(g.NavMoveRequest=!0,g.NavMoveDirLast=g.NavMoveDir),g.NavMoveRequest&&0==g.NavId&&(g.NavInitRequest=g.NavInitRequestFromMove=!0,g.NavInitResultId=0,g.NavDisableHighlight=!1),this.navUpdateAnyRequestFlag(),g.NavWindow&&!(g.NavWindow.Flags&WindowFlags.NoNavInputs)&&!g.NavWindowingTarget){let win=g.NavWindow;var pad=Math.floor(100*win.CalcLineHeight()*g.IO.DeltaTime+.5);0==win.DC.NavLayerActiveMask&&win.DC.NavHasScroll&&g.NavMoveRequest&&(g.NavMoveDir!=Dir.Left&&g.NavMoveDir!=Dir.Right||win.SetWindowScrollX(Math.floor(win.Scroll.x+(g.NavMoveDir==Dir.Left?-1:1)*pad)),g.NavMoveDir!=Dir.Up&&g.NavMoveDir!=Dir.Down||win.SetWindowScrollY(Math.floor(win.Scroll.y+(g.NavMoveDir==Dir.Up?-1:1)*pad)));scroll_dir=this.getNavInputAmount2d(NavDirSourceFlags.PadLStick,InputReadMode.Down,.1,10);0!=scroll_dir.x&&win.ScrollbarX&&(win.SetWindowScrollX(Math.floor(win.Scroll.x+scroll_dir.x*pad)),g.NavMoveFromClampedRefRect=!0),0!=scroll_dir.y&&(win.SetWindowScrollY(Math.floor(win.Scroll.y+scroll_dir.y*pad)),g.NavMoveFromClampedRefRect=!0)}if(g.NavMoveResultLocal.Clear(),g.NavMoveResultLocalVisibleSet.Clear(),g.NavMoveResultOther.Clear(),g.NavMoveRequest&&g.NavMoveFromClampedRefRect&&0==g.NavLayer){let win=g.NavWindow,window_rect_rel=new Rect(Vec2.SubtractXY(Vec2.Subtract(win.InnerMainRect.Min,win.Pos),1,1),Vec2.AddXY(Vec2.Subtract(win.InnerMainRect.Max,win.Pos),1,1));window_rect_rel.Contains(win.NavRectRel[g.NavLayer])||(pad=.5*win.CalcLineHeight(),window_rect_rel.expandXY(-Math.min(window_rect_rel.GetWidth(),pad),-Math.min(window_rect_rel.GetHeight(),pad)),win.NavRectRel[g.NavLayer].ClipWith(window_rect_rel),g.NavId=0),g.NavMoveFromClampedRefRect=!1}let nav_rect_rel;nav_rect_rel=g.NavWindow&&!g.NavWindow.NavRectRel[g.NavLayer].IsInverted()?g.NavWindow.NavRectRel[g.NavLayer]:Rect.FromXY(0,0,0,0),g.NavWindow?g.NavScoringRectScreen=new Rect(Vec2.Add(g.NavWindow.Pos,nav_rect_rel.Min),Vec2.Add(g.NavWindow.Pos,nav_rect_rel.Max)):g.NavScoringRectScreen=this.getViewportRect().Clone(),g.NavScoringRectScreen.TranslateY(nav_scoring_rect_offset_y),g.NavScoringRectScreen.Min.x=Math.min(g.NavScoringRectScreen.Min.x+1,g.NavScoringRectScreen.Max.x),g.NavScoringRectScreen.Max.x=g.NavScoringRectScreen.Min.x,console.assert(!g.NavScoringRectScreen.IsInverted()),g.NavScoringCount=0},navProcessItem(win,nav_bb,id){let g=this.guictx;var item_flags=win.DC.ItemFlags,nav_bb_rel=new Rect(Vec2.Subtract(nav_bb.Min,win.Pos),Vec2.Subtract(nav_bb.Max,win.Pos));if(g.NavInitRequest&&g.NavLayer==win.DC.NavLayerCurrent&&(item_flags&ItemFlags.NoNavDefaultFocus&&0!=g.NavInitResultId||(g.NavInitResultId=id,g.NavInitResultRectRel=nav_bb_rel),item_flags&ItemFlags.NoNavDefaultFocus||(g.NavInitRequest=!1,this.navUpdateAnyRequestFlag())),(g.NavId!=id||g.NavMoveRequestFlags&NavMoveFlags.AllowCurrentNavId)&&!(item_flags&(ItemFlags.Disabled|ItemFlags.NoNav))){let result=win==g.NavWindow?g.NavMoveResultLocal:g.NavMoveResultOther;g.NavMoveRequest&&this.navScoreItem(result,nav_bb)&&(result.ID=id,result.SelectScopeId=g.MultiSelectScopeId,result.Window=win,result.RectRel=nav_bb_rel);g.NavMoveRequestFlags&NavMoveFlags.AlsoScoreVisibleSet&&win.ClipRect.Overlaps(nav_bb)&&Vec1.Clamp(nav_bb.Max.y,win.ClipRect.Min.y,win.ClipRect.Max.y)-Vec1.Clamp(nav_bb.Min.y,win.ClipRect.Min.y,win.ClipRect.Max.y)>=.7*(nav_bb.Max.y-nav_bb.Min.y)&&this.navScoreItem(g.NavMoveResultLocalVisibleSet,nav_bb)&&(result=g.NavMoveResultLocalVisibleSet,result.ID=id,result.SelectScopeId=g.MultiSelectScopeId,result.Window=win,result.RectRel=nav_bb_rel)}g.NavId==id&&(console.assert(win),g.NavWindow=win,g.NavLayer=win.DC.NavLayerCurrent,g.NavIdIsAlive=!0,g.NavIdTabCounter=win.DC.FocusCounterTab,win.NavRectRel[win.DC.NavLayerCurrent]=nav_bb_rel)},navMoveRequestButNoResultYet(){var g=this.guictx;return g.NavMoveRequest&&0==g.NavMoveResultLocal.ID&&0==g.NavMoveResultOther.ID},navMoveRequestCancel(){let g=this.guictx;g.NavMoveRequest=!1,this.navUpdateAnyRequestFlag()},navMoveRequestForward(move_dir,clip_dir,bb_rel,move_flags){let g=this.guictx;console.assert(g.NavMoveRequestForward==NavForward.None),this.navMoveRequestCancel(),g.NavMoveDir=move_dir,g.NavMoveClipDir=clip_dir,g.NavMoveRequestForward=NavForward.ForwardQueued,g.NavMoveRequestFlags=move_flags,g.NavWindow.NavRectRel[g.NavLayer]=bb_rel.Clone()},navMoveRequestTryWrapping(win,move_flags){var g=this.guictx;if(g.NavWindow==win&&this.navMoveRequestButNoResultYet()&&g.NavMoveRequestForward==NavForward.None&&0==g.NavLayer){console.assert(0!=move_flags);let bb_rel=win.NavRectRel[0].Clone(),clip_dir=g.NavMoveDir;g.NavMoveDir==Dir.Left&&move_flags&(NavMoveFlags.WrapX|NavMoveFlags.LoopX)&&(bb_rel.Min.x=bb_rel.Max.x=Math.max(win.SizeFull.x,win.SizeContents.x)-win.Scroll.x,move_flags&NavMoveFlags.WrapX&&(bb_rel.TranslateY(-bb_rel.GetHeight()),clip_dir=Dir.Up),this.navMoveRequestForward(g.NavMoveDir,clip_dir,bb_rel,move_flags)),g.NavMoveDir==Dir.Right&&move_flags&(NavMoveFlags.WrapX|NavMoveFlags.LoopX)&&(bb_rel.Min.x=bb_rel.Max.x=-win.Scroll.x,move_flags&NavMoveFlags.WrapX&&(bb_rel.TranslateY(+bb_rel.GetHeight()),clip_dir=Dir.Down),this.navMoveRequestForward(g.NavMoveDir,clip_dir,bb_rel,move_flags)),g.NavMoveDir==Dir.Up&&move_flags&(NavMoveFlags.WrapY|NavMoveFlags.LoopY)&&(bb_rel.Min.y=bb_rel.Max.y=Math.max(win.SizeFull.y,win.SizeContents.y)-win.Scroll.y,move_flags&NavMoveFlags.WrapY&&(bb_rel.TranslateX(-bb_rel.GetWidth()),clip_dir=Dir.Left),this.navMoveRequestForward(g.NavMoveDir,clip_dir,bb_rel,move_flags)),g.NavMoveDir==Dir.Down&&move_flags&(NavMoveFlags.WrapY|NavMoveFlags.LoopY)&&(bb_rel.Min.y=bb_rel.Max.y=-win.Scroll.y,move_flags&NavMoveFlags.WrapY&&(bb_rel.wranslateX(+bb_rel.GetWidth()),clip_dir=Dir.Right),this.navMoveRequestForward(g.NavMoveDir,clip_dir,bb_rel,move_flags))}},getNavInputAmount(n,mode){var g=this.guictx;if(mode==InputReadMode.Down)return g.IO.NavInputs[n];var t=g.IO.NavInputsDownDuration[n];return t<0&&mode==InputReadMode.Released?0<=g.IO.NavInputsDownDurationPrev[n]?1:0:t<0?0:mode==InputReadMode.Pressed?0==t?1:0:mode==InputReadMode.Repeat?this.calcTypematicPressedRepeatAmount(t,t-g.IO.DeltaTime,.8*g.IO.KeyRepeatDelay,.8*g.IO.KeyRepeatRate):mode==InputReadMode.RepeatSlow?this.calcTypematicPressedRepeatAmount(t,t-g.IO.DeltaTime,+g.IO.KeyRepeatDelay,2*g.IO.KeyRepeatRate):mode==InputReadMode.RepeatFast?this.calcTypematicPressedRepeatAmount(t,t-g.IO.DeltaTime,.8*g.IO.KeyRepeatDelay,.3*g.IO.KeyRepeatRate):0},getNavInputAmount2d(dir_sources,mode,slow_factor,fast_factor){let delta=Vec2.Zero().Clone();return dir_sources&NavDirSourceFlags.Keyboard&&delta.AddXY(this.getNavInputAmount(NavInput.KeyRight_,mode)-this.getNavInputAmount(NavInput.KeyLeft_,mode),this.getNavInputAmount(NavInput.KeyDown_,mode)-this.getNavInputAmount(NavInput.KeyUp_,mode)),dir_sources&NavDirSourceFlags.PadDPad&&delta.AddXY(this.getNavInputAmount(NavInput.DpadRight,mode)-this.getNavInputAmount(NavInput.DpadLeft,mode),this.getNavInputAmount(NavInput.DpadDown,mode)-this.getNavInputAmount(NavInput.DpadUp,mode)),dir_sources&NavDirSourceFlags.PadLStick&&delta.AddXY(this.getNavInputAmount(NavInput.LStickRight,mode)-this.getNavInputAmount(NavInput.LStickLeft,mode),this.getNavInputAmount(NavInput.LStickDown,mode)-this.getNavInputAmount(NavInput.LStickUp,mode)),0!=slow_factor&&this.isNavInputDown(NavInput.TweakSlow)&&delta.Mult(slow_factor),0!=fast_factor&&this.isNavInputDown(NavInput.TweakFast)&&delta.Mult(fast_factor),delta},calcTypematicPressedRepeatAmount(t,t_prev,repeat_delay,count){if(0==t)return 1;if(t<=repeat_delay||count<=0)return 0;count=Math.floor((t-repeat_delay)/count)-Math.floor((t_prev-repeat_delay)/count);return 0<count?count:0},activateItem(id){this.guictx.NavNextActivateId=id},setNavID(id,nav_layer){let g=this.guictx;console.assert(g.NavWindow),console.assert(0==nav_layer||1==nav_layer),g.NavId=id,g.NavWindow.NavLastIds[nav_layer]=id},setNavIDWithRectRel(id,nav_layer,rect_rel){let g=this.guictx;this.setNavID(id,nav_layer),g.NavWindow.NavRectRel[nav_layer]=rect_rel,g.NavMousePosDirty=!0,g.NavDisableHighlight=!1,g.NavDisableMouseHover=!0},navUpdateWindowing(){let g=this.guictx;if(null==this.getFrontMostPopupModal()){let apply_focus_window=null,apply_toggle_layer=!1;g.NavWindowingTargetAnim&&null==g.NavWindowingTarget&&(g.NavWindowingHighlightAlpha=Math.max(g.NavWindowingHighlightAlpha-10*g.IO.DeltaTime,0),g.DimBgRatio<=0&&g.NavWindowingHighlightAlpha<=0&&(g.NavWindowingTargetAnim=null));var oldNavWin,window=!g.NavWindowingTarget&&this.isNavInputPressed(NavInput.Menu,InputReadMode.Pressed),focus_change_dir=!g.NavWindowingTarget&&g.IO.KeyCtrl&&this.isKeyPressedMap(Key.Tab)&&g.IO.ConfigFlags&ConfigFlags.NavEnableKeyboard;if(!window&&!focus_change_dir||null!=(window=g.NavWindow||this.findWindowNavFocusable(g.WindowsFocusOrder.Size-1,-Number.MAX_SAFE_INTEGER,-1))&&(g.NavWindowingTarget=g.NavWindowingTargetAnim=window,g.NavWindowingTimer=g.NavWindowingHighlightAlpha=0,g.NavWindowingToggleLayer=!focus_change_dir,g.NavInputSource=focus_change_dir?InputSource.NavKeyboard:InputSource.NavGamepad),g.NavWindowingTimer+=g.IO.DeltaTime,g.NavWindowingTarget&&g.NavInputSource==InputSource.NavGamepad&&(g.NavWindowingHighlightAlpha=Math.max(g.NavWindowingHighlightAlpha,Vec1.Saturate((g.NavWindowingTimer-NavWinHighlightDelay)/.05)),0!=(focus_change_dir=Math.floor(this.isNavInputPressed(NavInput.FocusPrev,InputReadMode.RepeatSlow))-Math.floor(this.isNavInputPressed(NavInput.FocusNext,InputReadMode.RepeatSlow)))&&(this.navUpdateWindowingHighlightWindow(focus_change_dir),g.NavWindowingHighlightAlpha=1),this.sNavInputDown(NavInput.Menu)||(g.NavWindowingToggleLayer&=g.NavWindowingHighlightAlpha<1,g.NavWindowingToggleLayer&&g.NavWindow?apply_toggle_layer=!0:g.NavWindowingToggleLayer||(apply_focus_window=g.NavWindowingTarget),g.NavWindowingTarget=null)),g.NavWindowingTarget&&g.NavInputSource==InputSource.NavKeyboard&&(g.NavWindowingHighlightAlpha=Math.max(g.NavWindowingHighlightAlpha,Vec1.Saturate((g.NavWindowingTimer-NavWinHighlightDelay)/.05)),this.isKeyPressedMap(Key.Tab,!0)&&this.navUpdateWindowingHighlightWindow(g.IO.KeyShift?1:-1),g.IO.KeyCtrl||(apply_focus_window=g.NavWindowingTarget)),(0==g.ActiveId||g.ActiveIdAllowOverlap)&&this.isNavInputPressed(NavInput.KeyMenu_,InputReadMode.Released)&&this.IsMousePosValid(g.IO.MousePos)==this.IsMousePosValid(g.IO.MousePosPrev)&&(apply_toggle_layer=!0),g.NavWindowingTarget&&!(g.NavWindowingTarget.Flags&WindowFlags.NoMove)){let move_delta;g.NavInputSource!=InputSource.NavKeyboard||g.IO.KeyShift||(move_delta=this.getNavInputAmount2d(NavDirSourceFlags.Keyboard,InputReadMode.Down)),g.NavInputSource==InputSource.NavGamepad&&(move_delta=this.getNavInputAmount2d(NavDirSourceFlags.PadLStick,InputReadMode.Down)),0==move_delta.x&&0==move_delta.y||(oldNavWin=Math.floor(80*g.IO.DeltaTime*Math.min(g.IO.DisplayFramebufferScale.x,g.IO.DisplayFramebufferScale.y)),g.NavWindowingTarget.RootWindow.Pos.Add(move_delta.Mult(oldNavWin)),g.NavDisableMouseHover=!0,this.MarkIniSettingsDirty(g.NavWindowingTarget))}if(!apply_focus_window||null!=g.NavWindow&&apply_focus_window==g.NavWindow.RootWindow||(g.NavDisableHighlight=!1,g.NavDisableMouseHover=!0,apply_focus_window=this.navRestoreLastChildNavWindow(apply_focus_window),this.closePopupsOverWindow(apply_focus_window),this.clearActiveID(),this.FocusWindow(apply_focus_window),0==apply_focus_window.NavLastIds[0]&&this.navInitWindow(apply_focus_window,!1),apply_focus_window.DC.NavLayerActiveMask==1<<NavLayer.Menu&&(g.NavLayer=NavLayer.Menu)),apply_focus_window&&(g.NavWindowingTarget=null),apply_toggle_layer&&g.NavWindow){let newNavWin=g.NavWindow;for(;0==(2&newNavWin.DC.NavLayerActiveMask)&&0!=(newNavWin.Flags&WindowFlags.ChildWindow)&&0==(newNavWin.Flags&(WindowFlags.Popup|WindowFlags.ChildMenu));)newNavWin=newNavWin.ParentWindow;newNavWin!=g.NavWindow&&(oldNavWin=g.NavWindow,this.FocusWindow(newNavWin),newNavWin.NavLastChildNavWindow=oldNavWin),g.NavDisableHighlight=!1,g.NavDisableMouseHover=!0,this.navRestoreLayer(g.NavWindow.DC.NavLayerActiveMask&1<<NavLayer.Menu?1^Math.floor(g.NavLayer):NavLayer.Main)}}else g.NavWindowingTarget=null},getFallbackWindowNameForWindowingList(window){return window.Flags&WindowFlags.Popup?"(Popup)":window.Flags&WindowFlags.MenuBar&&"##MainMenuBar"==window.Name?"(Main menu bar)":"(Untitled)"},navUpdateWindowingList(){let g=this.guictx;if(console.assert(null!=g.NavWindowingTarget),!(g.NavWindowingTimer<NavWinAppearDelay)){null==g.NavWindowingList&&(g.NavWindowingList=this.findWindowByName("###NavWindowingList")),this.SetNextWindowSizeConstraints(new Vec2(.2*g.IO.DisplaySize.x,.2*g.IO.DisplaySize.y),new Vec2(Number.MAX_VALUE,Number.MAX_VALUE)),this.SetNextWindowPos(Vec2.Mult(g.IO.DisplaySize,.5),CondFlags.Always,new Vec2(.5,.5)),this.PushStyleVar("WindowPadding",2*g.Style.WindowPadding),this.Begin("###NavWindowingList",null,WindowFlags.NoTitleBar|WindowFlags.NoFocusOnAppearing|WindowFlags.NoResize|WindowFlags.NoMove|WindowFlags.NoInputs|WindowFlags.AlwaysAutoResize|WindowFlags.NoSavedSettings);for(let n=g.WindowsFocusOrder.length-1;0<=n;n--){var window=g.WindowsFocusOrder[n];if(this.isWindowNavFocusable(window)){let label=window.Name;-1!=label.indexOf("##")&&(label=this.getFallbackWindowNameForWindowingList(window)),this.Selectable(label,g.NavWindowingTarget==window)}}this.End(),this.PopStyleVar()}},navCalcPreferredRefPos(){var g=this.guictx;if(!g.NavDisableHighlight&&g.NavDisableMouseHover&&g.NavWindow){let rect_rel=g.NavWindow.NavRectRel[g.NavLayer];var pos=Vec2.AddXY(g.NavWindow.Pos,rect_rel.Min.x+Math.min(4*g.Style.FramePadding.x,rect_rel.GetWidth()),rect_rel.Max.y-Math.min(g.Style.FramePadding.y,rect_rel.GetHeight())),visible_rect=this.getViewportRect();return Vec2.Clamp(Vec2.Floor(pos,visible_rect.Min,visible_rect.Max))}return this.IsMousePosValid(g.IO.MousePos)?g.IO.MousePos:g.LastValidMousePos},navUpdateMoveResult(){let g=this.guictx;if(0!=g.NavMoveResultLocal.ID||0!=g.NavMoveResultOther.ID){let result=0!=g.NavMoveResultLocal.ID?g.NavMoveResultLocal:g.NavMoveResultOther;var rect_abs,delta_scroll;g.NavMoveRequestFlags&NavMoveFlags.AlsoScoreVisibleSet&&0!=g.NavMoveResultLocalVisibleSet.ID&&g.NavMoveResultLocalVisibleSet.ID!=g.NavId&&(result=g.NavMoveResultLocalVisibleSet),result!=g.NavMoveResultOther&&0!=g.NavMoveResultOther.ID&&g.NavMoveResultOther.Window.ParentWindow==g.NavWindow&&(g.NavMoveResultOther.DistBox<result.DistBox||g.NavMoveResultOther.DistBox==result.DistBox&&g.NavMoveResultOther.DistCenter<result.DistCenter)&&(result,g.NavMoveResultOther),console.assert(g.NavWindow&&result.Window),0==g.NavLayer&&(rect_abs=new Rect(Vec2.Add(result.RectRel.Min,result.Window.Pos),Vec2.Add(result.RectRel.Max,result.Window.Pos)),this.navScrollToBringItemIntoView(result.Window,rect_abs),delta_scroll=result.Window.calcNextScrollFromScrollTargetAndClamp(!1),delta_scroll=Vec2.Subtract(result.Window.Scroll,delta_scroll),result.RectRel.Translate(delta_scroll),result.Window.Flags&WindowFlags.ChildWindow&&this.navScrollToBringItemIntoView(result.Window.ParentWindow,new Rect(Vec2.Add(rect_abs.Min,delta_scroll),Vec2.Add(rect_abs.Max,delta_scroll))))}else 0!=g.NavId&&(g.NavDisableHighlight=!1,g.NavDisableMouseHover=!0)},navScrollToBringItemIntoView(win,item_rect){let window_rect=new Rect(Vec2.AddXY(win.InnerMainRect.Min,-1,-1),Vec2.AddXY(win.InnerMainRect.Max+1,1));var g;window_rect.Contains(item_rect)||(g=this.guictx,win.ScrollbarX&&item_rect.Min.x<window_rect.Min.x?(win.ScrollTarget.x=item_rect.Min.x-win.Pos.x+win.Scroll.x-g.Style.ItemSpacing.x,win.ScrollTargetCenterRatio.x=0):win.ScrollbarX&&item_rect.Max.x>=window_rect.Max.x&&(win.ScrollTarget.x=item_rect.Max.x-win.Pos.x+win.Scroll.x+g.Style.ItemSpacing.x,win.ScrollTargetCenterRatio.x=1),item_rect.Min.y<window_rect.Min.y?(win.ScrollTarget.y=item_rect.Min.y-win.Pos.y+win.Scroll.y-g.Style.ItemSpacing.y,win.ScrollTargetCenterRatio.y=0):item_rect.Max.y>=window_rect.Max.y&&(win.ScrollTarget.y=item_rect.Max.y-win.Pos.y+win.Scroll.y+g.Style.ItemSpacing.y,win.ScrollTargetCenterRatio.y=1))},navUpdatePageUpPageDown(page_offset_y){let g=this.guictx;if(g.NavMoveDir==Dir.None&&g.NavWindow&&!(g.NavWindow.Flags&WindowFlags.NoNavInputs)&&!g.NavWindowingTarget&&0==g.NavLayer){let win=g.NavWindow;if((this.IsKeyDown(g.IO.KeyMap[Key.PageUp])&&page_offset_y&1<<Dir.Up)!=(this.IsKeyDown(g.IO.KeyMap[Key.PageDown])&&page_offset_y&1<<Dir.Down)){if(0!=win.DC.NavLayerActiveMask||!win.DC.NavHasScroll){let nav_rect_rel=win.NavRectRel[g.NavLayer];page_offset_y=Math.max(0,win.InnerClipRect.GetHeight()-+win.CalcLineHeight()+nav_rect_rel.GetHeight());let nav_scoring_rect_offset_y=0;return this.IsKeyPressed(g.IO.KeyMap[Key.PageUp],!0)?(nav_scoring_rect_offset_y=-page_offset_y,g.NavMoveDir=Dir.Down,g.NavMoveClipDir=Dir.Up,g.NavMoveRequestFlags=NavMoveFlags.AllowCurrentNavId|NavMoveFlags.AlsoScoreVisibleSet):this.IsKeyPressed(g.IO.KeyMap[Key.PageDown],!0)&&(nav_scoring_rect_offset_y=page_offset_y,g.NavMoveDir=Dir.Up,g.NavMoveClipDir=Dir.Down,g.NavMoveRequestFlags=NavMoveFlags.AllowCurrentNavId|NavMoveFlags.AlsoScoreVisibleSet),nav_scoring_rect_offset_y}this.IsKeyPressed(g.IO.KeyMap[Key.PageUp],!0)?win.SetWindowScrollY(win.Scroll.y-win.InnerClipRect.GetHeight()):this.IsKeyPressed(g.IO.KeyMap[Key.PageDown],!0)&&win.SetWindowScrollY(win.Scroll.y+win.InnerClipRect.GetHeight())}}return 0},navUpdateAnyRequestFlag(){let g=this.guictx;g.NavAnyRequest=g.NavMoveRequest||g.NavInitRequest,g.NavAnyRequest&&console.assert(g.NavWindow)},navSaveLastChildNavWindowIntoParent(nav_window){let parent=nav_window;for(;parent&&0!=(parent.Flags&WindowFlags.ChildWindow)&&0==(parent.Flags&(WindowFlags.Popup|WindowFlags.ChildMenu));)parent=parent.ParentWindow;parent&&parent!=nav_window&&(parent.NavLastChildNavWindow=nav_window)},navGetDirQuadrantFromDelta(dx,dy){return Math.abs(dx)>Math.abs(dy)?0<dx?Dir.Right:Dir.Left:0<dy?Dir.Down:Dir.Up},navScoreItemDistInterval(a0,a1,b0,b1){return a1<b0?a1-b0:b1<a0?a0-b1:0},navClampRectToVisibleAreaForMoveDir(move_dir,r,clip_rect){move_dir==Dir.Left||move_dir==Dir.Right?(r.Min.y=Vec1.Clamp(r.Min.y,clip_rect.Min.y,clip_rect.Max.y),r.Max.y=Vec1.Clamp(r.Max.y,clip_rect.Min.y,clip_rect.Max.y)):(r.Min.x=Vec1.Clamp(r.Min.x,clip_rect.Min.x,clip_rect.Max.x),r.Max.x=Vec1.Clamp(r.Max.x,clip_rect.Min.x,clip_rect.Max.x))},navScoreItem(result,dcy){let g=this.guictx,win=g.CurrentWindow;if(g.NavLayer!=win.DC.NavLayerCurrent)return!1;var dist_center=g.NavScoringRectScreen;if(g.NavScoringCount++,win.ParentWindow==g.NavWindow){if(console.assert((win.Flags|g.NavWindow.Flags)&WindowFlags.NavFlattened),!win.ClipRect.Contains(dcy))return!1;dcy.ClipWithFull(win.ClipRect)}this.navClampRectToVisibleAreaForMoveDir(g.NavMoveClipDir,dcy,win.ClipRect);let dbx=this.navScoreItemDistInterval(dcy.Min.x,dcy.Max.x,dist_center.Min.x,dist_center.Max.x);var dby=this.navScoreItemDistInterval(Vec1.Lerp(dcy.Min.y,dcy.Max.y,.2),Vec1.Lerp(dcy.Min.y,dcy.Max.y,.8),Vec1.Lerp(dist_center.Min.y,dist_center.Max.y,.2),Vec1.Lerp(dist_center.Min.y,dist_center.Max.y,.8));0!=dby&&0!=dbx&&(dbx=dbx/1e3+(0<dbx?1:-1));var dist_box=Math.abs(dbx)+Math.abs(dby),dcx=dcy.Min.x+dcy.Max.x-(dist_center.Min.x+dist_center.Max.x),dcy=dcy.Min.y+dcy.Max.y-(dist_center.Min.y+dist_center.Max.y),dist_center=Math.abs(dcx)+Math.abs(dcy);let quadrant,dax=0,day=0,dist_axial=0;quadrant=0!=dbx||0!=dby?(dax=dbx,day=dby,dist_axial=dist_box,this.navGetDirQuadrantFromDelta(dbx,dby)):0!=dcx||0!=dcy?(dax=dcx,day=dcy,dist_axial=dist_center,this.navGetDirQuadrantFromDelta(dcx,dcy)):win.DC.LastItemId<g.NavId?Dir.Left:Dir.Right;let new_best=!1;if(quadrant==g.NavMoveDir){if(dist_box<result.DistBox)return result.DistBox=dist_box,result.DistCenter=dist_center,!0;dist_box==result.DistBox&&(dist_center<result.DistCenter?(result.DistCenter=dist_center,new_best=!0):dist_center==result.DistCenter&&(g.NavMoveDir==Dir.Up||g.NavMoveDir==Dir.Down?dby:dbx)<0&&(new_best=!0))}return result.DistBox==Number.MAX_VALUE&&dist_axial<result.DistAxial&&(1!=g.NavLayer||g.NavWindow.Flags&WindowFlags.ChildMenu||(g.NavMoveDir==Dir.Left&&dax<0||g.NavMoveDir==Dir.Right&&0<dax||g.NavMoveDir==Dir.Up&&day<0||g.NavMoveDir==Dir.Down&&0<day)&&(result.DistAxial=dist_axial,new_best=!0)),new_best}};const WinResizeEdgeHalf=4;var ImguiWinMgrMixin={Begin(name,p_open=null,flags=0){let g=this.guictx;const style=g.Style;console.assert(name.length),console.assert(g.FrameScopeActive),console.assert(g.FrameCountEnded!=g.FrameCount);var resize_grip_count=name.split("##");name=resize_grip_count[resize_grip_count.length-1];var title=resize_grip_count[0];let win=this.findWindowByName(name);var pad_left=null==win;pad_left&&(popup_ref=0!=g.NextWindowData.SizeCond?g.NextWindowData.SizeVal:Vec2.Zero(),win=this.createNewWindow(name,popup_ref,flags)),(flags&WindowFlags.NoInputs)==WindowFlags.NoInputs&&(flags|=WindowFlags.NoMove|WindowFlags.NoResize),flags&WindowFlags.NavFlattened&&console.assert(flags&WindowFlags.ChildWindow);var title_bar_is_highlight=g.FrameCount,first_begin_of_the_frame=win.LastFrameActive!=title_bar_is_highlight;let window_just_activated_by_user=win.LastFrameActive<title_bar_is_highlight-1;var popup_ref,resize_grip_count=0<win.HiddenFramesCannotSkipItems;flags&WindowFlags.Popup&&(popup_ref=g.OpenPopupStack[g.BeginPopupStack.length],window_just_activated_by_user|=win.PopupId!=popup_ref.PopupId,window_just_activated_by_user|=win!=popup_ref.Window),win.Appearing=window_just_activated_by_user||resize_grip_count,win.Appearing&&win.SetWindowConditionAllowFlags(CondFlags.Appearing,!0),first_begin_of_the_frame?(win.Flags=flags,win.LastFrameActive=title_bar_is_highlight,win.BeginOrderWithinParent=0,win.BeginOrderWithinContext=g.WindowsActiveCount++):flags=win.Flags;title_bar_is_highlight=g.CurrentWindowStack.empty()?null:g.CurrentWindowStack.back();let parent_window=first_begin_of_the_frame?flags&(WindowFlags.ChildWindow|WindowFlags.Popup)?title_bar_is_highlight:null:win.ParentWindow;if(console.assert(null!=parent_window||!(flags&WindowFlags.ChildWindow)),g.CurrentWindowStack.push_back(win),g.CurrentWindow=null,this.checkStacksSize(win,!0),flags&WindowFlags.Popup){let popup_ref=g.OpenPopupStack[g.BeginPopupStack.length];popup_ref.Window=win,g.BeginPopupStack.push_back(popup_ref),win.PopupId=popup_ref.PopupId}!resize_grip_count||flags&WindowFlags.ChildWindow||(win.NavLastIds[0]=0);let window_pos_set_by_api=!1,window_size_x_set_by_api=!1,window_size_y_set_by_api=!1;if(g.NextWindowData.PosCond&&(window_pos_set_by_api=0!=(win.SetWindowPosAllowFlags&g.NextWindowData.PosCond),window_pos_set_by_api&&1e-5<g.NextWindowData.PosPivotVal.LengthSq()?(win.SetWindowPosVal.Copy(g.NextWindowData.PosVal),win.SetWindowPosPivot.Copy(g.NextWindowData.PosPivotVal),win.SetWindowPosAllowFlags&=~(CondFlags.Once|CondFlags.FirstUseEver|CondFlags.Appearing)):win.SetWindowPos(g.NextWindowData.PosVal,g.NextWindowData.PosCond)),g.NextWindowData.SizeCond&&(window_size_x_set_by_api=0!=(win.SetWindowSizeAllowFlags&g.NextWindowData.SizeCond)&&0<g.NextWindowData.SizeVal.x,window_size_y_set_by_api=0!=(win.SetWindowSizeAllowFlags&g.NextWindowData.SizeCond)&&0<g.NextWindowData.SizeVal.y,win.SetWindowSize(g.NextWindowData.SizeVal,g.NextWindowData.SizeCond)),g.NextWindowData.ZIndexCond&&(win.ZIndex=g.NextWindowData.ZIndex),g.NextWindowData.ContentSizeCond?(win.SizeContentsExplicit.Copy(g.NextWindowData.ContentSizeVal),0!=win.SizeContentsExplicit.y&&(win.SizeContentsExplicit.y+=win.TitleBarHeight()+win.MenuBarHeight())):first_begin_of_the_frame&&(win.SizeContentsExplicit=new Vec2(0,0)),g.NextWindowData.CollapsedCond&&win.SetWindowCollapsed(g.NextWindowData.CollapsedVal,g.NextWindowData.CollapsedCond),g.NextWindowData.FocusCond&&this.FocusWindow(win),win.Appearing&&win.SetWindowConditionAllowFlags(CondFlags.Appearing,!1),first_begin_of_the_frame){title_bar_is_highlight=flags&WindowFlags.ChildWindow&&flags&WindowFlags.Tooltip;win.UpdateWindowParentAndRootLinks(flags,parent_window),win.Active=!0,win.HasCloseButton=null!=p_open,win.ClipRect=Rect.FromXY(-Number.MAX_VALUE,-Number.MAX_VALUE,+Number.MAX_VALUE,+Number.MAX_VALUE),win.IDStack.resize(1);let window_title_visible_elsewhere=!1;if(null!=g.NavWindowingList&&0==(win.Flags&WindowFlags.NoNavFocus)&&(window_title_visible_elsewhere=!0),window_title_visible_elsewhere&&!pad_left&&name!=win.Name&&(win.Name=name),win.SizeContents=win.CalcSizeContents(win),0<win.HiddenFramesCanSkipItems&&win.HiddenFramesCanSkipItems--,0<win.HiddenFramesCannotSkipItems&&win.HiddenFramesCannotSkipItems--,!pad_left||window_size_x_set_by_api&&window_size_y_set_by_api||(win.HiddenFramesCannotSkipItems=1),window_just_activated_by_user&&0!=(flags&(WindowFlags.Popup|WindowFlags.Tooltip))&&(win.HiddenFramesCannotSkipItems=1,flags&WindowFlags.AlwaysAutoResize&&(window_size_x_set_by_api||(win.Size.x=win.SizeFull.x=0),window_size_y_set_by_api||(win.Size.y=win.SizeFull.y=0),win.SizeContents=new Vec2(0,0))),this.setCurrentWindow(win),flags&WindowFlags.ChildWindow?win.WindowBorderSize=style.ChildBorderSize:win.WindowBorderSize=flags&(WindowFlags.Popup|WindowFlags.Tooltip)&&!(flags&WindowFlags.Modal)?style.PopupBorderSize:style.WindowBorderSize,win.WindowPadding=style.WindowPadding,flags&WindowFlags.ChildWindow&&!(flags&(WindowFlags.AlwaysUseWindowPadding|WindowFlags.Popup))&&0==win.WindowBorderSize&&(win.WindowPadding=new Vec2(0,flags&WindowFlags.MenuBar?style.WindowPadding.y:0)),win.DC.MenuBarOffset.x=Math.max(Math.max(win.WindowPadding.x,style.ItemSpacing.x),g.NextWindowData.MenuBarOffsetMinVal.x),win.DC.MenuBarOffset.y=g.NextWindowData.MenuBarOffsetMinVal.y,flags&WindowFlags.NoTitleBar||flags&WindowFlags.NoCollapse)win.Collapsed=!1;else{let title_bar_rect=win.TitleBarRect();g.HoveredWindow==window&&0==g.HoveredId&&0==g.HoveredIdPreviousFrame&&this.IsMouseHoveringRect(title_bar_rect.Min,title_bar_rect.Max)&&g.IO.MouseDoubleClicked[0]&&(win.WantCollapseToggle=!0),win.WantCollapseToggle&&(win.Collapsed=!win.Collapsed,this.MarkIniSettingsDirty(win),this.FocusWindow(win))}win.WantCollapseToggle=!1;pad_left=win.CalcSizeAutoFit(win.SizeContents);let size_full_modified=new Vec2(Number.MAX_VALUE,Number.MAX_VALUE);flags&WindowFlags.AlwaysAutoResize&&!win.Collapsed?(window_size_x_set_by_api||(win.SizeFull.x=size_full_modified.x=pad_left.x),window_size_y_set_by_api||(win.SizeFull.y=size_full_modified.y=pad_left.y)):(0<win.AutoFitFramesX||0<win.AutoFitFramesY)&&(!window_size_x_set_by_api&&0<win.AutoFitFramesX&&(win.SizeFull.x=size_full_modified.x=win.AutoFitOnlyGrows?Math.max(win.SizeFull.x,pad_left.x):pad_left.x),!window_size_y_set_by_api&&0<win.AutoFitFramesY&&(win.SizeFull.y=size_full_modified.y=win.AutoFitOnlyGrows?Math.max(win.SizeFull.y,pad_left.y):pad_left.y),win.Collapsed||this.MarkIniSettingsDirty(win)),win.SizeFull=win.CalcSizeAfterConstraint(win.SizeFull),win.Size=!win.Collapsed||flags&WindowFlags.ChildWindow?win.SizeFull:win.TitleBarRect().GetSize(),win.Collapsed||(off=(size_full_modified.x!=Number.MAX_VALUE?win.SizeFull:win.SizeFullAtLastBegin).x,resize_grip_col=(size_full_modified.y!=Number.MAX_VALUE?win.SizeFull:win.SizeFullAtLastBegin).y,win.ScrollbarY=flags&WindowFlags.AlwaysVerticalScrollbar||win.SizeContents.y>resize_grip_col&&!(flags&WindowFlags.NoScrollbar),win.ScrollbarX=flags&WindowFlags.AlwaysHorizontalScrollbar||win.SizeContents.x>off-(win.ScrollbarY?style.ScrollbarSize:0)&&!(flags&WindowFlags.NoScrollbar)&&flags&WindowFlags.HorizontalScrollbar,win.ScrollbarX&&!win.ScrollbarY&&(win.ScrollbarY=win.SizeContents.y>resize_grip_col-style.ScrollbarSize&&!(flags&WindowFlags.NoScrollbar)),win.ScrollbarSizes=new Vec2(win.ScrollbarY?style.ScrollbarSize:0,win.ScrollbarX?style.ScrollbarSize:0)),window_just_activated_by_user&&(win.AutoPosLastDirection=Dir.None,0==(flags&WindowFlags.Popup)||window_pos_set_by_api||(win.Pos=g.BeginPopupStack.back().OpenPopupPos)),flags&WindowFlags.ChildWindow&&(console.assert(parent_window&&parent_window.Active),win.BeginOrderWithinParent=parent_window.DC.ChildWindows.length,parent_window.DC.ChildWindows.push_back(win),flags&WindowFlags.Popup||window_pos_set_by_api||title_bar_is_highlight||win.Pos.Copy(parent_window.DC.CursorPos)),win.SetWindowPosVal.x!=Number.MAX_VALUE&&0==win.HiddenFramesCannotSkipItems?win.SetWindowPos(Vec2.Max(style.DisplaySafeAreaPadding,Vec2.Subtract(win.SetWindowPosVal,Vec2.Mult(win.SizeFull,win.SetWindowPosPivot))),0):0==(flags&WindowFlags.ChildMenu)&&(0==(flags&WindowFlags.Popup)||window_pos_set_by_api||!resize_grip_count)&&(0==(flags&WindowFlags.Tooltip)||window_pos_set_by_api||title_bar_is_highlight)||(win.Pos=this.findBestWindowPosForPopup(win));var off=this.getViewportRect();!window_pos_set_by_api&&!(flags&WindowFlags.ChildWindow)&&win.AutoFitFramesX<=0&&win.AutoFitFramesY<=0&&0<g.IO.DisplaySize.x&&0<g.IO.DisplaySize.y&&(grip_draw_size=Vec2.Max(style.DisplayWindowPadding,style.DisplaySafeAreaPadding),win.ClampWindowRect(off,grip_draw_size)),win.Pos=Vec2.Floor(win.Pos),win.WindowRounding=flags&WindowFlags.ChildWindow?style.ChildRounding:flags&WindowFlags.Popup&&!(flags&WindowFlags.Modal)?style.PopupRounding:style.WindowRounding,win.CalcNextScrollFromScrollTargetAndClamp(!0);let want_focus=!1;!window_just_activated_by_user||flags&WindowFlags.NoFocusOnAppearing||(flags&WindowFlags.Popup||0==(flags&(WindowFlags.ChildWindow|WindowFlags.Tooltip)))&&(want_focus=!0);let border_held=new ValRef(-1);var resize_grip_col=[null,null,null,null],resize_grip_count=g.IO.ConfigWindowsResizeFromEdges?2:1,grip_draw_size=Math.floor(Math.max(1.35*g.FontSize,win.WindowRounding+1+.2*g.FontSize));win.Collapsed||win.UpdateManualResize(pad_left,border_held,resize_grip_count,resize_grip_col),win.ResizeBorderHeld=border_held.get(),!(0<win.Size.x)||flags&WindowFlags.Tooltip||flags&WindowFlags.AlwaysAutoResize?win.ItemWidthDefault=Math.floor(16*g.FontSize):win.ItemWidthDefault=Math.floor(.65*win.Size.x),win.DrawList.Clear(),win.DrawList.Flags=(g.Style.AntiAliasedLines?DrawListFlags.AntiAliasedLines:0)|(g.Style.AntiAliasedFill?DrawListFlags.AntiAliasedFill:0),flags&WindowFlags.Tooltip&&win.DrawList.BeginLayer(1),!(flags&WindowFlags.ChildWindow)||flags&WindowFlags.Popup||title_bar_is_highlight?this.PushClipRect(off.Min,off.Max,!0):this.PushClipRect(parent_window.ClipRect.Min,parent_window.ClipRect.Max,!0);pad_left=flags&WindowFlags.Modal&&win==this.getFrontMostPopupModal()&&win.HiddenFramesCannotSkipItems<=0,title_bar_is_highlight=g.NavWindowingTargetAnim&&win==g.NavWindowingTargetAnim.RootWindow;if((pad_left||title_bar_is_highlight)&&(window_border_size=style.GetColor(pad_left?"ModalWindowDimBg":"NavWindowingDimBg",g.DimBgRatio),win.DrawList.AddRectFilled(off.Min,off.Max,window_border_size)),title_bar_is_highlight&&win==g.NavWindowingTargetAnim){let bb=win.Rect();bb.Expand(g.FontSize),bb.Contains(off)||win.DrawList.AddRectFilled(bb.Min,bb.Max,style.GetColor("NavWindowingHighlight",.25*g.NavWindowingHighlightAlpha),g.Style.WindowRounding)}var pad_left=win.WindowRounding,window_border_size=win.WindowBorderSize,title_bar_is_highlight=g.NavWindowingTarget||g.NavWindow,title_bar_is_highlight=want_focus||title_bar_is_highlight&&win.RootWindowForTitleBarHighlight==title_bar_is_highlight.RootWindowForTitleBarHighlight;const title_bar_rect=win.TitleBarRect();if(win.Collapsed){var max=style.FrameBorderSize;g.Style.FrameBorderSize=win.WindowBorderSize;var min=style.GetColor(title_bar_is_highlight&&!g.NavDisableHighlight?"TitleBgActive":"TitleBgCollapsed");this.renderFrame(title_bar_rect.Min,title_bar_rect.Max,min,!0,pad_left),g.Style.FrameBorderSize=max}else{if(!(flags&WindowFlags.NoBackground)){let bg_col=style.GetColor(this.getWindowBgColorFromFlags(flags)),alpha=1;0!=g.NextWindowData.BgAlphaCond&&(alpha=g.NextWindowData.BgAlphaVal),1!=alpha&&(bg_col=bg_col.Clone(),bg_col.a=alpha);min=Vec2.AddXY(win.Pos,0,win.TitleBarHeight()),max=Vec2.Add(win.Pos,win.Size);win.DrawList.AddRectFilled(min,max,bg_col,pad_left,flags&WindowFlags.NoTitleBar?CornerFlags.All:CornerFlags.Bot)}if(g.NextWindowData.BgAlphaCond=0,!(flags&WindowFlags.NoTitleBar)){let title_bar_col=style.GetColor(title_bar_is_highlight?"TitleBgActive":"TitleBg");win.DrawList.AddRectFilled(title_bar_rect.Min,title_bar_rect.Max,title_bar_col,pad_left,CornerFlags.Top)}if(flags&WindowFlags.MenuBar){let menu_bar_rect=win.MenuBarRect();menu_bar_rect.ClipWith(win.Rect()),win.DrawList.AddRectFilled(Vec2.AddXY(menu_bar_rect.Min,window_border_size,0),Vec2.AddXY(menu_bar_rect.Max,-window_border_size,0),style.GetColor("MenuBarBg"),flags&WindowFlags.NoTitleBar?pad_left:0,CornerFlags.Top),0<style.FrameBorderSize&&menu_bar_rect.Max.y<win.Pos.y+win.Size.y&&win.DrawList.AddLine(menu_bar_rect.GetBL(),menu_bar_rect.GetBR(),style.GetColor("Border"),style.FrameBorderSize)}win.ScrollbarX&&this.scrollbar(Axis.X),win.ScrollbarY&&this.scrollbar(Axis.Y),flags&WindowFlags.NoResize||win.RenderResizeGrips(resize_grip_col,resize_grip_count,grip_draw_size,window_border_size,pad_left),win.RenderOuterBorders()}if(g.NavWindowingTargetAnim==win){let rounding=Math.max(win.WindowRounding,g.Style.WindowRounding),bb=win.Rect().Expand(g.FontSize);bb.Contains(off)&&(bb.Expand(-g.FontSize-1),rounding=win.WindowRounding),win.DrawList.AddRect(bb.Min,bb.Max,style.GetColor("NavWindowingHighlight",g.NavWindowingHighlightAlpha),rounding,-1,3)}if(win.SizeFullAtLastBegin=win.SizeFull,win.ContentsRegionRect.Min.x=win.Pos.x-win.Scroll.x+win.WindowPadding.x,win.ContentsRegionRect.Min.y=win.Pos.y-win.Scroll.y+win.WindowPadding.y+win.TitleBarHeight()+win.MenuBarHeight(),win.ContentsRegionRect.Max.x=win.Pos.x-win.Scroll.x-win.WindowPadding.x+(0!=win.SizeContentsExplicit.x?win.SizeContentsExplicit.x:win.Size.x-win.ScrollbarSizes.x),win.ContentsRegionRect.Max.y=win.Pos.y-win.Scroll.y-win.WindowPadding.y+(0!=win.SizeContentsExplicit.y?win.SizeContentsExplicit.y:win.Size.y-win.ScrollbarSizes.y),win.ContentsRegionRect.IsNaN()&&console.assert("hey!"),win.DC.Indent.x=0+win.WindowPadding.x-win.Scroll.x,win.DC.GroupOffset.x=0,win.DC.ColumnsOffset.x=0,win.DC.CursorStartPos=Vec2.AddXY(win.Pos,win.DC.Indent.x+win.DC.ColumnsOffset.x,win.TitleBarHeight()+win.MenuBarHeight()+win.WindowPadding.y-win.Scroll.y),win.DC.CursorPos.Copy(win.DC.CursorStartPos),win.DC.CursorPosPrevLine.Copy(win.DC.CursorPos),win.DC.CursorMaxPos.Copy(win.DC.CursorStartPos),win.DC.CurrentLineHeight=0,win.DC.CurrentLineHeightMax=0,win.DC.PrevLineHeight=0,win.DC.PrevLineHeightMax=0,win.DC.CurrentLineTextBaseOffset=win.DC.PrevLineTextBaseOffset=0,win.DC.NavHideHighlightOneFrame=!1,win.DC.NavHasScroll=0<this.getWindowScrollMaxY(win),win.DC.NavLayerActiveMask=win.DC.NavLayerActiveMaskNext,win.DC.NavLayerActiveMaskNext=0,win.DC.MenuBarAppending=!1,win.DC.ChildWindows.resize(0),win.DC.LayoutType=LayoutType.Vertical,win.DC.ParentLayoutType=parent_window?parent_window.DC.LayoutType:LayoutType.Vertical,win.DC.FocusCounterAll=win.DC.FocusCounterTab=-1,win.DC.ItemFlags=parent_window?parent_window.DC.ItemFlags:ItemFlags.Default,win.DC.ItemWidth=win.ItemWidthDefault,win.DC.TextWrapPos=-1,win.DC.ItemFlagsStack.resize(0),win.DC.ItemWidthStack.resize(0),win.DC.TextWrapPosStack.resize(0),win.DC.CurrentColumns=null,win.DC.TreeDepth=0,win.DC.TreeDepthMayJumpToParentOnPop=0,win.DC.StateStorage=win.StateStorage,win.DC.GroupStack.resize(0),win.MenuColumns.Update(3,style.ItemSpacing.x,window_just_activated_by_user),flags&WindowFlags.ChildWindow&&win.DC.ItemFlags!=parent_window.DC.ItemFlags&&(win.DC.ItemFlags=parent_window.DC.ItemFlags,win.DC.ItemFlagsStack.push_back(win.DC.ItemFlags)),0<win.AutoFitFramesX&&win.AutoFitFramesX--,0<win.AutoFitFramesY&&win.AutoFitFramesY--,want_focus&&(this.FocusWindow(win),this.navInitWindow(win,!1)),!(flags&WindowFlags.NoTitleBar)){pad_left=win.DC.ItemFlags;win.DC.ItemFlags|=ItemFlags.NoNavDefaultFocus,win.DC.NavLayerCurrent=NavLayer.Menu,win.DC.NavLayerCurrentMask=1<<NavLayer.Menu,flags&WindowFlags.NoCollapse||this.CollapseButton(win.GetID("#COLLAPSE"),win.Pos)&&(win.WantCollapseToggle=!0),null!=p_open&&(marker_pos=.5*g.FontSize,this.CloseButton(win.GetID("#CLOSE"),new Vec2(win.Pos.x+win.Size.x-style.FramePadding.x-marker_pos,win.Pos.y+style.FramePadding.y+marker_pos),1+marker_pos)&&(p_open.set(!1),this.MarkIniSettingsDirty())),win.DC.NavLayerCurrent=NavLayer.Main,win.DC.NavLayerCurrentMask=1<<NavLayer.Main,win.DC.ItemFlags=pad_left;var off=flags&WindowFlags.UnsavedDocument?this.CalcTextSize("*",!1).x:0,marker_pos=Vec2.AddXY(this.CalcTextSize(title,!0),off,0);let text_r=title_bar_rect.Clone();pad_left=flags&WindowFlags.NoCollapse?style.FramePadding.x:style.FramePadding.x+g.FontSize+style.ItemInnerSpacing.x;let pad_right=null==p_open?style.FramePadding.x:style.FramePadding.x+g.FontSize+style.ItemInnerSpacing.x;0<style.WindowTitleAlign.x&&(pad_right=Vec1.Lerp(pad_right,pad_left,style.WindowTitleAlign.x)),text_r.Min.x+=pad_left,text_r.Max.x-=pad_right;let clip_rect=text_r.Clone();clip_rect.Max.x=win.Pos.x+win.Size.x-(p_open?title_bar_rect.GetHeight()-3:style.FramePadding.x),this.renderTextClipped(text_r.Min,text_r.Max,title,marker_pos,style.WindowTitleAlign,clip_rect),flags&WindowFlags.UnsavedDocument&&(marker_pos=Math.max(text_r.Min.x,text_r.Min.x+(text_r.GetWidth()-marker_pos.x)*style.WindowTitleAlign.x)+marker_pos.x,marker_pos=Vec2.AddXY(new Vec2(marker_pos,text_r.Min.y),2-off,0),off=new Vec2(0,Math.floor(.25*-g.FontSize)),this.renderTextClipped(Vec2.Add(marker_pos,off),Vec2.Add(text_r.Max,off),"*",null,new Vec2(0,style.WindowTitleAlign.y),clip_rect))}win.OuterRectClipped=win.Rect(),win.OuterRectClipped.ClipWith(win.ClipRect),win.InnerMainRect.Min.x=title_bar_rect.Min.x+win.WindowBorderSize,win.InnerMainRect.Min.y=title_bar_rect.Max.y+win.MenuBarHeight()+(flags&WindowFlags.MenuBar||!(flags&WindowFlags.NoTitleBar)?style.FrameBorderSize:win.WindowBorderSize),win.InnerMainRect.Max.x=win.Pos.x+win.Size.x-win.ScrollbarSizes.x-win.WindowBorderSize,win.InnerMainRect.Max.y=win.Pos.y+win.Size.y-win.ScrollbarSizes.y-win.WindowBorderSize,win.InnerClipRect.Min.x=Math.floor(.5+win.InnerMainRect.Min.x+Math.max(0,Math.floor(.5*win.WindowPadding.x-win.WindowBorderSize))),win.InnerClipRect.Min.y=Math.floor(.5+win.InnerMainRect.Min.y),win.InnerClipRect.Max.x=Math.floor(.5+win.InnerMainRect.Max.x-Math.max(0,Math.floor(.5*win.WindowPadding.x-win.WindowBorderSize))),win.InnerClipRect.Max.y=Math.floor(.5+win.InnerMainRect.Max.y),win.DC.LastItemId=win.MoveId,win.DC.LastItemStatusFlags=this.IsMouseHoveringRect(title_bar_rect.Min,title_bar_rect.Max,!1)?ItemStatusFlags.HoveredRect:0,win.DC.LastItemRect=title_bar_rect}else this.setCurrentWindow(win);this.PushClipRect(win.InnerClipRect.Min,win.InnerClipRect.Max,!0),first_begin_of_the_frame&&(win.WriteAccessed=!1),win.BeginCount++,g.NextWindowData.Clear(),flags&WindowFlags.ChildWindow&&(console.assert(0!=(flags&WindowFlags.NoTitleBar)),!(flags&WindowFlags.AlwaysAutoResize)&&win.AutoFitFramesX<=0&&win.AutoFitFramesY<=0&&(win.OuterRectClipped.Min.x>=win.OuterRectClipped.Max.x||win.OuterRectClipped.Min.y>=win.OuterRectClipped.Max.y)&&(win.HiddenFramesCanSkipItems=1),parent_window&&(parent_window.Collapsed||parent_window.Hidden)&&(win.HiddenFramesCanSkipItems=1)),style.Alpha<=0&&(win.HiddenFramesCanSkipItems=1),win.Hidden=0<win.HiddenFramesCanSkipItems||0<win.HiddenFramesCannotSkipItems;let skip_items=!1;return(win.Collapsed||!win.Active||win.Hidden)&&win.AutoFitFramesX<=0&&win.AutoFitFramesY<=0&&win.HiddenFramesCannotSkipItems<=0&&(skip_items=!0),win.SkipItems=skip_items,!skip_items},End(){let g=this.guictx;if(g.CurrentWindowStack.length<=1&&g.FrameScopePushedImplicitWindow)console.assert(1<g.CurrentWindowStack.length,"Calling End() too many times!");else{console.assert(0<g.CurrentWindowStack.length);let win=g.CurrentWindow;null!=win.DC.CurrentColumns&&this.endColumns(),this.PopClipRect(),win.Flags&WindowFlags.ChildWindow||this.LogFinish(),g.CurrentWindowStack.pop_back(),win.Flags&WindowFlags.Popup&&g.BeginPopupStack.pop_back(),win.flags&WindowFlags.Tooltip&&win.DrawList.EndLayer(),this.checkStacksSize(win,!1),this.setCurrentWindow(g.CurrentWindowStack.empty()?null:g.CurrentWindowStack.back())}},BeginChild(strOrID,size_arg=Vec2.Zero(),border=!1,flags=0){let id,name;return id="string"==typeof strOrID?(name=strOrID,this.getCurrentWindow().GetID(strOrID)):(name=null,strOrID),this.beginChildEx(name,id,size_arg,border,flags)},beginChildEx(backup_border_size,id,auto_fit_axes,ret,flags){let g=this.guictx,parent_window=g.CurrentWindow;flags|=WindowFlags.NoTitleBar|WindowFlags.NoResize|WindowFlags.NoSavedSettings|WindowFlags.ChildWindow,flags|=parent_window.Flags&WindowFlags.NoMove;var content_avail=this.GetContentRegionAvail();let size=Vec2.Floor(auto_fit_axes);auto_fit_axes=(0==size.x?1<<Axis.X:0)|(0==size.y?1<<Axis.Y:0);size.x<=0&&(size.x=Math.max(content_avail.x+size.x,4)),size.y<=0&&(size.y=Math.max(content_avail.y+size.y,4)),this.SetNextWindowSize(size);let title;title=backup_border_size?`${parent_window.Name}/${backup_border_size}_${1048575&id}`:`${parent_window.Name}/${1048575&id}`;backup_border_size=g.Style.ChildBorderSize;ret||(g.Style.ChildBorderSize=0);ret=this.Begin(title,null,flags);g.Style.ChildBorderSize=backup_border_size;let child_window=g.CurrentWindow;return child_window.ChildId=id,child_window.AutoFitChildAxises=auto_fit_axes,1==child_window.BeginCount&&parent_window.DC.CursorPos.Copy(child_window.Pos),g.NavActivateId!=id||flags&WindowFlags.NavFlattened||0==child_window.DC.NavLayerActiveMask&&!child_window.DC.NavHasScroll||(this.FocusWindow(child_window),this.navInitWindow(child_window,!1),this.setActiveID(id+1,child_window),g.ActiveIdSource=InputSource.Nav),ret},EndChild(){var g=this.guictx;let win=g.CurrentWindow;if(console.assert(win.Flags&WindowFlags.ChildWindow,"Mismatched BeginChild()/EndChild()"),1<win.BeginCount)this.End();else{let sz=win.Size.Clone();win.AutoFitChildAxises&1<<Axis.X&&(sz.x=Math.max(4,sz.x)),win.AutoFitChildAxises&1<<Axis.Y&&(sz.y=Math.max(4,sz.y)),this.End();var bb=g.CurrentWindow,bb=new Rect(bb.DC.CursorPos,Vec2.Add(bb.DC.CursorPos,sz));this.itemSize(sz),0==win.DC.NavLayerActiveMask&&!win.DC.NavHasScroll||win.Flags&WindowFlags.NavFlattened?this.itemAdd(bb,0):(this.itemAdd(bb,win.ChildId),this.renderNavHighlight(bb,win.ChildId),0==win.DC.NavLayerActiveMask&&win==g.NavWindow&&this.renderNavHighlight(new Rect(Vec2.SubtractXY(bb.Min,2,2),Vec2.AddXY(bb.Max,2,2)),g.NavId,NavHighlightFlags.TypeThin))}},BeginChildFrame(id,size,ret=0){const style=this.guictx.Style;this.PushStyleColor("ChildBg",style.GetColor("FrameBg")),this.PushStyleVar("ChildRounding",style.FrameRounding),this.PushStyleVar("ChildBorderSize",style.FrameBorderSize),this.PushStyleVar("WindowPadding",style.FramePadding);ret=this.BeginChild(id,size,!0,WindowFlags.NoMove|WindowFlags.AlwaysUseWindowPadding|ret);return this.PopStyleVar(3),this.PopStyleColor(),ret},EndChildFrame(){this.EndChild()},IsWindowAppearing(){return this.guictx.CurrentWindow.Appearing},IsWindowCollapsed(){return this.guictx.CurrentWindow.Collapsed},IsWindowFocused(flags){var g=this.guictx;if(flags&FocusedFlags.AnyWindow)return null!=g.NavWindow;switch(console.assert(g.CurrentWindow),flags&(FocusedFlags.RootWindow|FocusedFlags.ChildWindows)){case FocusedFlags.RootWindow|FocusedFlags.ChildWindows:return g.NavWindow&&g.NavWindow.RootWindow==g.CurrentWindow.RootWindow;case FocusedFlags.RootWindow:return g.NavWindow==g.CurrentWindow.RootWindow;case FocusedFlags.ChildWindows:return g.NavWindow&&this.isWindowChildOf(g.NavWindow,g.CurrentWindow);default:return g.NavWindow==g.CurrentWindow}},IsWindowHovered(flags){console.assert(0==(flags&HoveredFlags.AllowWhenOverlapped));var g=this.guictx;if(flags&HoveredFlags.AnyWindow){if(null==g.HoveredWindow)return!1}else switch(flags&(HoveredFlags.RootWindow|HoveredFlags.ChildWindows)){case HoveredFlags.RootWindow|HoveredFlags.ChildWindows:if(g.HoveredRootWindow!=g.CurrentWindow.RootWindow)return!1;break;case HoveredFlags.RootWindow:if(g.HoveredWindow!=g.CurrentWindow.RootWindow)return!1;break;case HoveredFlags.ChildWindows:if(null==g.HoveredWindow||!this.isWindowChildOf(g.HoveredWindow,g.CurrentWindow))return!1;break;default:if(g.HoveredWindow!=g.CurrentWindow)return!1}return!!this.isWindowContentHoverable(g.HoveredWindow,flags)&&!!(flags&HoveredFlags.AllowWhenBlockedByActiveItem||0==g.ActiveId||g.ActiveIdAllowOverlap||g.ActiveId==g.HoveredWindow.MoveId)},GetWindowDrawList(){return this.guictx.CurrentWindow.DrawList},GetWindowPos(){return this.guictx.CurrentWindow.Pos},GetWindowSize(){return this.guictx.CurrentWindow.Size},GetWindowWidth(){return this.guictx.CurrentWindow.Size.x},GetWindowHeight(){return this.guictx.CurrentWindow.Size.y},GetWindowScroll(){return this.guictx.CurrentWindow.Scroll},GetContentRegionMax(){var win=this.guictx.CurrentWindow;let mx=Vec2.Subtract(win.ContentsRegionRect.Max,win.Pos);return win.DC.CurrentColumns&&(mx.x=this.GetColumnOffset(win.DC.CurrentColumns.Current+1)-win.WindowPadding.x),mx},getContentRegionMaxScreen(){let win=this.guictx.CurrentWindow,mx=win.ContentsRegionRect.Max.Clone();return win.DC.CurrentColumns&&(mx.x=win.Pos.x+this.GetColumnOffset(win.DC.CurrentColumns.Current+1)-win.WindowPadding.x),mx},GetContentRegionAvail(){var win=this.guictx.CurrentWindow;return Vec2.Subtract(this.GetContentRegionMax(),Vec2.Subtract(win.DC.CursorPos,win.Pos))},GetContentRegionAvailWidth(){return this.GetContentRegionAvail().x},GetContentRegionAvailHeight(){return this.GetContentRegionAvail().y},GetWindowContentRegionMin(){var win=this.guictx.CurrentWindow;return Vec2.Subtract(win.ContentsRegionRect.Min,win.Pos)},GetWindowContentRegionMax(){var win=this.guictx.CurrentWindow;return Vec2.Subtract(win.ContentsRegionRect.Max,win.Pos)},GetWindowContentRegionWidth(){let win=this.guictx.CurrentWindow;return win.ContentsRegionRect.GetWidth()},GetWindowContentRegionHeight(){let win=this.guictx.CurrentWindow;return win.ContentsRegionRect.GetHeight()},SetNextWindowPos(pos,cond,pivot){let g=this.guictx;g.NextWindowData.PosVal=pos,g.NextWindowData.PosCond=cond||CondFlags.Always,g.NextWindowData.PosPivotVal=pivot||Vec2.Zero()},SetNextWindowSize(size,cond=0){let g=this.guictx;g.NextWindowData.SizeVal.Copy(size),g.NextWindowData.SizeCond=cond||CondFlags.Always},SetNextWindowZIndex(zindex,cond=0){let g=this.guictx;g.NextWindowData.ZIndex=zindex,g.NextWindowData.ZIndexCond=cond||CondFlags.Always},SetNextWindowSizeConstraints(size_min,size_max,custom_callback,custom_callback_data){let g=this.guictx;g.NextWindowData.SizeConstraintCond=CondFlags.Always,g.NextWindowData.SizeConstraintRect=new Rect(size_min,size_max),(size_min.IsNaN()||size_max.IsNaN())&&console.assert(0,"bogus constraints"),g.NextWindowData.SizeCallback=custom_callback,g.NextWindowData.SizeCallbackUserData=custom_callback_data},SetNextWindowContentSize(size){let g=this.guictx;g.NextWindowData.ContentSizeVal=size,g.NextWindowData.ContentSizeCond=CondFlags.Always},SetNextWindowCollapsed(collapsed,cond=0){let g=this.guictx;g.NextWindowData.CollapsedVal=collapsed,g.NextWindowData.CollapsedCond=cond||CondFlags.Always},SetNextWindowFocus(){let g=this.guictx;g.NextWindowData.FocusCond=CondFlags.Always},SetNextWindowBgAlpha(alpha){let g=this.guictx;g.NextWindowData.BgAlphaVal=alpha,g.NextWindowData.BgAlphaCond=CondFlags.Always},SetWindowPos(pos,cond){let win=this.guictx.CurrentWindow;win.SetWindowPos(pos,cond)},SetWindowPosNm(nm,pos,cond){let win=this.findWindowByName(nm);win&&win.SetWindowPos(pos,cond)},SetWindowSize(size,cond){let win=this.guictx.CurrentWindow;win.SetWindowSize(size,cond)},SetWindowSizeNm(nm,size,cond){let win=this.findWindowByName(nm);win&&win.SetWindowSize(size,cond)},SetWindowCollapsed(collapsed,cond){this.guictx.CurrentWindow.SetWindowCollapsed(collapsed,cond)},SetWindowCollapsedNm(nm,collapsed,cond){let win=this.findWindowByName(nm);win&&win.SetWindowCollapsed(collapsed,cond)},SetWindowFocus(){this.FocusWindow(this.guictx.CurrentWindow)},SetWindowFocusNm(win){win=this.findWindowByName(win);win&&this.FocusWindow(win)},SetWindowFontScale(scale){let win=this.guictx.CurrentWindow;win.FontWindowScale=scale},GetScrollX(){return this.guictx.CurrentWindow.Scroll.x},GetScrollY(){return this.guictx.CurrentWindow.Scroll.y},GetScrollMaxX(){return this.guictx.CurrentWindow.GetScrollMaxX()},GetScrollMaxY(){return this.guictx.CurrentWindow.GetScrollMaxY()},SetScrollX(scroll_x){this.guictx.CurrentWindow.SetScrollX(scroll_x)},SetScrollY(scroll_y){this.guictx.CurrentWindow.SetScrollX(scroll_y)},SetScrollHereY(center_y_ratio=.5){var win=this.guictx.CurrentWindow,target_y=win.DC.CursorPosPrevLine.y-win.Pos.y;target_y+=win.DC.PrevLineHeight*center_y_ratio+this.guictx.Style.ItemSpacing.y*(center_y_ratio-.5)*2,this.SetScrollFromPosY(target_y,center_y_ratio)},SetScrollFromPosY(local_y,center_y_ratio){let win=this.guictx.CurrentWindow;console.assert(0<=center_y_ratio&&center_y_ratio<=1),win.ScrollTarget.y=Math.floor(local_y+win.Scroll.y),win.ScrollTargetCenterRatio.y=center_y_ratio},createNewWindow(name,size,flags){let g=this.guictx,win=new Window(name,this);if(win.Flags=flags,g.WindowsByName[name]=win,win.Pos=new Vec2(60,60),!(flags&WindowFlags.NoSavedSettings)){let settings=this.findWindowSettings(win.ID);settings&&(win.SettingsIdx=g.SettingsWindows.indexOf(settings),win.SetWindowConditionAllowFlags(CondFlags.FirstUseEver,!1),win.Pos=Vec2.Floor(settings.Pos),win.Collapsed=settings.Collapsed,1e-5<settings.Size.LengthSq()&&(size=Vec2.Floor(settings.Size)))}return win.Size=Vec2.Floor(size),win.SizeFull=Vec2.Floor(size),win.SizeFullAtLastBegin=Vec2.Floor(size),win.DC.CursorMaxPos.Copy(win.Pos),0!=(flags&WindowFlags.AlwaysAutoResize)?(win.AutoFitFramesX=win.AutoFitFramesY=2,win.AutoFitOnlyGrows=!1):(win.Size.x<=0&&(win.AutoFitFramesX=2),win.Size.y<=0&&(win.AutoFitFramesY=2),win.AutoFitOnlyGrows=0<win.AutoFitFramesX||0<win.AutoFitFramesY),g.WindowsFocusOrder.push_back(win),flags&WindowFlags.NoBringToFrontOnFocus?g.Windows.push_front(win):g.Windows.push_back(win),win},setCurrentWindow(win){(this.guictx.CurrentWindow=win)&&win.MakeCurrent()},getCurrentWindowRead(){return this.guictx.CurrentWindow},getCurrentWindow(){let g=this.guictx;return g.CurrentWindow.WriteAccessed=!0,g.CurrentWindow},findWindowByID(id){console.assert(0,"unused")},findWindowByName(name){return this.guictx.WindowsByName[name]},getWindowBgColorFromFlags(flags){return flags&(WindowFlags.Tooltip|WindowFlags.Popup)?"PopupBg":flags&WindowFlags.ChildWindow?"ChildBg":"WindowBg"},checkStacksSize(win,begin){let tracker=win.DC.StackSizesBackup;var g=this.guictx;begin?(tracker.ID=win.IDStack.length,tracker.Group=win.DC.GroupStack.length,tracker.BeginPopup=g.BeginPopupStack.length,tracker.DrawListLayers=win.DrawList.LayerStack.length,tracker.ColorModifiers=g.ColorModifiers.length,tracker.StyleModifiers=g.StyleModifiers.length,tracker.FontStack=g.FontStack.length):(console.assert(tracker.ID==win.IDStack.length),console.assert(tracker.Group==win.DC.GroupStack.length),console.assert(tracker.BeginPopup==g.BeginPopupStack.length),console.assert(tracker.DrawListLayers=win.DrawList.LayerStack.length),console.assert(tracker.ColorModifiers>=g.ColorModifiers.length),console.assert(tracker.StyleModifiers>=g.StyleModifiers.length),console.assert(tracker.FontStack>=g.FontStack.length))},FocusWindow(win){let g=this.guictx;g.NavWindow!=win&&((g.NavWindow=win)&&g.NavDisableMouseHover&&(g.NavMousePosDirty=!0),g.NavInitRequest=!1,g.NavId=win?win.NavLastIds[0]:0,g.NavIdIsAlive=!1,g.NavLayer=NavLayer.Main),win&&((win=win.RootWindow?win.RootWindow:win).Flags&WindowFlags.Popup&&0!=g.ActiveId&&g.ActiveIdWindow&&g.ActiveIdWindow.RootWindow!=win&&this.clearActiveID(),this.bringWindowToFocusFront(win),win.Flags&WindowFlags.NoBringToFrontOnFocus||this.bringWindowToDisplayFront(win))},focusPreviousWindowIgnoringOne(ignorewin){var g=this.guictx;for(let i=g.WindowsFocusOrder.length-1;0<=i;i--){var focus_window=g.WindowsFocusOrder[i];if(focus_window!=ignorewin&&focus_window.WasActive&&!(focus_window.Flags&WindowFlags.ChildWindow)&&(focus_window.Flags&(WindowFlags.NoMouseInputs|WindowFlags.NoNavInputs))!=(WindowFlags.NoMouseInputs|WindowFlags.NoNavInputs)){focus_window=this.navRestoreLastChildNavWindow(focus_window);return void this.FocusWindow(focus_window)}}},navRestoreLastChildNavWindow(win){return win.NavLastChildNavWindow||win},bringWindowToFocusFront(win){let g=this.guictx;var len=g.WindowsFocusOrder.length;if(g.WindowsFocusOrder[len-1]!=win)for(let i=len-2;0<=i;i--)if(g.WindowsFocusOrder[i]==win){g.WindowsFocusOrder.splice(i,1),g.WindowsFocusOrder.push(win);break}},bringWindowToDisplayFront(win){let g=this.guictx;var len=g.WindowsFocusOrder.length,front=g.Windows[len-1];if(!front||front!=win&&front.RootWindow!=win)for(let i=len-2;0<=i;i--)if(g.Windows[i]==win){g.Windows.splice(i,1),g.Windows.push(win);break}},bringWindowToDisplayBack(win){let g=this.guictx;if(g.Windows[0]!=win)for(let i=0;i<g.Windows.length;i++)if(g.Windows[i]==win){g.Windows.splice(i,1),g.Windows.splice(0,0,win);break}},calcWindowExpectedSize(win){var c=win.CalcSizeContents();return win.CalcSizeAfterConstraint(win.CalcSizeAutoFit(c))},isWindowChildOf(win,potentialParent){if(win.RootWindow==potentialParent)return!0;for(;null!=win;){if(win==potentialParent)return!0;win=win.ParentWindow}return!1},isWindowNavFocusable(win){return win.Active&&win==win.RootWindow&&!(win.Flags&WindowFlags.NoNavFocus)},getWindowScrollMaxX(win){return Math.max(0,win.SizeContents.x-(win.SizeFull.x-win.ScrollbarSizes.x))},getWindowScrollMaxY(win){return Math.max(0,win.SizeContents.y-(win.SizeFull.y-win.ScrollbarSizes.y))},getWindowAllowedExtentRect(win_unused){var padding=this.guictx.Style.DisplaySafeAreaPadding;let r_screen=this.getViewportRect();return r_screen.expandXY(r_screen.GetWidth()>2*padding.x?-padding.x:0,r_screen.GetHeight()>2*padding.y?-padding.y:0),r_screen},getViewportRect(){var g=this.guictx;return new Rect(0,0,g.IO.DisplaySize.x,g.IO.DisplaySize.y)},updateHoveredWindowAndCaptureFlags(){let g=this.guictx;this.findHoveredWindow();var modal_window=this.getFrontMostPopupModal();modal_window&&g.HoveredRootWindow&&!this.isWindowChildOf(g.HoveredRootWindow,modal_window)&&(g.HoveredRootWindow=g.HoveredWindow=null),g.IO.ConfigFlags&ConfigFlags.NoMouse&&(g.HoveredWindow=g.HoveredRootWindow=null);let firstDown=-1,anyDown=!1;for(let i=0;i<g.IO.MouseDown.length;i++)g.IO.MouseClicked[i]&&(g.IO.MouseDownOwned[i]=null!=g.HoveredWindow||0==!g.OpenPopupStack.length),anyDown|=g.IO.MouseDown[i],g.IO.MouseDown[i]&&(-1==firstDown||g.IO.MouseClickedTime[i]<g.IO.MouseClickedTime[firstDown])&&(firstDown=i);var mouseAvail=-1==firstDown||g.IO.MouseDownOwned[firstDown],draggingExternPayload=g.DragDropActive&&0!=(g.DragDropSourceFlags&DragDropFlags.SourceExtern);mouseAvail||draggingExternPayload||(g.HoveredWindow=g.HoveredRootWindow=null),-1!=g.WantCaptureMouseNextFrame?g.IO.WantCaptureMouse=0!=g.WantCaptureMouseNextFrame:g.IO.WantCaptureMouse=mouseAvail&&(null!=g.HoveredWindow||anyDown)||0<g.OpenPopupStack.length,-1!=g.WantCaptureKeyboardNextFrame?g.IO.WantCaptureKeyboard=0!=g.WantCaptureKeyboardNextFrame:g.IO.WantCaptureKeyboard=0!=g.ActiveId||null!=modal_window,g.IO.NavActive&&g.IO.ConfigFlags&ConfigFlags.NavEnableKeyboard&&!(g.IO.ConfigFlags&ConfigFlags.NavNoCaptureKeyboard)&&(g.IO.WantCaptureKeyboard=!0),g.IO.WantTextInput=-1!=g.WantTextInputNextFrame&&0!=g.WantTextInputNextFrame},findHoveredWindow(){let g=this.guictx,hovered_window=null;!g.MovingWindow||g.MovingWindow.Flags&WindowFlags.NoMouseInputs||(hovered_window=g.MovingWindow);var padding_regular=g.Style.TouchExtraPadding,padding_for_resize_from_edges=g.IO.ConfigWindowsResizeFromEdges?Vec2.Max(g.Style.TouchExtraPadding,new Vec2(WinResizeEdgeHalf,WinResizeEdgeHalf)):padding_regular;for(let i=g.Windows.length-1;0<=i;i--){let win=g.Windows[i];if(win.Active&&!win.Hidden&&!(win.Flags&WindowFlags.NoMouseInputs)){let bb=win.OuterRectClipped.Clone();if(win.Flags&WindowFlags.ChildWindow||win.Flags&WindowFlags.NoResize?bb.Expand(padding_regular):bb.Expand(padding_for_resize_from_edges),bb.Contains(g.IO.MousePos)&&(null==hovered_window&&(hovered_window=win),hovered_window))break}}g.HoveredWindow=hovered_window,g.HoveredRootWindow=g.HoveredWindow?g.HoveredWindow.RootWindow:null},getFrontMostPopupModal(){var g=this.guictx;for(let n=g.OpenPopupStack.length-1;0<=n;n--){var popup=g.OpenPopupStack[n].Window;if(popup&&popup.Flags&WindowFlags.Modal)return popup}return null},_zsort(a,b){return a.ParentWindow&&(a=a.ParentWindow),b.ParentWindow&&(b=b.ParentWindow),!a.Active||a.Flags&WindowFlags.ChildWindow||!b.Active||b.Flags&WindowFlags.ChildWindow?0:a.ZIndex-b.ZIndex},zsortWindows(){this.guictx.Windows.sort(this._zsort)},_compareWindows(a,b){let d=(a.Flags&WindowFlags.Popup)-(b.Flags&WindowFlags.Popup);return d||(d=(a.Flags&WindowFlags.Tooltip)-(b.Flags&WindowFlags.Tooltip),d||a.BeginOrderWithinParent-b.BeginOrderWithinParent)},addWindowToSortBuffer(buf,win){if(buf.push(win),win.Active){var count=win.DC.ChildWindows.length;1<count&&win.DC.ChildWindows.sort(this._compareWindows);for(let i=0;i<count;i++){var c=win.DC.ChildWindows[i];c.Active&&this.addWindowToSortBuffer(buf,c)}}}};const DirtyCount=5,MinimumFrameInterval=1e3;class IO{constructor(imgui,canvas,appname){this.imgui=imgui,this.PrevTime=0,this.PrevDirtyTime=0,this.Dirty=0,this.SynthesizePointerEvents=-1!==navigator.userAgent.indexOf("iPhone")||-1!==navigator.userAgent.indexOf("iPad"),void(this.ConfigFlags=0)===window.orientation&&-1===navigator.userAgent.indexOf("IEMobile")||(this.ConfigFlags|=ConfigFlags.IsTouchScreen),this.BackendFlags=0,this.DisplayOffset=new Vec2(0,0),this.DisplaySize=new Vec2(0,0),this.DeltaTime=1/60,this.IniSavingRate=5,this.IniFilename=`/${appname}/presets.json`,this.LogFilename=`${appname}/diagnostics.log`,this.LazyDraw=!1,this.MouseDoubleClickTime=.3,this.MouseDoubleClickMaxDist=6,this.MouseDragThreshold=6,this.KeyMap=new ArrayEx,this.KeyRepeatDelay=.25,this.LongPressInterval=.75,this.KeyRepeatRate=.05,this.UserData=null,this.Fonts=new FontAtlas(imgui),this.FontGlobalScale=1,this.FontAllowScaling=!1,this.DisplayFramebufferScale=new Vec2(1,1),this.MouseDrawCursor=!1,this.ConfigMacOSXBehaviors=!1,this.ConfigInputTextCursorBlink=!0,this.ConfigWindowsResizeFromEdges=!0,this.ConfigWindowsMoveFromTitleBarOnly=!1,this.BackendPlatformName="html5/canvas",this.BackendRendererName="canvas/2d",this.BackendPlatformUserData=null,this.BackendRendererUserData=null,this.BackendLanguageUserData=null,this.ClipboardUserData=null,this.Clipboardtext=null,this.ImeSetInputScreenPosFn=null,this.ImeWindowHandle=null,this.MousePos=new Vec2(-Number.MAX_VALUE,-Number.MAX_VALUE),this.MouseDown=[0,0,0,0,0],this.MouseWheel=0,this.MouseWheelH=0,this.MouseButtonMap=[0,2,1,3,4],this.KeyCtrl=!1,this.KeyShift=!1,this.KeyAlt=!1,this.KeySuper,this.KeysDown=new ArrayEx,this.KeysDown.length=512,this.NavInputs=new ArrayEx,this.NavInputs.length=NavInput.COUNT,this.NavInputs.fill(0),this.Touches=[],this.TouchActive=!1,this.TouchDelta={x:0,y:0},this.WantCaptureMouse=!1,this.WantCaptureKeyboard=!1,this.WantTextInput=!1,this.WantSetMousePos=!1,this.WantSaveIniSettings=!1,this.NavActive=!1,this.NavVisible=!1,this.Framerate=60,this.MetricsRenderVertices=0,this.MetricsRenderIndices=0,this.MetricsRenderWindows=0,this.MetricsActiveWindows=0,this.MetricsActiveAllocations,this.MouseDelta=new Vec2(0,0),this.MousePosPrev=new Vec2(0,0),this.MouseClickedPos=[null,null,null,null,null],this.MouseClickedTime=new ArrayEx,this.MouseClicked=new ArrayEx,this.MouseDoubleClicked=new ArrayEx,this.MouseReleased=new ArrayEx,this.MouseDownOwned=new ArrayEx,this.MouseDownDuration=new ArrayEx,this.MouseDownDurationPrev=new ArrayEx,this.MouseDragMaxDistanceAbs=new ArrayEx,this.MouseDragMaxDistanceSqr=new ArrayEx,this.KeysDownDuration=new ArrayEx,this.KeysDownDurationPrev=new ArrayEx,this.NavInputsDownDuration=new ArrayEx,this.NavInputsDownDuration.length=NavInput.COUNT,this.NavInputsDownDuration.fill(0),this.NavInputsDownDurationPrev=new ArrayEx,this.NavInputsDownDurationPrev.length=NavInput.COUNT,this.NavInputsDownDurationPrev.fill(0),this.InputKeyEvents=new ArrayEx,this.initCanvas(canvas)}initCanvas(canvas){for(var key in this.canvas=canvas,void 0!==this.imgui.appServices&&(this.ConfigMacOSXBehaviors=null!==this.imgui.appServices.platform.match(/Mac/)),"undefined"!=typeof document&&(document.body.addEventListener("copy",this.onCopy.bind(this)),document.body.addEventListener("cut",this.onCut.bind(this)),document.body.addEventListener("paste",this.onPaste.bind(this))),this.ClipboardUserData=null,"undefined"!=typeof window&&(window.addEventListener("resize",this.onWindowResize.bind(this)),window.addEventListener("gamepadconnected",this.onGamepadConnected.bind(this)),window.addEventListener("gamepaddisconnected",this.onGamepadDisconnected.bind(this)),window.oncontextmenu=function(){return!1}),null!==canvas&&(this.onWindowResize(),canvas.tabIndex=1,canvas.style.touchAction="none",canvas.addEventListener("blur",this.onBlur.bind(this)),canvas.addEventListener("keydown",this.onKeyDown.bind(this)),canvas.addEventListener("keyup",this.onKeyUp.bind(this)),canvas.addEventListener("keypress",this.onKeyPress.bind(this)),canvas.addEventListener("pointermove",this.onPointerMove.bind(this)),canvas.addEventListener("pointerdown",this.onPointerDown.bind(this)),canvas.addEventListener("pointerup",this.onPointerUp.bind(this)),canvas.addEventListener("wheel",this.onWheel.bind(this),{passive:!0}),canvas.addEventListener("touchstart",this.onTouchStart.bind(this),{passive:!0}),canvas.addEventListener("touchend",this.onTouchEnd.bind(this),{passive:!0}),canvas.addEventListener("touchcancel",this.onTouchCancel.bind(this),{passive:!0}),canvas.addEventListener("touchmove",this.onTouchMove.bind(this),{passive:!0})),this.BackendFlags|=BackendFlags.HasMouseCursors,this.NavKeys={ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Escape:27,Tab:9,Delete:46,Backspace:8,PageUp:33,PageDown:34,Insert:45,Home:36,End:35,Space:32,Enter:13},this.MetaKeys={Control:17,Shift:16,Alt:18,Meta:91},this.KeyMap[Key.Tab]=this.NavKeys.Tab,this.KeyMap[Key.LeftArrow]=this.NavKeys.ArrowLeft,this.KeyMap[Key.RightArrow]=this.NavKeys.ArrowRight,this.KeyMap[Key.UpArrow]=this.NavKeys.ArrowUp,this.KeyMap[Key.DownArrow]=this.NavKeys.ArrowDown,this.KeyMap[Key.PageUp]=this.NavKeys.PageUp,this.KeyMap[Key.PageDown]=this.NavKeys.PageDown,this.KeyMap[Key.Home]=this.NavKeys.Home,this.KeyMap[Key.End]=this.NavKeys.End,this.KeyMap[Key.Insert]=this.NavKeys.Insert,this.KeyMap[Key.Delete]=this.NavKeys.Delete,this.KeyMap[Key.Backspace]=this.NavKeys.Backspace,this.KeyMap[Key.Space]=this.NavKeys.Space,this.KeyMap[Key.Enter]=this.NavKeys.Enter,this.KeyMap[Key.Escape]=this.NavKeys.Escape,this.KeyMap[Key.A]=65,this.KeyMap[Key.C]=67,this.KeyMap[Key.V]=86,this.KeyMap[Key.X]=88,this.KeyMap[Key.Y]=89,this.KeyMap[Key.Z]=90,this.KeyCodeMap={},this.NavKeys)this.KeyCodeMap[this.NavKeys[key]]=key;this.KeyCodeMap[65]="A",this.KeyCodeMap[67]="C",this.KeyCodeMap[86]="V",this.KeyCodeMap[88]="X",this.KeyCodeMap[89]="Y",this.KeyCodeMap[90]="Z"}NewFrame(time){this.WantsSaveIniSettings&&(this.WantsSaveIniSettings=!1,window.localStorage.setItem(this.IniFilename,this.imgui.SaveIniSettingsToMemory())),this.DisplaySize.x=this.canvas.scrollWidth,this.DisplaySize.y=this.canvas.scrollHeight;var dt=this.canvas.getBoundingClientRect();dt&&null!=dt.x?(this.DisplayOffset.x=dt.x,this.DisplayOffset.y=dt.y):this.DisplayOffset.y!=this.canvas.offsetTop&&(console.debug("bad bounding client rect "+JSON.stringify(dt)),this.DisplayOffset.x=this.canvas.offsetLeft,this.DisplayOffset.y=this.canvas.offsetTop);dt=time-this.PrevTime;if(this.PrevTime=time,this.DeltaTime=dt/1e3,this.LazyDraw?time-this.PrevDirtyTime>MinimumFrameInterval&&(this.PrevDirtyTime=time,this.Dirty++):this.Dirty=!0,this.WantSetMousePos&&console.log("TODO: MousePos",this.MousePos.x,this.MousePos.y),this.MouseDrawCursor)document.body.style.cursor="none";else{let nc;switch(this.imgui.GetMouseCursor()){case MouseCursor.None:nc="none";break;case MouseCursor.TextInput:nc="text";break;case MouseCursor.ResizeAll:nc="move";break;case MouseCursor.ResizeNS:nc="ns-resize";break;case MouseCursor.ResizeEW:nc="ew-resize";break;case MouseCursor.ResizeNESW:nc="nesw-resize";break;case MouseCursor.ResizeNWSE:nc="nwse-resize";break;case MouseCursor.Hand:nc="move";break;case MouseCursor.Arrow:default:nc="default"}document.body.style.cursor!=nc&&(document.body.style.cursor=nc)}this.updateMouseInputs()}EndFrame(){0<this.Dirty&&this.Dirty--}Shutdown(){if(this.canvas){let c=this.canvas;c.removeEventListener("blur",this.onBlur.bind(this)),c.removeEventListener("keydown",this.onKeyDown.bind(this)),c.removeEventListener("pointerup",this.onPointerUp.bind(this)),c.removeEventListener("wheel",this.onWheel.bind(this)),c.removeEventListener("keyup",this.onKeyUp.bind(this)),c.removeEventListener("keypress",this.onKeyPress.bind(this)),c.removeEventListener("pointermove",this.onPointerMove.bind(this)),c.removeEventListener("pointerdown",this.onPointerDown.bind(this)),c.removeEventListener("contextmenu",this.onContextMenu.bind(this)),c.removeEventListener("touchstart",this.onTouchStart.bind(this)),c.removeEventListener("touchend",this.onTouchEnd.bind(this)),c.removeEventListener("touchcancel",this.onTouchCancel.bind(this)),c.removeEventListener("touchmove",this.onTouchMove.bind(this))}"undefined"!=typeof window&&(window.removeEventListener("resize",this.onWindowResize.bind(this)),window.removeEventListener("gamepadconnected",this.onGamepadConnected.bind(this)),window.removeEventListener("gamepaddisconnected",this.onGamepadDisconnected.bind(this))),"undefined"!=typeof document&&(document.body.removeEventListener("cut",this.onCut.bind(this)),document.body.removeEventListener("copy",this.onCopy.bind(this)),document.body.removeEventListener("paste",this.onPaste.bind(this)))}ClearInputCharacters(){this.InputKeyEvents.resize(0)}GetKeyFromCode(code){let ret=this.KeyCodeMap[code];return null==ret&&(ret=String.fromCharCode(code)),ret}onCopy(evt){evt.clipboardData.setData("text/plain",this.clipboardtext),evt.preventDefault(),this.Dirty=DirtyCount}onCut(evt){evt.clipboardData.setData("text/plain",this.clipboardtext),evt.preventDefault(),this.Dirty=DirtyCount}onPaste(evt){this.Clipboardtext=evt.clipboardData.getData("text/plain"),evt.preventDefault(),this.Dirty=DirtyCount}onWindowResize(){var devicePixelRatio;null!==this.canvas&&(devicePixelRatio=window.devicePixelRatio||1,this.canvas.width=this.canvas.scrollWidth*devicePixelRatio,this.canvas.height=this.canvas.scrollHeight*devicePixelRatio),this.Dirty=DirtyCount}onGamepadConnected(evt){console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",evt.gamepad.index,evt.gamepad.id,evt.gamepad.buttons.length,evt.gamepad.axes.length)}onGamepadDisconnected(evt){console.log("Gamepad disconnected at index %d: %s.",evt.gamepad.index,evt.gamepad.id)}onBlur(evt){this.KeyCtrl=!1,this.KeyShift=!1,this.KeyAlt=!1,this.KeySuper=!1;for(let i=0;i<this.KeysDown.length;++i)this.KeysDown[i]=!1;for(let i=0;i<this.MouseDown.length;++i)this.MouseDown[i]=!1;this.Dirty=DirtyCount}onKeyDown(evt){this.KeyCtrl=evt.ctrlKey,this.KeyShift=evt.shiftKey,this.KeyAlt=evt.altKey,this.KeySuper=evt.metaKey,this.KeysDown[evt.keyCode]=!0,null==this.MetaKeys[evt.key]&&(this.InputKeyEvents.push(evt),this.isSystemEvent(evt)||evt.preventDefault()),this.Dirty=DirtyCount}isSystemEvent(evt){let issystem=!1;return-1!=this.imgui.appServices.platform.indexOf("Mac")?(evt.shiftKey&&evt.metaKey&&"KeyI"==event.code||evt.shiftKey&&evt.metaKey&&"KeyC"==event.code||evt.metaKey&&"KeyR"==event.code)&&(issystem=!0):(evt.shiftKey&&evt.ctrlKey&&"I"==evt.key.toUpperCase()&&(issystem=!0),evt.ctrlKey&&"KeyR"==evt.code&&(issystem=!0)),"F11"!=evt.code&&"F12"!=evt.code||(issystem=!0),issystem}onKeyUp(evt){this.KeyCtrl=evt.ctrlKey,this.KeyShift=evt.shiftKey,this.KeyAlt=evt.altKey,this.KeySuper=evt.metaKey,this.KeysDown[evt.keyCode]=!1,this.Dirty=DirtyCount}onKeyPress(evt){this.Dirty=DirtyCount}onPointerMove(evt){this.MousePos.x=evt.offsetX,this.MousePos.y=evt.offsetY,this.WantCaptureMouse&&evt.preventDefault(),this.Dirty=DirtyCount}onPointerDown(evt){this.canvas.focus(),this.MousePos.x=evt.offsetX,this.MousePos.y=evt.offsetY,this.MouseDown[this.MouseButtonMap[evt.button]]=!0,evt.preventDefault(),this.Dirty=DirtyCount}onPointerUp(evt){this.MouseDown[this.MouseButtonMap[evt.button]]=!1,this.Dirty=DirtyCount}onWheel(evt){let scale=1;switch(evt.deltaMode){case 0:scale=.01;break;case 1:scale=.2;break;case 2:scale=1}this.MouseWheelH=evt.deltaX*scale,this.MouseWheel=-evt.deltaY*scale,this.Dirty=DirtyCount}onTouchStart(evt){for(var touches=evt.changedTouches,offset={x:0,y:0},i=0;i<touches.length;i++)this.validateTouch(touches[i],offset)&&(this.Touches.push(this.copyTouch(touches[i])),this.TouchActive++,this.TouchDelta.x=0,this.TouchDelta.y=0,this.SynthesizePointerEvents&&(this.fakePointerEvent(evt,touches[i]),this.onPointerMove(evt),this.onPointerDown(evt)));this.Dirty=DirtyCount}onTouchMove(evt){var j,deltaX,deltaY,touches=evt.changedTouches,offset={x:0,y:0};for(let i=0;i<touches.length;i++)this.validateTouch(touches[i],offset)?(0<=(j=this.getTouchIndex(touches[i]))&&(deltaX=touches[i].clientX-this.Touches[j].x,deltaY=touches[i].clientY-this.Touches[j].y,this.Touches.splice(j,1,this.copyTouch(touches[i])),this.TouchDelta.x=.01*deltaX,this.TouchDelta.y=.01*deltaY),this.SynthesizePointerEvents&&(this.fakePointerEvent(evt,touches[i]),this.onPointerMove(evt))):console.error("can't figure out which touch to continue");this.Dirty=DirtyCount}onTouchEnd(evt){var j,touches=evt.changedTouches,offset={x:0,y:0};for(let i=0;i<touches.length;i++)this.validateTouch(touches[i],offset)?(0<=(j=this.getTouchIndex(touches[i]))&&(this.Touches.splice(j,1),this.TouchActive--),this.SynthesizePointerEvents&&(this.fakePointerEvent(evt,touches[i]),this.onPointerUp(evt))):console.error("invalid touch");this.Dirty=DirtyCount}onTouchCancel(evt){for(var i=0;i<evt.changedTouches.length;i++){var j=this.getTouchIndex(evt.changedTouches[i]);-1!=j&&(this.TouchActive--,this.Touches.splice(j,1)),this.SynthesizePointerEvents&&(this.fakePointerEvent(evt,touches[i]),this.onPointerUp(evt))}this.Dirty=DirtyCount}fakePointerEvent(evt,touch){var r=evt.target.getBoundingClientRect();evt.button=0,evt.offsetX=touch.clientX-r.left,evt.offsetY=touch.clientY-r.top,evt.preventDefault()}getTouchIndex(t){for(let i=0;i<this.Touches.length;i++)if(t.identifier==this.Touches[i].id)return i;return-1}copyTouch(t){return{id:t.identifier,x:t.clientX,y:t.clientY}}validateTouch(t,offset){return 0<t.clientX-offset.x&&t.clientX-offset.x<parseFloat(this.canvas.width)&&0<t.clientY-offset.y&&t.clientY-offset.y<parseFloat(this.canvas.height)}onContextMenu(evt){}updateMouseInputs(){let imgui=this.imgui,g=this.imgui.guictx;imgui.IsMousePosValid(this.MousePos)&&(this.MousePos=g.LastValidMousePos=Vec2.Floor(this.MousePos)),imgui.IsMousePosValid(this.MousePos)&&imgui.IsMousePosValid(this.MousePosPrev)?this.MouseDelta=Vec2.Subtract(this.MousePos,this.MousePosPrev):this.MouseDelta=Vec2.Zero(),0==this.MouseDelta.x&&0==this.MouseDelta.y||(g.NavDisableMouseHover=!1),this.MousePosPrev=this.MousePos.Clone();for(let i=0;i<this.MouseDown.length;i++){if(this.MouseClicked[i]=this.MouseDown[i]&&this.MouseDownDuration[i]<0,this.MouseReleased[i]=!this.MouseDown[i]&&0<=this.MouseDownDuration[i],this.MouseDownDurationPrev[i]=this.MouseDownDuration[i],this.MouseDownDuration[i]=this.MouseDown[i]?this.MouseDownDuration[i]<0?0:this.MouseDownDuration[i]+this.DeltaTime:-1,this.MouseDoubleClicked[i]=!1,this.MouseClicked[i]){if(g.Time-this.MouseClickedTime[i]<this.MouseDoubleClickTime){let deltaClick=imgui.IsMousePosValid(this.MousePos)?Vec2.Subtract(this.MousePos,this.MouseClickedPos[i]):Vec2.Zero();deltaClick.LengthSq()<this.MouseDoubleClickMaxDist*this.MouseDoubleClickMaxDist&&(this.MouseDoubleClicked[i]=!0),this.MouseClickedTime[i]=-Number.MAX_VALUE}else this.MouseClickedTime[i]=g.Time;this.MouseClickedPos[i]=this.MousePos.Clone(),this.MouseDragMaxDistanceAbs[i]=new Vec2(0,0),this.MouseDragMaxDistanceSqr[i]=0}else if(this.MouseDown[i]){let deltaClick=imgui.IsMousePosValid(this.MousePos)?Vec2.Subtract(this.MousePos,this.MouseClickedPos[i]):Vec2.Zero();var len=deltaClick.LengthSq();this.MouseDragMaxDistanceSqr[i]=Math.max(this.MouseDragMaxDistanceSqr[i],len),this.MouseDragMaxDistanceAbs[i].x=Math.max(this.MouseDragMaxDistanceAbs[i].x,Math.abs(deltaClick.x)),this.MouseDragMaxDistanceAbs[i].y=Math.max(this.MouseDragMaxDistanceAbs[i].y,Math.abs(deltaClick.y))}this.MouseClicked[i]&&(g.NavDisableMouseHover=!1)}}}class GuiContext{constructor(imgui,canvas,appname="imgui-njs"){this.canvas=canvas,this.AppName=appname,this.Initialized=!0,this.FrameScopeActive=!1,this.FrameScopePushedImplicitWindow=!1,this.IO=new IO(imgui,canvas,appname),this.Style=new Style(this.IO.Fonts,imgui),this.Font=null,this.FontSize=0,this.FontLineHeight=0,this.Time=0,this.FrameCount=0,this.FrameCountEnded=-1,this.FrameCountRendered=-1,this.Windows=new ArrayEx,this.WindowsFocusOrder=new ArrayEx,this.WindowsSortBuffer=new ArrayEx,this.CurrentWindowStack=new ArrayEx,this.WindowsByName={},this.WindowsActiveCount=0,this.CurrentWindow=null,this.HoveredWindow=null,this.HoveredRootWindow=null,this.HoveredId=0,this.HoveredIdAllowOverlap=!1,this.HoveredIdPreviousFrame=0,this.HoveredIdTimer=0,this.HoveredIdNotActiveTimer=0,this.ActiveId=0,this.ActiveIdPreviousFrame=0,this.ActiveIdIsAlive=0,this.ActiveIdTimer=0,this.ActiveIdIsJustActivated=!1,this.ActiveIdAllowOverlap=!1,this.ActiveIdHasBeenPressed=!1,this.ActiveIdHasBeenEdited=!1,this.ActiveIdPreviousFrameIsAlive=!1,this.ActiveIdPreviousFrameHasBeenEdited=!1,this.ActiveIdAllowNavDirFlags=0,this.ActiveIdBlockNavInputFlags=0,this.ActiveIdClickOffset=new Vec2(-1,-1),this.ActiveIdWindow=null,this.ActiveIdPreviousFrameWindow=null,this.ActiveIdSource=InputSource.None,this.LastActiveId=0,this.LastActiveIdTimer=0,this.LastValidMousePos=new Vec2(0,0),this.MovingWindow=null,this.ColorModifiers=new ArrayEx,this.StyleModifiers=new ArrayEx,this.FontStack=new ArrayEx,this.OpenPopupStack=new ArrayEx,this.BeginPopupStack=new ArrayEx,this.NextWindowData=new NextWindowData,this.NextTreeNodeOpenVal=!1,this.NextTreeNodeOpenCond=CondFlags.None,this.NavWindow=null,this.NavId=0,this.NavActivateId=0,this.NavActivateDownId=0,this.NavActivatePressedId=0,this.NavInputId=0,this.NavJustTabbedId=0,this.NavJustMovedToId=0,this.NavJustMovedToSelectScopeId=0,this.NavNextActivateId=0,this.NavInputSource=InputSource.None,this.NavScoringRectScreen=new Rect,this.NavScoringCount=0,this.NavWindowingTarget=null,this.NavWindowingTargetAnim=null,this.NavWindowingList=null,this.NavWindowingTimer=0,this.NavWindowingHighlightAlpha=0,this.NavWindowingToggleLayer=!1,this.NavLayer=NavLayer.Main,this.NavIdTabCounter=Number.MAX_SAFE_INTEGER,this.NavIdIsAlive=!1,this.NavMousePosDirty=!1,this.NavDisableHighlight=!0,this.NavDisableMouseHover=!1,this.NavAnyRequest=!1,this.NavInitRequest=!1,this.NavInitRequestFromMove=!1,this.NavInitResultId=0,this.NavMoveFromClampedRefRect=!1,this.NavMoveRequest=!1,this.NavMoveRequestFlags=0,this.NavMoveRequestForward=NavForward.None,this.NavMoveDir=Dir.None,this.NavMoveDirLast=Dir.None,this.NavMoveClipDir=Dir.None,this.NavMoveResultLocal=new NavMoveResult,this.NavMoveResultLocalVisibleSet=new NavMoveResult,this.NavMoveResultOther=new NavMoveResult,this.FocusRequestCurrWindow=null,this.FocusRequestNextWindow=null,this.FocusRequestCurrCounterAll=Number.MAX_SAFE_INTEGER,this.FocusRequestCurrCounterTab=Number.MAX_SAFE_INTEGER,this.FocusRequestNextCounterAll=Number.MAX_SAFE_INTEGER,this.FocusRequestNextCounterTab=Number.MAX_SAFE_INTEGER,this.FocusTabPressed=!1,this.DimBgRatio=0,this.DrawList=new DrawList(imgui,"guictx"),this.MouseCursor=MouseCursor.Arrow,this.DragDropActive=!1,this.DragDropWithinSourceOrTarget=!1,this.DragDropSourceFlags=0,this.DragDropSourceFrameCount=-1,this.DragDropMouseButton=-1,this.DragDropPayload=new Payload,this.DragDropTargetRect=new Rect,this.DragDropTargetId=0,this.DragDropAcceptFlags=0,this.DragDropAcceptIdCurrRectSurface=0,this.ActiveIdDragDropAcceptIdCurr=0,this.DragDropAcceptIdPrev=0,this.DragDropAcceptFrameCount=-1,this.TabBars={},this.CurrentTabBar=null,this.CurrentTabBarStack=new ArrayEx,this.TabSortByWidthBuffer=new ArrayEx,this.InputTextState=new InputTextState(this),this.InputTextPasswordFont=null,this.ScalarAsInputTextId=0,this.ColorEditOptions=ColorEditFlags.OptionsDefault,this.ColorPickerRef=Color.rgba(),this.DragCurrentAccumDirty=!1,this.DragCurrentAccum=0,this.DragSpeedDefaultRatio=.01,this.ScrollbarClickDeltaToGrabCenter=new Vec2(0,0),this.TooltipOverrideCount=0,this.PrivateClipboard=null,this.MultiSelectScopeId=0,this.PlatformImePos=new Vec2(Number.MAX_VALUE,Number.MAX_VALUE),this.PlatformImeLastPos=new Vec2(Number.MAX_VALUE,Number.MAX_VALUE),this.SettingsLoaded=!1,this.SettingsDirtyTimer=0,this.SettingsHandlers=new ArrayEx,this.SettingsHandlers.push(new WindowsSettingsHandler),this.SettingsHandlers.push(this.Style),this.SettingsWindows=new ArrayEx,this.SettingsIniData="",this.LogEnabled=!1,this.LogType=LogType.None,this.LogFile=null,this.LogLinePosY=Number.MAX_VALUE,this.LogLineFirstItem=!1,this.LogDepthRef=0,this.LogDepthToExpand=this.LogDepthToExpandDefault=2,this.FramerateSecPerFrame=new ArrayEx,this.FramerateSecPerFrame.length=120,this.FramerateSecPerFrame.fill(0),this.FramerateSecPerFrameIdx=0,this.FramerateSecPerFrameAccum=0,this.WantCaptureMouseNextFrame=-1,this.WantCaptureKeyboardNextFrame=-1,this.WantTextInputNextFrame=-1,this.TempBuffer=new ArrayEx}NewFrame(time){this.IO.NewFrame(time)}EndFrame(){this.IO.EndFrame()}}class SettingsHandler{constructor(){}GetTypeName(){console.assert(0)}Encapsulate(imgui){console.assert(0)}Instantiate(imgui,obj){console.assert(0)}}class WindowSettings{constructor(o){this.Name=null,this.ID=0,this.Pos=new Vec2,this.Size=new Vec2,this.Collapsed=!1}Encapsulate(){return this}Instantiate(o){this.Name=o.Name,this.ID=o.ID,this.Pos.x=o.Pos.x,this.Pos.y=o.Pos.y,this.Size.x=o.Size.x,this.Size.y=o.Size.y,this.Collapsed=o.Collapsed}}class WindowsSettingsHandler extends SettingsHandler{constructor(){super()}GetTypeName(){return"Windows"}Encapsulate(imgui){let g=imgui.guictx,o={};for(var win of g.Windows)if(!(win.Flags&WindowFlags.NoSavedSettings)){let settings=-1!=win.SettingsIdx?g.SettingsWindows[win.SettingsIdx]:imgui.findWindowSettings(win.ID);settings||(settings=imgui.createNewWindowSettings(win.Name),win.SettingsIdx=g.SettingsWindows.indexOf(settings)),console.assert(settings.ID==win.ID),settings.Pos.Copy(win.Pos),settings.Size.Copy(win.SizeFull),settings.Collapsed=win.Collapsed,o[win.Name]=settings.Encapsulate()}return o}Instantiate(imgui,strOrObj){let g=imgui.guictx;try{var key,el,o="string"==typeof strOrObj?JSON.parse(strOrObj):strOrObj;let extra=[];for(key in o){let ws=null;for(var w of g.SettingsWindows)if(key==w.Name){ws=w;break}null==ws&&(ws=new WindowSettings,extra.push(ws)),ws.Instantiate(o[key])}for(el of extra)g.SettingsWindows.push(el)}catch(err){console.error("JSON parse error: "+err)}}}var ImguiSettingsMixin={LoadIniSettingsFromDisk(d=null){null==d&&(d=this.guictx.IO.IniFilename);d=window.localStorage.getItem(d);d&&this.LoadIniSettingsFromMemory(d)},SaveIniSettingsToDisk(ini_filename){let g=this.guictx;var value;g.SettingsDirtyTimer=0,!ini_filename||(value=this.SaveIniSettingsToMemory())&&window.localStorage.setItem(ini_filename,value)},LoadIniSettingsFromMemory(json){try{var key,o=JSON.parse(json);for(key in o){let h=this.FindSettingsHandler(key);h&&h.Instantiate(this,o[key])}this.guictx.SettingsLoaded=!0}catch(err){console.error("Problem parsing settings",err)}},SaveIniSettingsToMemory(pretty=!1){let g=this.guictx,o={};for(let handler_n=g.SettingsDirtyTimer=0;handler_n<g.SettingsHandlers.length;handler_n++){let handler=g.SettingsHandlers[handler_n];var typename=handler.GetTypeName();o[typename]=handler.Encapsulate(this)}return g.SettingsIniData=pretty?JSON.stringify(o,null,2):JSON.stringify(o),g.SettingsIniData},MarkIniSettingsDirty(win=null){if(!(win&&win.Flags&WindowFlags.NoSavedSettings)){let g=this.guictx;g.SettingsDirtyTimer<=0&&(g.SettingsDirtyTimer=g.IO.IniSavingRate)}},createNewWindowSettings(name){let g=this.guictx;g.SettingsWindows.push_back(new WindowSettings);let wSetting=g.SettingsWindows.back();return wSetting.Name=name,wSetting.ID=GetHash(name),wSetting},findWindowSettings(id){var g=this.guictx;for(let i=0;i!=g.SettingsWindows.length;i++)if(g.SettingsWindows[i].ID==id)return g.SettingsWindows[i];return null},findOrCreateWindowSettings(name){var settings=this.findWindowSettings(GetHash(name));return settings||this.createNewWindowSettings(name)},FindSettingsHandler(type_name){var g=this.guictx;for(let i=0;i<g.SettingsHandlers.length;i++){let h=g.SettingsHandlers[i];if(h.GetTypeName()===type_name)return h}return null}};const sStdMeasureChars={capHeight:"S",baseline:"n",xHeight:"x",descent:"p",ascent:"h",tittle:"i"};class FontMetrics{constructor(){this.initialized=!1,this.padding=null,this.context=null,this.canvas=null}initialize(){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.initialized=!0}MeasureFont(family,size,weight,style,bypass){return this.SetFont(family,size,weight,style),this.GetMetrics(bypass?null:sStdMeasureChars)}SetFont(fontFamily,fontSize,fontWeight,fontStyle){this.initialized||this.initialize(),this.fontFamily=fontFamily,this.fontSize=fontSize,this.fontWeight=fontWeight,this.fontStyle=fontStyle,this.padding=.5*fontSize,this.canvas.width=2*fontSize,this.canvas.height=2*fontSize+this.padding,this.context.font=`${fontStyle} ${fontWeight} ${fontSize}px ${fontFamily}`,this.context.textBaseline="top",this.context.textAlign="center"}GetMetrics(chars=sStdMeasureChars){return null==chars?{fontFamily:this.fontFamily,fontSize:this.fontSize,fontWeight:this.fontWeight,capHeight:0,baseline:this.fontSize,xHeight:.5*this.fontSize,descent:this.fontSize,bottom:this.fontSize,ascent:0,tittle:.5*this.fontSize,top:0}:{fontFamily:this.fontFamily,fontSize:this.fontSize,fontWeight:this.fontWeight,capHeight:this.measureTop(chars.capHeight),baseline:this.measureBottom(chars.baseline),xHeight:this.measureTop(chars.xHeight),descent:this.measureBottom(chars.descent),bottom:this.computeLineHeight(),ascent:this.measureTop(chars.ascent),tittle:this.measureTop(chars.tittle),top:0}}setAlignment(baseline="top"){var ty="bottom"===baseline?this.canvas.height:0;this.context.setTransform(1,0,0,1,0,ty),this.context.textBaseline=baseline}updateText(text){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.fillText(text,this.canvas.width/2,this.padding,this.canvas.width)}computeLineHeight(){this.setAlignment("bottom");var gutter=this.canvas.height-this.measureBottom("A");return this.setAlignment("top"),this.measureBottom("A")+gutter}getPixels(text){return this.updateText(text),this.context.getImageData(0,0,this.canvas.width,this.canvas.height).data}getFirstIndex(pixels){for(let i=3,n=pixels.length;i<n;i+=4)if(0<pixels[i])return(i-3)/4;return pixels.length}getLastIndex(pixels){for(let i=pixels.length-1;3<=i;i-=4)if(0<pixels[i])return i/4;return 0}normalize(metrics,fontSize,origin){const result={};var key,offset=metrics[origin];for(key in metrics)result[key]=(metrics[key]-offset)/fontSize;return result}measureTop(text){return Math.round(this.getFirstIndex(this.getPixels(text))/this.canvas.width)-this.padding}measureBottom(text){return Math.round(this.getLastIndex(this.getPixels(text))/this.canvas.width)-this.padding}}function LineClosestPoint(a,b,dot){var abLenSq=Vec2.Subtract(dot,a),abDir=Vec2.Subtract(b,a),dot=Vec2.dot(abLenSq,abDir);if(dot<0)return a;abLenSq=Vec2.dot(abDir,abDir);return abLenSq<dot?b:Vec2.Add(a,Vec2.Scale(abDir,dot/abLenSq))}function TriangleContainsPoint(b3,b2,c,p){var b1=(p.x-b2.x)*(b3.y-b2.y)-(p.y-b2.y)*(b3.x-b2.x)<0,b2=(p.x-c.x)*(b2.y-c.y)-(p.y-c.y)*(b2.x-c.x)<0,b3=(p.x-b3.x)*(c.y-b3.y)-(p.y-b3.y)*(c.x-b3.x)<0;return b1==b2&&b2==b3}function TriangleBarycentricCoords(out_w,v0,out_v,v2){v0=Vec2.Subtract(v0,out_w),out_v=Vec2.Subtract(out_v,out_w),v2=Vec2.Subtrace(v2,out_w),out_w=v0.x*out_v.y-out_v.x*v0.y,out_v=(v2.x*out_v.y-out_v.x*v2.y)/out_w,out_w=(v0.x*v2.y-v2.x*v0.y)/out_w;return[out_v,out_w,1-out_v-out_w]}function TriangleClosestPoint(dist2_bc,proj_ca,dist2_ab,m){var proj_ab=LineClosestPoint(dist2_bc,proj_ca,m),proj_bc=LineClosestPoint(proj_ca,dist2_ab,m),proj_ca=LineClosestPoint(dist2_ab,dist2_bc,m),dist2_ab=Vec2.LengthSqr(m,proj_ab),dist2_bc=Vec2.LengthSqr(m,proj_bc),m=Vec2.LengthSqr(m,proj_ca),m=Math.min(dist2_ab,dist2_bc,m);return m==dist2_ab?proj_ab:m==dist2_bc?proj_bc:proj_ca}class ColorMod{constructor(field,backupValue){this.Field=field,this.BackupValue=backupValue}}function _lerp(v,a,b){return a+(b-a)*v}var CSSColors={},Colors={};class Color{static RandomCss(){var keys=Object.keys(CSSColors),i=Math.floor(Math.random()*keys.length);return Color.Css(keys[i])}static Random(min=0,max=1){return Color.rgb(_lerp(Math.random(),min,max),_lerp(Math.random(),min,max),_lerp(Math.random(),min,max))}static Css(nm){return CSSColors[nm].Clone()}static FromArray(c,alpha=!0,space=void 0){return new Color(c[0],c[1],c[2],alpha?c[3]:1,space)}static FromCSS(base){let m=/^(rgba?)\s*\(([^)]*)\)/.exec(base),fields;if(m)fields=m[2].split(",").map((x,i)=>i<3?parseFloat(x)/255:parseFloat(x));else{if(!/^#[A-Fa-f0-9]+$/.test(base))return null;{var base=base.slice(1),size=base.length;let parts=base.split(size<=4?/(.)/:/(..)/).filter(x=>""!=x);fields=parts.map(function(x){return size<=4?parseInt(x+"0",16)/255:parseInt(x,16)/255})}}return 3==fields.length?Color.rgb(fields[0],fields[1],fields[2]):Color.rgba(fields[0],fields[1],fields[2],fields[3])}static rgbi(r,g,b){return void 0===r&&(r=g=b=0),new Color(r/255,g/255,b/255,1)}static rgbai(r,g,b,a){return void 0===r&&(r=g=b=0,a=1),new Color(r/255,g/255,b/255,a/255)}static rgb(r,g,b){return void 0===r&&(r=g=b=0),new Color(r,g,b,1)}static rgba(r,g,b,a){return void 0===r&&(r=g=b=0,a=1),new Color(r,g,b,a)}static hsv(h,s,v){return new Color(h,s,v,1,"hsv")}static hsva(h,s,v,a){return new Color(h,s,v,a,"hsv")}static hsl(h,s,l){return new Color(h,s,l,1,"hsl")}static hsla(h,s,l,a){return new Color(h,s,l,a,"hsl")}static Lerp(a,b,pct){return console.assert(a.space==b.space),new Color(a.x+(b.x-a.x)*pct,a.y+(b.y-a.y)*pct,a.z+(b.z-a.z)*pct,a.a+(b.a-a.a)*pct)}static Blend(x,y){var z=y.a;if(1==z)return y;if(0==z)return x;var under=x.AsRGB(),over=y.AsRGB(),x=Vec1.Lerp(under.x,over.x,z),y=Vec1.Lerp(under.y,over.y,z),z=Vec1.Lerp(under.z,over.z,z);return new Color(x,y,z)}static Instantiate(fields){let c=new Color;fields=fields.split(" ");return console.assert(5==fields.length),c.space=fields[0],c.x=Number(fields[1]),c.y=Number(fields[2]),c.z=Number(fields[3]),c.a=Number(fields[4]),c}constructor(x,y,z,a,space="rgb"){this.x=x,this.y=y,this.z=z,this.space=space,this.a=void 0===a?1:a,this.str=null}Encapsulate(){return`${this.space} ${this.x.toFixed(3)} `+`${this.y.toFixed(3)} ${this.z.toFixed(3)} ${this.a.toFixed(3)}`}Copy(src){this.x=src.x,this.y=src.y,this.z=src.z,this.a=src.a,this.space=src.space,this.str=null}CopyArray(src){this.x=src[0],this.y=src[1],this.z=src[2],this.a=src[3],this.str=null}Equals(other){return this.AsStr()==other.AsStr()}Clone(){return new Color(this.x,this.y,this.z,this.a,this.space)}Dirty(){this.str&&(this.str=null)}Index(i){return 0==i?this.x:1==i?this.y:2==i?this.z:3==i?this.a:void 0}AsArray(space=null){return null==space||space==this.space?[this.x,this.y,this.z,this.a]:(console.assert(0,"could do more work here."),[])}AsIArray(){return[Math.round(255*this.x),Math.round(255*this.y),Math.round(255*this.z),Math.round(255*this.a)]}AsFloatStr(a){var x=this.x.toFixed(3),y=this.y.toFixed(3),z=this.z.toFixed(3);if(a)return`${this.space}(${x}, ${y}, ${z})`;a=this.a.toFixed(3);return`${this.space}a(${x}, ${y}, ${z}, ${a})`}AsIntStr(a){var x=Math.floor(255*this.x),y=Math.floor(255*this.y),z=Math.floor(255*this.z);if(a)return`${this.space}(${x}, ${y}, ${z})`;a=Math.floor(255*this.a);return`${this.space}a(${x}, ${y}, ${z}, ${a})`}AsHashStr(noalpha=!1){var c=this.AsRGB(),r=("0"+Math.floor(255*c.x).toString(16)).slice(-2),g=("0"+Math.floor(255*c.y).toString(16)).slice(-2),b=("0"+Math.floor(255*c.z).toString(16)).slice(-2);return(noalpha?`#${r}${g}${b}`:`#${r}${g}${b}${("0"+Math.floor(255*c.a).toString(16)).slice(-2)}`).toUpperCase()}AsHexStr(noalpha=!1){var c=this.AsRGB(),r=("0"+Math.floor(255*c.x).toString(16)).slice(-2),g=("0"+Math.floor(255*c.y).toString(16)).slice(-2),b=("0"+Math.floor(255*c.z).toString(16)).slice(-2);return noalpha?`0x${r}${g}${b}`:`0x${r}${g}${b}${("0"+Math.floor(255*c.a).toString(16)).slice(-2)}`}AsStr(alphaMult=0){if(this.str)return this.str;let c=this.AsRGB();var r=(255*c.x).toFixed(0),g=(255*c.y).toFixed(0),b=(255*c.z).toFixed(0),a=c.a.toFixed(3);return this.str=`rgba(${r},${g},${b},${a})`,this.str}AsMultiStr(noalpha=!1){switch(this.space){case"rgb":return`${this.AsHashStr(noalpha)}\n${this.AsIntStr(noalpha)}\n${this.AsFloatStr(noalpha)}`;case"hsv":{let dstr=this.AsIntStr(noalpha),fstr=this.AsFloatStr(noalpha);return`${dstr}\n${fstr}`}case"hsl":console.assert(0,"unimplemented")}}AsOpaque(){return 1==this.a?this:new Color(this.x,this.y,this.z,1,this.space)}AsRGB(alphaMult=1,clone=!1){switch(this.space){case"rgb":return 1!=alphaMult||clone?new Color(this.x,this.y,this.z,this.a*alphaMult):this;case"hsv":{var f=this.x,s=this.y,v=this.z;let r,g,b;var hue2rgb=Math.floor(6*f),f=6*f-hue2rgb;let p=v*(1-s),q=v*(1-f*s);var t=v*(1-(1-f)*s);switch(hue2rgb%6){case 0:r=v,g=t,b=p;break;case 1:r=q,g=v,b=p;break;case 2:r=p,g=v,b=t;break;case 3:r=p,g=q,b=v;break;case 4:r=t,g=p,b=v;break;case 5:r=v,g=p,b=q}return new Color(r,g,b,this.a*alphaMult)}case"hsl":{let r,g,b,h=this.x,s=this.y;var q,p=this.z;return 0==this.y?r=g=b=this.z:(hue2rgb=function(p,q,t){return t<0&&(t+=1),1<t&&--t,t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p},p=2*p-(q=p<.5?p*(1+s):p+s-p*s),r=hue2rgb(p,q,h+1/3),g=hue2rgb(p,q,h),b=hue2rgb(p,q,h-1/3)),new Color(r,g,b,this.a*this.alphaMult)}}}AsHSL(){switch(this.space){case"rgb":{var r=this.x,g=this.y,b=this.z,a=this.a,max=Math.max(r,g,b),min=Math.min(r,g,b);let h,s,l=(max+min)/2;if(max==min)h=0,s=0;else{var d=max-min;switch(s=.5<l?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return new Color(h,s,l,a,"hsl")}case"hsl":return this;case"hsv":return this.AsRGB().AsHSL()}}AsHSV(clone=!1){switch(this.space){case"rgb":{let K=0,t,r=this.x,g=this.y,b=this.z;g<b&&(t=g,g=b,b=t,K=-1),r<g&&(t=r,r=g,g=t,K=-2/6-K);var v=r-(g<b?g:b),h=Math.abs(K+(g-b)/(6*v+1e-20)),s=v/(r+1e-20),v=r;return new Color(h,s,v,this.a,"hsv")}case"hsl":return this.AsRGB().AsHSV();case"hsv":return clone?this.Clone():this}}rgbaStr(){var c=this.AsRGB();return"rgba("+(255*c.x).toFixed(0)+","+(255*c.y).toFixed(0)+","+(255*c.z).toFixed(0)+","+this.a.toFixed(3)+")"}hslaStr(){var c=this.AsHSL();return"hsla("+(360*c.x).toFixed(0)+","+(100*c.y).toFixed(0)+"%,"+(100*c.z).toFixed(0)+"%,"+this.a.toFixed(3)+")"}}CSSColors={aliceblue:Color.rgbi(240,248,255),antiquewhite:Color.rgbi(250,235,215),aqua:Color.rgbi(0,255,255),aquamarine:Color.rgbi(127,255,212),azure:Color.rgbi(240,255,255),beige:Color.rgbi(245,245,220),bisque:Color.rgbi(255,228,196),black:Color.rgbi(0,0,0),blanchedalmond:Color.rgbi(255,235,205),blue:Color.rgbi(0,0,255),blueviolet:Color.rgbi(138,43,226),brown:Color.rgbi(165,42,42),burlywood:Color.rgbi(222,184,135),cadetblue:Color.rgbi(95,158,160),chartreuse:Color.rgbi(127,255,0),chocolate:Color.rgbi(210,105,30),coral:Color.rgbi(255,127,80),cornflowerblue:Color.rgbi(100,149,237),cornsilk:Color.rgbi(255,248,220),crimson:Color.rgbi(220,20,60),cyan:Color.rgbi(0,255,255),darkblue:Color.rgbi(0,0,139),darkcyan:Color.rgbi(0,139,139),darkgoldenrod:Color.rgbi(184,134,11),darkgray:Color.rgbi(169,169,169),darkgreen:Color.rgbi(0,100,0),darkgrey:Color.rgbi(169,169,169),darkkhaki:Color.rgbi(189,183,107),darkmagenta:Color.rgbi(139,0,139),darkolivegreen:Color.rgbi(85,107,47),darkorange:Color.rgbi(255,140,0),darkorchid:Color.rgbi(153,50,204),darkred:Color.rgbi(139,0,0),darksalmon:Color.rgbi(233,150,122),darkseagreen:Color.rgbi(143,188,143),darkslateblue:Color.rgbi(72,61,139),darkslategray:Color.rgbi(47,79,79),darkslategrey:Color.rgbi(47,79,79),darkturquoise:Color.rgbi(0,206,209),darkviolet:Color.rgbi(148,0,211),deeppink:Color.rgbi(255,20,147),deepskyblue:Color.rgbi(0,191,255),dimgray:Color.rgbi(105,105,105),dimgrey:Color.rgbi(105,105,105),dodgerblue:Color.rgbi(30,144,255),firebrick:Color.rgbi(178,34,34),floralwhite:Color.rgbi(255,250,240),forestgreen:Color.rgbi(34,139,34),fuchsia:Color.rgbi(255,0,255),gainsboro:Color.rgbi(220,220,220),ghostwhite:Color.rgbi(248,248,255),gold:Color.rgbi(255,215,0),goldenrod:Color.rgbi(218,165,32),gray:Color.rgbi(128,128,128),green:Color.rgbi(0,128,0),greenyellow:Color.rgbi(173,255,47),grey:Color.rgbi(128,128,128),honeydew:Color.rgbi(240,255,240),hotpink:Color.rgbi(255,105,180),indianred:Color.rgbi(205,92,92),indigo:Color.rgbi(75,0,130),ivory:Color.rgbi(255,255,240),khaki:Color.rgbi(240,230,140),lavender:Color.rgbi(230,230,250),lavenderblush:Color.rgbi(255,240,245),lawngreen:Color.rgbi(124,252,0),lemonchiffon:Color.rgbi(255,250,205),lightblue:Color.rgbi(173,216,230),lightcoral:Color.rgbi(240,128,128),lightcyan:Color.rgbi(224,255,255),lightgoldenrodyellow:Color.rgbi(250,250,210),lightgray:Color.rgbi(211,211,211),lightgreen:Color.rgbi(144,238,144),lightgrey:Color.rgbi(211,211,211),lightpink:Color.rgbi(255,182,193),lightsalmon:Color.rgbi(255,160,122),lightseagreen:Color.rgbi(32,178,170),lightskyblue:Color.rgbi(135,206,250),lightslategray:Color.rgbi(119,136,153),lightslategrey:Color.rgbi(119,136,153),lightsteelblue:Color.rgbi(176,196,222),lightyellow:Color.rgbi(255,255,224),lime:Color.rgbi(0,255,0),limegreen:Color.rgbi(50,205,50),linen:Color.rgbi(250,240,230),magenta:Color.rgbi(255,0,255),maroon:Color.rgbi(128,0,0),mediumaquamarine:Color.rgbi(102,205,170),mediumblue:Color.rgbi(0,0,205),mediumorchid:Color.rgbi(186,85,211),mediumpurple:Color.rgbi(147,112,219),mediumseagreen:Color.rgbi(60,179,113),mediumslateblue:Color.rgbi(123,104,238),mediumspringgreen:Color.rgbi(0,250,154),mediumturquoise:Color.rgbi(72,209,204),mediumvioletred:Color.rgbi(199,21,133),midnightblue:Color.rgbi(25,25,112),mintcream:Color.rgbi(245,255,250),mistyrose:Color.rgbi(255,228,225),moccasin:Color.rgbi(255,228,181),navajowhite:Color.rgbi(255,222,173),navy:Color.rgbi(0,0,128),oldlace:Color.rgbi(253,245,230),olive:Color.rgbi(128,128,0),olivedrab:Color.rgbi(107,142,35),orange:Color.rgbi(255,165,0),orangered:Color.rgbi(255,69,0),orchid:Color.rgbi(218,112,214),palegoldenrod:Color.rgbi(238,232,170),palegreen:Color.rgbi(152,251,152),paleturquoise:Color.rgbi(175,238,238),palevioletred:Color.rgbi(219,112,147),papayawhip:Color.rgbi(255,239,213),peachpuff:Color.rgbi(255,218,185),peru:Color.rgbi(205,133,63),pink:Color.rgbi(255,192,203),plum:Color.rgbi(221,160,221),powderblue:Color.rgbi(176,224,230),purple:Color.rgbi(128,0,128),red:Color.rgbi(255,0,0),rosybrown:Color.rgbi(188,143,143),royalblue:Color.rgbi(65,105,225),saddlebrown:Color.rgbi(139,69,19),salmon:Color.rgbi(250,128,114),sandybrown:Color.rgbi(244,164,96),seagreen:Color.rgbi(46,139,87),seashell:Color.rgbi(255,245,238),sienna:Color.rgbi(160,82,45),silver:Color.rgbi(192,192,192),skyblue:Color.rgbi(135,206,235),slateblue:Color.rgbi(106,90,205),slategray:Color.rgbi(112,128,144),slategrey:Color.rgbi(112,128,144),snow:Color.rgbi(255,250,250),springgreen:Color.rgbi(0,255,127),steelblue:Color.rgbi(70,130,180),tan:Color.rgbi(210,180,140),teal:Color.rgbi(0,128,128),thistle:Color.rgbi(216,191,216),tomato:Color.rgbi(255,99,71),turquoise:Color.rgbi(64,224,208),violet:Color.rgbi(238,130,238),wheat:Color.rgbi(245,222,179),white:Color.rgbi(255,255,255),whitesmoke:Color.rgbi(245,245,245),yellow:Color.rgbi(255,255,0),yellowgreen:Color.rgbi(154,205,50)};for(let k in CSSColors)CSSColors[k].str=k;var HueRampStr=[CSSColors.red.AsStr(),CSSColors.yellow.AsStr(),CSSColors.green.AsStr(),CSSColors.cyan.AsStr(),CSSColors.blue.AsStr(),CSSColors.magenta.AsStr(),CSSColors.red.AsStr()],Colors={clear:Color.rgba(0,0,0,0),black:Color.rgb(0,0,0),gray:Color.rgb(.5,.5,.5),white:Color.rgb(1,1,1),red:Color.rgb(1,0,0),green:Color.rgb(0,1,0),blue:Color.rgb(0,0,1),cyan:Color.rgb(0,1,1),yellow:Color.rgb(1,1,0),magenta:Color.rgb(1,0,1),dark1:Color.rgb(.05,.05,.08),dark2:Color.rgb(.08,.08,.1),dark3:Color.rgb(.1,.1,.15),mid1:Color.rgb(.4,.4,.4)};let rgba=Color.rgba,rgb=Color.rgb,rgbi=Color.rgbi;var DarkColors={};let c=DarkColors,bgActive=rgb(.16,.29,.48),bg=rgb(.04,.04,.04);DarkColors.Border=rgba(.43,.43,.5,.5),DarkColors.BorderShadow=rgba(0,0,0,0),DarkColors.Button=rgba(.26,.59,.98,.4),DarkColors.ButtonActive=rgba(.06,.53,.98,1),DarkColors.ButtonHovered=rgba(.26,.59,.98,1),DarkColors.CheckMark=rgba(.26,.59,.98,1),DarkColors.CheckerOff=rgbi(64,64,64),DarkColors.CheckerOn=rgbi(204,204,204),DarkColors.ChildBg=rgba(0,0,0,0),DarkColors.DragDropTarget=rgba(1,1,0,.9),DarkColors.FBDir=rgb(.2,.9,.2),DarkColors.FBFile=rgb(.8,.8,.8),DarkColors.FBMkDir=rgb(.3,.6,1),DarkColors.FrameBg=rgba(.16,.29,.48,.54),DarkColors.FrameBgActive=rgba(.26,.59,.98,.67),DarkColors.FrameBgHovered=rgba(.26,.59,.98,.4),DarkColors.Header=rgba(.26,.59,.98,.31),DarkColors.HeaderActive=rgba(.26,.59,.98,1),DarkColors.HeaderHovered=rgba(.26,.59,.98,.8),DarkColors.Link=rgb(.3,.6,.9),DarkColors.LinkActive=rgb(.2,.9,.7),DarkColors.LinkHovered=rgb(.4,.6,1),DarkColors.MenuBarBg=rgba(.14,.14,.14,1),DarkColors.ModalWindowDimBg=rgba(.8,.8,.8,.35),DarkColors.NavHighlight=rgba(.26,.59,.98,1),DarkColors.NavWindowingDimBg=rgba(.8,.8,.8,.2),DarkColors.NavWindowingHighlight=rgba(1,1,1,.7),DarkColors.PlotBg=rgb(.1,.1,.1),DarkColors.PlotHistogram=rgba(.9,.7,0,1),DarkColors.PlotHistogramDimmed=rgba(.45,.35,0,1),DarkColors.PlotHistogramHovered=rgba(1,.6,0,1),DarkColors.PlotLines=rgba(.61,.61,.61,1),DarkColors.PlotLinesDimmed=rgba(.3,.3,.3,1),DarkColors.PlotLinesHovered=rgba(1,.43,.35,1),DarkColors.PlotSignal=rgba(.9,.7,0,1),DarkColors.PlotSignalDimmed=rgba(.45,.35,0,1),DarkColors.PlotSignalHovered=rgba(1,.43,.35,1),DarkColors.PopupBg=rgba(.08,.08,.08,.94),DarkColors.ResizeGrip=rgba(.26,.59,.98,.25),DarkColors.ResizeGripActive=rgba(.26,.59,.98,.95),DarkColors.ResizeGripHovered=rgba(.26,.59,.98,.67),DarkColors.ScrollbarBg=rgba(.02,.02,.02,.53),DarkColors.ScrollbarGrab=rgba(.31,.31,.31,1),DarkColors.ScrollbarGrabActive=rgba(.51,.51,.51,1),DarkColors.ScrollbarGrabHovered=rgba(.41,.41,.41,1),DarkColors.Separator=c.Border,DarkColors.SeparatorActive=rgba(.1,.4,.75,1),DarkColors.SeparatorHovered=rgba(.1,.4,.75,.78),DarkColors.SliderGrab=rgba(.24,.52,.88,1),DarkColors.SliderGrabActive=rgba(.26,.59,.98,1),DarkColors.Tab=Color.Lerp(c.Header,bgActive,.8),DarkColors.TabActive=Color.Lerp(c.HeaderActive,bgActive,.6),DarkColors.TabHovered=c.HeaderHovered,DarkColors.TabUnfocused=Color.Lerp(c.Tab,bg,.8),DarkColors.TabUnfocusedActive=Color.Lerp(c.TabActive,bg,.4),DarkColors.Text=rgb(.9,.9,.9),DarkColors.TextDisabled=rgb(.5,.5,.5),DarkColors.TextEmphasized=rgb(.8,1,.8),DarkColors.TextHighlighted=rgbi(25,211,97),DarkColors.TextError=CSSColors.darkorange,DarkColors.TextSelectedBg=rgba(.26,.59,.98,.35),DarkColors.TitleBg=bg,DarkColors.TitleBgActive=bgActive,DarkColors.TitleBgCollapsed=rgba(0,0,0,.51),DarkColors.WindowBg=rgba(.06,.06,.06,.94),DarkColors.DEBUG=rgb(.2,.4,.9),DarkColors.INFO=rgb(.3,.8,.9),DarkColors.NOTICE=rgb(.4,.9,.4),DarkColors.WARNING=CSSColors.darkorange,DarkColors.ALERT=CSSColors.darkorange,DarkColors.ERROR=rgb(1,0,0),DarkColors._DEBUG0=rgba(1,0,0,.5),DarkColors._DEBUG1=rgba(0,1,0,.5),DarkColors._DEBUG2=rgba(0,0,1,.5),DarkColors._DEBUG3=rgba(1,1,0,.5);var ClassicColors=Object.assign({},DarkColors);c=ClassicColors,ClassicColors.Border=rgba(.5,.5,.5,.5),ClassicColors.BorderShadow=rgba(0,0,0,0),ClassicColors.Button=rgba(.35,.4,.61,.62),ClassicColors.ButtonActive=rgba(.46,.54,.8,1),ClassicColors.ButtonHovered=rgba(.4,.48,.71,.79),ClassicColors.CheckMark=rgba(.9,.9,.9,.5),ClassicColors.CheckerOff=rgbi(64,64,64),ClassicColors.CheckerOn=rgbi(204,204,204),ClassicColors.ChildBg=rgba(0,0,0,0),ClassicColors.DragDropTarget=rgba(1,1,0,.9),ClassicColors.FBDir=rgb(.2,.9,.2),ClassicColors.FBFile=rgb(.8,.8,.8),ClassicColors.FBMkDir=rgb(.2,.4,.9),ClassicColors.FrameBg=rgba(.43,.43,.43,.39),ClassicColors.FrameBgActive=rgba(.42,.41,.64,.69),ClassicColors.FrameBgHovered=rgba(.47,.47,.69,.4),ClassicColors.Header=rgba(.4,.4,.9,.45),ClassicColors.HeaderActive=rgba(.53,.53,.87,.8),ClassicColors.HeaderHovered=rgba(.45,.45,.9,.8),ClassicColors.MenuBarBg=rgba(.4,.4,.55,.8),ClassicColors.ModalWindowDimBg=rgba(.2,.2,.2,.35),ClassicColors.NavHighlight=c.HeaderHovered,ClassicColors.NavWindowingDimBg=rgba(.8,.8,.8,.2),ClassicColors.NavWindowingHighlight=rgba(1,1,1,.7),ClassicColors.PlotBg=rgb(.1,.1,.1),ClassicColors.PlotHistogram=rgba(.9,.7,0,1),ClassicColors.PlotHistogramDimmed=rgba(1,.6,0,1),ClassicColors.PlotHistogramHovered=rgba(1,.6,0,1),ClassicColors.PlotLines=rgba(1,1,1,1),ClassicColors.PlotLinesDimmed=rgba(.9,.7,0,1),ClassicColors.PlotLinesHovered=rgba(.9,.7,0,1),ClassicColors.PlotSignal=rgba(1,1,1,1),ClassicColors.PlotSignalDimmed=rgba(.9,.7,0,1),ClassicColors.PlotSignalHovered=rgba(.9,.7,0,1),ClassicColors.PopupBg=rgba(.11,.11,.14,.92),ClassicColors.ResizeGrip=rgba(1,1,1,.16),ClassicColors.ResizeGripActive=rgba(.78,.82,1,.9),ClassicColors.ResizeGripHovered=rgba(.78,.82,1,.6),ClassicColors.ScrollbarBg=rgba(.2,.25,.3,.6),ClassicColors.ScrollbarGrab=rgba(.4,.4,.8,.3),ClassicColors.ScrollbarGrabActive=rgba(.41,.39,.8,.6),ClassicColors.ScrollbarGrabHovered=rgba(.4,.4,.8,.4),ClassicColors.Separator=rgba(.5,.5,.5,1),ClassicColors.SeparatorActive=rgba(.7,.7,.9,1),ClassicColors.SeparatorHovered=rgba(.6,.6,.7,1),ClassicColors.SliderGrab=rgba(1,1,1,.3),ClassicColors.SliderGrabActive=rgba(.41,.39,.8,.6),ClassicColors.Tab=Color.Lerp(c.Header,c.TitleBgActive,.8),ClassicColors.TabActive=Color.Lerp(c.HeaderActive,c.TitleBgActive,.6),ClassicColors.TabHovered=c.HeaderHovered,ClassicColors.TabUnfocused=Color.Lerp(c.Tab,c.TitleBg,.8),ClassicColors.TabUnfocusedActive=Color.Lerp(c.TabActive,c.TitleBg,.4),ClassicColors.Text=rgba(.9,.9,.9,1),ClassicColors.TextDisabled=rgba(.6,.6,.6,1),ClassicColors.TextEmphasized=rgba(.6,.8,.6,1),ClassicColors.TextError=CSSColors.darkorange,ClassicColors.TextSelectedBg=rgba(0,0,1,.35),ClassicColors.TitleBg=rgba(.27,.27,.54,.83),ClassicColors.TitleBgActive=rgba(.32,.32,.63,.87),ClassicColors.TitleBgCollapsed=rgba(.4,.4,.8,.2),ClassicColors.WindowBg=rgba(0,0,0,.7);var LightColors=Object.assign({},DarkColors);c=LightColors,LightColors.Border=rgba(0,0,0,.3),LightColors.BorderShadow=rgba(0,0,0,0),LightColors.Button=rgba(.26,.59,.98,.4),LightColors.ButtonActive=rgba(.06,.53,.98,1),LightColors.ButtonHovered=rgba(.26,.59,.98,1),LightColors.CheckMark=rgba(.26,.59,.98,1),LightColors.CheckerOff=rgbi(64,64,64),LightColors.CheckerOn=rgbi(204,204,204),LightColors.ChildBg=rgba(0,0,0,0),LightColors.DragDropTarget=rgba(.26,.59,.98,.95),LightColors.FBDir=rgb(.2,.9,.2),LightColors.FBFile=rgb(.8,.8,.8),LightColors.FBMkDir=rgb(.2,.4,.9),LightColors.FrameBg=rgba(1,1,1,1),LightColors.FrameBgActive=rgba(.26,.59,.98,.67),LightColors.FrameBgHovered=rgba(.26,.59,.98,.4),LightColors.Header=rgba(.26,.59,.98,.31),LightColors.HeaderActive=rgba(.26,.59,.98,1),LightColors.HeaderHovered=rgba(.26,.59,.98,.8),LightColors.MenuBarBg=rgba(.86,.86,.86,1),LightColors.ModalWindowDimBg=rgba(.2,.2,.2,.35),LightColors.NavHighlight=c.HeaderHovered,LightColors.NavWindowingDimBg=rgba(.2,.2,.2,.2),LightColors.NavWindowingHighlight=rgba(.7,.7,.7,.7),LightColors.PlotBg=rgb(.1,.1,.1),LightColors.PlotHistogram=rgba(.9,.7,0,1),LightColors.PlotHistogramDimmed=rgba(.9,.7,0,1),LightColors.PlotHistogramHovered=rgba(1,.45,0,1),LightColors.PlotLines=rgba(.39,.39,.39,1),LightColors.PlotLinesDimmed=rgba(.39,.39,.39,1),LightColors.PlotLinesHovered=rgba(1,.43,.35,1),LightColors.PlotSignal=rgba(.9,.7,0,1),LightColors.PlotSignalDimmed=rgba(.9,.7,0,1),LightColors.PlotSignalHovered=rgba(1,.45,0,1),LightColors.PopupBg=rgba(1,1,1,.98),LightColors.ResizeGrip=rgba(.8,.8,.8,.56),LightColors.ResizeGripActive=rgba(.26,.59,.98,.95),LightColors.ResizeGripHovered=rgba(.26,.59,.98,.67),LightColors.ScrollbarBg=rgba(.98,.98,.98,.53),LightColors.ScrollbarGrab=rgba(.69,.69,.69,.8),LightColors.ScrollbarGrabActive=rgba(.49,.49,.49,1),LightColors.ScrollbarGrabHovered=rgba(.49,.49,.49,.8),LightColors.Separator=rgba(.39,.39,.39,1),LightColors.SeparatorActive=rgba(.14,.44,.8,1),LightColors.SeparatorHovered=rgba(.14,.44,.8,.78),LightColors.SliderGrab=rgba(.26,.59,.98,.78),LightColors.SliderGrabActive=rgba(.46,.54,.8,.6),LightColors.Tab=Color.Lerp(c.Header,c.TitleBgActive,.9),LightColors.TabActive=Color.Lerp(c.HeaderActive,c.TitleBgActive,.6),LightColors.TabHovered=c.HeaderHovered,LightColors.TabUnfocused=Color.Lerp(c.Tab,c.TitleBg,.8),LightColors.TabUnfocusedActive=Color.Lerp(c.TabActive,c.TitleBg,.4),LightColors.Text=rgba(0,0,0,1),LightColors.TextDisabled=rgba(.6,.6,.6,1),LightColors.TextEmphasized=rgba(0,.2,0,1),LightColors.TextError=CSSColors.darkorange,LightColors.TextSelectedBg=rgba(.26,.59,.98,.35),LightColors.TitleBg=rgba(.96,.96,.96,1),LightColors.TitleBgActive=rgba(.82,.82,.82,1),LightColors.TitleBgCollapsed=rgba(1,1,1,.51),LightColors.WindowBg=rgba(.94,.94,.94,1);var DebugColors=Object.assign({},DarkColors);for(let k in DebugColors)DebugColors[k]=Color.RandomCss();var ColorSchemes={ClassicColors:ClassicColors,DarkColors:DarkColors,LightColors:LightColors,DebugColors:DebugColors};class StyleMod{constructor(field,val){this.Field=field,this.Value=val}}class Style extends SettingsHandler{constructor(fontAtlas,imgui){super(),this._imgui=imgui,this.Alpha=1,this.WindowPadding=new Vec2(8,8),this.WindowRounding=7,this.WindowBorderSize=1,this.WindowMinSize=new Vec2(32,32),this.WindowTitleAlign=new Vec2(0,.5),this.ChildRounding=0,this.ChildBorderSize=1,this.PopupRounding=0,this.PopupBorderSize=1,this.FramePadding=new Vec2(4,3),this.FrameRounding=3,this.FrameBorderSize=0,this.ItemSpacing=new Vec2(8,4),this.ItemInnerSpacing=new Vec2(4,4),this.TextLineHeightPct=1.25,this.LabelWidth="MMMMMM",this.TouchExtraPadding=new Vec2(0,0),this.IndentSpacing=21,this.ColumnsMinSpacing=6,this.ScrollbarSize=16,this.ScrollbarRounding=3,this.GrabMinSize=10,this.GrabRounding=0,this.TabRounding=4,this.TabBorderSize=0,this.ButtonTextAlign=new Vec2(.5,.5),this.SelectableTextAlign=new Vec2(0,0),this.DisplayWindowPadding=new Vec2(19,19),this.DisplaySafeAreaPadding=new Vec2(3,3),this.MouseCursorScale=1,this.AntiAliasedLines=!0,this.AntiAliasedFill=!0,this.CurveTessellationTol=1.25,this.SetColorScheme("DarkColors"),this._DefaultFontSizes={Small:9,Std:10,Med:15,Big:20,Huge:32},this._DefaultFonts={Default:["Exo","Std","normal"],Label:["Exo","Std","bold"],Small:["Exo","Small","normal"],Med:["Exo","Med","normal"],Std:["Exo","Std","normal"],Big:["Exo","Big","normal"],serif:["Georgia","Std","normal"],"sans-serif":["Exo","Std","normal"],monospace:["SourceCodePro","Std","normal"],Fixed:["SourceCodePro","Std","normal"],MedFixed:["SourceCodePro","Med","normal"],BigFixed:["SourceCodePro","Big","normal"],Icons:["Material Icons","Std","normal"],BigIcons:["Material Icons","Big","normal"],HugeIcons:["Material Icons","Huge","normal"]},this.FontSizes=Object.assign({},this._DefaultFontSizes),this.Fonts=Object.assign({},this._DefaultFonts),this._MIcons={AccountBalance:String.fromCharCode(59471),AddLocation:String.fromCharCode(58727),BorderColor:String.fromCharCode(57899),Build:String.fromCharCode(59497),Camera:String.fromCharCode(59967),ChevronLeft:String.fromCharCode(58827),ChevronRight:String.fromCharCode(58828),Close:String.fromCharCode(58829),CloudDownload:String.fromCharCode(58048),CloudUpload:String.fromCharCode(58051),CreateNewFolder:String.fromCharCode(58060),DateRange:String.fromCharCode(59670),Delete:String.fromCharCode(59506),DeleteSweep:String.fromCharCode(57708),Edit:String.fromCharCode(58313),Error:String.fromCharCode(57344),ErrorOutline:String.fromCharCode(57345),Eye:String.fromCharCode(59636),Folder:String.fromCharCode(58055),FolderOpen:String.fromCharCode(58056),Help:String.fromCharCode(59527),HelpOutline:String.fromCharCode(59645),Info:String.fromCharCode(59534),InfoOutline:String.fromCharCode(59535),ImportExport:String.fromCharCode(57539),LibraryBooks:String.fromCharCode(57391),NavFwd:String.fromCharCode(58133),NavRev:String.fromCharCode(58132),Menu:String.fromCharCode(58834),MenuOpen:String.fromCharCode(59837),Mute:String.fromCharCode(57423),Monitization:String.fromCharCode(57955),MyLocation:String.fromCharCode(57424),NoMute:String.fromCharCode(57424),Note:String.fromCharCode(58273),Notes:String.fromCharCode(57964),OpenInBrowser:String.fromCharCode(59549),People:String.fromCharCode(59937),Pause:String.fromCharCode(57396),PickFile:String.fromCharCode(58056),PickImage:String.fromCharCode(58430),Play:String.fromCharCode(57399),Refresh:String.fromCharCode(58837),Settings:String.fromCharCode(59576),StarFilled:String.fromCharCode(59448),StarOutline:String.fromCharCode(59450),Stop:String.fromCharCode(57415),Sync:String.fromCharCode(58919),Trash:String.fromCharCode(59506),UnfoldLess:String.fromCharCode(58838),UnfoldMore:String.fromCharCode(58839),ViewComfy:String.fromCharCode(58410),ViewGrid:String.fromCharCode(59632),ViewHeadline:String.fromCharCode(59506),ViewList:String.fromCharCode(59506),ViewModule:String.fromCharCode(59632),Warning:String.fromCharCode(57346)},initMaterialIcons(this._MIcons),this._UIcons={NavIcon:String.fromCodePoint(9776),InfoIcon:String.fromCodePoint(8505),GearIcon:String.fromCodePoint(9881),RightArrow:String.fromCodePoint(9654),SmallRightArrow:String.fromCodePoint(9656),RightArrow2:String.fromCodePoint(9658),DownArrow:String.fromCodePoint(9660),SmallDownArrow:String.fromCodePoint(9662),Tricolon:String.fromCodePoint(8285)},this._fontAtlas=fontAtlas,this.GetFont("Default")}GetTypeName(){return"Style"}Encapsulate(imgui){let o={};for(var k of Object.getOwnPropertyNames(this))if("_"!=k[0])if("Colors"==k)for(var cnm in o.Colors={},this.Colors)o.Colors[cnm]=this.Colors[cnm].Encapsulate();else o[k]=this[k];return o.ColorScheme="custom",o}Instantiate(imgui,o){let deprecatedProps=["MIcons","UIcons"],knownProps=Object.getOwnPropertyNames(this);for(var k in o)if(-1==deprecatedProps.indexOf(k))if(-1==knownProps.indexOf(k))console.debug("Style unknown field: "+k);else if("Colors"==k){var cnm,colors=o[k];for(cnm in colors)this.Colors[cnm]=Color.Instantiate(colors[cnm])}else"Fonts"==k?this.Fonts=Object.assign(this._DefaultFonts,o[k]):"FontSizes"==k?this.FontSizes=Object.assign(this._DefaultFontSizes,o[k]):"object"==typeof o[k]&&this[k]&&this[k].Copy?this[k].Copy(o[k]):this[k]=o[k]}GetSchemeColorNames(){return Object.keys(this.Colors).sort()}SetColorScheme(name){this.ColorScheme=name,this.Colors=ColorSchemes[name]}Clone(){let s=Object.assign({},this);for(var cnm in s.Fonts=Object.assign({},this.Fonts),s.Colors={},this.Colors)s.Colors[cnm]=this.Colors[cnm].Clone();return s}GetFont(nm){var weight=this.Fonts[nm],nm=weight[0];let sz=weight[1];weight=weight[2];return"string"==typeof sz&&(sz=this.FontSizes[sz]),this._fontAtlas.GetFont(nm,sz,weight)}SetFont(field,font){this.Fonts[field]=[font.Family,font.Size,font.Weight],this._imgui.MarkIniSettingsDirty()}GetFontSize(nm){return this.FontSizes[nm]}SetFontSize(nm,sz){this.FontSizes[nm]=sz,this._imgui.MarkIniSettingsDirty()}GetColor(field){let c=this.Colors[field];return null==c&&(console.warn("unknown style color "+field),c=this.Colors._DEBUG0),1==this.Alpha||(c=c.Clone(),c.a=this.Alpha),c}MarkDirty(){this._imgui.MarkIniSettingsDirty()}ScaleAllSizes(factor){this.WindowPadding.Mult(factor).Floor(),this.WindowRounding=Math.floor(this.WindowRounding*factor),this.WindowMinSize.Mult(factor).Floor(),this.ChildRounding=Math.floor(this.ChildRounding*factor),this.PopupRounding=Math.floor(this.PopupRounding*factor),this.FramePadding.Mult(factor).Floor(),this.FrameRounding=Math.floor(this.FrameRounding*factor),this.ItemSpacing.Mult(factor).Floor(),this.ItemInnerSpacing.Mult(factor).Floor(),this.TouchExtraPadding.Mult(factor).Floor(),this.IndentSpacing=Math.floor(this.IndentSpacing*factor),this.ColumnsMinSpacing=Math.floor(this.ColumnsMinSpacing*factor),this.ScrollbarSize=Math.floor(this.ScrollbarSize*factor),this.ScrollbarRounding=Math.floor(this.ScrollbarRounding*factor),this.GrabMinSize=Math.floor(this.GrabMinSize*factor),this.GrabRounding=Math.floor(this.GrabRounding*factor),this.TabRounding=Math.floor(this.TabRounding*factor),this.DisplayWindowPadding.Mult(factor).Floor(),this.DisplaySafeAreaPadding.Mult(factor).Floor(),this.MouseCursorScale=Math.floor(this.MouseCursorScale*factor)}}function initMaterialIcons(iconTable){`
3d_rotation e84d
ac_unit eb3b
access_alarm e190
access_alarms e191
access_time e192
accessibility e84e
accessible e914
account_balance e84f
account_balance_wallet e850
account_box e851
account_circle e853
adb e60e
add e145
add_a_photo e439
add_alarm e193
add_alert e003
add_box e146
add_circle e147
add_circle_outline e148
add_location e567
add_shopping_cart e854
add_to_photos e39d
add_to_queue e05c
adjust e39e
airline_seat_flat e630
airline_seat_flat_angled e631
airline_seat_individual_suite e632
airline_seat_legroom_extra e633
airline_seat_legroom_normal e634
airline_seat_legroom_reduced e635
airline_seat_recline_extra e636
airline_seat_recline_normal e637
airplanemode_active e195
airplanemode_inactive e194
airplay e055
airport_shuttle eb3c
alarm e855
alarm_add e856
alarm_off e857
alarm_on e858
album e019
all_inclusive eb3d
all_out e90b
android e859
announcement e85a
apps e5c3
archive e149
arrow_back e5c4
arrow_downward e5db
arrow_drop_down e5c5
arrow_drop_down_circle e5c6
arrow_drop_up e5c7
arrow_forward e5c8
arrow_upward e5d8
art_track e060
aspect_ratio e85b
assessment e85c
assignment e85d
assignment_ind e85e
assignment_late e85f
assignment_return e860
assignment_returned e861
assignment_turned_in e862
assistant e39f
assistant_photo e3a0
attach_file e226
attach_money e227
attachment e2bc
audiotrack e3a1
autorenew e863
av_timer e01b
backspace e14a
backup e864
battery_alert e19c
battery_charging_full e1a3
battery_full e1a4
battery_std e1a5
battery_unknown e1a6
beach_access eb3e
beenhere e52d
block e14b
bluetooth e1a7
bluetooth_audio e60f
bluetooth_connected e1a8
bluetooth_disabled e1a9
bluetooth_searching e1aa
blur_circular e3a2
blur_linear e3a3
blur_off e3a4
blur_on e3a5
book e865
bookmark e866
bookmark_border e867
border_all e228
border_bottom e229
border_clear e22a
border_color e22b
border_horizontal e22c
border_inner e22d
border_left e22e
border_outer e22f
border_right e230
border_style e231
border_top e232
border_vertical e233
branding_watermark e06b
brightness_1 e3a6
brightness_2 e3a7
brightness_3 e3a8
brightness_4 e3a9
brightness_5 e3aa
brightness_6 e3ab
brightness_7 e3ac
brightness_auto e1ab
brightness_high e1ac
brightness_low e1ad
brightness_medium e1ae
broken_image e3ad
brush e3ae
bubble_chart e6dd
bug_report e868
build e869
burst_mode e43c
business e0af
business_center eb3f
cached e86a
cake e7e9
call e0b0
call_end e0b1
call_made e0b2
call_merge e0b3
call_missed e0b4
call_missed_outgoing e0e4
call_received e0b5
call_split e0b6
call_to_action e06c
camera e3af
camera_alt e3b0
camera_enhance e8fc
camera_front e3b1
camera_rear e3b2
camera_roll e3b3
cancel e5c9
card_giftcard e8f6
card_membership e8f7
card_travel e8f8
casino eb40
cast e307
cast_connected e308
center_focus_strong e3b4
center_focus_weak e3b5
change_history e86b
chat e0b7
chat_bubble e0ca
chat_bubble_outline e0cb
check e5ca
check_box e834
check_box_outline_blank e835
check_circle e86c
chevron_left e5cb
chevron_right e5cc
child_care eb41
child_friendly eb42
chrome_reader_mode e86d
class e86e
clear e14c
clear_all e0b8
close e5cd
closed_caption e01c
cloud e2bd
cloud_circle e2be
cloud_done e2bf
cloud_download e2c0
cloud_off e2c1
cloud_queue e2c2
cloud_upload e2c3
code e86f
collections e3b6
collections_bookmark e431
color_lens e3b7
colorize e3b8
comment e0b9
compare e3b9
compare_arrows e915
computer e30a
confirmation_number e638
contact_mail e0d0
contact_phone e0cf
contacts e0ba
content_copy e14d
content_cut e14e
content_paste e14f
control_point e3ba
control_point_duplicate e3bb
copyright e90c
create e150
create_new_folder e2cc
credit_card e870
crop e3be
crop_16_9 e3bc
crop_3_2 e3bd
crop_5_4 e3bf
crop_7_5 e3c0
crop_din e3c1
crop_free e3c2
crop_landscape e3c3
crop_original e3c4
crop_portrait e3c5
crop_rotate e437
crop_square e3c6
dashboard e871
data_usage e1af
date_range e916
dehaze e3c7
delete e872
delete_forever e92b
delete_sweep e16c
description e873
desktop_mac e30b
desktop_windows e30c
details e3c8
developer_board e30d
developer_mode e1b0
device_hub e335
devices e1b1
devices_other e337
dialer_sip e0bb
dialpad e0bc
directions e52e
directions_bike e52f
directions_boat e532
directions_bus e530
directions_car e531
directions_railway e534
directions_run e566
directions_subway e533
directions_transit e535
directions_walk e536
disc_full e610
dns e875
do_not_disturb e612
do_not_disturb_alt e611
do_not_disturb_off e643
do_not_disturb_on e644
dock e30e
domain e7ee
done e876
done_all e877
donut_large e917
donut_small e918
drafts e151
drag_handle e25d
drive_eta e613
dvr e1b2
edit e3c9
edit_location e568
eject e8fb
email e0be
enhanced_encryption e63f
equalizer e01d
error e000
error_outline e001
euro_symbol e926
ev_station e56d
event e878
event_available e614
event_busy e615
event_note e616
event_seat e903
exit_to_app e879
expand_less e5ce
expand_more e5cf
explicit e01e
explore e87a
exposure e3ca
exposure_neg_1 e3cb
exposure_neg_2 e3cc
exposure_plus_1 e3cd
exposure_plus_2 e3ce
exposure_zero e3cf
extension e87b
face e87c
fast_forward e01f
fast_rewind e020
favorite e87d
favorite_border e87e
featured_play_list e06d
featured_video e06e
feedback e87f
fiber_dvr e05d
fiber_manual_record e061
fiber_new e05e
fiber_pin e06a
fiber_smart_record e062
file_download e2c4
file_upload e2c6
filter e3d3
filter_1 e3d0
filter_2 e3d1
filter_3 e3d2
filter_4 e3d4
filter_5 e3d5
filter_6 e3d6
filter_7 e3d7
filter_8 e3d8
filter_9 e3d9
filter_9_plus e3da
filter_b_and_w e3db
filter_center_focus e3dc
filter_drama e3dd
filter_frames e3de
filter_hdr e3df
filter_list e152
filter_none e3e0
filter_tilt_shift e3e2
filter_vintage e3e3
find_in_page e880
find_replace e881
fingerprint e90d
first_page e5dc
fitness_center eb43
flag e153
flare e3e4
flash_auto e3e5
flash_off e3e6
flash_on e3e7
flight e539
flight_land e904
flight_takeoff e905
flip e3e8
flip_to_back e882
flip_to_front e883
folder e2c7
folder_open e2c8
folder_shared e2c9
folder_special e617
font_download e167
format_align_center e234
format_align_justify e235
format_align_left e236
format_align_right e237
format_bold e238
format_clear e239
format_color_fill e23a
format_color_reset e23b
format_color_text e23c
format_indent_decrease e23d
format_indent_increase e23e
format_italic e23f
format_line_spacing e240
format_list_bulleted e241
format_list_numbered e242
format_paint e243
format_quote e244
format_shapes e25e
format_size e245
format_strikethrough e246
format_textdirection_l_to_r e247
format_textdirection_r_to_l e248
format_underlined e249
forum e0bf
forward e154
forward_10 e056
forward_30 e057
forward_5 e058
free_breakfast eb44
fullscreen e5d0
fullscreen_exit e5d1
functions e24a
g_translate e927
gamepad e30f
games e021
gavel e90e
gesture e155
get_app e884
gif e908
golf_course eb45
gps_fixed e1b3
gps_not_fixed e1b4
gps_off e1b5
grade e885
gradient e3e9
grain e3ea
graphic_eq e1b8
grid_off e3eb
grid_on e3ec
group e7ef
group_add e7f0
group_work e886
hd e052
hdr_off e3ed
hdr_on e3ee
hdr_strong e3f1
hdr_weak e3f2
headset e310
headset_mic e311
healing e3f3
hearing e023
help e887
help_outline e8fd
high_quality e024
highlight e25f
highlight_off e888
history e889
home e88a
hot_tub eb46
hotel e53a
hourglass_empty e88b
hourglass_full e88c
http e902
https e88d
image e3f4
image_aspect_ratio e3f5
remove_red_eye e417
remove_shopping_cart e928
reorder e8fe
repeat e040
repeat_one e041
replay e042
replay_10 e059
replay_30 e05a
replay_5 e05b
reply e15e
reply_all e15f
report e160
report_problem e8b2
restaurant e56c
restaurant_menu e561
restore e8b3
restore_page e929
ring_volume e0d1
room e8b4
room_service eb49
rotate_90_degrees_ccw e418
rotate_left e419
rotate_right e41a
rounded_corner e920
router e328
rowing e921
rss_feed e0e5
rv_hookup e642
satellite e562
save e161
scanner e329
schedule e8b5
school e80c
screen_lock_landscape e1be
screen_lock_portrait e1bf
screen_lock_rotation e1c0
screen_rotation e1c1
screen_share e0e2
sd_card e623
sd_storage e1c2
search e8b6
security e32a
select_all e162
send e163
sentiment_dissatisfied e811
sentiment_neutral e812
sentiment_satisfied e813
sentiment_very_dissatisfied e814
sentiment_very_satisfied e815
settings e8b8
settings_applications e8b9
settings_backup_restore e8ba
settings_bluetooth e8bb
settings_brightness e8bd
settings_cell e8bc
settings_ethernet e8be
settings_input_antenna e8bf
settings_input_component e8c0
settings_input_composite e8c1
settings_input_hdmi e8c2
settings_input_svideo e8c3
settings_overscan e8c4
settings_phone e8c5
settings_power e8c6
settings_remote e8c7
settings_system_daydream e1c3
settings_voice e8c8
share e80d
shop e8c9
shop_two e8ca
shopping_basket e8cb
shopping_cart e8cc
short_text e261
show_chart e6e1
shuffle e043
signal_cellular_4_bar e1c8
signal_cellular_connected_no_internet_4_bar e1cd
signal_cellular_no_sim e1ce
signal_cellular_null e1cf
signal_cellular_off e1d0
signal_wifi_4_bar e1d8
signal_wifi_4_bar_lock e1d9
signal_wifi_off e1da
sim_card e32b
sim_card_alert e624
skip_next e044
skip_previous e045
slideshow e41b
slow_motion_video e068
smartphone e32c
smoke_free eb4a
smoking_rooms eb4b
sms e625
sms_failed e626
snooze e046
sort e164
sort_by_alpha e053
spa eb4c
space_bar e256
speaker e32d
speaker_group e32e
speaker_notes e8cd
speaker_notes_off e92a
speaker_phone e0d2
spellcheck e8ce
star e838
star_border e83a
star_half e839
stars e8d0
stay_current_landscape e0d3
stay_current_portrait e0d4
stay_primary_landscape e0d5
stay_primary_portrait e0d6
stop e047
stop_screen_share e0e3
storage e1db
store e8d1
store_mall_directory e563
straighten e41c
streetview e56e
strikethrough_s e257
style e41d
subdirectory_arrow_left e5d9
subdirectory_arrow_right e5da
subject e8d2
subscriptions e064
subtitles e048
subway e56f
supervisor_account e8d3
surround_sound e049
swap_calls e0d7
swap_horiz e8d4
swap_vert e8d5
swap_vertical_circle e8d6
switch_camera e41e
switch_video e41f
sync e627
sync_disabled e628
sync_problem e629
system_update e62a
system_update_alt e8d7
tab e8d8
tab_unselected e8d9
tablet e32f
tablet_android e330
tablet_mac e331
tag_faces e420
tap_and_play e62b
terrain e564
text_fields e262
text_format e165
textsms e0d8
texture e421
theaters e8da
thumb_down e8db
thumb_up e8dc
thumbs_up_down e8dd
time_to_leave e62c
timelapse e422
timeline e922
timer e425
timer_10 e423
timer_3 e424
timer_off e426
title e264
toc e8de
today e8df
toll e8e0
tonality e427
touch_app e913
toys e332
track_changes e8e1
traffic e565
train e570
tram e571
transfer_within_a_station e572
transform e428
translate e8e2
trending_down e8e3
trending_flat e8e4
trending_up e8e5
tune e429
turned_in e8e6
turned_in_not e8e7
tv e333
unarchive e169
undo e166
unfold_less e5d6
unfold_more e5d7
update e923
usb e1e0
verified_user e8e8
vertical_align_bottom e258
vertical_align_center e259
vertical_align_top e25a
vibration e62d
video_call e070
video_label e071
video_library e04a
videocam e04b
videocam_off e04c
videogame_asset e338
view_agenda e8e9
view_array e8ea
view_carousel e8eb
view_column e8ec
view_comfy e42a
view_compact e42b
view_day e8ed
view_headline e8ee
view_list e8ef
view_module e8f0
view_quilt e8f1
view_stream e8f2
view_week e8f3
vignette e435
visibility e8f4
visibility_off e8f5
voice_chat e62e
voicemail e0d9
volume_down e04d
volume_mute e04e
volume_off e04f
volume_up e050
vpn_key e0da
vpn_lock e62f
wallpaper e1bc
warning e002
watch e334
watch_later e924
wb_auto e42c
wb_cloudy e42d
wb_incandescent e42e
wb_iridescent e436
wb_sunny e430
wc e63d
web e051
web_asset e069
weekend e16b
whatshot e80e
widgets e1bd
wifi e63e
wifi_lock e1e1
wifi_tethering e1e2
work e8f9
wrap_text e25b
youtube_searched_for e8fa
zoom_in e8ff
zoom_out e900
zoom_out_map e56b
        `.split("\n").forEach(num=>{var fields;""==num||2==(fields=num.split(" ")).length&&(num=Number("0x"+fields[1]),iconTable[fields[0]]=String.fromCharCode(num))})}class ArrayEx{constructor(){var aex=Object.create(Array.prototype);for(let i=0;i<arguments.length;i++)aex.push(arguments[i]);return ArrayEx._extendArray(aex),aex}clear(){this.length=0}back(){return this[this.length-1]}push_back(v){return this.push(v)}pop_back(){return this.pop()}push_front(v){this.unshift(v)}resize(len){return this.length=len}empty(){return 0==this.length}clone(){return this.slice()}static _extendArray(aex){var nm;for(nm of Object.getOwnPropertyNames(ArrayEx.prototype))aex[nm]=ArrayEx.prototype[nm];return aex}}class Storage{constructor(){this.Clear()}Clear(){this.intMap={},this.floatMap={},this.boolMap={},this.voidPtrMap={}}GetInt(v,defaultVal=0){v=this.intMap[v];return void 0===v?defaultVal:v}SetInt(key,val){this.intMap[key]=val}GetBool(v,defaultVal=!1){v=this.boolMap[v];return void 0===v?defaultVal:v}SetBool(key,val){this.boolMap[key]=val}GetFloat(v,defaultVal=0){v=this.floatMap[v];return void 0===v?defaultVal:v}SetFloat(key,val){this.floatMap[key]=val}GetVoidPtr(v){v=this.voidPtrMap[v];return void 0===v?null:v}SetVoidPtr(key,val){this.voidPtrMap[key]=val}}function GetHash(val,vals=0){var i,hash=vals;if("number"==typeof val){if(vals)return hash+val;val=""+val}if("string"==typeof val){if(0===val.length)return hash+23;vals=val.split("##");for(val=vals[vals.length-1],i=0;i<val.length;i++)hash=(hash<<5)-hash+val.charCodeAt(i)}else console.assert(0,"unimplemented hash type:"+typeof val);return hash}function HashData(data,seed){var i,hash=0;if(0===data.length)return hash;for(i=0;i<data.length;i++)hash=(hash<<5)-hash+data[i],hash|=0;return hash}function IsPowerOfTwo(num){return 0!=num&&0==(num&num-1)}let f;var FocusedFlags={None:0,ChildWindows:1,RootWindow:2,AnyWindow:4};FocusedFlags.RootAndChildWindows=FocusedFlags.RootWindow|FocusedFlags.ChildWindows;var HoveredFlags={None:0,ChildWindows:1,RootWindow:2,AnyWindow:4,AllowWhenBlockedByPopup:8,AllowWhenBlockedByActiveItem:32,AllowWhenOverlapped:64,AllowWhenDisabled:128};HoveredFlags.RectOnly=HoveredFlags.AllowWhenBlockedByPopup|HoveredFlags.AllowWhenBlockedByActiveItem|HoveredFlags.AllowWhenOverlapped,HoveredFlags.RootAndChildWindows=HoveredFlags.RootWindow|HoveredFlags.ChildWindows;var NavHighlightFlags={None:0,TypeDefault:1,TypeThin:2,AlwaysDraw:4,NoRounding:8},NavMoveFlags={None:0,LoopX:1,LoopY:2,WrapX:4,WrapY:8,AllowCurrentNavId:16,AlsoScoreVisibleSet:32},ItemFlags={Default:0,NoTabStop:1,ButtonRepeat:2,Disabled:4,NoNav:8,NoNavDefaultFocus:16,SelectableDontClosePopup:32},ItemStatusFlags={None:0,HoveredRect:1,HasDisplayRect:2,Edited:4},CondFlags={None:0,Always:1,Once:2,FirstUseEver:4,Appearing:8},ConfigFlags={None:0,NavEnableKeyboard:1,NavEnableGamepad:2,NavEnableSetMousePos:4,NavNoCaptureKeyboard:8,NoMouse:16,NoMouseCursorChange:32,IsSRGB:1<<20,IsTouchScreen:1<<21},BackendFlags={None:0,HasGamepad:1,HasMouseCursors:2,HasSetMousePos:4},ColorEditFlags={None:0,NoAlpha:2,NoPicker:4,NoOptions:8,NoSmallPreview:16,NoInputs:32,NoTooltip:64,NoLabel:128,NoSidePreview:256,NoDragDrop:512,AlphaBar:65536,AlphaPreview:1<<17,AlphaPreviewHalf:1<<18,HDR:1<<19,DisplayRGB:1<<20,DisplayHSV:1<<21,DisplayHex:1<<22,Uint8:1<<23,Float:1<<24,PickerHueBar:1<<25,PickerHueWheel:1<<26,InputRGB:1<<27,InputHSV:1<<28};ColorEditFlags.OptionsDefault=ColorEditFlags.Uint8|ColorEditFlags.DisplayRGB|ColorEditFlags.InputRGB|ColorEditFlags.PickerHueBar,ColorEditFlags.DisplayMask=ColorEditFlags.DisplayRGB|ColorEditFlags.DisplayHSV|ColorEditFlags.DisplayHex,ColorEditFlags.DataTypeMask=ColorEditFlags.Uint8|ColorEditFlags.Float,ColorEditFlags.PickerMask=ColorEditFlags.PickerHueWheel|ColorEditFlags.PickerHueBar,ColorEditFlags.InputMask=ColorEditFlags.InputRGB|ColorEditFlags.InputHSV;var NavDirSourceFlags={None:0,Keyboard:1,PadDPa:2,PadLStic:4},CornerFlags={TopLeft:1,TopRight:2,BotLeft:4,BotRight:8};f=CornerFlags,f.Top=f.TopLeft|f.TopRight,f.Bot=f.BotLeft|f.BotRight,f.Left=f.TopLeft|f.BotLeft,f.Right=f.TopRight|f.BotRight,f.All=15;var DrawListFlags={None:0,AntiAliasedLines:1,AntiAliasedFill:2};class ItemHoveredDataBackup{constructor(guictx){this.guictx=guictx,this.Backup()}Backup(){let win=this.guictx.CurrentWindow;this.LastItemId=win.DC.LastItemId,this.LastItemStatusFlags=win.DC.LastItemStatusFlags,this.LastItemRect=win.DC.LastItemRect.Clone(),this.LastItemDisplayRect=win.DC.LastItemDisplayRect.Clone()}Restore(){let win=this.guictx.CurrentWindow;win.DC.LastItemId=this.LastItemId,win.DC.LastItemStatusFlags=this.LastItemStatusFlags,win.DC.LastItemRect=this.LastItemRect,win.DC.LastItemDisplayRect=this.LastItemDisplayRect}}var ImguiMiscMixin={init(ctx){},shutdown(ctx){},startMouseMovingWindow(win){let g=this.guictx;this.FocusWindow(win),this.setActiveID(win.MoveId,win),g.NavDisableHighlight=!0,g.ActiveIdClickOffset=Vec2.Subtract(g.IO.MousePos,win.RootWindow.Pos);let can_move_window=!0;(win.Flags&WindowFlags.NoMove||win.RootWindow.Flags&WindowFlags.NoMove)&&(can_move_window=!1),can_move_window&&(g.MovingWindow=win)},updateMouseMovingWindowNewFrame(){let g=this.guictx;if(null!=g.MovingWindow){this.keepAliveID(g.ActiveId),console.assert(g.MovingWindow&&g.MovingWindow.RootWindow);let moving_window=g.MovingWindow.RootWindow;var pos;g.IO.MouseDown[0]&&this.IsMousePosValid(g.IO.MousePos)?(pos=Vec2.Subtract(g.IO.MousePos,g.ActiveIdClickOffset),moving_window.Pos.x==pos.x&&moving_window.Pos.y==pos.y||(this.MarkIniSettingsDirty(moving_window),moving_window.SetWindowPos(pos,CondFlags.Always)),this.FocusWindow(g.MovingWindow)):(this.clearActiveID(),g.MovingWindow=null)}else g.ActiveIdWindow&&g.ActiveIdWindow.MoveId==g.ActiveId&&(this.keepAliveID(g.ActiveId),g.IO.MouseDown[0]||this.clearActiveID())},updateMouseMovingWindowEndFrame(){let g=this.guictx;if(0==g.ActiveId&&0==g.HoveredId&&(!g.NavWindow||!g.NavWindow.Appearing)&&(g.IO.MouseClicked[0]&&(g.HoveredRootWindow?(this.startMouseMovingWindow(g.HoveredWindow),!g.IO.ConfigWindowsMoveFromTitleBarOnly||g.HoveredRootWindow.Flags&WindowFlags.NoTitleBar||g.HoveredRootWindow.TitleBarRect().Contains(g.IO.MouseClickedPos[0])||(g.MovingWindow=null)):g.NavWindow&&!this.getFrontMostPopupModal()&&this.FocusWindow(null)),g.IO.MouseClicked[1])){var modal=this.getFrontMostPopupModal();let hovered_window_above_modal=!1;modal&&(hovered_window_above_modal=!0);for(let i=g.Windows.length-1;0<=i&&0==hovered_window_above_modal;i--){var win=g.Windows[i];if(win==modal)break;win==g.HoveredWindow&&(hovered_window_above_modal=!0)}this.closePopupsOverWindow(hovered_window_above_modal?g.HoveredWindow:modal)}},getItemID(){return this.guictx.CurrentWindow.DC.LastItemId},getActiveID(){return this.guictx.ActiveId},getFocusID(){return this.guictx.NavId},setActiveID(id,win){let g=this.guictx;g.ActiveIdIsJustActivated=g.ActiveId!=id,g.ActiveIdIsJustActivated&&(g.ActiveIdTimer=0,g.ActiveIdHasBeenPressed=!1,g.ActiveIdHasBeenEdited=!1,0!=id&&(g.LastActiveId=id,g.LastActiveIdTimer=0)),g.ActiveId=id,g.ActiveIdAllowNavDirFlags=0,g.ActiveIdBlockNavInputFlags=0,g.ActiveIdAllowOverlap=!1,g.ActiveIdWindow=win,id&&(g.ActiveIdIsAlive=id,g.NavActivateId==id||g.NavInputId==id||g.NavJustTabbedId==id||g.NavJustMovedToId==id?g.ActiveIdSource=InputSource.Nav:g.ActiveIdSource=InputSource.Mouse)},setFocusID(id,win){let g=this.guictx;console.assert(0!=id);var nav_layer=win.DC.NavLayerCurrent;g.NavWindow!=win&&(g.NavInitRequest=!1),g.NavId=id,g.NavWindow=win,g.NavLayer=nav_layer,win.NavLastIds[nav_layer]=id,win.DC.LastItemId==id&&(win.NavRectRel[nav_layer]=new Rect(Vec2.Subtract(win.DC.LastItemRect.Min,win.Pos),Vec2.Subtract(win.DC.LastItemRect.Max,win.Pos))),g.ActiveIdSource==InputSource.Nav?g.NavDisableMouseHover=!0:g.NavDisableHighlight=!0},clearActiveID(){this.setActiveID(0,null)},getHoveredID(){var g=this.guictx;return g.HoveredId||g.HoveredIdPreviousFrame},setHoveredID(id){let g=this.guictx;g.HoveredId=id,g.HoveredIdAllowOverlap=!1,0!=id&&g.HoveredIdPreviousFrame!=id&&(g.HoveredIdTimer=g.HoveredIdNotActiveTimer=0)},keepAliveID(id){let g=this.guictx;g.ActiveId==id&&(g.ActiveIdIsAlive=id),g.ActiveIdPreviousFrame==id&&(g.ActiveIdPreviousFrameIsAlive=!0)},markItemEdited(id){let g=this.guictx;console.assert(g.ActiveId==id||0==g.ActiveId||g.DragDropActive),g.ActiveIdHasBeenEdited=!0,g.CurrentWindow.DC.LastItemStatusFlags|=ItemStatusFlags.Edited},itemHoverable(bb,id){var g=this.guictx;if(0!=g.HoveredId&&g.HoveredId!=id&&!g.HoveredIdAllowOverlap)return!1;var win=g.CurrentWindow;return g.HoveredWindow==win&&(!(0!=g.ActiveId&&g.ActiveId!=id&&!g.ActiveIdAllowOverlap)&&(!!this.IsMouseHoveringRect(bb.Min,bb.Max)&&(!(g.NavDisableMouseHover||!this.isWindowContentHoverable(win,HoveredFlags.None))&&(!(win.DC.ItemFlags&ItemFlags.Disabled)&&(this.setHoveredID(id),!0)))))},focusableItemRegister(win,id){let g=this.guictx;var is_tab_stop=0==(win.DC.ItemFlags&(ItemFlags.NoTabStop|ItemFlags.Disabled));if(win.DC.FocusCounterAll++,is_tab_stop&&win.DC.FocusCounterTab++,g.ActiveId!=id||!g.FocusTabPressed||g.ActiveIdBlockNavInputFlags&1<<NavInput.KeyTab||null!=g.FocusRequestNextWindow||(g.FocusRequestNextWindow=win,g.FocusRequestNextCounterTab=win.DC.FocusCounterTab+(g.IO.KeyShift?is_tab_stop?-1:0:1)),g.FocusRequestCurrWindow==win){if(win.DC.FocusCounterAll==g.FocusRequestCurrCounterAll)return!0;if(is_tab_stop&&win.DC.FocusCounterTab==g.FocusRequestCurrCounterTab)return g.NavJustTabbedId=id,!0;g.ActiveId==id&&this.clearActiveID()}return!1},focusableItemUnregister(win){win.DC.FocusCounterAll--,win.DC.FocusCounterTab--},logBegin(type,auto_open_depth){},logToBuffer(auto_open_depth=0){},isKeyPressedMap(key_index,repeat=!0){key_index=this.guictx.IO.KeyMap[key_index];return 0<=key_index&&this.IsKeyPressed(key_index,repeat)},beginDragDropTargetCustom(bbox,id){console.assert(0)},clearDragDrop(){console.assert(0)},isDragDropPayloadBeingAccepted(){console.assert(0)},beginColumns(id,count,flags){console.assert(0)},endColumns(){console.assert(0)},pushColumnClipRect(colIndex){console.assert(0)},textEx(text,textflags=0){console.assert(0)},scrollbar(axis){console.assert(0)},setScrollbarID(win,axis){console.assert(0)},updateMouseWheel(){let g=this.guictx;if(g.HoveredWindow&&!g.HoveredWindow.Collapsed&&(0!=g.IO.MouseWheel||0!=g.IO.MouseWheelH||0!=g.IO.TouchDelta.x||0!=g.IO.TouchDelta.y)){let win=g.HoveredWindow,scroll_window=win;for(;scroll_window.Flags&WindowFlags.ChildWindow&&scroll_window.Flags&WindowFlags.NoScrollWithMouse&&!(scroll_window.Flags&WindowFlags.NoScrollbar)&&!(scroll_window.Flags&WindowFlags.NoMouseInputs)&&scroll_window.ParentWindow;)scroll_window=scroll_window.ParentWindow;var scroll_allowed=!(scroll_window.Flags&WindowFlags.NoScrollWithMouse||scroll_window.Flags&WindowFlags.NoMouseInputs);if(0!=g.IO.MouseWheel||0!=g.IO.TouchDelta.y)if(g.IO.KeyCtrl&&g.IO.FontAllowUserScaling){let new_font_scale=win.FontWindowScale+.1*g.IO.MouseWheel;new_font_scale<.5?new_font_scale=.5:2.5<new_font_scale&&(new_font_scale=2.5);var scale=new_font_scale/win.FontWindowScale;win.FontWindowScale=new_font_scale;var offset=Vec2.Subtract(g.IO.MousePos,win.Pos),iws=Vec2.Mult(win.Size,1-scale),offset=Vec2.Divide(iws,win.Size).Mult(offset);win.Pos.Add(offset),win.Size.Mult(scale),win.SizeFull.Mult(scale)}else if(!g.IO.KeyCtrl&&scroll_allowed){let amt=5*scroll_window.CalcLineHeight();amt=Math.floor(Math.min(amt,.67*(scroll_window.ContentsRegionRect.GetHeight()+2*scroll_window.WindowPadding.y))),0!=g.IO.MouseWheel?amt*=g.IO.MouseWheel:(amt*=g.IO.TouchDelta.y,0==g.IO.TouchActive&&(g.IO.TouchDelta.y*=.98,Math.abs(g.IO.TouchDelta.y)<.15&&(g.IO.TouchDelta.y=0))),scroll_window.SetWindowScrollY(scroll_window.Scroll.y-amt)}if(0!=g.IO.MouseWheelH||0!=g.IO.TouchDelta.x&&scroll_allowed&&!g.IO.KeyCtrl){let amt=scroll_window.CalcLineHeight();0!=g.IO.MouseWheelH?amt*=g.IO.MouseWheelH:(amt*=g.IO.TouchDelta.x,0==g.IO.TouchActive&&(g.IO.TouchDelta.x*=.75,Math.abs(g.IO.TouchDelta.x)<.15&&(g.IO.TouchDelta.x=0))),scroll_window.SetWindowScrollX(scroll_window.Scroll.x-amt)}}},beginListBox(label,size){},endListBox(){},modPositive(a,b){return(a+b)%b}};let PathType={Line:0,Rect:1,Arc:2,Bezier:3},Angles=[];for(let i=0;i<13;i++)Angles.push(2*Math.PI*i/12);class DrawList{constructor(imgui,owner){this.imgui=imgui,this.canvas=imgui.canvas,this.canvasCtx=this.canvas.getContext("2d"),this.owner=owner,this.flags=DrawListFlags.None,this.Clear()}Clear(layer=void 0){null==layer?this.drawLayers=[[]]:this.drawLayers[layer]=[],this.path=[],this.clipRectStack=[],this.LayerStack=[this.drawLayers[0]],this.currentLayer=this.drawLayers[0]}BeginLayer(i){let layer=this.drawLayers[i];null==layer&&(layer=[],this.drawLayers[i]=layer),this.LayerStack.push(layer),this.currentLayer=layer}EndLayer(){this.LayerStack.pop(),this.currentLayer=this.LayerStack[this.LayerStack.length-1],console.assert(null!=this.currentLayer)}Render(layer){if(null==layer)for(let layer of this.drawLayers)for(let i=0;i<layer.length;i++)this.layer[i]();else{let drawlayer=this.drawLayers[layer];if(null!=drawlayer)for(let i=0;i<drawlayer.length;i++)drawlayer[i]()}this.Clear(layer)}PushClipRect(min,max,current=!1){let cr=new Rect(min,max);current&&0<this.clipRectStack.length&&(current=this.clipRectStack[this.clipRectStack.length-1],cr.ClipWith(current)),this.clipRectStack.push(cr)}PushClipRectFullScreen(){this.clipRectStack.push(null)}UpdateClipRect(){}PopClipRect(){this.clipRectStack.pop()}GetClipRect(){return this.clipRectStack[this.clipRectStack.length-1]}AddLine(a,b,col,thickness=1){"string"!=typeof col&&(col=col.AsStr()),this.currentLayer.push(this.drawLine.bind(this,a.x,a.y,b.x,b.y,col,thickness,this.getClipRect()))}AddLines(lines,thickness){this.currentLayer.push(this.drawLines.bind(this,lines,thickness,this.getClipRect()))}AddRect(a,h,col,rounding=0,corners=CornerFlags.All,thickness=1){var w=h.x-a.x,h=h.y-a.y;"string"!=typeof col&&(col=col.AsStr()),this.currentLayer.push(this.drawRect.bind(this,a.x,a.y,w,h,col,rounding,corners,thickness,!1,this.getClipRect()))}AddRectRamp(a,h,ramp,ttob){var w=h.x-a.x,h=h.y-a.y;this.currentLayer.push(this.drawRectRamp.bind(this,a.x,a.y,w,h,ramp,ttob,this.getClipRect()))}AddRectFilled(a,h,col,rounding=0,corners=CornerFlags.All){var w=h.x-a.x,h=h.y-a.y;"string"!=typeof col&&(col=col.AsStr()),this.currentLayer.push(this.drawRect.bind(this,a.x,a.y,w,h,col,rounding,corners,0,!0,this.getClipRect()))}AddRectFilled4(x,y,w,h,fillstyle,rounding=0,corners=CornerFlags.All){this.currentLayer.push(this.drawRect.bind(this,x,y,w,h,fillstyle,rounding,corners,0,!0,this.getClipRect()))}AddRectsFilled(fill,rects,rounding=0){this.currentLayer.push(this.drawRectsFilled.bind(this,fill,rects,rounding,this.getClipRect()))}AddRectFilledMultiColor(a,c0,uleftCol,urightCol,brightCol,bleftCol){console.assert(uleftCol.Equals(urightCol)||uleftCol.Equals(bleftCol),"linear gradients only");var w=c0.x-a.x,h=c0.y-a.y,c0=uleftCol.AsStr();let c1,ttob;ttob=uleftCol==urightCol?(c1=bleftCol.AsStr(),!0):(c1=urightCol.AsStr(),!1),this.currentLayer.push(this.drawRectRamp.bind(this,a.x,a.y,w,h,[c0,c1],ttob,this.getClipRect()))}AddQuad(a,b,c,d,col,thickness=0){console.log("AddQuad is unimplemented")}AddQuadFilled(a,b,c,d,col){console.log("AddQuad is unimplemented")}AddTriangle(a,b,c,col,thickness=0){"string"!=typeof col&&(col=col.AsStr()),this.currentLayer.push(this.drawTriangle.bind(this,a.x,a.y,b.x,b.y,c.x,c.y,col,!1,this.getClipRect()))}AddTriangleFilled(a,b,c,col){"string"!=typeof col&&(col=col.AsStr()),this.currentLayer.push(this.drawTriangle.bind(this,a.x,a.y,b.x,b.y,c.x,c.y,col,!0,this.getClipRect()))}AddCircle(org,radius,col,thickness=1){"string"!=typeof col&&(col=col.AsStr()),this.currentLayer.push(this.drawCircle.bind(this,org.x,org.y,radius,col,!1,thickness,this.getClipRect()))}AddCircleFilled(org,radius,col){"string"!=typeof col&&(col=col.AsStr()),this.currentLayer.push(this.drawCircle.bind(this,org.x,org.y,radius,col,!0,0,this.getClipRect()))}AddText(text,pos,font,lineHeight,col,wrap_width=0,clipRect=null){let clip;"string"!=typeof col&&(col=col.AsStr()),clip=null!=clipRect?(clipRect.ClipWith(this.GetClipRect()),[clipRect.Min.x,clipRect.Min.y,clipRect.GetWidth(),clipRect.GetHeight()]):this.getClipRect(),this.currentLayer.push(this.drawText.bind(this,text,font,lineHeight,pos.x,pos.y,col,clip,wrap_width))}FillText(txt,x,y,fillStyle,baseline,align,font=null){var clip=this.getClipRect();this.currentLayer.push(this.fillText.bind(this,txt,x,y,fillStyle,baseline,align,font,clip))}AddTexts(attrs,tarray){var clip=this.getClipRect();this.currentLayer.push(this.fillTexts.bind(this,attrs,tarray,clip))}AddImage(img,dstSz,dstPos=null,srcSz=null,cstr=null){var clip=this.getClipRect(),srcPos=dstSz.GetSize(),cstr=cstr?cstr.AsStr():null;null==dstPos||null==srcSz?this.currentLayer.push(this.drawImage.bind(this,img,dstSz.Min.x,dstSz.Min.y,srcPos.x,srcPos.y,cstr,clip)):(srcPos=new Vec2(img.width*dstPos.x,img.height*dstPos.y),srcSz=new Vec2(img.width*(srcSz.x-dstPos.x),img.height*(srcSz.x-dstPos.x)),dstPos=dstSz.Min,dstSz=dstSz.GetSize(),this.currentLayer.push(this.drawSubImage.bind(this,img,srcPos.x,srcPos.y,srcSz.x,srcSz.y,dstPos.x,dstPos.y,dstSz.x,dstSz.y,cstr,clip)))}AddImageQuad(user_texture_id,a,b,c,d,uv_a=0,uv_b,uv_c,uv_d,col){}AddImageRounded(user_texture_id,a,b,uv_a,uv_b,col,rounding,rounding_corners=CornerFlags.All){}AddPolyline(points,col,closed,thickness){}AddConvexPolyFilled(points,num_points,col){}AddBezierCurve(pos0,cp0,cp1,pos1,col,thickness,num_segments=0){}PathClear(){this.path.length=0}PathLineTo(pos){this.path.push([PathType.Line,pos])}PathLineToMergeDuplicate(pos){var lastpt=this.path[this.path.length-1][0];null!=lastpt&&lastpt.x==pos.x&&lastpt.y==pos.y||this.path.push([PathType.Line,pos])}PathArcTo(org,radius,a_min,a_max,num_segments=0){this.path.push([PathType.Arc,org,radius,a_min,a_max])}PathArcToFast(org,radius,a_min_of_12,a_max_of_12){this.path.push([PathType.Arc,org,radius,Angles[a_min_of_12],Angles[a_max_of_12]])}PathBezierCurveTo(p1,p2,p3,num_segments=0){this.path.push([PathType.Bezier,p1,p2,p3])}PathRect(a,b,rounding=0,corners_flags=CornerFlags.All){0==rounding||0==corners_flags?(this.PathLineTo(a),this.PathLineTo(new Vec2(b.x,a.y)),this.PathLineTo(b),this.PathLineTo(new Vec2(a.x,b.y))):this.path.push([PathType.Rect,a,b,rounding,corners_flags])}PathFillConvex(col){"string"!=typeof col&&(col=col.AsStr()),this.currentLayer.push(this.drawPath.bind(this,this.path,col,"fillConvex")),this.path=[]}PathStroke(col,closed,thickness=1){"string"!=typeof col&&(col=col.AsStr()),this.currentLayer.push(this.drawPath.bind(this,this.path,col,"stroke",closed,thickness)),this.path=[]}ChannelsSplit(channels_count){}ChannelsMerge(){}ChannelsSetCurrent(channel_index){}UpdateTextureID(){}getClipRect(){let cr=this.GetClipRect();return cr?[cr.Min.x,cr.Min.y,cr.GetWidth(),cr.GetHeight()]:[]}doClip(ctx,clip){ctx.beginPath(),ctx.rect(clip[0],clip[1],clip[2],clip[3]),ctx.clip()}drawLine(ax,ay,bx,by,col,thickness,clip){let ctx=this.canvasCtx;ctx.save(),clip&&this.doClip(ctx,clip),ctx.lineWidth=thickness,ctx.strokeStyle=col,ctx.beginPath(),ctx.moveTo(ax,ay),ctx.lineTo(bx,by),ctx.stroke(),ctx.restore()}drawLines(lines,thickness,clip){let ctx=this.canvasCtx;ctx.save(),clip&&this.doClip(ctx,clip),ctx.lineWidth=thickness;for(let i=0;i<lines.length;i++){var line=lines[i];ctx.strokeStyle=line[2],ctx.beginPath(),ctx.moveTo(line[0].x,line[0].y),ctx.lineTo(line[1].x,line[1].y),ctx.stroke()}ctx.restore()}drawImage(img,x0,y0,xsize,ysize,tint,clip){let ctx=this.canvasCtx;ctx.save(),clip&&this.doClip(ctx,clip),ctx.drawImage(img,x0,y0,xsize,ysize),ctx.restore()}drawSubImage(img,srcPosX,srcPosY,srcSizeX,srcSizeY,dstPosX,dstPosY,dstSizeX,dstSizeY,tint,clip){let ctx=this.canvasCtx;ctx.save(),clip&&this.doClip(ctx,clip),ctx.drawImage(img,srcPosX,srcPosY,srcSizeX,srcSizeY,dstPosX,dstPosY,dstSizeX,dstSizeY),ctx.restore()}drawTriangle(ax,ay,bx,by,cx,cy,col,fill,clip){let ctx=this.canvasCtx;ctx.save(),clip&&this.doClip(ctx,clip),fill?ctx.fillStyle=col:ctx.strokeStyle=col,ctx.beginPath(),ctx.moveTo(ax,ay),ctx.lineTo(bx,by),ctx.lineTo(cx,cy),ctx.closePath(),fill?ctx.fill():ctx.stroke(),ctx.restore()}drawRectsFilled(fill,rects,rounding,clip){let ctx=this.canvasCtx;if(ctx.save(),clip&&this.doClip(ctx,clip),ctx.fillStyle=fill,0==rounding)for(var r of rects)ctx.fillRect(r[0],r[1],r[2],r[3]);else for(let r of rects)this.roundRect(r[0],r[1],r[2],r[3],rounding,CornerFlags.All,!1,!0);ctx.restore()}drawRect(x,y,w,h,col,rounding,corners,thickness,fill,clip){let ctx=this.canvasCtx;ctx.save(),clip&&this.doClip(ctx,clip),fill?ctx.fillStyle=col:(ctx.lineWidth=thickness,ctx.strokeStyle=col),0==rounding?fill?ctx.fillRect(x,y,w,h):(ctx.beginPath(),ctx.rect(x,y,w,h),ctx.stroke()):this.roundRect(x,y,w,h,rounding,corners,!fill,fill),ctx.restore()}drawRectRamp(x,y,w,h,stops,ttob,clip){let ctx=this.canvasCtx;ctx.save(),clip&&this.doClip(ctx,clip);let grd;grd=ttob?ctx.createLinearGradient(x,y,x,y+h):ctx.createLinearGradient(x,y,x+w,y);let t=0,dt=1/(stops.length-1);for(var c of stops)grd.addColorStop(t,c),t+=dt;ctx.fillStyle=grd,ctx.fillRect(x,y,w,h),ctx.restore()}roundRect(x,y,width,height,radius,corners,stroke=!0,fill=!0){let ctx=this.canvasCtx;0==radius?ctx.rect(x,y,width,height):(ctx.beginPath(),corners&CornerFlags.TopLeft?ctx.moveTo(x+radius,y):ctx.moveTo(x,y),ctx.lineTo(x+width-radius,y),corners&CornerFlags.TopRight?ctx.quadraticCurveTo(x+width,y,x+width,y+radius):ctx.lineTo(x+width,y),ctx.lineTo(x+width,y+height-radius),corners&CornerFlags.BotRight?ctx.quadraticCurveTo(x+width,y+height,x+width-radius,y+height):ctx.lineTo(x+width,y+height),ctx.lineTo(x+radius,y+height),corners&CornerFlags.BotLeft?ctx.quadraticCurveTo(x,y+height,x,y+height-radius):ctx.lineTo(x,y+height),corners&CornerFlags.TopLeft&&(ctx.lineTo(x,y+radius),ctx.quadraticCurveTo(x,y,x+radius,y)),ctx.closePath()),stroke&&ctx.stroke(),fill&&ctx.fill()}drawCircle(orgX,orgY,radius,col,fill,thickness,clip){let ctx=this.canvasCtx;ctx.save(),clip&&this.doClip(ctx,clip),ctx.beginPath(),fill?(ctx.fillStyle=col,ctx.lineWidth=0):(ctx.strokeStyle=col,ctx.lineWidth=thickness),ctx.arc(orgX,orgY,radius,0,2*Math.PI),fill?ctx.fill():ctx.stroke(),ctx.restore()}drawPath(path,style,op,closed,thickness,clip){let ctx=this.canvasCtx;ctx.save(),clip&&this.doClip(ctx,clip),ctx.beginPath();for(let i=0;i<path.length;i++){var el=path[i];switch(el[0]){case PathType.Line:var amin=el[1];0==i?ctx.moveTo(amin.x,amin.y):ctx.lineTo(amin.x,amin.y);break;case PathType.Arc:var org=el[1],rad=el[2],amin=el[3],min=el[4];ctx.arc(org.x,org.y,rad,amin,min);break;case PathType.Bezier:var max=el[1],rounding=el[2],corners=el[2];console.assert(0!=i,"bezier move to"),0!=i&&ctx.bezierCurveTo(max.x,max.y,rounding.x,rounding.y,corners.x,corners.y);break;case PathType.Rect:min=el[1],max=el[2],rounding=el[3],corners=el[4];this.roundRect(min.x,min.y,max.x-min.x,max.y-min.y,rounding,corners,!1,!1)}}"stroke"==op?(ctx.lineWidth=thickness,ctx.strokeStyle=style,ctx.stroke()):(ctx.fillStyle=style,ctx.fill()),ctx.restore()}drawText(text,font,lineHeight,x,y,col,clip,wrapWidth){let ctx=this.canvasCtx;var lines=Vec2.Zero();ctx.save(),ctx.font=font.AsStr(),clip&&this.doClip(ctx,clip),ctx.fillStyle=col;lines=font.MeasureText(text,wrapWidth,lineHeight,lines);let i=0;var line,offset=y+(lineHeight-font.Size)/2+font.Baseline;for(line of lines)0<line.length&&ctx.fillText(line,x,offset+lineHeight*i),i++;ctx.restore()}fillText(txt,x,y,fillStyle,baseline,align,font=null,clip=null){let ctx=this.canvasCtx;ctx.save(),clip&&this.doClip(ctx,clip),font&&(font.AsStr?ctx.font=font.AsStr():ctx.font=font),ctx.fillStyle=fillStyle,ctx.textBaseline=baseline,ctx.textAlign=align,ctx.fillText(txt,x,y),ctx.restore()}fillTexts(attrs,tarray,clip=null){let ctx=this.canvasCtx;ctx.save(),clip&&this.doClip(ctx,clip),ctx.font=attrs[0],ctx.fillStyle=attrs[1],ctx.textBaseline=attrs[2],ctx.textAlign=attrs[3];for(let i=0;i<tarray.length;i++){var t=tarray[i];ctx.fillText(t[0],t[1],t[2])}ctx.restore()}}class ValRef{constructor(val){this.value=val}get(){return this.value}set(v){this.value=v}toggle(){this.value=!this.value}}class Vec1{constructor(x){this.x=x}Clone(){return new Vec1(this.x)}static Lerp(a,b,pct){if("number"==typeof a)return a+(b-a)*pct;console.assert(!1)}static Clamp(a,min,max){return a<min?min:max<a?max:a}static Saturate(val){return val<0?0:1<val?1:val}}let sZero,sMaxValue,sMaxNegValue;class Vec2{constructor(x,y){this.x=void 0===x?0:x,this.y=void 0===y?0:y}Equals(other){return this.x==other.x&&this.y==other.y}IsNaN(){return isNaN(this.x)||isNaN(this.y)}Clone(){return new Vec2(this.x,this.y)}Copy(src){this.x=src.x,this.y=src.y}CopyXY(x,y){this.x=x,this.y=y}Add(other){return"number"==typeof other?(this.x+=other,this.y+=other):(this.x+=other.x,this.y+=other.y),this}AddXY(x,y){return this.x+=x,this.y+=y,this}Subtract(other){return"number"==typeof other?(this.x-=other,this.y-=other):(this.x-=other.x,this.y-=other.y),this}SubtractXY(x,y){return this.x-=x,this.y-=y,this}Mult(other){return"number"==typeof other?(this.x*=other,this.y*=other):(this.x*=other.x,this.y*=other.y),this}MultXY(x,y){return this.x*=x,this.y*=y,this}Divide(other){return"number"==typeof other?(this.x/=other,this.y/=other):(this.x/=other.x,this.y/=other.y),this}Floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}LengthSq(){return this.x*this.x+this.y*this.y}static Zero(clone=!0){return null==sZero&&(sZero=new Vec2(0,0)),clone?sZero.Clone():sZero}static MAX_VALUE(clone=!0){return null==sMaxValue&&(sMaxValue=new Vec2(Number.MAX_VALUE,Number.MAX_VALUE)),clone?sMaxValue.Clone():sMaxValue}static MAX_NEGVALUE(clone=!0){return null==sMaxNegValue&&(sMaxNegValue=new Vec2(-Number.MAX_VALUE,-Number.MAX_VALUE)),clone?sMaxNegValue.Clone():sMaxNegValue}static Add(a,b,c){return"number"==typeof b?(null==c&&(c=b),new Vec2(a.x+b,a.y+c)):new Vec2(a.x+b.x,a.y+b.y)}static AddXY(a,x,y){return new Vec2(a.x+x,a.y+y)}static Subtract(a,b){return new Vec2(a.x-b.x,a.y-b.y)}static SubtractXY(a,x,y){return new Vec2(a.x-x,a.y-y)}static Scale(a,factor){return Vec2.Mult(a,factor)}static Mult(a,factor){return"number"==typeof factor?new Vec2(a.x*factor,a.y*factor):new Vec2(a.x*factor.x,a.y*factor.y)}static MultXY(a,mx,my){return new Vec2(a.x*mx,a.y*my)}static Divide(a,factor){return"number"==typeof factor?new Vec2(a.x/factor,a.y/factor):new Vec2(a.x/factor.x,a.y/factor.y)}static LengthSq(a,b){let dp=Vec2.Subtract(a,b);return dp.LengthSq()}static Dot(a,b){return a.x*b.x+a.y+b.y}static Min(lhs,rhs){return new Vec2((lhs.x<rhs.x?lhs:rhs).x,(lhs.y<rhs.y?lhs:rhs).y)}static Max(lhs,rhs){return new Vec2((lhs.x>=rhs.x?lhs:rhs).x,(lhs.y>=rhs.y?lhs:rhs).y)}static Clamp(v,mn,mx){return new Vec2((v.x<mn.x?mn:v.x>mx.x?mx:v).x,(v.y<mn.y?mn:v.y>mx.y?mx:v).y)}static Floor(v){return new Vec2(Math.floor(v.x),Math.floor(v.y))}static Lerp(a,b,pct){return"number"==typeof pct?new Vec2(a.x+(b.x-a.x)*pct,a.y+(b.y-a.y)*pct):new Vec2(a.x+(b.x-a.x)*pct.x,a.y+(b.y-a.y)*pct.y)}}class Rect{constructor(a=null,b=null,c=null,d=null,clone=!0){null==a?(this.Min=new Vec2(Number.MAX_VALUE,Number.MAX_VALUE),this.Max=new Vec2(-Number.MAX_VALUE,-Number.MAX_VALUE)):"number"==typeof c?(this.Min=new Vec2(a,b),this.Max=new Vec2(c,d)):clone?(this.Min=a.Clone(),this.Max=b.Clone()):(this.Min=a,this.Max=b)}static Expand(r,val){return Rect.FromRect(r).Expand(val)}static FromRect(r){return new Rect(r.Min,r.Max)}static FromXY(x1,y1,x2,y2){return"number"==typeof x1?new Rect(new Vec2(x1,y1),new Vec2(x2,y2),!1):(console.assert(null==y2),new Rect(x1.Clone(),new Vec2(y1,x2)))}Clone(){return Rect.FromRect(this)}Copy(src){this.Min.Copy(src.Min),this.Max.Copy(src.Max)}IsNaN(){return this.Min.IsNaN()||this.Max.IsNaN()}IsValid(){return this.Min.x!=Number.MAX_VALUE||this.Min.y!=Number.MAX_VALUE||this.Max.x!=-Number.MAX_VALUE||this.Max.y!=-Number.MAX_VALUE}GetTL(){return this.Min}GetTR(){return new Vec2(this.Max.x,this.Min.y)}GetBR(){return this.Max}GetBL(){return new Vec2(this.Min.x,this.Max.y)}GetMin(){return this.Min}GetMax(){return this.Max}GetSize(){return new Vec2(this.GetWidth(),this.GetHeight())}SetSize(sz,szy=void 0){null!=szy?(this.Max.x=this.Min.x+sz,this.Max.y=this.Min.y+szy):(this.Max.x=this.Min.x+sz.x,this.Max.y=this.Min.y+sz.y)}GetWidth(){return this.Max.x-this.Min.x}GetHeight(){return this.Max.y-this.Min.y}GetCenter(){return new Vec2(this.Min.x+.5*this.GetWidth(),this.Min.y+.5*this.GetHeight())}Contains(p){return null!=p.x?this.ContainsPt(p):p.Min?this.ContainsRect(p):void console.assert("unexpected parameter")}ContainsPt(p){return p.x>=this.Min.x&&p.y>=this.Min.y&&p.x<this.Max.x&&p.y<this.Max.y}ContainsRect(r){return r.Min.x>=this.Min.x&&r.Min.y>=this.Min.y&&r.Max.x<=this.Max.x&&r.Max.y<=this.Max.y}Overlaps(r){return r.Min.y<this.Max.y&&r.Max.y>this.Min.y&&r.Min.x<this.Max.x&&r.Max.x>this.Min.x}AddPt(p){this.Min.x>p.x&&(this.Min.x=p.x),this.Min.y>p.y&&(this.Min.y=p.y),this.Max.x<p.x&&(this.Max.x=p.x),this.Max.y<p.y&&(this.Max.y=p.y)}AddRect(r){this.Min.x>r.Min.x&&(this.Min.x=r.Min.x),this.Min.y>r.Min.y&&(this.Min.y=r.Min.y),this.Max.x<r.Max.x&&(this.Max.x=r.Max.x),this.Max.y<r.Max.y&&(this.Max.y=r.Max.y)}Expand(val){return"number"==typeof val?this.expandF(val):this.expandXY(val.x,val.y),this}expandF(amount){this.Min.x-=amount,this.Min.y-=amount,this.Max.x+=amount,this.Max.y+=amount}expandXY(x,y){this.Min.x-=x,this.Min.y-=y,this.Max.x+=x,this.Max.y+=y}Translate(pt){this.Min.x+=pt.x,this.Min.y+=pt.y,this.Max.x+=pt.x,this.Max.y+=pt.y}TranslateX(dx){this.Min.x+=dx,this.Max.x+=dx}TranslateY(dy){this.Min.y+=dy,this.Max.y+=dy}ClipWith(r){return this.Min=Vec2.Max(this.Min,r.Min),this.Max=Vec2.Min(this.Max,r.Max),this}ClipWithFull(r){return this.Min=Vec2.Clamp(this.Min,r.Min,r.Max),this.Max=Vec2.Clamp(this.Max,r.Min,r.Max),this}Floor(){return this.Min.x=Math.floor(this.Min.x),this.Min.y=Math.floor(this.Min.y),this.Max.x=Math.floor(this.Max.x),this.Max.y=Math.floor(this.Max.y),this}IsInverted(){return this.Min.x>this.Max.x||this.Min.y>this.Max.y}}class MutableString{constructor(str=""){this.str=str}IsMutable(){}Clone(){return new MutableString(this.str)}Copy(mstr){console.assert(mstr.IsMutable),this.str=mstr.str}Equals(str){return str.IsMutable?this.str==str.str:this.str==str}Get(){return this.str}toString(){return this.str}Set(str){this.str=str||""}Length(){return this.str?this.str.length:0}CountLines(){let linecount=1;for(let i=0;i<this.str.length;i++)10==this.str.charCodeAt(i)&&linecount++;return linecount}GetChar(idx){return this.str[idx]}FindLineBegin(idx){for(let i=idx-1;0<=i;i--)if(10==this.str.charCodeAt(i))return i+1;return 0}IsNewline(idx){return 10==this.str.charCodeAt(idx)}IsSeparator(idx){return/[\s,;(){}|]/.test(this.str[idx])}GetCharCode(idx){return this.str.charCodeAt(idx)}GetChars(where,len){return this.str.slice(where,where+len)}DeleteChars(where,len){this.Splice(where,len)}InsertChars(where,chars){this.Splice(where,0,chars)}Splice(start,delCount,newSubStr){let str=this.str;this.str=newSubStr?str.slice(0,start)+newSubStr+str.slice(start+delCount):str.slice(0,start)+str.slice(start+delCount)}}let materialIconsIJMap={icons:{e84d:{name:"3d Rotation"},eb3b:{name:"Ac Unit"},e190:{name:"Access Alarm"},e191:{name:"Access Alarms"},e192:{name:"Access Time"},e84e:{name:"Accessibility"},e914:{name:"Accessible"},e84f:{name:"Account Balance"},e850:{name:"Account Balance Wallet"},e851:{name:"Account Box"},e853:{name:"Account Circle"},e60e:{name:"Adb"},e145:{name:"Add"},e439:{name:"Add A Photo"},e193:{name:"Add Alarm"},e003:{name:"Add Alert"},e146:{name:"Add Box"},e147:{name:"Add Circle"},e148:{name:"Add Circle Outline"},e567:{name:"Add Location"},e854:{name:"Add Shopping Cart"},e39d:{name:"Add To Photos"},e05c:{name:"Add To Queue"},e39e:{name:"Adjust"},e630:{name:"Airline Seat Flat"},e631:{name:"Airline Seat Flat Angled"},e632:{name:"Airline Seat Individual Suite"},e633:{name:"Airline Seat Legroom Extra"},e634:{name:"Airline Seat Legroom Normal"},e635:{name:"Airline Seat Legroom Reduced"},e636:{name:"Airline Seat Recline Extra"},e637:{name:"Airline Seat Recline Normal"},e195:{name:"Airplanemode Active"},e194:{name:"Airplanemode Inactive"},e055:{name:"Airplay"},eb3c:{name:"Airport Shuttle"},e855:{name:"Alarm"},e856:{name:"Alarm Add"},e857:{name:"Alarm Off"},e858:{name:"Alarm On"},e019:{name:"Album"},eb3d:{name:"All Inclusive"},e90b:{name:"All Out"},e859:{name:"Android"},e85a:{name:"Announcement"},e5c3:{name:"Apps"},e149:{name:"Archive"},e5c4:{name:"Arrow Back"},e5db:{name:"Arrow Downward"},e5c5:{name:"Arrow Drop Down"},e5c6:{name:"Arrow Drop Down Circle"},e5c7:{name:"Arrow Drop Up"},e5c8:{name:"Arrow Forward"},e5d8:{name:"Arrow Upward"},e060:{name:"Art Track"},e85b:{name:"Aspect Ratio"},e85c:{name:"Assessment"},e85d:{name:"Assignment"},e85e:{name:"Assignment Ind"},e85f:{name:"Assignment Late"},e860:{name:"Assignment Return"},e861:{name:"Assignment Returned"},e862:{name:"Assignment Turned In"},e39f:{name:"Assistant"},e3a0:{name:"Assistant Photo"},e226:{name:"Attach File"},e227:{name:"Attach Money"},e2bc:{name:"Attachment"},e3a1:{name:"Audiotrack"},e863:{name:"Autorenew"},e01b:{name:"Av Timer"},e14a:{name:"Backspace"},e864:{name:"Backup"},e19c:{name:"Battery Alert"},e1a3:{name:"Battery Charging Full"},e1a4:{name:"Battery Full"},e1a5:{name:"Battery Std"},e1a6:{name:"Battery Unknown"},eb3e:{name:"Beach Access"},e52d:{name:"Beenhere"},e14b:{name:"Block"},e1a7:{name:"Bluetooth"},e60f:{name:"Bluetooth Audio"},e1a8:{name:"Bluetooth Connected"},e1a9:{name:"Bluetooth Disabled"},e1aa:{name:"Bluetooth Searching"},e3a2:{name:"Blur Circular"},e3a3:{name:"Blur Linear"},e3a4:{name:"Blur Off"},e3a5:{name:"Blur On"},e865:{name:"Book"},e866:{name:"Bookmark"},e868:{name:"Bug Report"},e228:{name:"Border All"},e229:{name:"Border Bottom"},e22a:{name:"Border Clear"},e22b:{name:"Border Color"},e22c:{name:"Border Horizontal"},e22d:{name:"Border Inner"},e22e:{name:"Border Left"},e22f:{name:"Border Outer"},e230:{name:"Border Right"},e231:{name:"Border Style"},e232:{name:"Border Top"},e233:{name:"Border Vertical"},e06b:{name:"Branding Watermark"},e3a6:{name:"Brightness 1"},e3a7:{name:"Brightness 2"},e3a8:{name:"Brightness 3"},e3a9:{name:"Brightness 4"},e3aa:{name:"Brightness 5"},e3ab:{name:"Brightness 6"},e3ac:{name:"Brightness 7"},e1ab:{name:"Brightness Auto"},e1ac:{name:"Brightness High"},e1ad:{name:"Brightness Low"},e1ae:{name:"Brightness Medium"},e3ad:{name:"Broken Image"},e3ae:{name:"Brush"},e6dd:{name:"Bubble Chart"},e869:{name:"Build"},e43c:{name:"Burst Mode"},e0af:{name:"Business"},eb3f:{name:"Business Center"},e86a:{name:"Cached"},e7e9:{name:"Cake"},e0b0:{name:"Call"},e0b1:{name:"Call End"},e0b2:{name:"Call Made"},e0b3:{name:"Call Merge"},e0b4:{name:"Call Missed"},e0e4:{name:"Call Missed Outgoing"},e0b5:{name:"Call Received"},e0b6:{name:"Call Split"},e06c:{name:"Call To Action"},e3af:{name:"Camera"},e3b0:{name:"Camera Alt"},e8fc:{name:"Camera Enhance"},e3b1:{name:"Camera Front"},e3b2:{name:"Camera Rear"},e3b3:{name:"Camera Roll"},e5c9:{name:"Cancel"},e8f6:{name:"Card Giftcard"},e8f7:{name:"Card Membership"},e8f8:{name:"Card Travel"},eb40:{name:"Casino"},e307:{name:"Cast"},e308:{name:"Cast Connected"},e3b4:{name:"Center Focus Strong"},e3b5:{name:"Center Focus Weak"},e86b:{name:"Change History"},e0b7:{name:"Chat"},e0ca:{name:"Chat Bubble"},e0cb:{name:"Chat Bubble Outline"},e5ca:{name:"Check"},e834:{name:"Check Box"},e835:{name:"Check Box Outline Blank"},e86c:{name:"Check Circle"},e5cb:{name:"Chevron Left"},e5cc:{name:"Chevron Right"},eb41:{name:"Child Care"},eb42:{name:"Child Friendly"},e86d:{name:"Chrome Reader Mode"},e86e:{name:"Class"},e14c:{name:"Clear"},e0b8:{name:"Clear All"},e5cd:{name:"Close"},e01c:{name:"Closed Caption"},e2bd:{name:"Cloud"},e2be:{name:"Cloud Circle"},e2bf:{name:"Cloud Done"},e2c0:{name:"Cloud Download"},e2c1:{name:"Cloud Off"},e2c2:{name:"Cloud Queue"},e2c3:{name:"Cloud Upload"},e86f:{name:"Code"},e3b6:{name:"Collections"},e431:{name:"Collections Bookmark"},e3b7:{name:"Color Lens"},e3b8:{name:"Colorize"},e0b9:{name:"Comment"},e3b9:{name:"Compare"},e915:{name:"Compare Arrows"},e30a:{name:"Computer"},e638:{name:"Confirmation Number"},e0d0:{name:"Contact Mail"},e0cf:{name:"Contact Phone"},e0ba:{name:"Contacts"},e14d:{name:"Content Copy"},e14e:{name:"Content Cut"},e14f:{name:"Content Paste"},e3ba:{name:"Control Point"},e3bb:{name:"Control Point Duplicate"},e90c:{name:"Copyright"},e150:{name:"Create"},e2cc:{name:"Create New Folder"},e870:{name:"Credit Card"},e3be:{name:"Crop"},e3bc:{name:"Crop 16 9"},e3bd:{name:"Crop 3 2"},e3bf:{name:"Crop 5 4"},e3c0:{name:"Crop 7 5"},e3c1:{name:"Crop Din"},e3c2:{name:"Crop Free"},e3c3:{name:"Crop Landscape"},e3c4:{name:"Crop Original"},e3c5:{name:"Crop Portrait"},e437:{name:"Crop Rotate"},e3c6:{name:"Crop Square"},e871:{name:"Dashboard"},e1af:{name:"Data Usage"},e916:{name:"Date Range"},e3c7:{name:"Dehaze"},e872:{name:"Delete"},e92b:{name:"Delete Forever"},e16c:{name:"Delete Sweep"},e873:{name:"Description"},e30b:{name:"Desktop Mac"},e30c:{name:"Desktop Windows"},e3c8:{name:"Details"},e30d:{name:"Developer Board"},e1b0:{name:"Developer Mode"},e335:{name:"Device Hub"},e1b1:{name:"Devices"},e337:{name:"Devices Other"},e0bb:{name:"Dialer Sip"},e0bc:{name:"Dialpad"},e52e:{name:"Directions"},e52f:{name:"Directions Bike"},e532:{name:"Directions Boat"},e530:{name:"Directions Bus"},e531:{name:"Directions Car"},e534:{name:"Directions Railway"},e566:{name:"Directions Run"},e533:{name:"Directions Subway"},e535:{name:"Directions Transit"},e536:{name:"Directions Walk"},e610:{name:"Disc Full"},e875:{name:"Dns"},e612:{name:"Do Not Disturb"},e611:{name:"Do Not Disturb Alt"},e643:{name:"Do Not Disturb Off"},e644:{name:"Do Not Disturb On"},e30e:{name:"Dock"},e7ee:{name:"Domain"},e876:{name:"Done"},e877:{name:"Done All"},e917:{name:"Donut Large"},e918:{name:"Donut Small"},e151:{name:"Drafts"},e25d:{name:"Drag Handle"},e613:{name:"Drive Eta"},e1b2:{name:"Dvr"},e3c9:{name:"Edit"},e568:{name:"Edit Location"},e8fb:{name:"Eject"},e0be:{name:"Email"},e63f:{name:"Enhanced Encryption"},e01d:{name:"Equalizer"},e000:{name:"Error"},e001:{name:"Error Outline"},e926:{name:"Euro Symbol"},e56d:{name:"Ev Station"},e878:{name:"Event"},e614:{name:"Event Available"},e615:{name:"Event Busy"},e616:{name:"Event Note"},e903:{name:"Event Seat"},e879:{name:"Exit To App"},e5ce:{name:"Expand Less"},e5cf:{name:"Expand More"},e01e:{name:"Explicit"},e87a:{name:"Explore"},e3ca:{name:"Exposure"},e3cb:{name:"Exposure Neg 1"},e3cc:{name:"Exposure Neg 2"},e3cd:{name:"Exposure Plus 1"},e3ce:{name:"Exposure Plus 2"},e3cf:{name:"Exposure Zero"},e87b:{name:"Extension"},e87c:{name:"Face"},e01f:{name:"Fast Forward"},e020:{name:"Fast Rewind"},e87d:{name:"Favorite"},e87e:{name:"Favorite Border"},e06d:{name:"Featured Play List"},e06e:{name:"Featured Video"},e87f:{name:"Feedback"},e05d:{name:"Fiber Dvr"},e061:{name:"Fiber Manual Record"},e05e:{name:"Fiber New"},e06a:{name:"Fiber Pin"},e062:{name:"Fiber Smart Record"},e2c4:{name:"File Download"},e2c6:{name:"File Upload"},e3d3:{name:"Filter"},e3d0:{name:"Filter 1"},e3d1:{name:"Filter 2"},e3d2:{name:"Filter 3"},e3d4:{name:"Filter 4"},e3d5:{name:"Filter 5"},e3d6:{name:"Filter 6"},e3d7:{name:"Filter 7"},e3d8:{name:"Filter 8"},e3d9:{name:"Filter 9"},e3da:{name:"Filter 9 Plus"},e3db:{name:"Filter B And W"},e3dc:{name:"Filter Center Focus"},e3dd:{name:"Filter Drama"},e3de:{name:"Filter Frames"},e3df:{name:"Filter Hdr"},e152:{name:"Filter List"},e3e0:{name:"Filter None"},e3e2:{name:"Filter Tilt Shift"},e3e3:{name:"Filter Vintage"},e880:{name:"Find In Page"},e881:{name:"Find Replace"},e90d:{name:"Fingerprint"},e5dc:{name:"First Page"},eb43:{name:"Fitness Center"},e153:{name:"Flag"},e3e4:{name:"Flare"},e3e5:{name:"Flash Auto"},e3e6:{name:"Flash Off"},e3e7:{name:"Flash On"},e539:{name:"Flight"},e904:{name:"Flight Land"},e905:{name:"Flight Takeoff"},e3e8:{name:"Flip"},e882:{name:"Flip To Back"},e883:{name:"Flip To Front"},e2c7:{name:"Folder"},e2c8:{name:"Folder Open"},e2c9:{name:"Folder Shared"},e617:{name:"Folder Special"},e167:{name:"Font Download"},e234:{name:"Format Align Center"},e235:{name:"Format Align Justify"},e236:{name:"Format Align Left"},e237:{name:"Format Align Right"},e238:{name:"Format Bold"},e239:{name:"Format Clear"},e23a:{name:"Format Color Fill"},e23b:{name:"Format Color Reset"},e23c:{name:"Format Color Text"},e23d:{name:"Format Indent Decrease"},e23e:{name:"Format Indent Increase"},e23f:{name:"Format Italic"},e240:{name:"Format Line Spacing"},e241:{name:"Format List Bulleted"},e242:{name:"Format List Numbered"},e243:{name:"Format Paint"},e244:{name:"Format Quote"},e25e:{name:"Format Shapes"},e245:{name:"Format Size"},e246:{name:"Format Strikethrough"},e247:{name:"Format Textdirection L To R"},e248:{name:"Format Textdirection R To L"},e249:{name:"Format Underlined"},e0bf:{name:"Forum"},e154:{name:"Forward"},e056:{name:"Forward 10"},e057:{name:"Forward 30"},e058:{name:"Forward 5"},eb44:{name:"Free Breakfast"},e5d0:{name:"Fullscreen"},e5d1:{name:"Fullscreen Exit"},e24a:{name:"Functions"},e927:{name:"G Translate"},e30f:{name:"Gamepad"},e021:{name:"Games"},e90e:{name:"Gavel"},e155:{name:"Gesture"},e884:{name:"Get App"},e908:{name:"Gif"},eb45:{name:"Golf Course"},e1b3:{name:"Gps Fixed"},e1b4:{name:"Gps Not Fixed"},e1b5:{name:"Gps Off"},e885:{name:"Grade"},e3e9:{name:"Gradient"},e3ea:{name:"Grain"},e1b8:{name:"Graphic Eq"},e3eb:{name:"Grid Off"},e3ec:{name:"Grid On"},e7ef:{name:"Group"},e7f0:{name:"Group Add"},e886:{name:"Group Work"},e052:{name:"Hd"},e3ed:{name:"Hdr Off"},e3ee:{name:"Hdr On"},e3f1:{name:"Hdr Strong"},e3f2:{name:"Hdr Weak"},e310:{name:"Headset"},e311:{name:"Headset Mic"},e3f3:{name:"Healing"},e023:{name:"Hearing"},e887:{name:"Help"},e8fd:{name:"Help Outline"},e024:{name:"High Quality"},e25f:{name:"Highlight"},e888:{name:"Highlight Off"},e889:{name:"History"},e88a:{name:"Home"},eb46:{name:"Hot Tub"},e53a:{name:"Hotel"},e88b:{name:"Hourglass Empty"},e88c:{name:"Hourglass Full"},e902:{name:"Http"},e88d:{name:"Https"},e3f4:{name:"Image"},e3f5:{name:"Image Aspect Ratio"},e0e0:{name:"Import Contacts"},e0c3:{name:"Import Export"},e912:{name:"Important Devices"},e156:{name:"Inbox"},e909:{name:"Indeterminate Check Box"},e88e:{name:"Info"},e88f:{name:"Info Outline"},e890:{name:"Input"},e24b:{name:"Insert Chart"},e24c:{name:"Insert Comment"},e24d:{name:"Insert Drive File"},e24e:{name:"Insert Emoticon"},e24f:{name:"Insert Invitation"},e250:{name:"Insert Link"},e251:{name:"Insert Photo"},e891:{name:"Invert Colors"},e0c4:{name:"Invert Colors Off"},e3f6:{name:"Iso"},e312:{name:"Keyboard"},e313:{name:"Keyboard Arrow Down"},e314:{name:"Keyboard Arrow Left"},e315:{name:"Keyboard Arrow Right"},e316:{name:"Keyboard Arrow Up"},e317:{name:"Keyboard Backspace"},e318:{name:"Keyboard Capslock"},e31a:{name:"Keyboard Hide"},e31b:{name:"Keyboard Return"},e31c:{name:"Keyboard Tab"},e31d:{name:"Keyboard Voice"},eb47:{name:"Kitchen"},e892:{name:"Label"},e893:{name:"Label Outline"},e3f7:{name:"Landscape"},e894:{name:"Language"},e31e:{name:"Laptop"},e31f:{name:"Laptop Chromebook"},e320:{name:"Laptop Mac"},e321:{name:"Laptop Windows"},e5dd:{name:"Last Page"},e895:{name:"Launch"},e53b:{name:"Layers"},e53c:{name:"Layers Clear"},e3f8:{name:"Leak Add"},e3f9:{name:"Leak Remove"},e3fa:{name:"Lens"},e02e:{name:"Library Add"},e02f:{name:"Library Books"},e030:{name:"Library Music"},e90f:{name:"Lightbulb Outline"},e919:{name:"Line Style"},e91a:{name:"Line Weight"},e260:{name:"Linear Scale"},e157:{name:"Link"},e438:{name:"Linked Camera"},e896:{name:"List"},e0c6:{name:"Live Help"},e639:{name:"Live Tv"},e53f:{name:"Local Activity"},e53d:{name:"Local Airport"},e53e:{name:"Local Atm"},e540:{name:"Local Bar"},e541:{name:"Local Cafe"},e542:{name:"Local Car Wash"},e543:{name:"Local Convenience Store"},e556:{name:"Local Dining"},e544:{name:"Local Drink"},e545:{name:"Local Florist"},e546:{name:"Local Gas Station"},e547:{name:"Local Grocery Store"},e548:{name:"Local Hospital"},e549:{name:"Local Hotel"},e54a:{name:"Local Laundry Service"},e54b:{name:"Local Library"},e54c:{name:"Local Mall"},e54d:{name:"Local Movies"},e54e:{name:"Local Offer"},e54f:{name:"Local Parking"},e550:{name:"Local Pharmacy"},e551:{name:"Local Phone"},e552:{name:"Local Pizza"},e553:{name:"Local Play"},e554:{name:"Local Post Office"},e555:{name:"Local Printshop"},e557:{name:"Local See"},e558:{name:"Local Shipping"},e559:{name:"Local Taxi"},e7f1:{name:"Location City"},e1b6:{name:"Location Disabled"},e0c7:{name:"Location Off"},e0c8:{name:"Location On"},e1b7:{name:"Location Searching"},e897:{name:"Lock"},e898:{name:"Lock Open"},e899:{name:"Lock Outline"},e3fc:{name:"Looks"},e3fb:{name:"Looks 3"},e3fd:{name:"Looks 4"},e3fe:{name:"Looks 5"},e3ff:{name:"Looks 6"},e400:{name:"Looks One"},e401:{name:"Looks Two"},e028:{name:"Loop"},e402:{name:"Loupe"},e16d:{name:"Low Priority"},e89a:{name:"Loyalty"},e158:{name:"Mail"},e0e1:{name:"Mail Outline"},e55b:{name:"Map"},e159:{name:"Markunread"},e89b:{name:"Markunread Mailbox"},e322:{name:"Memory"},e5d2:{name:"Menu"},e252:{name:"Merge Type"},e0c9:{name:"Message"},e029:{name:"Mic"},e02a:{name:"Mic None"},e02b:{name:"Mic Off"},e618:{name:"Mms"},e253:{name:"Mode Comment"},e254:{name:"Mode Edit"},e263:{name:"Monetization On"},e25c:{name:"Money Off"},e403:{name:"Monochrome Photos"},e7f2:{name:"Mood"},e7f3:{name:"Mood Bad"},e619:{name:"More"},e5d3:{name:"More Horiz"},e5d4:{name:"More Vert"},e91b:{name:"Motorcycle"},e323:{name:"Mouse"},e168:{name:"Move To Inbox"},e02c:{name:"Movie"},e404:{name:"Movie Creation"},e43a:{name:"Movie Filter"},e6df:{name:"Multiline Chart"},e405:{name:"Music Note"},e063:{name:"Music Video"},e55c:{name:"My Location"},e406:{name:"Nature"},e407:{name:"Nature People"},e408:{name:"Navigate Before"},e409:{name:"Navigate Next"},e55d:{name:"Navigation"},e569:{name:"Near Me"},e1b9:{name:"Network Cell"},e640:{name:"Network Check"},e61a:{name:"Network Locked"},e1ba:{name:"Network Wifi"},e031:{name:"New Releases"},e16a:{name:"Next Week"},e1bb:{name:"Nfc"},e641:{name:"No Encryption"},e0cc:{name:"No Sim"},e033:{name:"Not Interested"},e06f:{name:"Note"},e89c:{name:"Note Add"},e7f4:{name:"Notifications"},e7f7:{name:"Notifications Active"},e7f5:{name:"Notifications None"},e7f6:{name:"Notifications Off"},e7f8:{name:"Notifications Paused"},e90a:{name:"Offline Pin"},e63a:{name:"Ondemand Video"},e91c:{name:"Opacity"},e89d:{name:"Open In Browser"},e89e:{name:"Open In New"},e89f:{name:"Open With"},e7f9:{name:"Pages"},e8a0:{name:"Pageview"},e40a:{name:"Palette"},e925:{name:"Pan Tool"},e40b:{name:"Panorama"},e40c:{name:"Panorama Fish Eye"},e40d:{name:"Panorama Horizontal"},e40e:{name:"Panorama Vertical"},e40f:{name:"Panorama Wide Angle"},e7fa:{name:"Party Mode"},e034:{name:"Pause"},e035:{name:"Pause Circle Filled"},e036:{name:"Pause Circle Outline"},e8a1:{name:"Payment"},e7fb:{name:"People"},e7fc:{name:"People Outline"},e8a2:{name:"Perm Camera Mic"},e8a3:{name:"Perm Contact Calendar"},e8a4:{name:"Perm Data Setting"},e8a5:{name:"Perm Device Information"},e8a6:{name:"Perm Identity"},e8a7:{name:"Perm Media"},e8a8:{name:"Perm Phone Msg"},e8a9:{name:"Perm Scan Wifi"},e7fd:{name:"Person"},e7fe:{name:"Person Add"},e7ff:{name:"Person Outline"},e55a:{name:"Person Pin"},e56a:{name:"Person Pin Circle"},e63b:{name:"Personal Video"},e91d:{name:"Pets"},e0cd:{name:"Phone"},e324:{name:"Phone Android"},e61b:{name:"Phone Bluetooth Speaker"},e61c:{name:"Phone Forwarded"},e61d:{name:"Phone In Talk"},e325:{name:"Phone Iphone"},e61e:{name:"Phone Locked"},e61f:{name:"Phone Missed"},e620:{name:"Phone Paused"},e326:{name:"Phonelink"},e0db:{name:"Phonelink Erase"},e0dc:{name:"Phonelink Lock"},e327:{name:"Phonelink Off"},e0dd:{name:"Phonelink Ring"},e0de:{name:"Phonelink Setup"},e410:{name:"Photo"},e411:{name:"Photo Album"},e412:{name:"Photo Camera"},e43b:{name:"Photo Filter"},e413:{name:"Photo Library"},e432:{name:"Photo Size Select Actual"},e433:{name:"Photo Size Select Large"},e434:{name:"Photo Size Select Small"},e415:{name:"Picture As Pdf"},e8aa:{name:"Picture In Picture"},e911:{name:"Picture In Picture Alt"},e6c4:{name:"Pie Chart"},e6c5:{name:"Pie Chart Outlined"},e55e:{name:"Pin Drop"},e55f:{name:"Place"},e037:{name:"Play Arrow"},e038:{name:"Play Circle Filled"},e039:{name:"Play Circle Outline"},e906:{name:"Play For Work"},e03b:{name:"Playlist Add"},e065:{name:"Playlist Add Check"},e05f:{name:"Playlist Play"},e800:{name:"Plus One"},e801:{name:"Poll"},e8ab:{name:"Polymer"},eb48:{name:"Pool"},e0ce:{name:"Portable Wifi Off"},e416:{name:"Portrait"},e63c:{name:"Power"},e336:{name:"Power Input"},e8ac:{name:"Power Settings New"},e91e:{name:"Pregnant Woman"},e0df:{name:"Present To All"},e8ad:{name:"Print"},e645:{name:"Priority High"},e80b:{name:"Public"},e255:{name:"Publish"},e8ae:{name:"Query Builder"},e8af:{name:"Question Answer"},e03c:{name:"Queue"},e03d:{name:"Queue Music"},e066:{name:"Queue Play Next"},e03e:{name:"Radio"},e837:{name:"Radio Button Checked"},e836:{name:"Radio Button Unchecked"},e560:{name:"Rate Review"},e8b0:{name:"Receipt"},e03f:{name:"Recent Actors"},e91f:{name:"Record Voice Over"},e8b1:{name:"Redeem"},e15a:{name:"Redo"},e5d5:{name:"Refresh"},e15b:{name:"Remove"},e15c:{name:"Remove Circle"},e15d:{name:"Remove Circle Outline"},e067:{name:"Remove From Queue"},e417:{name:"Remove Red Eye"},e928:{name:"Remove Shopping Cart"},e8fe:{name:"Reorder"},e040:{name:"Repeat"},e041:{name:"Repeat One"},e042:{name:"Replay"},e059:{name:"Replay 10"},e05a:{name:"Replay 30"},e05b:{name:"Replay 5"},e15e:{name:"Reply"},e15f:{name:"Reply All"},e160:{name:"Report"},e8b2:{name:"Report Problem"},e56c:{name:"Restaurant"},e561:{name:"Restaurant Menu"},e8b3:{name:"Restore"},e929:{name:"Restore Page"},e0d1:{name:"Ring Volume"},e8b4:{name:"Room"},eb49:{name:"Room Service"},e418:{name:"Rotate 90 Degrees Ccw"},e419:{name:"Rotate Left"},e41a:{name:"Rotate Right"},e920:{name:"Rounded Corner"},e328:{name:"Router"},e921:{name:"Rowing"},e0e5:{name:"Rss Feed"},e642:{name:"Rv Hookup"},e562:{name:"Satellite"},e161:{name:"Save"},e329:{name:"Scanner"},e8b5:{name:"Schedule"},e80c:{name:"School"},e1be:{name:"Screen Lock Landscape"},e1bf:{name:"Screen Lock Portrait"},e1c0:{name:"Screen Lock Rotation"},e1c1:{name:"Screen Rotation"},e0e2:{name:"Screen Share"},e623:{name:"Sd Card"},e1c2:{name:"Sd Storage"},e8b6:{name:"Search"},e32a:{name:"Security"},e162:{name:"Select All"},e163:{name:"Send"},e811:{name:"Sentiment Dissatisfied"},e812:{name:"Sentiment Neutral"},e813:{name:"Sentiment Satisfied"},e814:{name:"Sentiment Very Dissatisfied"},e815:{name:"Sentiment Very Satisfied"},e8b8:{name:"Settings"},e8b9:{name:"Settings Applications"},e8ba:{name:"Settings Backup Restore"},e8bb:{name:"Settings Bluetooth"},e8bd:{name:"Settings Brightness"},e8bc:{name:"Settings Cell"},e8be:{name:"Settings Ethernet"},e8bf:{name:"Settings Input Antenna"},e8c0:{name:"Settings Input Component"},e8c1:{name:"Settings Input Composite"},e8c2:{name:"Settings Input Hdmi"},e8c3:{name:"Settings Input Svideo"},e8c4:{name:"Settings Overscan"},e8c5:{name:"Settings Phone"},e8c6:{name:"Settings Power"},e8c7:{name:"Settings Remote"},e1c3:{name:"Settings System Daydream"},e8c8:{name:"Settings Voice"},e80d:{name:"Share"},e8c9:{name:"Shop"},e8ca:{name:"Shop Two"},e8cb:{name:"Shopping Basket"},e8cc:{name:"Shopping Cart"},e261:{name:"Short Text"},e6e1:{name:"Show Chart"},e043:{name:"Shuffle"},e1c8:{name:"Signal Cellular 4 Bar"},e1cd:{name:"Signal Cellular Connected No Internet 4 Bar"},e1ce:{name:"Signal Cellular No Sim"},e1cf:{name:"Signal Cellular Null"},e1d0:{name:"Signal Cellular Off"},e1d8:{name:"Signal Wifi 4 Bar"},e1d9:{name:"Signal Wifi 4 Bar Lock"},e1da:{name:"Signal Wifi Off"},e32b:{name:"Sim Card"},e624:{name:"Sim Card Alert"},e044:{name:"Skip Next"},e045:{name:"Skip Previous"},e41b:{name:"Slideshow"},e068:{name:"Slow Motion Video"},e32c:{name:"Smartphone"},eb4a:{name:"Smoke Free"},eb4b:{name:"Smoking Rooms"},e625:{name:"Sms"},e626:{name:"Sms Failed"},e046:{name:"Snooze"},e164:{name:"Sort"},e053:{name:"Sort By Alpha"},eb4c:{name:"Spa"},e256:{name:"Space Bar"},e32d:{name:"Speaker"},e32e:{name:"Speaker Group"},e8cd:{name:"Speaker Notes"},e92a:{name:"Speaker Notes Off"},e0d2:{name:"Speaker Phone"},e8ce:{name:"Spellcheck"},e838:{name:"Star"},e83a:{name:"Star Border"},e839:{name:"Star Half"},e8d0:{name:"Stars"},e0d3:{name:"Stay Current Landscape"},e0d4:{name:"Stay Current Portrait"},e0d5:{name:"Stay Primary Landscape"},e0d6:{name:"Stay Primary Portrait"},e047:{name:"Stop"},e0e3:{name:"Stop Screen Share"},e1db:{name:"Storage"},e8d1:{name:"Store"},e563:{name:"Store Mall Directory"},e41c:{name:"Straighten"},e56e:{name:"Streetview"},e257:{name:"Strikethrough S"},e41d:{name:"Style"},e5d9:{name:"Subdirectory Arrow Left"},e5da:{name:"Subdirectory Arrow Right"},e8d2:{name:"Subject"},e064:{name:"Subscriptions"},e048:{name:"Subtitles"},e56f:{name:"Subway"},e8d3:{name:"Supervisor Account"},e049:{name:"Surround Sound"},e0d7:{name:"Swap Calls"},e8d4:{name:"Swap Horiz"},e8d5:{name:"Swap Vert"},e8d6:{name:"Swap Vertical Circle"},e41e:{name:"Switch Camera"},e41f:{name:"Switch Video"},e627:{name:"Sync"},e628:{name:"Sync Disabled"},e629:{name:"Sync Problem"},e62a:{name:"System Update"},e8d7:{name:"System Update Alt"},e8d8:{name:"Tab"},e8d9:{name:"Tab Unselected"},e32f:{name:"Tablet"},e330:{name:"Tablet Android"},e331:{name:"Tablet Mac"},e420:{name:"Tag Faces"},e62b:{name:"Tap And Play"},e564:{name:"Terrain"},e262:{name:"Text Fields"},e165:{name:"Text Format"},e0d8:{name:"Textsms"},e421:{name:"Texture"},e8da:{name:"Theaters"},e8db:{name:"Thumb Down"},e8dc:{name:"Thumb Up"},e8dd:{name:"Thumbs Up Down"},e62c:{name:"Time To Leave"},e422:{name:"Timelapse"},e922:{name:"Timeline"},e425:{name:"Timer"},e423:{name:"Timer 10"},e424:{name:"Timer 3"},e426:{name:"Timer Off"},e264:{name:"Title"},e8de:{name:"Toc"},e8df:{name:"Today"},e8e0:{name:"Toll"},e427:{name:"Tonality"},e913:{name:"Touch App"},e332:{name:"Toys"},e8e1:{name:"Track Changes"},e565:{name:"Traffic"},e570:{name:"Train"},e571:{name:"Tram"},e572:{name:"Transfer Within A Station"},e428:{name:"Transform"},e8e2:{name:"Translate"},e8e3:{name:"Trending Down"},e8e4:{name:"Trending Flat"},e8e5:{name:"Trending Up"},e429:{name:"Tune"},e8e6:{name:"Turned In"},e8e7:{name:"Turned In Not"},e333:{name:"Tv"},e169:{name:"Unarchive"},e166:{name:"Undo"},e5d6:{name:"Unfold Less"},e5d7:{name:"Unfold More"},e923:{name:"Update"},e1e0:{name:"Usb"},e8e8:{name:"Verified User"},e258:{name:"Vertical Align Bottom"},e259:{name:"Vertical Align Center"},e25a:{name:"Vertical Align Top"},e62d:{name:"Vibration"},e070:{name:"Video Call"},e071:{name:"Video Label"},e04a:{name:"Video Library"},e04b:{name:"Videocam"},e04c:{name:"Videocam Off"},e338:{name:"Videogame Asset"},e8e9:{name:"View Agenda"},e8ea:{name:"View Array"},e8eb:{name:"View Carousel"},e8ec:{name:"View Column"},e42a:{name:"View Comfy"},e42b:{name:"View Compact"},e8ed:{name:"View Day"},e8ee:{name:"View Headline"},e8ef:{name:"View List"},e8f0:{name:"View Module"},e8f1:{name:"View Quilt"},e8f2:{name:"View Stream"},e8f3:{name:"View Week"},e435:{name:"Vignette"},e8f4:{name:"Visibility"},e8f5:{name:"Visibility Off"},e62e:{name:"Voice Chat"},e0d9:{name:"Voicemail"},e04d:{name:"Volume Down"},e04e:{name:"Volume Mute"},e04f:{name:"Volume Off"},e050:{name:"Volume Up"},e0da:{name:"Vpn Key"},e62f:{name:"Vpn Lock"},e1bc:{name:"Wallpaper"},e002:{name:"Warning"},e334:{name:"Watch"},e924:{name:"Watch Later"},e42c:{name:"Wb Auto"},e42d:{name:"Wb Cloudy"},e42e:{name:"Wb Incandescent"},e436:{name:"Wb Iridescent"},e430:{name:"Wb Sunny"},e63d:{name:"Wc"},e051:{name:"Web"},e069:{name:"Web Asset"},e16b:{name:"Weekend"},e80e:{name:"Whatshot"},e1bd:{name:"Widgets"},e63e:{name:"Wifi"},e1e1:{name:"Wifi Lock"},e1e2:{name:"Wifi Tethering"},e8f9:{name:"Work"},e25b:{name:"Wrap Text"},e8fa:{name:"Youtube Searched For"},e8ff:{name:"Zoom In"},e900:{name:"Zoom Out"},e56b:{name:"Zoom Out Map"}}};function fixupMap(m){for(var code in m.nameToCode={},m.knownCodes=[],m.icons)m.nameToCode[m.icons[code].name]=code,m.knownCodes.push(Number("0x"+code));return m}var FontIJMap={"Material Icons":fixupMap(materialIconsIJMap)},ImguiLoggingMixin={LogToTTY(auto_open_depth){},LogToFile(auto_open_dept=0,filename){},LogToClipboard(auto_open_depth=0){},LogFinish(){},LogButtons(){},LogText(str){}},LayoutType={Horizontal:0,Vertical:1},MouseCursor={None:-1,Arrow:0,TextInput:1,ResizeAll:2,ResizeNS:3,ResizeEW:4,ResizeNESW:5,ResizeNWSE:6,Hand:7,COUNT:8},Key={Tab:0,LeftArrow:1,RightArrow:2,UpArrow:3,DownArrow:4,PageUp:5,PageDown:6,Home:7,End:8,Insert:9,Delete:10,Backspace:11,Space:12,Enter:13,Escape:14,A:15,C:16,V:17,X:18,Y:19,Z:20,COUNT:21},Dir={None:-1,Left:0,Right:1,Up:2,Down:3,COUNT:4},InputSource={None:0,Mouse:1,Nav:2,NavKeyboard:3,NavGampad:4,COUNT:5},InputReadMode={Down:0,Pressed:1,Released:2,Repeat:3,RepeatSlow:4,RepeatFast:5};let i=0;var NavInput={Activate:i++,Cancel:i++,Input:i++,Menu:i++,DpadLeft:i++,DpadRight:i++,DpadUp:i++,DpadDown:i++,LStickLeft:i++,LStickRight:i++,LStickUp:i++,LStickDown:i++,FocusPrev:i++,FocusNext:i++,TweakSlow:i++,TweakFast:i++,KeyMenu_:i++,KeyTab_:i++,KeyLeft_:i++,KeyRight_:i++,KeyUp_:i++,KeyDown_:i++,COUNT:i};NavInput.InternalStart_=NavInput.KeyMenu_;var NavLayer={Main:0,Menu:1,COUNT:2},NavForward={None:0,ForwardQueued:1,ForwardActive:2},LogType={None:0,TTY:1,File:2,Buffer:3,Clipboard:4},Axis={None:-1,X:0,Y:1},WindowFlags={None:0,NoTitleBar:1,NoResize:2,NoMove:4,NoScrollbar:8,NoScrollWithMouse:16,NoCollapse:32,AlwaysAutoResize:64,NoBackground:128,NoSavedSettings:256,NoMouseInputs:512,MenuBar:1024,HorizontalScrollbar:2048,NoFocusOnAppearing:4096,NoBringToFrontOnFocus:8192,AlwaysVerticalScrollbar:16384,AlwaysHorizontalScrollbar:32768,AlwaysUseWindowPadding:65536,NoNavInputs:1<<18,NoNavFocus:1<<19,UnsavedDocument:1<<20,LockScrollingContentSize:1<<21,NavFlattened:1<<23,ChildWindow:1<<24,Tooltip:1<<25,Popup:1<<26,Modal:1<<27,ChildMenu:1<<28};f=WindowFlags,f.NoNav=f.NoNavInputs|f.NoNavFocus,f.NoDecoration=f.NoTitleBar|f.NoResize|f.NoScrollbar|f.NoCollapse,f.NoInputs=f.NoMouseInputs|f.NoNavInputs|f.NoNavFocus;const WindowResizeFromEdge=4,WindowResizeFromEdgeTimer=.04;class ResizeGripDef{constructor(corner,innerDir,min12,max12){this.CornerPosN=corner,this.InnerDir=innerDir,this.AngleMin12=min12,this.AngleMax12=max12}}const ResizeGripDefs=[new ResizeGripDef(new Vec2(1,1),new Vec2(-1,-1),0,3),new ResizeGripDef(new Vec2(0,1),new Vec2(1,-1),3,6),new ResizeGripDef(new Vec2(0,0),new Vec2(1,1),6,9),new ResizeGripDef(new Vec2(1,0),new Vec2(-1,1),9,12)];class ResizeBorderDef{constructor(innerDir,n1,n2,ang){this.InnerDir=innerDir,this.CornerPosN1=n1,this.CornerPosN2=n2,this.OuterAngle=ang}}const s_resizeBorderDefs=[new ResizeBorderDef(new Vec2(0,1),new Vec2(0,0),new Vec2(1,0),1.5*Math.PI),new ResizeBorderDef(new Vec2(-1,0),new Vec2(1,0),new Vec2(1,1),0),new ResizeBorderDef(new Vec2(0,-1),new Vec2(1,1),new Vec2(0,1),.5*Math.PI),new ResizeBorderDef(new Vec2(1,0),new Vec2(0,1),new Vec2(0,0),Math.PI)];class Window{constructor(name,imgui){this.imgui=imgui,this.Name=name,this.ID=GetHash(name,0),this.IDStack=new ArrayEx(this.ID),this.Flags=WindowFlags.None,this.Pos=new Vec2(0,0),this.Size=new Vec2(0,0),this.SizeFull=new Vec2(0,0),this.SizeFullAtLastBegin=new Vec2(0,0),this.SizeContents=new Vec2(0,0),this.SizeContentsExplicit=new Vec2(0,0),this.WindowPadding=new Vec2(0,0),this.WindowRounding=0,this.WindowBorderSize=0,this.NameBufLen=name.length+1,this.MoveId=this.GetID("#MOVE"),this.ChildId=0,this.Scroll=new Vec2(0,0),this.ScrollTarget=Vec2.MAX_VALUE(),this.ScrollTargetCenterRatio=new Vec2(.5,.5),this.ScrollbarSizes=new Vec2(0,0),this.ScrollbarX=!1,this.ScrollbarY=!1,this.Active=!1,this.WasActive=!1,this.WriteAccessed=!1,this.Collapsed=!1,this.WantCollapseToggle=!1,this.SkipItems=!1,this.Appearing=!1,this.Hidden=!1,this.HasCloseButton=!1,this.ResizeBorderHeld=-1,this.BeginCount=0,this.BeginOrderWithinParent=-1,this.BeginOrderWithinContext=-1,this.PopupId=0,this.AutoFitFramesX=-1,this.AutoFitFramesY=-1,this.AutoFitOnlyGrows=!1,this.AutoFitChildAxises=0,this.AutoPosLastDirection=Dir.None,this.HiddenFramesCanSkipItems=0,this.HiddenFramesCannotSkipItems=0,this.SetWindowPosAllowFlags=this.SetWindowSizeAllowFlags=this.SetWindowCollapsedAllowFlags=CondFlags.Always|CondFlags.Once|CondFlags.FirstUseEver|CondFlags.Appearing,this.SetWindowPosVal=Vec2.MAX_VALUE(),this.SetWindowPosPivot=Vec2.MAX_VALUE(),this.DC=new WindowTempData,this.ClipRect=new Rect,this.OuterRectClipped=new Rect,this.InnerMainRect=new Rect,this.InnerClipRect=new Rect,this.ContentsRegionRect=new Rect,this.LastFrameActive=-1,this.ItemWidthDefault=0,this.MenuColumns=new MenuColumns,this.StateStorage=new Storage,this.ColumnsStorage=new ArrayEx,this.FontWindowScale=1,this.SettingsIdx=-1,this.DrawList=new DrawList(imgui,this.Name),this.ParentWindow=null,this.RootWindow=null,this.RootWindowForTitleBarHighlight=null,this.RootWindowForNav=null,this.NavLastChildNavWindow=null,this.NavLastIds=new ArrayEx,this.NavLastIds[0]=this.NavLastIds[1]=0,this.NavRectRel=new ArrayEx,this.NavRectRel[0]=new Rect,this.NavRectRel[1]=new Rect,this.ZIndex=0}destructor(){for(let i=0;i!=this.ColumnsStorage.length;i++)this.ColumnsStorage[i]=null;this.ColumnsStorage.resize(0)}PushID(id){this.IDStack.push(this.GetIDNoKeepAlive(id))}PopID(){this.IDStack.pop()}GetID(id){id=GetHash(id,this.IDStack.back());return this.imgui.keepAliveID(id),id}GetIDNoKeepAlive(str){return GetHash(str,this.IDStack.back())}GetIDFromRectangle(r_abs){var id=this.IDStack.back(),id=HashData([Math.floor(r_abs.Min.x-this.Pos.x),Math.floor(r_abs.Min.y-this.Pos.y),Math.floor(r_abs.Max.x-this.Pos.x),Math.floor(r_abs.Max.y-this.Pos.y)],id);return this.imgui.keepAliveID(id),id}IsActiveAndVisible(){return this.Active&&!this.Hidden}Rect(){return Rect.FromXY(this.Pos.x,this.Pos.y,this.Pos.x+this.Size.x,this.Pos.y+this.Size.y)}MakeCurrent(){this.Font?this.imgui.SetFont(this.Font):this.imgui.SetFont(this.imgui.GetFont(null,this.FontWindowScale))}Render(layer){this.DrawList.Render(layer)}CalcLineHeight(){return this.imgui.GetLineHeight()*this.FontWindowScale}TitleBarHeight(){return this.Flags&WindowFlags.NoTitleBar?0:this.CalcLineHeight()+2*this.imgui.guictx.Style.FramePadding.y}TitleBarRect(){return Rect.FromXY(this.Pos.x,this.Pos.y,this.Pos.x+this.SizeFull.x,this.Pos.y+this.TitleBarHeight())}MenuBarHeight(){return this.Flags&WindowFlags.MenuBar?this.DC.MenuBarOffset.y+this.CalcLineHeight()+2*this.imgui.guictx.Style.FramePadding.y:0}MenuBarRect(){var y1=this.Pos.y+this.TitleBarHeight(),y2=y1+this.MenuBarHeight();return Rect.FromXY(this.Pos.x,y1,this.Pos.x+this.SizeFull.x,y2)}UpdateWindowParentAndRootLinks(flags,parent){for(this.ParentWindow=parent,this.RootWindow=this.RootWindowForTitleBarHighlight=this.RootWindowForNav=this,parent&&flags&WindowFlags.ChildWindow&&!(flags&WindowFlags.Tooltip)&&(this.RootWindow=parent.RootWindow),parent&&!(flags&WindowFlags.Modal)&&flags&(WindowFlags.ChildWindow|WindowFlags.Popup)&&(this.RootWindowForTitleBarHighlight=parent.RootWindowForTitleBarHighlight);this.RootWindowForNav.Flags&WindowFlags.NavFlattened;)console.assert(this.RootWindowForNav.ParentWindow),this.RootWindowForNav=this.RootWindowForNav.ParentWindow}getResizeBorderRect(border_n,perp_padding,thickness){let rect=this.Rect();return 0==thickness&&rect.Max.SubtractXY(1,1),0==border_n?new Rect(rect.Min.x+perp_padding,rect.Min.y-thickness,rect.Max.x-perp_padding,rect.Min.y+thickness):1==border_n?new Rect(rect.Max.x-thickness,rect.Min.y+perp_padding,rect.Max.x+thickness,rect.Max.y-perp_padding):2==border_n?new Rect(rect.Min.x+perp_padding,rect.Max.y-thickness,rect.Max.x-perp_padding,rect.Max.y+thickness):3==border_n?new Rect(rect.Min.x-thickness,rect.Min.y+perp_padding,rect.Min.x+thickness,rect.Max.y-perp_padding):(console.assert(0),new Rect)}SetWindowPos(pos,old_pos){old_pos&&0==(this.SetWindowPosAllowFlags&old_pos)||(this.SetWindowPosAllowFlags&=~(CondFlags.Once|CondFlags.FirstUseEver|CondFlags.Appearing),this.SetWindowPosVal=new Vec2(Number.MAX_VALUE,Number.MAX_VALUE),old_pos=this.Pos,this.Pos=Vec2.Floor(pos),this.DC.CursorPos.Add(Vec2.Subtract(this.Pos,old_pos)),this.DC.CursorMaxPos.Add(Vec2.Subtract(this.Pos,old_pos)))}SetWindowSize(size,cond){cond&&0==(this.SetWindowSizeAllowFlags&cond)||(this.SetWindowSizeAllowFlags&=~(CondFlags.Once|CondFlags.FirstUseEver|CondFlags.Appearing),0<size.x?(this.AutoFitFramesX=0,this.SizeFull.x=Math.floor(size.x)):(this.AutoFitFramesX=2,this.AutoFitOnlyGrows=!1),0<size.y?(this.AutoFitFramesY=0,this.SizeFull.y=Math.floor(size.y)):(this.AutoFitFramesY=2,this.AutoFitOnlyGrows=!1))}SetWindowCollapsed(collapsed,cond){cond&&0==(this.SetWindowCollapsedAllowFlags&cond)||(this.SetWindowCollapsedAllowFlags&=~(CondFlags.Once|CondFlags.FirstUseEver|CondFlags.Appearing),this.Collapsed=collapsed)}SetScrollX(x){this.ScrollTarget.x=x,this.ScrollTargetCenterRatio.x=0}SetScrollY(y){this.ScrollTarget.y=y+this.TitleBarHeight()+this.MenuBarHeight(),this.ScrollTargetCenterRatio.y=0}SetWindowScrollX(x){this.DC.CursorMaxPos.x+=this.Scroll.x,this.Scroll.x=x,this.DC.CursorMaxPos.x-=this.Scroll.x}SetWindowScrollY(y){this.DC.CursorMaxPos.y+=this.Scroll.y,this.Scroll.y=y,this.DC.CursorMaxPos.y-=this.Scroll.y}GetScrollMaxX(){return Math.max(0,this.SizeContents.x-(this.SizeFull.x-this.ScrollbarSizes.x))}GetScrollMaxY(){return Math.max(0,this.SizeContents.y-(this.SizeFull.y-this.ScrollbarSizes.y))}CalcSizeContents(){if(this.Collapsed&&this.AutoFitFramesX<=0&&this.AutoFitFramesY<=0)return this.SizeContents;if(this.Hidden&&0==this.HiddenFramesCannotSkipItems&&0<this.HiddenFramesCanSkipItems)return this.SizeContents;let sz=new Vec2;return sz.x=Math.floor(0!=this.SizeContentsExplicit.x?this.SizeContentsExplicit.x:this.DC.CursorMaxPos.x-this.Pos.x+this.Scroll.x),sz.y=Math.floor(0!=this.SizeContentsExplicit.y?this.SizeContentsExplicit.y:this.DC.CursorMaxPos.y-this.Pos.y+this.Scroll.y),sz.y,Vec2.Add(sz,this.WindowPadding)}CalcSizeAutoFit(size_contents){var sz3=this.imgui.guictx,style=sz3.Style;if(this.Flags&WindowFlags.Tooltip)return size_contents;{var is_popup=0!=(this.Flags&WindowFlags.Popup),is_menu=0!=(this.Flags&WindowFlags.ChildMenu);let size_min=style.WindowMinSize;(is_popup||is_menu)&&(size_min=Vec2.Min(size_min,new Vec2(4,4)));sz3=Vec2.Max(size_min,Vec2.Subtract(sz3.IO.DisplaySize,Vec2.Mult(style.DisplaySafeAreaPadding,2)));let size_auto_fit=Vec2.Clamp(size_contents,size_min,sz3);sz3=this.CalcSizeAfterConstraint(size_auto_fit);return sz3.x<size_contents.x&&!(this.Flags&WindowFlags.NoScrollbar)&&this.Flags&WindowFlags.HorizontalScrollbar&&(size_auto_fit.y+=style.ScrollbarSize),sz3.y<size_contents.y&&!(this.Flags&WindowFlags.NoScrollbar)&&(size_auto_fit.x+=style.ScrollbarSize),size_auto_fit}}CalcSizeAfterConstraint(new_size){let g=this.imgui.guictx;if(0!=g.NextWindowData.SizeConstraintCond){var cr=g.NextWindowData.SizeConstraintRect;if(new_size.x=0<=cr.Min.x&&0<=cr.Max.x?Vec1.Clamp(new_size.x,cr.Min.x,cr.Max.x):this.SizeFull.x,new_size.y=0<=cr.Min.y&&0<=cr.Max.y?Vec1.Clamp(new_size.y,cr.Min.y,cr.Max.y):this.SizeFull.y,g.NextWindowData.SizeCallback){let data={};data.UserData=g.NextWindowData.SizeCallbackUserData,data.Pos=this.Pos,data.CurrentSize=this.SizeFull.Clone(),data.DesiredSize=new_size.Clone(),g.NextWindowData.SizeCallback(data),new_size=data.DesiredSize}}return this.Flags&(WindowFlags.ChildWindow|WindowFlags.AlwaysAutoResize)||((new_size=Vec2.Max(new_size,g.Style.WindowMinSize)).y=Math.max(new_size.y,this.TitleBarHeight()+this.MenuBarHeight()+Math.max(0,g.Style.WindowRounding-1))),new_size}getBgColor(flag,alpha){let key;return key=flag&(WindowFlags.Tooltip|WindowFlags.Popup)?"PopupBg":flag&WindowFlags.ChildWindow?"ChildBg":"WindowBg",this.imgui.GetStyleColor(key,alpha)}CalcNextScrollFromScrollTargetAndClamp(snap_on_edges){let scroll=this.Scroll;var g=this.imgui.guictx;if(this.ScrollTarget.x<Number.MAX_VALUE&&(cr_y=this.ScrollTargetCenterRatio.x,scroll.x=this.ScrollTarget.x-cr_y*(this.SizeFull.x-this.ScrollbarSizes.x)),this.ScrollTarget.y<Number.MAX_VALUE){var cr_y=this.ScrollTargetCenterRatio.y;let target_y=this.ScrollTarget.y;snap_on_edges&&cr_y<=0&&target_y<=this.WindowPadding.y&&(target_y=0),snap_on_edges&&1<=cr_y&&target_y>=this.SizeContents.y-this.WindowPadding.y+g.Style.ItemSpacing.y&&(target_y=this.SizeContents.y),scroll.y=target_y-(1-cr_y)*(this.TitleBarHeight()+this.MenuBarHeight())-cr_y*(this.SizeFull.y-this.ScrollbarSizes.y)}scroll=Vec2.Max(scroll,Vec2.Zero()),this.Collapsed||this.SkipItems||(scroll.x=Math.min(scroll.x,this.GetScrollMaxX()),scroll.y=Math.min(scroll.y,this.GetScrollMaxY())),this.Scroll=scroll,this.ScrollTarget=new Vec2(Number.MAX_VALUE,Number.MAX_VALUE)}ClampWindowRect(rect,padding){var g=this.imgui.guictx;let sz;sz=!g.IO.ConfigWindowsMoveFromTitleBarOnly||this.Flags&WindowFlags.NoTitleBar?this.Size:new Vec2(this.Size.x,this.TitleBarHeight()),this.Pos=Vec2.Min(Vec2.Subtract(rect.Max,padding),Vec2.Subtract(Vec2.Max(Vec2.Add(this.Pos,sz),Vec2.Add(rect.Min,padding)),sz))}calcResizePosSizeFromAnyCorner(size_expected,corner_norm,out_pos,out_size){var pos_min=Vec2.Lerp(size_expected,this.Pos,corner_norm),size_constrained=Vec2.Lerp(Vec2.Add(this.Pos,this.Size),size_expected,corner_norm),size_expected=Vec2.Subtract(size_constrained,pos_min),size_constrained=this.CalcSizeAfterConstraint(size_expected);out_pos.Copy(pos_min),0==corner_norm.x&&(out_pos.x-=size_constrained.x-size_expected.x),0==corner_norm.y&&(out_pos.y-=size_constrained.y-size_expected.y),out_size.Copy(size_constrained)}UpdateManualResize(autofit,borderheld,resize_grip_count,resize_grip_col){let imgui=this.imgui,g=this.imgui.guictx;var grip_draw_size=this.Flags;if(!(grip_draw_size&WindowFlags.NoResize||grip_draw_size&WindowFlags.AlwaysAutoResize||0<this.AutoFitFramesX||0<this.AutoFitFramesY)&&0!=this.WasActive){var resize_border_count=g.IO.ConfigWindowsResizeFromEdges?4:0,grip_draw_size=Math.floor(Math.max(1.35*g.FontSize,this.WindowRounding+1+.2*g.FontSize)),grip_hover_innersize=Math.floor(.75*grip_draw_size),grip_hover_outersize=g.IO.ConfigWindowsResizeFromEdges?WindowResizeFromEdge:0;let hovered=new ValRef,held=new ValRef,pos_target=Vec2.MAX_VALUE().Clone(),size_target=Vec2.MAX_VALUE().Clone();this.PushID("#RESIZE");for(let resize_grip_n=0;resize_grip_n<resize_grip_count;resize_grip_n++){var col=ResizeGripDefs[resize_grip_n],tmp=Vec2.Lerp(this.Pos,Vec2.Add(this.Pos,this.Size),col.CornerPosN);let resize_rect=new Rect(Vec2.Subtract(tmp,Vec2.Mult(col.InnerDir,grip_hover_outersize)),Vec2.Add(tmp,Vec2.Mult(col.InnerDir,grip_hover_innersize)));if(resize_rect.Min.x>resize_rect.Max.x&&(tmp=resize_rect.Min.x,resize_rect.Min.x=resize_rect.Max.x,resize_rect.Max.x=tmp),resize_rect.Min.y>resize_rect.Max.y){let tmp=resize_rect.Min.y;resize_rect.Min.y=resize_rect.Max.y,resize_rect.Max.y=tmp}if(imgui.ButtonBehavior(resize_rect,this.GetID(resize_grip_n),hovered,held,ButtonFlags.FlattenChildren|ButtonFlags.NoNavFocus),(hovered.get()||held.get())&&(g.MouseCursor=1&resize_grip_n?MouseCursor.ResizeNESW:MouseCursor.ResizeNWSE),held.get()&&g.IO.MouseDoubleClicked[0]&&0==resize_grip_n)size_target=this.CalcSizeAfterConstraint(autofit),imgui.clearActiveID();else if(held.get()){let corner_target=Vec2.Subtract(g.IO.MousePos,g.ActiveIdClickOffset);corner_target.Add(Vec2.Lerp(Vec2.Mult(col.InnerDir,grip_hover_outersize),Vec2.Mult(col.InnerDir,-grip_hover_outersize),col.CornerPosN)),this.calcResizePosSizeFromAnyCorner(corner_target,col.CornerPosN,pos_target,size_target)}(0==resize_grip_n||held.get()||hovered.get())&&(col=g.Style.GetColor(held.get()?"ResizeGripActive":hovered.get()?"ResizeGripHovered":"ResizeGrip"),resize_grip_col[resize_grip_n]=col)}for(let border_n=0;border_n<resize_border_count;border_n++){var border_rect=this.getResizeBorderRect(border_n,grip_hover_innersize,WindowResizeFromEdge);if(imgui.ButtonBehavior(border_rect,this.GetID(border_n+4),hovered,held,ButtonFlags.FlattenChildren),(hovered.get()&&g.HoveredIdTimer>WindowResizeFromEdgeTimer||held.get())&&(g.MouseCursor=1&border_n?MouseCursor.ResizeEW:MouseCursor.ResizeNS,held.get()&&borderheld.set(border_n)),held.get()){let border_target=this.Pos.Clone(),border_posn=new Vec2;0==border_n&&(border_posn=Vec2.Zero(),border_target.y=g.IO.MousePos.y-g.ActiveIdClickOffset.y+WindowResizeFromEdge),1==border_n&&(border_posn=new Vec2(1,0),border_target.x=g.IO.MousePos.x-g.ActiveIdClickOffset.x+WindowResizeFromEdge),2==border_n&&(border_posn=new Vec2(0,1),border_target.y=g.IO.MousePos.y-g.ActiveIdClickOffset.y+WindowResizeFromEdge),3==border_n&&(border_posn=Vec2.Zero(),border_target.x=g.IO.MousePos.x-g.ActiveIdClickOffset.x+WindowResizeFromEdge),this.calcResizePosSizeFromAnyCorner(border_target,border_posn,pos_target,size_target)}}if(imgui.PopID(),g.NavWindowingTarget&&g.NavWindowingTarget.RootWindow==this){let nav_resize_delta;g.NavInputSource==InputSource.NavKeyboard&&g.IO.KeyShift&&(nav_resize_delta=imgui.getNavInputAmount2d(NavDirSourceFlags.Keyboard,InputReadMode.Down)),g.NavInputSource==InputSource.NavGamepad&&(nav_resize_delta=imgui.getNavInputAmount2d(NavDirSourceFlags.PadDPad,InputReadMode.Down)),!nav_resize_delta||0==nav_resize_delta.x&&0==nav_resize_delta.y||(nav_resize_delta.Mult(Math.floor(600*g.IO.DeltaTime*Math.min(g.IO.DisplayFramebufferScale.x,g.IO.DisplayFramebufferScale.y))),g.NavWindowingToggleLayer=!1,g.NavDisableMouseHover=!0,resize_grip_col[0]=g.Style.GetColor("ResizeGripActive"),size_target=this.CalcSizeAfterConstraint(Vec2.Add(this.SizeFull,nav_resize_delta)))}size_target.x!=Number.MAX_VALUE&&(this.SizeFull=size_target,imgui.MarkIniSettingsDirty(this)),pos_target.x!=Number.MAX_VALUE&&(this.Pos=pos_target.Floor(),imgui.MarkIniSettingsDirty(this)),this.Size=this.SizeFull}}SetWindowConditionAllowFlags(flags,enabled){enabled?(this.SetWindowPosAllowFlags=this.SetWindowPosAllowFlags|flags,this.SetWindowSizeAllowFlags=this.SetWindowSizeAllowFlags|flags,this.SetWindowCollapsedAllowFlags=this.SetWindowCollapsedAllowFlags|flags):(this.SetWindowPosAllowFlags=this.SetWindowPosAllowFlags&~flags,this.SetWindowSizeAllowFlags=this.SetWindowSizeAllowFlags&~flags,this.SetWindowCollapsedAllowFlags=this.SetWindowCollapsedAllowFlags&~flags)}RenderOuterBorders(){let imgui=this.imgui;var g=this.imgui.guictx,rounding=this.WindowRounding,border_size=this.WindowBorderSize;0<border_size&&!(this.Flags&WindowFlags.NoBackground)&&this.DrawList.AddRect(this.Pos,Vec2.Add(this.Pos,this.Size),imgui.GetStyleColor("Border"),rounding,CornerFlags.All,border_size);var half,border_r,y,p0=this.ResizeBorderHeld;-1!=p0&&(half=new Vec2(.5,.5),y=s_resizeBorderDefs[p0],border_r=this.getResizeBorderRect(p0,rounding,0),p0=Vec2.Lerp(border_r.Min,border_r.Max,y.CornerPosN1),this.DrawList.PathArcTo(Vec2.Add(Vec2.Add(p0,half),Vec2.Mult(y.InnerDir,rounding)),rounding,y.OuterAngle-.25*Math.PI,y.OuterAngle),p0=Vec2.Lerp(border_r.Min,border_r.Max,y.CornerPosN2),this.DrawList.PathArcTo(Vec2.Add(Vec2.Add(p0,half),Vec2.Mult(y.InnerDir,rounding)),rounding,y.OuterAngle,y.OuterAngle+.25*Math.PI),this.DrawList.PathStroke(imgui.GetStyleColor("SeparatorActive"),!1,Math.max(2,border_size))),0<g.Style.FrameBorderSize&&!(this.Flags&WindowFlags.NoTitleBar)&&(y=this.Pos.y+this.TitleBarHeight()-1,this.DrawList.AddLine(new Vec2(this.Pos.x+border_size,y),new Vec2(this.Pos.x+this.Size.x-border_size,y),imgui.GetStyleColor("Border"),g.Style.FrameBorderSize))}RenderResizeGrips(resize_grip_col,resize_grip_count,grip_draw_size,window_border_size,window_rounding){for(let resize_grip_n=0;resize_grip_n<resize_grip_count;resize_grip_n++){var grip,corner,offset,col=resize_grip_col[resize_grip_n];null!=col&&(grip=ResizeGripDefs[resize_grip_n],corner=Vec2.Lerp(this.Pos,Vec2.Add(this.Pos,this.Size),grip.CornerPosN),offset=1&resize_grip_n?new Vec2(window_border_size,grip_draw_size):new Vec2(grip_draw_size,window_border_size),this.DrawList.PathLineTo(Vec2.Add(corner,Vec2.Mult(offset,grip.InnerDir))),offset=1&resize_grip_n?new Vec2(grip_draw_size,window_border_size):new Vec2(window_border_size,grip_draw_size),this.DrawList.PathLineTo(Vec2.Add(corner,Vec2.Mult(offset,grip.InnerDir))),this.DrawList.PathArcToFast(new Vec2(corner.x+grip.InnerDir.x*(window_rounding+window_border_size),corner.y+grip.InnerDir.y*(window_rounding+window_border_size)),window_rounding,grip.AngleMin12,grip.AngleMax12),this.DrawList.PathFillConvex(col))}}}class NextWindowData{constructor(){this.Clear(),this.PosVal=new Vec2(0,0),this.PosPivotVal=new Vec2(0,0),this.SizeVal=new Vec2(0,0),this.ContentSizeVal=new Vec2(0,0),this.CollapsedVal=!1,this.SizeConstraintRect=new Rect,this.SizeCallback=null,this.SizeCallbackUserData=null,this.BgAlphaVal=Number.MAX_VALUE,this.ZIndex=0,this.MenuBarOffsetMinVal=new Vec2(0,0)}Clear(){this.PosCond=CondFlags.None,this.SizeCond=CondFlags.None,this.ContentSizeCond=CondFlags.None,this.CollapsedCond=CondFlags.None,this.SizeConstraintCond=CondFlags.None,this.FocusCond=CondFlags.None,this.BgAlphaCond=CondFlags.None,this.ZIndexCond=CondFlags.None}}class WindowGroupData{constructor(win,guictx){this.BackupCursorPos=win.DC.CursorPos.Clone(),this.BackupCursorMaxPos=win.DC.CursorMaxPos.Clone(),this.BackupIndent=win.DC.Indent.Clone(),this.BackupGroupOffset=win.DC.GroupOffset.Clone(),this.BackupCurrentLineHeight=win.DC.CurrentLineHeight,this.BackupCurrentLineHeightMax=win.DC.CurrentLineHeightMax,this.BackupCurrentLineTextBaseOffset=win.DC.CurrentLineTextBaseOffset,this.BackupActiveIdIsAlive=guictx.ActiveIdIsAlive,this.BackupActiveIdPreviousFrameIsAlive=guictx.ActiveIdPreviousFrameIsAlive,this.AdvanceCursor=!0}}class WindowTempData{constructor(){var DC=this;DC.CursorPos=new Vec2(0,0),DC.CursorPosPrevLine=new Vec2(0,0),DC.CursorStartPos=new Vec2(0,0),DC.CursorMaxPos=new Vec2(0,0),DC.CurrentLineHeight=0,DC.CurrentLineHeightMax=0,DC.PrevLineHeight=0,DC.PrevLineHeightMax=0,DC.CurrentLineTextBaseOffset=0,DC.PrevLineTextBaseOffset=0,DC.TreeDepth=0,DC.TreeDepthMayJumpToParentOnPop=0,DC.LastItemId=0,DC.LastItemStatusFlags=0,DC.LastItemRect=new Rect,DC.LastItemDisplayRect=new Rect,DC.NavLayerCurrent=NavLayer.Main,DC.NavLayerCurrentMask=1<<NavLayer.Main,DC.NavLayerActiveMask=0,DC.NavLayerActiveMaskNext=0,DC.NavHideHighlightOneFrame=!1,DC.NavHasScroll=!1,DC.MenuBarAppending=!1,DC.MenuBarOffset=new Vec2(0,0),DC.ChildWindows=new ArrayEx,DC.StateStorage=null,DC.LayoutType=LayoutType.Vertical,DC.ParentLayoutType=LayoutType.Vertical,DC.FocusCounterAll=-1,DC.FocusCounterTab=-1,DC.ItemFlags=ItemFlags.Default,DC.ItemWidth=0,DC.NextItemWidth=Number.MAX_VALUE,DC.TextWrapPos=-1,DC.ItemFlagsStack=new ArrayEx,DC.ItemWidthStack=new ArrayEx,DC.TextWrapPosStack=new ArrayEx,DC.GroupStack=new ArrayEx,DC.StackSizesBackup={},DC.Indent=new Vec1(0),DC.GroupOffset=new Vec1(0),DC.ColumnsOffset=new Vec1(0),DC.CurrentColumns=null}}i=0;var DataType={S8:i++,U8:i++,S16:i++,U16:i++,S32:i++,U32:i++,S64:i++,U64:i++,Float:i++,Double:i++,Count:i};const GDataTypeInfo=[[1,"%d",[-128,127]],[1,"%u",[0,255]],[2,"%d",[-32768,32767]],[2,"%u",[0,65535]],[4,"%d",[-2147483648,2147483647]],[4,"%u",[0,4294967295]],[8,"%lld",[-Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER]],[8,"%llu",[0,0x10000000000000000]],[4,"%f",[.5*-Number.MAX_VALUE,.5*Number.Max_VALUE]],[8,"%f",[.5*-Number.MAX_VALUE,.5*Number.Max_VALUE]]],KnownFormats=/%d|%[0-9]d|%e|%[fg]|%.[0-9][fg]|%[0-9].[0-9][fg]|%s/g;function FormatValues(format,args){let i=0;return format.replace(KnownFormats,function(match,capture){let arg=args[i++];switch(match){case"%d":return"boolean"==typeof arg?arg?"1":"0":"number"==typeof arg?arg.toFixed():arg.toString();case"%f":case"%g":return arg.toString();case"%e":return arg.toExponential();case"%s":return arg;default:if("d"==match[2]){var p=Number(match[1]);return("     "+arg.toString()).slice(-p)}if("."==match[1]){let p=format[capture+2];return arg.toFixed(p)}if("."!=match[2])return match;{let w=match[1],p=match[3];return 0==w&&(w=10),("          "+arg.toFixed(p)).slice(-w)}}})}function FormatValue(v,format,precision=0){var i=format.indexOf("%");let j,digits;if(-1!=i)for(j=0;j<format.length;j++)switch(format[j]){case"f":precision=Number(format[j-1]);break;case"d":digits=j==i+1?0:Number(format[j-1]),precision=0}let vstr;return vstr="number"!=typeof v?(console.assert(0,typeof v,v),v):v.toFixed(precision),digits&&(vstr=("000"+vstr).slice(-digits)),j?format.slice(0,i)+vstr+format.slice(j+1):vstr}function DataTypeFormatString(val,data_type,format){return FormatValue(val,format=null==format?GDataTypeInfo[data_type][1]:format)}function addClampOverflow(v1,x,minmax){x=Number(v1)+Number(x);return x<minmax[0]?minmax[0]:x>minmax[1]?minmax[1]:x}function subClampOverflow(v1,x,minmax){x=Number(v1)-Number(x);return x<minmax[0]?minmax[0]:x>minmax[1]?minmax[1]:x}function DataTypeApplyOp(minmax,op,arg1,arg2){console.assert("+"==op|"-"==op);minmax=GDataTypeInfo[minmax][2];return("+"==op?addClampOverflow:subClampOverflow)(arg1,arg2,minmax)}function DataTypeApplyOpFromText(buf,buforig,data_type,format,onChange=null){let result;try{if(result=-1!="*/+".indexOf(buf[0])?eval(buforig+buf):Number(buf),result!=buforig)return onChange&&onChange(result),!0}catch(err){}return!1}const MinStep=[1,.1,.01,.001,1e-4,1e-5,1e-6,1e-7,1e-8,1e-9];function GetMinStepAtFloatPrecision(precision){return precision<0?Number.MIN_VALUE:precision<MinStep.length?MinStep[precision]:Math.pow(10,-precision)}function RoundScalarToPrecision(val,scale){if(0==scale)return Math.round(val);scale=Math.pow(10,scale);return Math.round(scale*val)/scale}function ParseFormatPrecision(fmt){var i;switch("%"==fmt[0]||-1!=(i=fmt.indexOf("%"))&&(fmt=fmt.slice(i)),fmt){case"%d":case"%.0f":return 0;case"%.1f":return 1;case"%.2f":return 2;case"%.3f":default:return 3}}const StandardCharCodes=Array.from({length:512},(x,i)=>i);class Font{constructor(canvctx,metrics,str){this.Metrics=metrics,this.Family=metrics.fontFamily,this.Size=metrics.fontSize,this.Weight=metrics.fontWeight,this.Ascent=this.Metrics.ascent,this.Baseline=this.Metrics.baseline,this.Descent=this.Metrics.descent,this.str=str,this.measuring=0,this.ctx=canvctx,this.ijmap=FontIJMap[this.Family]}IsLoaded(){return!0}CalcTextSizeA(max_width,wrap_width,text,lineHeight){var sz=Vec2.Zero();return this.MeasureText(text,wrap_width,lineHeight,sz),sz}MeasureBegin(){0==this.measuring&&(this.ctx.save(),this.ctx.font=this.AsStr()),this.measuring++}MeasureWidth(w){0==this.measuring&&(this.ctx.save(),this.ctx.font=this.AsStr());w=this.ctx.measureText(w).width;return 0==this.measuring&&this.ctx.restore(),w}MeasureEnd(){this.measuring--,0==this.measuring&&this.ctx.restore(),this.measuring<0&&console.assert(0,"measure block botch")}MeasureText(text,wrapWidth,lineHeight,sz){let lines=[];if(text=text||"",0==this.measuring&&(this.ctx.save(),this.ctx.font=this.AsStr()),wrapWidth<=0){lines=text.split("\n");for(let l of lines)sz.x=Math.max(sz.x,this.ctx.measureText(l).width);sz.y=lines.length*lineHeight}else{for(var line of text.split("\n")){let currentLine="";for(var word of line.split(/ +/)){var potentialLine=currentLine.length?currentLine+" "+word:word,width=this.ctx.measureText(potentialLine).width;if(width<wrapWidth)currentLine=potentialLine,sz.x=Math.max(sz.x,width);else{let wrap_word=!0;if(5<=word.length){for(var l=0,r=word.length,m=0;l<=r;){var m=parseInt((l+r)/2),subword=word.substring(0,m)+"-";let potentialLine=currentLine.length?currentLine+" "+subword:subword,width=Math.ceil(this.ctx.measureText(potentialLine).width);if(width<wrapWidth)m=l=m+1;else{if(!(width>wrapWidth))break;m=r=m-1}}if(2<=m){let subword=word.substring(0,m)+"-",potentialLine=currentLine.length?currentLine+" "+subword:subword;lines.push(potentialLine),currentLine=word.substring(m),wrap_word=!1}}wrap_word&&(lines.push(currentLine),currentLine=word)}}lines.push(currentLine)}sz.y=lines.length*lineHeight}return 0==this.measuring&&this.ctx.restore(),lines}RenderChar(draw_list,size,pos,col,c){console.assert(0,"RenderChar")}RenderText(draw_list,size,pos,col,clip_rect,text,wrapwidth=0){console.assert(0,"RenderText")}AsStr(){return this.str}GetKnownCodes(){return this.ijmap?this.ijmap.knownCodes:StandardCharCodes}GetCodeName(code){return this.ijmap?this.ijmap.icons[code.toString(16)].name:null}GetCodeFor(name){return this.ijmap?this.ijmap.namesToCode[name]:null}GetCharFor(name){return this.ijmap?String.fromCharCode(this.ijmap.namesToCode[name]):null}}class FontAtlas{constructor(imgui){this.Locked=!1,this.Flags=0,this.canvasCtx=imgui.canvas.getContext("2d"),this.fontsInUse={},this.fontMetrics=new FontMetrics,this.defaultFontFamily="Verdana",this.defaultFontSize=12,this.defaultFontWeight="normal",this.defaultFontStyle="normal",this.availableFonts=["Material Icons","Arial","Arial Black","Arial Narrow","Exo","Gill Sans","Helvetica","Impact","Verdana","Noto Sans","Open Sans","Optima","Roboto","Trebuchet MS","American Typewriter","Bookman","Didot","Georgia","New Century Schoolbook","Palatino","Times","Times New Roman","Ultra","Andale Mono","Courier New","Courier","FreeMono","Lucida Console","Roboto Mono","SourceCodePro","Comic Sans MS"]}fontToStr(family,size,weight,style){return`${style} ${weight} ${size}px ${family}`}FontLoaded(family,size=null,weight=null,str=null){family&&"default"!=family||(family=this.defaultFontFamily),size=size||this.defaultFontSize,weight=weight||this.defaultFontWeight,str=str||this.defaultFontStyle;str=this.fontToStr(family,size,weight,str);return this.fontsInUse[str]}EnumerateFonts(){return this.availableFonts}GetFont(family,size=null,weight=null,style=null){family&&"default"!=family||(family=this.defaultFontFamily),size=size||this.defaultFontSize,weight=weight||this.defaultFontWeight,style=style||this.defaultFontStyle;let f=this.FontLoaded(family,size,weight,style);if(null==f){let str=this.fontToStr(family,size,weight,style);var metrics=-1!=str.indexOf("Icon"),metrics=this.fontMetrics.MeasureFont(family,size,weight,style,metrics);f=new Font(this.canvasCtx,metrics,str),this.fontsInUse[str]=f}return f}Size(){return Object.keys(this.fontsInUse).length}ClearFonts(){this.fontsInUse={}}Clear(){}}let _i=0;var RenderIcons={None:_i++,Square:_i++,Stop:_i++,Play:_i++,Pause:_i++,RightArrow:_i++,LeftArrow:_i++,UpArrow:_i++,DownArrow:_i++},ImguiRenderMixin={renderText(pos,text,hide_text_after_hash=!0){let g=this.guictx,window=g.CurrentWindow;hide_text_after_hash&&(text=text.split("##")[0]),window.DrawList.AddText(text,pos,g.Font,g.FontLineHeight,g.Style.GetColor("Text")),g.LogEnabled&&this.logRenderedText(pos,text)},renderTextWrapped(pos,text,wrap_width){let g=this.guictx,window=g.CurrentWindow;window.DrawList.AddText(text,pos,g.Font,g.FontLineHeight,g.Style.GetColor("Text"),wrap_width),g.LogEnabled&&this.logRenderedText(pos,text)},renderTextClipped(posMin,posMax,text,text_size_if_known=null,align=null,clipRect=null){var window=this.guictx.CurrentWindow;this.renderTextClippedEx(window.DrawList,posMin,posMax,text,text_size_if_known,align,clipRect)},renderTextClippedEx(draw_list,fine_clip_rect,pos_max,text,clip_min=null,align=null,clip_rect=null){let g=this.guictx,pos=fine_clip_rect;var text_size=clip_min||this.CalcTextSize(text,!1,0),clip_min=clip_rect?clip_rect.Min:fine_clip_rect,fine_clip_rect=clip_rect?clip_rect.Max:pos_max;let need_clipping=pos.x+text_size.x>=fine_clip_rect.x||pos.y+text_size.y>=fine_clip_rect.y;clip_rect&&(need_clipping|=pos.x<clip_min.x||pos.y<clip_min.y),align&&(0<align.x&&(pos.x=Math.max(pos.x,pos.x+(pos_max.x-pos.x-text_size.x)*align.x)),0<align.y&&(pos.y=Math.max(pos.y,pos.y+(pos_max.y-pos.y-text_size.y)*align.y))),need_clipping?(fine_clip_rect=Rect.FromXY(clip_min.x,clip_min.y,fine_clip_rect.x,fine_clip_rect.y),draw_list.AddText(text,pos,g.Font,g.FontLineHeight,g.Style.GetColor("Text"),0,fine_clip_rect)):draw_list.AddText(text,pos,g.Font,g.FontLineHeight,g.Style.GetColor("Text"),0,null)},renderFrame(p_min,p_max,fill_col,border=!0,rounding=0){let window=this.guictx.CurrentWindow;window.DrawList.AddRectFilled(p_min,p_max,fill_col,rounding),border&&this.renderFrameBorder(p_min,p_max,rounding)},renderFrameBorder(p_min,p_max,rounding,border_size=0){let g=this.guictx,window=g.CurrentWindow;border_size=0==border_size?g.Style.FrameBorderSize:border_size;0<border_size&&(window.DrawList.AddRect(Vec2.AddXY(p_min,1,1),Vec2.AddXY(p_max,1,1),g.Style.GetColor("BorderShadow"),rounding,CornerFlags.All,border_size),window.DrawList.AddRect(p_min,p_max,g.Style.GetColor("Border"),rounding,CornerFlags.All,border_size))},renderColorRectWithAlphaCheckerboard(p_min,p_max,fill_col,grid_step,grid_off,rounding,rounding_corners_flags=-1){let win=this.getCurrentWindow();const style=this.guictx.Style;let on=style.GetColor("CheckerOff"),off=style.GetColor("CheckerOn");if(0<fill_col.a&&(on=Color.Blend(on,fill_col),off=Color.Blend(off,fill_col)),on.Equals(off))win.DrawList.AddRectFilled(p_min,p_max,on,rounding,rounding_corners_flags);else{win.DrawList.AddRectFilled(p_min,p_max,off,rounding,rounding_corners_flags);let yi=0,p1=new Vec2,p2=new Vec2;for(let y=p_min.y+grid_off.y;y<p_max.y;y+=grid_step,yi++)if(p1.y=Vec1.Clamp(y,p_min.y,p_max.y),p2.y=Math.min(y+grid_step,p_max.y),!(p2.y<=p1.y))for(let x=p_min.x+grid_off.x+(1&yi)*grid_step;x<p_max.x;x+=2*grid_step)if(p1.x=Vec1.Clamp(x,p_min.x,p_max.x),p2.x=Math.min(x+grid_step,p_max.x),!(p2.x<=p1.x)){let rounding_corners_flags_cell=0;p1.y<=p_min.y&&(p1.x<=p_min.x&&(rounding_corners_flags_cell|=CornerFlags.TopLeft),p2.x>=p_max.x&&(rounding_corners_flags_cell|=CornerFlags.TopRight)),p2.y>=p_max.y&&(p1.x<=p_min.x&&(rounding_corners_flags_cell|=CornerFlags.BotLeft),p2.x>=p_max.x&&(rounding_corners_flags_cell|=CornerFlags.BotRight)),rounding_corners_flags_cell&=rounding_corners_flags,win.DrawList.AddRectFilled(p1,p2,on,rounding_corners_flags_cell?rounding:0,rounding_corners_flags_cell)}}},renderIcon(icon,p_min,scale=1){let g=this.guictx;switch(icon){case RenderIcons.Play:case RenderIcons.Arrow:case RenderIcons.RightArrow:this.renderArrow(p_min,Dir.Right,scale);break;case RenderIcons.LeftArrow:this.renderArrow(p_min,Dir.Left,scale);break;case RenderIcons.UpArrow:this.renderArrow(p_min,Dir.Up,scale);break;case RenderIcons.DownArrow:this.renderArrow(p_min,Dir.Down,scale);break;case RenderIcons.Stop:case RenderIcons.Square:var p0=g.FontSize,col=g.Style.GetColor("Text"),p1=.3*p0*scale,center=Vec2.AddXY(p_min,.5*p0,.5*p0*scale),p0=Vec2.AddXY(center,-p1,-p1),p1=Vec2.AddXY(center,p1,p1);g.CurrentWindow.DrawList.AddRectFilled(p0,p1,col,0);break;case RenderIcons.Pause:}},renderArrow(p_min,dir,center=1,disabled=!1){let g=this.guictx;var h=g.FontSize;let r=.4*h*center;center=Vec2.AddXY(p_min,.5*h,.5*h*center);let a,b,c;switch(dir){case Dir.Up:case Dir.Down:dir==Dir.Up&&(r=-r),a=new Vec2(0,.75*r),b=new Vec2(-.866*r,-.75*r),c=new Vec2(.866*r,-.75*r);break;case Dir.Left:case Dir.Right:dir==Dir.Left&&(r=-r),a=new Vec2(.75*r,0),b=new Vec2(-.75*r,.866*r),c=new Vec2(-.75*r,-.866*r);break;case Dir.None:case Dir.COUNT:console.assert(0)}g.CurrentWindow.DrawList.AddTriangleFilled(Vec2.Add(center,a),Vec2.Add(center,b),Vec2.Add(center,c),disabled?g.Style.GetColor("TextDisabled"):g.Style.GetColor("Text"))},renderBullet(pos){let g=this.guictx,window=g.CurrentWindow;window.DrawList.AddCircleFilled(pos,.2*g.FontSize,g.Style.GetColor("Text"),9)},renderCheckMark(pos,col,by){let window=this.guictx.CurrentWindow;var thickness=Math.max(by/5,1),third=(by-=.5*thickness)/3,bx=(pos=Vec2.AddXY(pos,.25*thickness,.25*thickness)).x+third,by=pos.y+by-.5*third;window.DrawList.PathLineTo(new Vec2(bx-third,by-third)),window.DrawList.PathLineTo(new Vec2(bx,by)),window.DrawList.PathLineTo(new Vec2(bx+2*third,by-2*third)),window.DrawList.PathStroke(col,!1,thickness)},renderNavHighlight(fully_visible,rounding,flags=NavHighlightFlags.TypeDefault){let g=this.guictx;if(rounding==g.NavId&&(!g.NavDisableHighlight||flags&NavHighlightFlags.AlwaysDraw)){let window=g.CurrentWindow;if(!window.DC.NavHideHighlightOneFrame){rounding=flags&NavHighlightFlags.NoRounding?0:g.Style.FrameRounding;let display_rect=fully_visible.Clone().ClipWith(window.ClipRect);flags&NavHighlightFlags.TypeDefault&&(display_rect.Expand(4),(fully_visible=window.ClipRect.Contains(display_rect))||window.DrawList.PushClipRect(display_rect.Min,display_rect.Max),window.DrawList.AddRect(Vec2.Add(display_rect.Min,1),Vec2.Subtract(display_rect.Max,1),g.Style.GetColor("NavHighlight"),rounding,CornerFlags.All,2),fully_visible||window.DrawList.PopClipRect()),flags&NavHighlightFlags.TypeThin&&window.DrawList.AddRect(display_rect.Min,display_rect.Max,this.Style.GetColor("NavHighlight"),rounding,-1,1)}}},logRenderedText(ref_pos,text){},renderArrowPointingAt(draw_list,pos,half_sz,direction,col){switch(direction){case Dir.Left:return void draw_list.AddTriangleFilled(new Vec2(pos.x+half_sz.x,pos.y-half_sz.y),new Vec2(pos.x+half_sz.x,pos.y+half_sz.y),pos,col);case Dir.Right:return void draw_list.AddTriangleFilled(new Vec2(pos.x-half_sz.x,pos.y+half_sz.y),new Vec2(pos.x-half_sz.x,pos.y-half_sz.y),pos,col);case Dir.Up:return void draw_list.AddTriangleFilled(new Vec2(pos.x+half_sz.x,pos.y+half_sz.y),new Vec2(pos.x-half_sz.x,pos.y+half_sz.y),pos,col);case Dir.Down:return void draw_list.AddTriangleFilled(new Vec2(pos.x-half_sz.x,pos.y-half_sz.y),new Vec2(pos.x+half_sz.x,pos.y-half_sz.y),pos,col);case Dir.None:case Dir.COUNT:}},renderRectFilledRangeH(draw_list,x1,col,arc1_b,x0,rounding){const half_pi=.5*Math.PI;function acos01(x){return x<=0?half_pi:1<=x?0:Math.acos(x)}var p0,p1,arc0_b,arc1_e;x0!=arc1_b&&(x0<arc1_b&&(arc0_b=x0,x0=arc1_b,arc1_b=arc0_b),p0=new Vec2(Vec1.Lerp(x1.Min.x,x1.Max.x,arc1_b),x1.Min.y),p1=new Vec2(Vec1.Lerp(x1.Min.x,x1.Max.x,x0),x1.Max.y),0!=rounding?(arc1_e=1/(rounding=Vec1.Clamp(Math.min(.5*(x1.Max.x-x1.Min.x),.5*(x1.Max.y-x1.Min.y))-1,0,rounding)),arc0_b=acos01(1-(p0.x-x1.Min.x)*arc1_e),arc1_b=acos01(1-(p1.x-x1.Min.x)*arc1_e),x0=Math.max(p0.x,x1.Min.x+rounding),arc0_b==arc1_b?(draw_list.PathLineTo(new Vec2(x0,p1.y)),draw_list.PathLineTo(new Vec2(x0,p0.y))):0==arc0_b&&arc1_b==half_pi?(draw_list.PathArcToFast(new Vec2(x0,p1.y-rounding),rounding,3,6),draw_list.PathArcToFast(new Vec2(x0,p0.y+rounding),rounding,6,9)):(draw_list.PathArcTo(new Vec2(x0,p1.y-rounding),rounding,Math.PI-arc1_b,Math.PI-arc0_b,3),draw_list.PathArcTo(new Vec2(x0,p0.y+rounding),rounding,Math.PI+arc0_b,Math.PI+arc1_b,3)),p1.x>x1.Min.x+rounding&&(arc1_b=acos01(1-(x1.Max.x-p1.x)*arc1_e),arc1_e=acos01(1-(x1.Max.x-p0.x)*arc1_e),x1=Math.min(p1.x,x1.Max.x-rounding),arc1_b==arc1_e?(draw_list.PathLineTo(new Vec2(x1,p0.y)),draw_list.PathLineTo(new Vec2(x1,p1.y))):0==arc1_b&&arc1_e==half_pi?(draw_list.PathArcToFast(new Vec2(x1,p0.y+rounding),rounding,9,12),draw_list.PathArcToFast(new Vec2(x1,p1.y-rounding),rounding,0,3)):(draw_list.PathArcTo(new Vec2(x1,p0.y+rounding),rounding,-arc1_e,-arc1_b,3),draw_list.PathArcTo(new Vec2(x1,p1.y-rounding),rounding,+arc1_b,+arc1_e,3))),draw_list.PathFillConvex(col)):draw_list.AddRectFilled(p0,p1,col,0))},renderPixelEllipsis(draw_list,pos,count,col){console.assert(0,"ellipsis")}},DragDropFlags={None:0,SourceNoPreviewTooltip:1,SourceNoDisableHover:2,SourceNoHoldToOpenOthers:4,SourceAllowNullID:8,SourceExtern:16,SourceAutoExpirePayload:32,AcceptBeforeDelivery:1024,AcceptNoDrawDefaultRect:2048,AcceptNoPreviewTooltip:4096};f=DragDropFlags,f.AcceptPeekOnly=f.AcceptBeforeDelivery|f.AcceptNoDrawDefaultRect;class Payload{constructor(){this.Clear()}IsDataType(typ){return-1!=this.DataFrameCount&&this.DataType===typ}IsPreview(){return this.Preview}IsDelivery(){return this.Delivery}Clear(){this.SourceId=0,this.SourceParentId=0,this.DataType="",this.Data=null,this.DataFrameCount=-1,this.Preview=!1,this.Delivery=!1}}var ImguiDragDropMixin={ClearDragDrop(){let g=this.guictx;g.DragDropActive=!1,g.DragDropPayload.Clear(),g.DragDropAcceptFlags=DragDropFlags.None,g.DragDropAcceptIdCurr=g.DragDropAcceptIdPrev=0,g.DragDropAcceptIdCurrRectSurface=Number.MAX_VALUE,g.DragDropAcceptFrameCount=-1},BeginDragDropSource(flags=0){let g=this.guictx,win=g.CurrentWindow,source_drag_active=!1,source_id=0,source_parent_id=0;if(flags&DragDropFlags.SourceExtern)win=null,source_id=GetHash("#SourceExtern"),source_drag_active=!0;else{if(source_id=win.DC.LastItemId,0!=source_id&&g.ActiveId!=source_id)return!1;if(0==g.IO.MouseDown[0])return!1;if(0==source_id){if(!(flags&DragDropFlags.SourceAllowNullID))return console.assert(0),!1;var is_hovered=0!=(win.DC.LastItemStatusFlags&ItemStatusFlags.HoveredRect);if(!is_hovered&&(0==g.ActiveId||g.ActiveIdWindow!=win))return!1;source_id=win.DC.LastItemId=win.GetIDFromRectangle(win.DC.LastItemRect),is_hovered&&this.setHoveredID(source_id),is_hovered&&g.IO.MouseClicked[0]&&(this.setActiveID(source_id,win),this.FocusWindow(win)),g.ActiveId==source_id&&(g.ActiveIdAllowOverlap=is_hovered)}else g.ActiveIdAllowOverlap=!1;if(g.ActiveId!=source_id)return!1;source_parent_id=win.IDStack.back(),source_drag_active=this.IsMouseDragging(0)}if(source_drag_active){if(!g.DragDropActive){console.assert(0!=source_id),this.ClearDragDrop();let payload=g.DragDropPayload;payload.SourceId=source_id,payload.SourceParentId=source_parent_id,g.DragDropActive=!0,g.DragDropSourceFlags=flags,g.DragDropMouseButton=0}if(g.DragDropSourceFrameCount=g.FrameCount,g.DragDropWithinSourceOrTarget=!0,!(flags&DragDropFlags.SourceNoPreviewTooltip)&&(this.BeginTooltip(),g.DragDropAcceptIdPrev&&g.DragDropAcceptFlags&DragDropFlags.AcceptNoPreviewTooltip)){let tooltip_win=g.CurrentWindow;tooltip_win.SkipItems=!0,tooltip_win.HiddenFramesCanSkipItems=1}return flags&DragDropFlags.SourceNoDisableHover||flags&DragDropFlags.SourceExtern||(win.DC.LastItemStatusFlags&=~ItemStatusFlags.HoveredRect),!0}return!1},EndDragDropSource(){let g=this.guictx;console.assert(g.DragDropActive),console.assert(g.DragDropWithinSourceOrTarget,"Not after a BeginDragDropSource()?"),g.DragDropSourceFlags&DragDropFlags.SourceNoPreviewTooltip||this.EndTooltip(),-1==g.DragDropPayload.DataFrameCount&&this.ClearDragDrop(),g.DragDropWithinSourceOrTarget=!1},SetDragDropPayload(type,data,cond=0){var g=this.guictx;let payload=g.DragDropPayload;return 0==cond&&(cond=CondFlags.Always),console.assert(null!=type),console.assert(type.length<32,"Payload type can be at most 32 characters long"),console.assert(cond==CondFlags.Always||cond==CondFlags.Once),console.assert(0!=payload.SourceId),cond!=CondFlags.Always&&-1!=payload.DataFrameCount||(payload.DataType=type,payload.Data=data),payload.DataFrameCount=g.FrameCount,g.DragDropAcceptFrameCount==g.FrameCount||g.DragDropAcceptFrameCount==g.FrameCount-1},BeginDragDropTarget(){let g=this.guictx;if(!g.DragDropActive)return!1;let win=g.CurrentWindow;if(!(win.DC.LastItemStatusFlags&ItemStatusFlags.HoveredRect))return!1;if(null==g.HoveredWindow||win.RootWindow!=g.HoveredWindow.RootWindow)return!1;const display_rect=win.DC.LastItemStatusFlags&ItemStatusFlags.HasDisplayRect?win.DC.LastItemDisplayRect:win.DC.LastItemRect;let id=win.DC.LastItemId;return 0==id&&(id=win.GetIDFromRectangle(display_rect)),g.DragDropPayload.SourceId!=id&&(console.assert(0==g.DragDropWithinSourceOrTarget),g.DragDropTargetRect=display_rect.Clone(),g.DragDropTargetId=id,g.DragDropWithinSourceOrTarget=!0)},BeginDragDropTargetCustom(bb,id){let g=this.guictx;if(!g.DragDropActive)return!1;var win=g.CurrentWindow;return null!=g.HoveredWindow&&win.RootWindow==g.HoveredWindow.RootWindow&&(console.assert(0!=id),!(!this.IsMouseHoveringRect(bb.Min,bb.Max)||id==g.DragDropPayload.SourceId)&&(!win.SkipItems&&(console.assert(0==g.DragDropWithinSourceOrTarget),g.DragDropTargetRect=bb,g.DragDropTargetId=id,g.DragDropWithinSourceOrTarget=!0)))},isDragDropPayloadBeingAccepted(){var g=this.guictx;return g.DragDropActive&&0!=g.DragDropAcceptIdPrev},AcceptDragDropPayload(push_clip_rect,flags=0){let g=this.guictx,win=g.CurrentWindow,payload=g.DragDropPayload;if(console.assert(g.DragDropActive,"Not called between BeginDragDropTargetand EndDragDropTarget?"),console.assert(-1!=payload.DataFrameCount,"Forgot to call EndDragDropTarget?"),null!=push_clip_rect&&!payload.IsDataType(push_clip_rect))return null;var was_accepted_previously=g.DragDropAcceptIdPrev==g.DragDropTargetId;let r=g.DragDropTargetRect.Clone();push_clip_rect=r.GetWidth()*r.GetHeight();return push_clip_rect<g.DragDropAcceptIdCurrRectSurface&&(g.DragDropAcceptFlags=flags,g.DragDropAcceptIdCurr=g.DragDropTargetId,g.DragDropAcceptIdCurrRectSurface=push_clip_rect),payload.Preview=was_accepted_previously,(flags|=g.DragDropSourceFlags&DragDropFlags.AcceptNoDrawDefaultRect)&DragDropFlags.AcceptNoDrawDefaultRect||!payload.Preview||(r.Expand(3.5),(push_clip_rect=win.ClipRect.Contains(r))&&win.DrawList.PushClipRect(Vec2.AddXY(r.Min,-1,-1),Vec2.AddXY(r.Max,1,1)),win.DrawList.AddRect(r.Min,r.Max,g.Style.GetColor("DragDropTarget"),0,-1,2),push_clip_rect&&win.DrawList.PopClipRect()),g.DragDropAcceptFrameCount=g.FrameCount,payload.Delivery=was_accepted_previously&&!this.IsMouseDown(g.DragDropMouseButton),payload.Delivery||flags&DragDropFlags.AcceptBeforeDelivery?payload:null},GetDragDropPayload(){var g=this.guictx;return g.DragDropActive?g.DragDropPayload:null},EndDragDropTarget(){let g=this.guictx;console.assert(g.DragDropActive),console.assert(g.DragDropWithinSourceOrTarget),g.DragDropWithinSourceOrTarget=!1}},SeparatorFlags={None:0,Horizontal:1,Vertical:2};class LayoutGroupData{constructor(win,guictx){this.BackupCursorPos=win.DC.CursorPos.Clone(),this.BackupCursorMaxPos=win.DC.CursorMaxPos.Clone(),this.BackupIndent=win.DC.Indent.Clone(),this.BackupGroupOffset=win.DC.GroupOffset.Clone(),this.BackupCurrentLineHeight=win.DC.CurrentLineHeight,this.BackupCurrentLineHeightMax=win.DC.CurrentLineHeightMax,this.BackupCurrentLineTextBaseOffset=win.DC.CurrentLineTextBaseOffset,this.BackupActiveIdIsAlive=guictx.ActiveIdIsAlive,this.BackupActiveIdPreviousFrameIsAlive=guictx.ActiveIdPreviousFrameIsAlive,this.AdvanceCursor=!0}}var ImguiLayoutMixin={SameLine(offset_from_start_x=0,spacing_w=-1){let win=this.getCurrentWindow();var g;win.SkipItems||(g=this.guictx,0!=offset_from_start_x?(spacing_w<0&&(spacing_w=0),win.DC.CursorPos.x=win.Pos.x-win.Scroll.x+offset_from_start_x+spacing_w+win.DC.GroupOffset.x+win.DC.ColumnsOffset.x):(spacing_w<0&&(spacing_w=g.Style.ItemSpacing.x),win.DC.CursorPos.x=win.DC.CursorPosPrevLine.x+spacing_w),win.DC.CursorPos.y=win.DC.CursorPosPrevLine.y,win.DC.CurrentLineHeight=win.DC.PrevLineHeight,win.DC.CurrentLineHeightMax=win.DC.PrevLineHeightMax,win.DC.CurrentLineTextBaseOffset=win.DC.PrevLineTextBaseOffset)},PrevLineHeight(){var win=this.getCurrentWindow();return win.SkipItems?0:win.DC.PrevLineHeight},Indent(indent_w=0){let win=this.getCurrentWindow();var g=this.guictx;win.DC.Indent.x+=0!=indent_w?indent_w:g.Style.IndentSpacing,win.DC.CursorPos.x=win.Pos.x+win.DC.Indent.x+win.DC.ColumnsOffset.x},Unindent(indent_w=0){let win=this.getCurrentWindow();var g=this.guictx;win.DC.Indent.x-=0!=indent_w?indent_w:g.Style.IndentSpacing,win.DC.CursorPos.x=win.Pos.x+win.DC.Indent.x+win.DC.ColumnsOffset.x},Spacing(){this.getCurrentWindow().SkipItems||this.itemSize(Vec2.Zero())},Dummy(bb){var win=this.getCurrentWindow();win.SkipItems||(bb=new Rect(win.DC.CursorPos,Vec2.Add(win.DC.CursorPos,bb)),this.itemSize(bb),this.itemAdd(bb,0))},NextItemWouldBeClipped(bb){var win=this.getCurrentWindow();if(win.SkipItems)return!0;bb=new Rect(win.DC.CursorPos,Vec2.Add(win.DC.CursorPos,bb));return this.isClippedEx(bb)},NewLine(fraction=1){let win=this.getCurrentWindow();var g,backup_layout_type;win.SkipItems||(g=this.guictx,backup_layout_type=win.DC.LayoutType,win.DC.LayoutType=LayoutType.Vertical,0<win.DC.CurrentLineHeight?this.itemSize(Vec2.Zero()):this.itemSize(new Vec2(0,g.FontLineHeight*fraction)),win.DC.LayoutType=backup_layout_type)},AlignTextToFramePadding(){let win=this.getCurrentWindow();var g,next;win.SkipItems||(g=this.guictx,next=Math.max(win.DC.CurrentLineHeight,g.FontLineHeight+2*g.Style.FramePadding.y),win.DC.CurrentLineHeight=next,win.DC.CurrentLineHeightMax=Math.max(win.DC.CurrentLineHeightMax,next),win.DC.CurrentLineTextBaseOffset=Math.max(win.DC.CurrentLineTextBaseOffset,g.Style.FramePadding.y))},AlignTextToFrameCenter(fmid){let win=this.getCurrentWindow();var ypad,mid;win.SkipItems||(ypad=(mid=this.guictx).Style.FramePadding.y,mid=mid.FontLineHeight+2*ypad,win.DC.CurrentLineHeight=mid,win.DC.CurrentLineHeightMax=Math.max(win.DC.CurrentLineHeightMax,mid),mid=fmid/2,fmid=this.GetFontMidline(),win.DC.CurrentLineTextBaseOffset=Math.max(ypad,ypad+(mid-fmid)))},Separator(){let win=this.getCurrentWindow();if(!win.SkipItems){let g=this.guictx;if((win.DC.LayoutType==LayoutType.Horizontal?SeparatorFlags.Vertical:SeparatorFlags.Horizontal)&SeparatorFlags.Vertical)this.VerticalSeparator();else{win.DC.CurrentColumns&&this.PopClipRect();let x1=win.Pos.x;var bb=win.Pos.x+win.Size.x;win.DC.GroupStack.empty()&&(x1+=win.DC.Indent.x);bb=Rect.FromXY(x1,win.DC.CursorPos.y,bb,win.DC.CursorPos.y+1);this.itemSize(Vec2.Zero()),this.itemAdd(bb,0)?(win.DrawList.AddLine(bb.Min,new Vec2(bb.Max.x,bb.Min.y),g.Style.GetColor("Separator")),g.LogEnabled&&this.LogRenderedText(bb.Min,"--------------------------------"),win.DC.CurrentColumns&&(this.pushColumnClipRect(),win.DC.CurrentColumns.LineMinY=win.DC.CursorPos.y)):win.DC.CurrentColumns&&this.pushColumnClipRect()}}},VerticalSeparator(){let win=this.getCurrentWindow();if(!win.SkipItems){let g=this.guictx;var y1=win.DC.CursorPos.y,y2=win.DC.CursorPos.y+win.DC.CurrentLineHeightMax;const bb=Rect.FromXY(win.DC.CursorPos.x,y1,win.DC.CursorPos.x+1,y2);this.itemSize(new Vec2(bb.GetWidth(),0)),this.itemAdd(bb,0)&&(win.DrawList.AddLine(new Vec2(bb.Min.x,bb.Min.y),new Vec2(bb.Min.x,bb.Max.y),g.Style.GetColor("Separator")),g.LogEnabled&&this.LogText(" |"))}},SplitterBehavior(size_1_maximum_delta,id,axis,size1,size2,min_size1,min_size2,size_2_maximum_delta,col){let win=this.getCurrentWindow(),g=this.guictx;var item_flags_backup=win.DC.ItemFlags;win.DC.ItemFlags|=ItemFlags.NoNav|ItemFlags.NoNavDefaultFocus;var item_add=this.itemAdd(size_1_maximum_delta,id);if(win.DC.ItemFlags=item_flags_backup,!item_add)return!1;let hovered=new ValRef,held=new ValRef,bb_interact=size_1_maximum_delta.Clone();bb_interact.Expand(axis==Axis.Y?new Vec2(0,size_2_maximum_delta):new Vec2(size_2_maximum_delta,0)),this.ButtonBehavior(bb_interact,id,hovered,held,ButtonFlags.FlattenChildren|ButtonFlags.AllowItemOverlap),g.ActiveId!=id&&this.SetItemAllowOverlap(),(held.get()||g.HoveredId==id&&g.HoveredIdPreviousFrame==id&&g.HoveredIdTimer>=col)&&this.SetMouseCursor(axis==Axis.Y?MouseCursor.ResizeNS:MouseCursor.ResizeEW);let bb_render=size_1_maximum_delta.Clone();if(held.get()){size_2_maximum_delta=Vec2.Subtract(Vec2.Subtract(g.IO.MousePos,g.ActiveIdClickOffset),bb_interact.Min);let mouse_delta=axis==Axis.Y?size_2_maximum_delta.y:size_2_maximum_delta.x;size_1_maximum_delta=Math.max(0,size1.get()-min_size1),size_2_maximum_delta=Math.max(0,size2.get()-min_size2);mouse_delta<-size_1_maximum_delta&&(mouse_delta=-size_1_maximum_delta),mouse_delta>size_2_maximum_delta&&(mouse_delta=size_2_maximum_delta),0!=mouse_delta&&(mouse_delta<0&&console.assert(size1.get()+mouse_delta>=min_size1),0<mouse_delta&&console.assert(size2.get()-mouse_delta>=min_size2),size1.set(size1.get()+mouse_delta),size2.set(size2.get()-mouse_delta),bb_render.Translate(axis==Axis.X?new Vec2(mouse_delta,0):new Vec2(0,mouse_delta)),this.MarkItemEdited(id))}col=g.Style.GetColor(held.get()?"SeparatorActive":hovered.get()&&g.HoveredIdTimer>=col?"SeparatorHovered":"Separator");return win.DrawList.AddRectFilled(bb_render.Min,bb_render.Max,col,g.Style.FrameRounding),held.get()},BeginGroup(){let g=this.guictx,win=this.getCurrentWindow();win.DC.GroupStack.push(new LayoutGroupData(win,g)),win.DC.GroupOffset.x=win.DC.CursorPos.x-win.Pos.x-win.DC.ColumnsOffset.x,win.DC.Indent=win.DC.GroupOffset,win.DC.CursorMaxPos.Copy(win.DC.CursorPos),win.DC.CurrentLineHeight=0,win.DC.CurrentLineHeightMax=0,g.LogEnabled&&(g.LogLinePosY=-Number.MAX_VALUE)},EndGroup(){let g=this.guictx,win=this.getCurrentWindow();console.assert(!win.DC.GroupStack.empty(),"Mismatched BeginGroup()/EndGroup() calls");var group_data=win.DC.GroupStack.back();let group_bb=new Rect(group_data.BackupCursorPos,win.DC.CursorMaxPos);group_bb.Max=Vec2.Max(group_bb.Min,group_bb.Max),win.DC.CursorPos.Copy(group_data.BackupCursorPos),win.DC.CursorMaxPos=Vec2.Max(group_data.BackupCursorMaxPos,win.DC.CursorMaxPos),win.DC.Indent=group_data.BackupIndent,win.DC.GroupOffset=group_data.BackupGroupOffset,win.DC.CurrentLineHeight=group_data.BackupCurrentLineHeight,win.DC.CurrentLineHeightMax=group_data.BackupCurrentLineHeightMax,win.DC.CurrentLineTextBaseOffset=group_data.BackupCurrentLineTextBaseOffset,g.LogEnabled&&(g.LogLinePosY=-Number.MAX_VALUE),group_data.AdvanceCursor&&(win.DC.CurrentLineTextBaseOffset=Math.max(win.DC.PrevLineTextBaseOffset,group_data.BackupCurrentLineTextBaseOffset),this.itemSize(group_bb.GetSize(),0),this.itemAdd(group_bb,0)),group_data.BackupActiveIdIsAlive!=g.ActiveId&&g.ActiveIdIsAlive==g.ActiveId&&g.ActiveId?win.DC.LastItemId=g.ActiveId:!group_data.BackupActiveIdPreviousFrameIsAlive&&g.ActiveIdPreviousFrameIsAlive&&(win.DC.LastItemId=g.ActiveIdPreviousFrame),win.DC.LastItemRect=group_bb,win.DC.GroupStack.pop_back()},GetCursorPos(){var win=this.getCurrentWindowRead();return new Vec2(win.DC.CursorPos.x-win.Pos.x+win.Scroll.x,win.DC.CursorPos.y-win.Pos.y+win.Scroll.y)},SetCursorPos(local_pos){let win=this.getCurrentWindow();win.DC.CursorPos.x=win.Pos.x-win.Scroll.x+local_pos.x,win.DC.CursorPos.y=win.Pos.y-win.Scroll.y+local_pos.y,win.DC.CursorMaxPos=Vec2.Max(win.DC.CursorMaxPos,win.DC.CursorPos)},GetCursorPosX(){var win=this.getCurrentWindowRead();return win.DC.CursorPos.x-win.Pos.x+win.Scroll.x},GetCursorPosXLastLine(){var win=this.getCurrentWindowRead();return win.DC.CursorPosPrevLine.x-win.Pos.x+win.Scroll.x},GetCursorPosY(){var win=this.getCurrentWindowRead();return win.DC.CursorPos.y-win.Pos.y+win.Scroll.y},SetCursorPosX(local_x){let win=this.getCurrentWindow();win.DC.CursorPos.x=win.Pos.x-win.Scroll.x+local_x,win.DC.CursorMaxPos.x=Math.max(win.DC.CursorMaxPos.x,win.DC.CursorPos.x)},SetCursorPosY(local_y){let win=this.getCurrentWindow();win.DC.CursorPos.y=win.Pos.y-win.Scroll.y+local_y,win.DC.CursorMaxPos.y=Math.max(win.DC.CursorMaxPos.y,win.DC.CursorPos.y),win.DC.CursorPos.IsNaN()&&console.assert(0,"hey!")},SetCursorPosYAndSetupDummyPrevLine(pos_y,line_height){this.SetCursorPosY(pos_y);let win=this.getCurrentWindow();win.DC.CursorPosPrevLine.y=win.DC.CursorPos.y-line_height,win.DC.PrevLineHeight=line_height-this.guictx.Style.ItemSpacing.y,win.DC.PrevLineHeightMax=win.DC.PrevLineHeight,win.DC.CurrentColumns&&(win.DC.CurrentColumns.LineMinY=win.DC.CursorPos.y)},GetCursorStartPos(){var win=this.getCurrentWindowRead();return Vec2.Subtract(win.DC.CursorStartPos,win.Pos)},GetCursorScreenPos(){let win=this.getCurrentWindowRead();return win.DC.CursorPos.Clone()},GetCursorScreenStartPos(){return this.getCurrentWindowRead().DC.CursorStartPos},SetCursorScreenPos(pos){let win=this.getCurrentWindow();win.DC.CursorPos.Copy(pos),win.DC.CursorMaxPos=Vec2.Max(win.DC.CursorMaxPos,win.DC.CursorPos)},itemSize(size,text_base_offset=0){let g=this.guictx,win=g.CurrentWindow;var line_height;win.SkipItems||(null!=size.Max&&(size=size.GetSize()),line_height=Math.max(win.DC.CurrentLineHeight,size.y),text_base_offset=Math.max(win.DC.CurrentLineTextBaseOffset,text_base_offset),g.IO.KeyAlt&&win.DrawList.AddRect(win.DC.CursorPos,Vec2.AddXY(win.DC.CursorPos,size.x,line_height),g.Style.GetColor("_DEBUG2")),win.DC.CursorPosPrevLine=new Vec2(win.DC.CursorPos.x+size.x,win.DC.CursorPos.y),win.DC.CursorPos.x=Math.floor(win.Pos.x+win.DC.Indent.x+win.DC.ColumnsOffset.x),win.DC.CursorPos.y=Math.floor(win.DC.CursorPos.y+line_height+g.Style.ItemSpacing.y),win.DC.CursorMaxPos.x=Math.max(win.DC.CursorMaxPos.x,win.DC.CursorPosPrevLine.x),win.DC.CursorMaxPos.y=Math.max(win.DC.CursorMaxPos.y,win.DC.CursorPos.y-g.Style.ItemSpacing.y),(win.DC.CursorMaxPos.IsNaN()||win.DC.CursorPos.IsNaN())&&console.assert(0,"hey!"),win.DC.PrevLineHeight=line_height,win.DC.PrevLineHeightMax=Math.max(line_height,win.DC.CurrentLineHeightMax),win.DC.PrevLineTextBaseOffset=text_base_offset,win.DC.CurrentLineHeight=win.DC.CurrentLineTextBaseOffset=0,win.DC.CurrentLineHeightMax=0,win.DC.LayoutType==LayoutType.Horizontal&&this.SameLine())},itemAdd(bb,id,nav_bb=null){let g=this.guictx,win=g.CurrentWindow;return 0!=id&&(win.DC.NavLayerActiveMaskNext|=win.DC.NavLayerCurrentMask,(g.NavId==id||g.NavAnyRequest)&&g.NavWindow.RootWindowForNav==win.RootWindowForNav&&(win==g.NavWindow||(win.Flags|g.NavWindow.Flags)&WindowFlags.NavFlattened)&&this.navProcessItem(win,nav_bb||bb,id)),win.DC.LastItemId=id,win.DC.LastItemRect.Copy(bb),win.DC.LastItemStatusFlags=ItemStatusFlags.None,!this.isClippedEx(bb,id,!1)&&(g.IO.KeyAlt&&win.DrawList.AddRect(bb.Min,bb.Max,g.Style.GetColor("_DEBUG1")),this.IsMouseHoveringRect(bb.Min,bb.Max)&&(win.DC.LastItemStatusFlags|=ItemStatusFlags.HoveredRect),!0)},isClippedEx(bb,id=0,clip_even_when_logged=!1){var g=this.guictx,win=g.CurrentWindow;return!(bb.Overlaps(win.ClipRect)||0!=id&&id==g.ActiveId||!clip_even_when_logged&&g.LogEnabled)}},TabBarFlags={None:0,Reorderable:1,AutoSelectNewTabs:2,TabListPopupButton:4,NoCloseWithMiddleMouseButton:8,NoTabListScrollingButtons:16,NoTooltip:32,FittingPolicyResizeDown:64,FittingPolicyScroll:128};f=TabBarFlags,f.FittingPolicyMask_=f.FittingPolicyResizeDown|f.FittingPolicyScroll,f.FittingPolicyDefault_=f.FittingPolicyResizeDown;var TabItemFlags={None:0,UnsavedDocument:1,SetSelected:2,NoCloseWithMiddleMouseButton:4,NoPushId:8};function linearSweep(current,target,speed){return current<target?Math.min(current+speed,target):target<current?Math.max(current-speed,target):current}class TabSortItem{constructor(){this.Index=-1,this.Width=0}}class TabItem{constructor(){this.ID=this.Flags=0,this.LastFrameVisible=this.LastFrameSelected=-1,this.NameOffset=-1,this.Offset=this.Width=this.WidthContents=0}}class TabBar{constructor(id){this.Tabs=[],this.ID=id,this.SelectedTabId=this.NextSelectedTabId=this.VisibleTabId=0,this.CurrFrameVisible=this.PrevFrameVisible=-1,this.BarRect=null,this.ContentsHeight=0,this.OffsetMax=this.OffsetNextTab=0,this.ScrollingAnim=this.ScrollingTarget=0,this.ScrollingTargetDistToVisibility=this.ScrollingSpeed=0,this.Flags=TabBarFlags.None,this.ReorderRequestTabId=0,this.ReorderRequestDir=0,this.WantLayout=this.VisibleTabWasSubmitted=!1,this.LastTabItemIdx=-1,this.FramePadding=null,this.TabsNames=[]}GetTabOrder(item){item=this.Tabs.indexOf(item);return null==item&&console.assert(0),item}GetTabName(tab){return this.TabsNames[this.GetTabOrder(tab)]}}var ImguiTabBarMixin={BeginTabBar(tab_bar_bb,flags=0){let g=this.guictx,win=g.CurrentWindow;if(win.SkipItems)return!1;tab_bar_bb=win.GetID(tab_bar_bb);let tab_bar=g.TabBars[tab_bar_bb];null==tab_bar&&(tab_bar=new TabBar(tab_bar_bb),g.TabBars[tab_bar_bb]=tab_bar);tab_bar_bb=Rect.FromXY(win.DC.CursorPos.x,win.DC.CursorPos.y,win.InnerClipRect.Max.x,win.DC.CursorPos.y+g.FontLineHeight+2*g.Style.FramePadding.y);return this.beginTabBarEx(tab_bar,tab_bar_bb,flags|TabBarFlags.IsFocused)},beginTabBarEx(separator_max_x,y,separator_min_x){let g=this.guictx,win=g.CurrentWindow;if(win.SkipItems)return!1;if(0==(separator_min_x&TabBarFlags.DockNode)&&win.IDStack.push(separator_max_x.ID),g.CurrentTabBarStack.push(separator_max_x),(g.CurrentTabBar=separator_max_x).CurrFrameVisible==g.FrameCount)return console.assert(0,"beginTabBarEx already called this frame"),!0;separator_min_x&TabBarFlags.Reorderable&&!(separator_max_x.Flags&TabBarFlags.Reorderable)&&1<separator_max_x.Tabs.length&&-1!=separator_max_x.PrevFrameVisible&&separator_max_x.Tabs.sort(this._compareTabItemsByVisibleOffset),0==(separator_min_x&TabBarFlags.FittingPolicyMask_)&&(separator_min_x|=TabBarFlags.FittingPolicyDefault_),separator_max_x.Flags=separator_min_x,separator_max_x.BarRect=y,separator_max_x.WantLayout=!0,separator_max_x.PrevFrameVisible=separator_max_x.CurrFrameVisible,separator_max_x.CurrFrameVisible=g.FrameCount,separator_max_x.FramePadding=g.Style.FramePadding,this.itemSize(new Vec2(separator_max_x.OffsetMax,separator_max_x.BarRect.GetHeight())),win.DC.CursorPos.x=separator_max_x.BarRect.Min.x;var col=g.Style.GetColor(separator_min_x&TabBarFlags.IsFocused?"TabActive":"Tab"),y=separator_max_x.BarRect.Max.y-1,separator_min_x=separator_max_x.BarRect.Min.x-win.WindowPadding.x,separator_max_x=separator_max_x.BarRect.Max.x+win.WindowPadding.x;return win.DrawList.AddLine(new Vec2(separator_min_x,y),new Vec2(separator_max_x,y),col,1),!0},_compareTabItemsByVisibleOffset(a,b){return a.Offset-b.Offset},tabBarCalcTabID(id,label){if(id.Flags&TabBarFlags.DockNode){id=GetHash(label,0);return this.KeepAliveID(id),id}{let win=this.guictx.CurrentWindow;return win.GetID(label)}},EndTabBar(){let g=this.guictx,win=g.CurrentWindow;if(!win.SkipItems){let tab_bar=g.CurrentTabBar;var tab_bar_appearing;null!=tab_bar?(tab_bar.WantLayout&&this.tabBarLayout(tab_bar),tab_bar_appearing=tab_bar.PrevFrameVisible+1<g.FrameCount,tab_bar.VisibleTabWasSubmitted||0==tab_bar.VisibleTabId||tab_bar_appearing?tab_bar.ContentsHeight=Math.max(win.DC.CursorPos.y-tab_bar.BarRect.Max.y,0):win.DC.CursorPos.y=tab_bar.BarRect.Max.y+tab_bar.ContentsHeight,0==(tab_bar.Flags&TabBarFlags.DockNode)&&this.PopID(),g.CurrentTabBarStack.pop(),g.CurrentTabBar=0==g.CurrentTabBarStack.length?null:g.CurrentTabBarStack[g.CurrentTabBarStack.length-1]):console.assert(null!=tab_bar,"Mismatched BeginTabBar()/EndTabBar()!")}},BeginTabItem(label,ret=null,flags=0){let g=this.guictx;if(g.CurrentWindow.SkipItems)return!1;var tab=g.CurrentTabBar;if(null==tab)return console.assert(tab,"Needs to be called between BeginTabBar() and EndTabBar()!"),!1;ret=this.tabItemEx(tab,label,ret,flags);return!ret||flags&TabItemFlags.NoPushId||(tab=tab.Tabs[tab.LastTabItemIdx],g.CurrentWindow.IDStack.push(tab.ID)),ret},EndTabItem(){let g=this.guictx;var tab_bar;g.CurrentWindow.SkipItems||(null!=(tab_bar=g.CurrentTabBar)?(console.assert(0<=tab_bar.LastTabItemIdx),tab_bar.Tabs[tab_bar.LastTabItemIdx].Flags&TabItemFlags.NoPushId||g.CurrentWindow.IDStack.pop()):console.assert(null!=tab_bar,"Needs to be called between BeginTabBar() and EndTabBar()!"))},tabItemEx(tab_bar,label,p_open,flags){tab_bar.WantLayout&&this.tabBarLayout(tab_bar);var g=this.guictx;let win=g.CurrentWindow;if(win.SkipItems)return!1;const style=g.Style;var id=this.tabBarCalcTabID(tab_bar,label);if(p_open&&!p_open.get())return this.PushItemFlag(ItemFlags.NoNav|ItemFlags.NoNavDefaultFocus,!0),this.itemAdd(new Rect,id),this.PopItemFlag(),!1;let size=this.tabItemCalcSize(label,null!=p_open),tab=this.tabBarFindTabByID(tab_bar,id),tab_is_new=!1;null==tab&&(tab=new TabItem,tab.ID=id,tab.Width=size.x,tab_is_new=!0,tab_bar.Tabs.push(tab)),tab_bar.LastTabItemIdx=tab_bar.Tabs.indexOf(tab),tab.WidthContents=size.x,null==p_open&&(flags|=TabItemFlags.NoCloseButton);var want_clip_rect=tab_bar.PrevFrameVisible+1<g.FrameCount,close_button_id=0!=(tab_bar.Flags&TabBarFlags.IsFocused),drawList=tab.LastFrameVisible+1<g.FrameCount;tab.LastFrameVisible=g.FrameCount,tab.Flags=flags,tab.NameOffset=tab_bar.TabsNames.length,tab_bar.TabsNames.push(label),drawList||tab_bar.Flags&TabBarFlags.Reorderable||(tab.Offset=tab_bar.OffsetNextTab,tab_bar.OffsetNextTab+=tab.Width+g.Style.ItemInnerSpacing.x),drawList&&tab_bar.Flags&TabBarFlags.AutoSelectNewTabs&&0==tab_bar.NextSelectedTabId&&(want_clip_rect&&0!=tab_bar.SelectedTabId||(tab_bar.NextSelectedTabId=id)),flags&TabItemFlags.SetSelected&&tab_bar.SelectedTabId!=id&&(tab_bar.NextSelectedTabId=id);let tab_contents_visible=tab_bar.VisibleTabId==id;if(tab_contents_visible&&(tab_bar.VisibleTabWasSubmitted=!0),!tab_contents_visible&&0==tab_bar.SelectedTabId&&want_clip_rect&&(1!=tab_bar.Tabs.length||tab_bar.Flags&TabBarFlags.AutoSelectNewTabs||(tab_contents_visible=!0)),drawList&&(!want_clip_rect||tab_is_new))return this.PushItemFlag(ItemFlags.NoNav|ItemFlags.NoNavDefaultFocus,!0),this.itemAdd(new Rect,id),this.PopItemFlag(),tab_contents_visible;tab_bar.SelectedTabId==id&&(tab.LastFrameSelected=g.FrameCount);var backup_main_cursor_pos=win.DC.CursorPos;size.x=tab.Width,win.DC.CursorPos=Vec2.AddXY(tab_bar.BarRect.Min,Math.floor(tab.Offset-tab_bar.ScrollingAnim),0);want_clip_rect=win.DC.CursorPos;let bb=new Rect(want_clip_rect,Vec2.Add(want_clip_rect,size));want_clip_rect=bb.Min.x<tab_bar.BarRect.Min.x||bb.Max.x>=tab_bar.BarRect.Max.x;if(want_clip_rect&&this.PushClipRect(new Vec2(Math.max(bb.Min.x,tab_bar.BarRect.Min.x),bb.Min.y-1),new Vec2(tab_bar.BarRect.Max.x,bb.Max.y),!0),this.itemSize(bb,style.FramePadding.y),!this.itemAdd(bb,id))return want_clip_rect&&this.PopClipRect(),win.DC.CursorPos=backup_main_cursor_pos,tab_contents_visible;let button_flags=ButtonFlags.PressedOnClick|ButtonFlags.AllowItemOverlap;g.DragDropActive&&(button_flags|=ButtonFlags.PressedOnDragDropHold);let hovered=new ValRef,held=new ValRef;this.ButtonBehavior(bb,id,hovered,held,button_flags)&&(tab_bar.NextSelectedTabId=id),hovered|=g.HoveredId==id,held.get()||this.SetItemAllowOverlap(),held&&!drawList&&this.IsMouseDragging(0)&&tab_bar.Flags&TabBarFlags.Reorderable&&(g.DragDropActive||(g.IO.MouseDelta.x<0&&g.IO.MousePos.x<bb.Min.x?tab_bar.Flags&TabBarFlags.Reorderable&&this.tabBarQueueChangeTabOrder(tab_bar,tab,-1):0<g.IO.MouseDelta.x&&g.IO.MousePos.x>bb.Max.x&&tab_bar.Flags&TabBarFlags.Reorderable&&this.tabBarQueueChangeTabOrder(tab_bar,tab,1)));drawList=win.DrawList,close_button_id=style.GetColor(held.get()||hovered?"TabHovered":tab_contents_visible?close_button_id?"TabActive":"TabUnfocusedActive":close_button_id?"Tab":"TabUnfocused");this.tabItemBackground(drawList,bb,flags,close_button_id),this.renderNavHighlight(bb,id),this.IsItemHovered(HoveredFlags.AllowWhenBlockedByPopup)&&(this.IsMouseClicked(1)||this.IsMouseReleased(1))&&(tab_bar.NextSelectedTabId=id),tab_bar.Flags&TabBarFlags.NoCloseWithMiddleMouseButton&&(flags|=TabItemFlags.NoCloseWithMiddleMouseButton);close_button_id=p_open?win.GetID(""+id+1):0;return this.tabItemLabelAndCloseButton(drawList,bb,flags,tab_bar.FramePadding,label,id,close_button_id)&&null!=p_open&&(p_open.set(!1),this.tabBarCloseTab(tab_bar,tab)),want_clip_rect&&this.PopClipRect(),win.DC.CursorPos=backup_main_cursor_pos,g.HoveredId==id&&!held&&.5<g.HoveredIdNotActiveTimer&&this.IsItemHovered()&&(tab_bar.Flags&TabBarFlags.NoTooltip||this.SetTooltip(label)),tab_contents_visible},SetTabItemClosed(_tab_or_docked_window_label){},tabBarLayout(tab_bar){var tab1,tab2_order,tab2,g=this.guictx;tab_bar.WantLayout=!1;let tab_dst_n=0;for(let tab_src_n=0;tab_src_n<tab_bar.Tabs.length;tab_src_n++){var tab=tab_bar.Tabs[tab_src_n];tab.LastFrameVisible<tab_bar.PrevFrameVisible?tab.ID==tab_bar.SelectedTabId&&(tab_bar.SelectedTabId=0):(tab_dst_n!=tab_src_n&&(tab_bar.Tabs[tab_dst_n]=tab_bar.Tabs[tab_src_n]),tab_dst_n++)}tab_bar.Tabs.length!=tab_dst_n&&(tab_bar.Tabs.length=tab_dst_n);let scrollTrackSelTabId=0;tab_bar.NextSelectedTabId&&(tab_bar.SelectedTabId=tab_bar.NextSelectedTabId,tab_bar.NextSelectedTabId=0,scrollTrackSelTabId=tab_bar.SelectedTabId),0!=tab_bar.ReorderRequestTabId&&((tab1=this.tabBarFindTabByID(tab_bar,tab_bar.ReorderRequestTabId))&&(0<=(tab2_order=tab_bar.GetTabOrder(tab1)+tab_bar.ReorderRequestDir)&&tab2_order<tab_bar.Tabs.length&&(tab2=tab_bar.Tabs[tab2_order],tab_bar.Tabs[tab2_order]=tab1,(tab_bar.Tabs[tab_bar.ReqorderRequestTabId]=tab2).ID==tab_bar.SelectedTabId&&(scrollTrackSelTabId=tab2.ID)),tab_bar.Flags&TabBarFlags.SaveSettings&&this.MarkIniSettingsDirty()),tab_bar.ReorderRequestTabId=0),0!=(tab_bar.Flags&TabBarFlags.TabListPopupButton)&&(width_avail=this.tabBarTabListPopupButton(tab_bar))&&(scrollTrackSelTabId=tab_bar.SelectedTabId=width_avail.ID);let widthBuffer=g.TabSortByWidthBuffer;widthBuffer.length=tab_bar.Tabs.length;let widthTotal=0,recentTab=null,foundSelTabID=!1;for(let tab_n=0;tab_n<tab_bar.Tabs.length;tab_n++){let tab=tab_bar.Tabs[tab_n];console.assert(tab.LastFrameVisible>=tab_bar.PrevFrameVisible),(null==recentTab||recentTab.LastFrameSelected<tab.LastFrameSelected)&&(recentTab=tab),tab.ID==tab_bar.SelectedTabId&&(foundSelTabID=!0);var tab_name=tab_bar.GetTabName(tab);tab.WidthContents=this.tabItemCalcSize(tab_name,!(tab.Flags&TabItemFlags.NoCloseButton)).x,widthTotal+=(0<tab_n?g.Style.ItemInnerSpacing.x:0)+tab.WidthContents;let si=widthBuffer[tab_n];null==si&&(si=new TabSortItem,widthBuffer[tab_n]=si),si.Index=tab_n,si.Width=tab.WidthContents}var teleport,width_avail=tab_bar.BarRect.GetWidth();let width_excess=width_avail<widthTotal?widthTotal-width_avail:0;if(0<width_excess&&tab_bar.Flags&TabBarFlags.FittingPolicyResizeDown){1<tab_bar.Tabs.length&&widthBuffer.sort(this.tabBarSortItemComparer);let tab_count_same_width=1;for(;0<width_excess&&tab_count_same_width<tab_bar.Tabs.length;){for(;tab_count_same_width<tab_bar.Tabs.length&&widthBuffer[0].Width==widthBuffer[tab_count_same_width].Width;)tab_count_same_width++;var width_to_remove_per_tab_max=tab_count_same_width<tab_bar.Tabs.length?widthBuffer[0].Width-widthBuffer[tab_count_same_width].Width:widthBuffer[0].Width-1,width_to_remove_per_tab=Math.min(width_excess/tab_count_same_width,width_to_remove_per_tab_max);for(let tab_n=0;tab_n<tab_count_same_width;tab_n++)widthBuffer[tab_n].Width-=width_to_remove_per_tab;width_excess-=width_to_remove_per_tab*tab_count_same_width}for(let tab_n=0;tab_n<tab_bar.Tabs.length;tab_n++)tab_bar.Tabs[widthBuffer[tab_n].Index].Width=Math.floor(widthBuffer[tab_n].Width)}else{var tab_max_width=this.tabBarCalcMaxTabWidth();for(let tab_n=0;tab_n<tab_bar.Tabs.length;tab_n++){let tab=tab_bar.Tabs[tab_n];tab.Width=Math.min(tab.WidthContents,tab_max_width)}}let offset_x=0;for(let tab_n=0;tab_n<tab_bar.Tabs.length;tab_n++){let tab=tab_bar.Tabs[tab_n];tab.Offset=offset_x,0==scrollTrackSelTabId&&g.NavJustMovedToId==tab.ID&&(scrollTrackSelTabId=tab.ID),offset_x+=tab.Width+g.Style.ItemInnerSpacing.x}if(tab_bar.OffsetMax=Math.max(offset_x-g.Style.ItemInnerSpacing.x,0),tab_bar.OffsetNextTab=0,tab_bar.OffsetMax>tab_bar.BarRect.GetWidth()&&1<tab_bar.Tabs.length&&!(tab_bar.Flags&TabBarFlags.NoTabListScrollingButtons)&&tab_bar.Flags&TabBarFlags.FittingPolicyScroll){let tab_to_select=this.tabBarScrollingButtons(tab_bar);tab_to_select&&(scrollTrackSelTabId=tab_bar.SelectedTabId=tab_to_select.ID)}0==foundSelTabID&&(tab_bar.SelectedTabId=0),0==tab_bar.SelectedTabId&&0==tab_bar.NextSelectedTabId&&null!=recentTab&&(scrollTrackSelTabId=tab_bar.SelectedTabId=recentTab.ID),tab_bar.VisibleTabId=tab_bar.SelectedTabId,tab_bar.VisibleTabWasSubmitted=!1,!scrollTrackSelTabId||(teleport=this.tabBarFindTabByID(tab_bar,scrollTrackSelTabId))&&this.tabBarScrollToTab(tab_bar,teleport),tab_bar.ScrollingAnim=this.tabBarScrollClamp(tab_bar,tab_bar.ScrollingAnim),tab_bar.ScrollingTarget=this.tabBarScrollClamp(tab_bar,tab_bar.ScrollingTarget),tab_bar.ScrollingAnim!=tab_bar.ScrollingTarget?(tab_bar.ScrollingSpeed=Math.max(tab_bar.ScrollingSpeed,70*g.FontSize),tab_bar.ScrollingSpeed=Math.max(tab_bar.ScrollingSpeed,Math.abs(tab_bar.ScrollingTarget-tab_bar.ScrollingAnim)/.3),teleport=tab_bar.PrevFrameVisible+1<g.FrameCount||tab_bar.ScrollingTargetDistToVisibility>10*g.FontSize,tab_bar.ScrollingAnim=teleport?tab_bar.ScrollingTarget:linearSweep(tab_bar.ScrollingAnim,tab_bar.ScrollingTarget,g.IO.DeltaTime*tab_bar.ScrollingSpeed)):tab_bar.ScrollingSpeed=0,0==(tab_bar.Flags&TabBarFlags.DockNode)&&(tab_bar.TabsNames.length=0)},tabBarCalcMaxTabWidth(){return 20*this.guictx.FontSize},tabBarFindTabByID(tabbar,tabid){if(0!=tabid)for(let n=0;n<tabbar.Tabs.length;n++)if(tabbar.Tabs[n].ID==tabid)return tabbar.Tabs[n];return null},tabBarCloseTab(tabbar,tab){tabbar.VisibleTabId!=tab.ID||tab.Flags&TabItemFlags.UnsavedDocument?tabbar.VisibleTabId!=tab.ID&&tab.Flags&TabItemFlags.UnsavedDocument&&(tabbar.NextSelectedTabId=tab.ID):(tab.LastFrameVisible=-1,tabbar.SelectedTabId=tabbar.NextSelectedTabId=0)},tabBarQueueChangeTabOrder(tabbar,tab,dir){console.assert(-1==dir||1==dir),console.assert(0==tabbar.ReorderRequestTabId),tabbar.ReorderRequestTabId=tab.ID,tabbar.ReorderRequestDir=dir},tabBarScrollClamp(tabbar,scrolling){return scrolling=Math.min(scrolling,tabbar.OffsetMax-tabbar.BarRect.GetWidth()),Math.max(scrolling,0)},tabBarScrollToTab(tabbar,tab){var w=+this.guictx.FontSize,tab_x2=tabbar.GetTabOrder(tab),tab_x1=tab.Offset+(0<tab_x2?-w:0),tab_x2=tab.Offset+tab.Width+(tab_x2+1<tabbar.Tabs.length?w:1);tabbar.ScrollingTargetDistToVisibility=0,tabbar.ScrollingTarget>tab_x1?(tabbar.ScrollingTargetDistToVisibility=Math.max(tabbar.ScrollingAnim-tab_x2,0),tabbar.ScrollingTarget=tab_x1):tabbar.ScrollingTarget<tab_x2-tabbar.BarRect.GetWidth()&&(w=tabbar.BarRect.GetWidth(),tabbar.ScrollingTargetDistToVisibility=Math.max(tab_x1-w-tabbar.ScrollingAnim,0),tabbar.ScrollingTarget=tab_x2-w)},tabItemCalcSize(labelSize,hasCloseButton){var g=this.guictx;null==labelSize&&(console.assert(0),labelSize="Error");labelSize=this.CalcTextSize(labelSize,!0);let size=new Vec2(labelSize.x+g.Style.FramePadding.x,labelSize.y+2*g.Style.FramePadding.y);return size.x+=g.Style.FramePadding.x+1,hasCloseButton&&(size.x+=g.Style.ItemInnerSpacing.x+g.FontSize),size.x=Math.min(size.x,this.tabBarCalcMaxTabWidth()),size},tabItemBackground(drawlist,bb,itemflags,col){let g=this.guictx;var y2=bb.GetWidth();console.assert(0<y2);var rounding=Math.max(0,Math.min(g.Style.TabRounding,.5*y2-1)),y1=bb.Min.y+1,y2=bb.Max.y-1;drawlist.PathLineTo(new Vec2(bb.Min.x,y2)),drawlist.PathArcToFast(new Vec2(bb.Min.x+rounding,y1+rounding),rounding,6,9),drawlist.PathArcToFast(new Vec2(bb.Max.x-rounding,y1+rounding),rounding,9,12),drawlist.PathLineTo(new Vec2(bb.Max.x,y2)),drawlist.PathFillConvex(col),0<g.Style.TabBorderSize&&(drawlist.PathLineTo(new Vec2(bb.Min.x+.5,y2)),drawlist.PathArcToFast(new Vec2(bb.Min.x+rounding+.5,y1+rounding+.5),rounding,6,9),drawlist.PathArcToFast(new Vec2(bb.Max.x-rounding-.5,y1+rounding+.5),rounding,9,12),drawlist.PathLineTo(new Vec2(bb.Max.x-.5,y2)),drawlist.PathStroke(g.Style.GetColor("Border"),!1,g.Style.TabBorderSize))},tabItemLabelAndCloseButton(drawlist,bb,flags,framepadding,label,close_button_sz,closebuttonid){let g=this.guictx;var unsaved_marker_pos,maxwidth=this.CalcTextSize(label,!0);let text_pixel_clip_bb=Rect.FromXY(bb.Min.x+framepadding.x,bb.Min.y+framepadding.y,bb.Max.x-framepadding.x,bb.Max.y);flags&TabItemFlags.UnsavedDocument&&(text_pixel_clip_bb.Max.x-=this.CalcTextSize("*",null,!1).x,unsaved_marker_pos=new Vec2(Math.min(bb.Min.x+framepadding.x+maxwidth.x+2,text_pixel_clip_bb.Max.x),bb.Min.y+framepadding.y+Math.floor(.25*-g.FontLineHeight)),this.renderTextClippedEx(drawlist,unsaved_marker_pos,Vec2.Subtract(bb.Max,framepadding),"*",null,null));let text_ellipsis_clip_bb=text_pixel_clip_bb.Clone(),close_button_pressed=!1,close_button_visible=!1;if(0!=closebuttonid&&(g.HoveredId!=close_button_sz&&g.HoveredId!=closebuttonid&&g.ActiveId!=closebuttonid||(close_button_visible=!0)),close_button_visible){let last_item_backup=new ItemHoveredDataBackup(this.guictx);close_button_sz=.5*g.FontSize;this.CloseButton(closebuttonid,new Vec2(bb.Max.x-framepadding.x-close_button_sz,bb.Min.y+framepadding.y+close_button_sz),close_button_sz)&&(close_button_pressed=!0),last_item_backup.Restore(),flags&TabItemFlags.NoCloseWithMiddleMouseButton||!this.IsMouseClicked(2)||(close_button_pressed=!0),text_pixel_clip_bb.Max.x-=2*close_button_sz}return maxwidth.x>text_ellipsis_clip_bb.GetWidth()&&(maxwidth=text_ellipsis_clip_bb.GetWidth()-5+1,g.Font.CalcTextSizeA(maxwidth,-1,label).x),this.renderTextClippedEx(drawlist,text_pixel_clip_bb.Min,text_pixel_clip_bb.Max,label,null),close_button_pressed},tabBarTabListPopupButton(tab_bar){var open=this.guictx;let win=open.CurrentWindow;var tab_list_popup_button_width=open.FontLineHeight+open.Style.FramePadding.y,backup_cursor_pos=win.DC.CursorPos;win.DC.CursorPos=new Vec2(tab_bar.BarRect.Min.x-open.Style.FramePadding.y,tab_bar.BarRect.Min.y),tab_bar.BarRect.Min.x+=tab_list_popup_button_width;let arrow_col=open.Style.Colors.Text;arrow_col.w*=0,this.PushStyleColor("Text",arrow_col),this.PushStyleColor("Button",Color.rgba(0,0,0,0));open=this.BeginCombo("##v",null,ComboFlags.NoPreview);this.PopStyleColor(2);let tab_to_select=null;if(open){for(let tab_n=0;tab_n<tab_bar.Tabs.length;tab_n++){var tab=tab_bar.Tabs[tab_n],tab_name=tab_bar.GetTabName(tab);this.Selectable(tab_name,tab_bar.SelectedTabId==tab.ID)&&(tab_to_select=tab)}this.EndCombo()}return win.DC.CursorPos=backup_cursor_pos,tab_to_select},tabBarScrollingButtons(tab_bar){let g=this.guictx,win=g.CurrentWindow;var arrow_button_size=new Vec2(g.FontSize-2,g.FontSize+2*g.Style.FramePadding.y),scrolling_buttons_width=2*arrow_button_size.x,backup_cursor_pos=win.DC.CursorPos.Clone();const avail_bar_rect=tab_bar.BarRect;var it=!avail_bar_rect.Contains(new Rect(win.DC.CursorPos,Vec2.AddXY(win.DC.CursorPos,scrolling_buttons_width,0)));it&&this.PushClipRect(tab_bar.BarRect.Min,Vec2.AddXY(tab_bar.BarRect.Max,g.Style.ItemInnerSpacing.x,0),!0);let tab_to_select=null,select_dir=0;const arrow_col=g.Style.Colors.Text;arrow_col.w*=.5,this.PushStyleColor("Text",arrow_col),this.PushStyleColor("Button",Colors.clear);var target_order=g.IO.KeyRepeatDelay,backup_repeat_rate=g.IO.KeyRepeatRate;return g.IO.KeyRepeatDelay=.25,g.IO.KeyRepeatRate=.2,win.DC.CursorPos=new Vec2(tab_bar.BarRect.Max.x-scrolling_buttons_width,tab_bar.BarRect.Min.y),this.ArrowButtonEx("##<",Dir.Left,arrow_button_size,ButtonFlags.PressedOnClick|ButtonFlags.Repeat)&&(select_dir=-1),win.DC.CursorPos=new Vec2(tab_bar.BarRect.Max.x-scrolling_buttons_width+arrow_button_size.x,tab_bar.BarRect.Min.y),this.ArrowButtonEx("##>",Dir.Right,arrow_button_size,ButtonFlags.PressedOnClick|ButtonFlags.Repeat)&&(select_dir=1),this.PopStyleColor(2),g.IO.KeyRepeatRate=backup_repeat_rate,g.IO.KeyRepeatDelay=target_order,it&&this.PopClipRect(),0==select_dir||(target_order=this.TabBarFindTabByID(tab_bar,tab_bar.SelectedTabId))&&(it=0<=(target_order=(it=tab_bar.GetTabOrder(target_order))+select_dir)&&target_order<tab_bar.Tabs.length?target_order:it,tab_to_select=tab_bar.Tabs[it]),win.DC.CursorPos=backup_cursor_pos,tab_bar.BarRect.Max.x-=1+scrolling_buttons_width,tab_to_select}};class ListClipper{constructor(imgui,items_count=-1,items_height=-1){console.assert(imgui),this.imgui=imgui,this.Begin(items_count,items_height)}Begin(out,items_height=-1){this.StartPosY=this.imgui.GetCursorPosY(),this.ItemsHeight=items_height,this.ItemsCount=out,this.StepNo=0,this.DisplayEnd=this.DisplayStart=-1,0<this.ItemsHeight&&(out=this.imgui.CalcListClipping(this.ItemsCount,this.ItemsHeight),this.DisplayStart=out[0],this.DisplayEnd=out[1],0<this.DisplayStart&&this.imgui.SetCursorPosYAndSetupDummyPrevLine(this.StartPosY+this.DisplayStart*this.ItemsHeight,this.ItemsHeight),this.StepNo=2)}End(){this.ItemsCount<0||(this.ItemsCount<Number.MAX_SAFE_INTEGER&&this.imgui.SetCursorPosYAndSetupDummyPrevLine(this.StartPosY+this.ItemsCount*this.ItemsHeight,this.ItemsHeight),this.ItemsCount=-1,this.StepNo=3)}Step(){if(0==this.ItemsCount||this.imgui.getCurrentWindowRead().SkipItems)return!(this.ItemsCount=-1);if(0==this.StepNo)return this.DisplayStart=0,this.DisplayEnd=1,this.StartPosY=this.imgui.GetCursorPosY(),this.StepNo=1,!0;if(1!=this.StepNo)return 2==this.StepNo?(console.assert(0<=this.DisplayStart&&0<=this.DisplayEnd),this.StepNo=3,!0):(3==this.StepNo&&this.End(),!1);if(1==this.ItemsCount)return!(this.ItemsCount=-1);var items_height=this.imgui.GetCursorPosY()-this.StartPosY;return console.assert(0<items_height),this.Begin(this.ItemsCount-1,items_height),this.DisplayStart++,this.DisplayEnd++,this.StepNo=3,!0}}var ImguiListboxMixin={CalcListClipping(items_count,items_height){var g=this.guictx;let win=g.CurrentWindow;if(g.LogEnabled)return[0,items_count];if(win.SkipItems)return[0,0];let unclipped_rect=win.ClipRect.Clone();g.NavMoveRequest&&unclipped_rect.Add(g.NavScoringRectScreen);var pos=win.DC.CursorPos;let start=Math.floor((unclipped_rect.Min.y-pos.y)/items_height),end=Math.floor((unclipped_rect.Max.y-pos.y)/items_height);return g.NavMoveRequest&&g.NavMoveClipDir==Dir.Up&&start--,g.NavMoveRequest&&g.NavMoveClipDir==Dir.Down&&end++,start=Vec1.Clamp(start,0,items_count),end=Vec1.Clamp(end+1,start,items_count),(isNaN(start)||isNaN(end))&&console.assert(0),[start,end]},ListBoxHeader(label,items_count,height_in_items_f){if(null!=items_count.x)return this.ListBoxHeaderEx(label,items_count);height_in_items_f<0&&(height_in_items_f=Math.min(items_count,7));var style=this.GetStyle(),height_in_items_f=height_in_items_f<items_count?height_in_items_f+.25:height_in_items_f+0;let size=new Vec2;return size.x=0,size.y=this.GetTextLineHeightWithSpacing()*height_in_items_f+2*style.FramePadding.y,this.ListBoxHeaderEx(label,size)},ListBoxHeaderEx(label,frame_size){let win=this.getCurrentWindow();if(win.SkipItems)return!1;var style=this.GetStyle(),id=this.GetID(label),label_size=this.CalcTextSize(label,!0),frame_size=this.calcItemSize(frame_size,this.getNextItemWidth(),7.4*this.GetTextLineHeightWithSpacing()+style.ItemSpacing.y),frame_size=new Vec2(frame_size.x,Math.max(frame_size.y,label_size.y));let frame_bb=new Rect(win.DC.CursorPos,Vec2.Add(win.DC.CursorPos,frame_size)),bb=new Rect(frame_bb.Min,Vec2.AddXY(frame_bb.Max,0<label_size.x?style.ItemInnerSpacing.x+label_size.x:0,0));return win.DC.LastItemRect=bb,this.IsRectVisible(bb.Min,bb.Max)?(this.BeginGroup(),0<label_size.x&&this.renderText(new Vec2(frame_bb.Max.x+style.ItemInnerSpacing.x,frame_bb.Min.y+style.FramePadding.y),label),this.BeginChildFrame(id,frame_bb.GetSize()),!0):(this.itemSize(bb.GetSize(),style.FramePadding.y),this.itemAdd(bb,0,frame_bb),!1)},ListBoxFooter(){let parent_window=this.getCurrentWindow().ParentWindow;const bb=parent_window.DC.LastItemRect;var style=this.GetStyle();this.EndChildFrame(),this.SameLine(),parent_window.DC.CursorPos=bb.Min.Clone(),this.itemSize(bb,style.FramePadding.y),this.EndGroup()},ListBox(label,current_item,items,height_items=-1,onChange){return this.ListBoxCB(label,current_item,function(i){return items[i]},items.length,height_items,onChange)},ListBoxCB(label,current_item,items_getter,items_count,height_in_items,onChange){var g=this.guictx;let value_changed=!1;if(this.ListBoxHeader(label,items_count,height_in_items)){let clipper=new ListClipper(this,items_count,this.GetTextLineHeightWithSpacing());for(;clipper.Step();)for(let i=clipper.DisplayStart;i<clipper.DisplayEnd;i++){var item_selected=i==current_item;let item_text=items_getter(i);null==item_text&&(item_text="*Unknown item*"),this.PushID(i),this.Selectable(item_text,item_selected)&&(current_item=i,value_changed=!0),item_selected&&this.SetItemDefaultFocus(),this.PopID()}this.ListBoxFooter()}return value_changed&&(onChange&&onChange(current_item),this.markItemEdited(g.CurrentWindow.DC.LastItemId)),value_changed}},SelectableFlags={None:0,DontClosePopups:1,SpanAllColumns:2,AllowDoubleClick:4,Disabled:8,NoHoldingActiveID:1024,PressedOnClick:2048,PressedOnRelease:4096,DrawFillAvailWidth:8192,AllowItemOverlap:16384},ImguiSelectableMixin={Selectable(label,col=!1,flags=0,spacing_R=Vec2.Zero(!1)){let win=this.getCurrentWindow();if(win.SkipItems)return!1;let g=this.guictx;const style=g.Style;flags&SelectableFlags.SpanAllColumns&&win.DC.CurrentColumns&&this.PopClipRect();var id=win.GetID(label),spacing_U=this.CalcTextSize(label,!0),spacing_L=new Vec2((0!=spacing_R.x?spacing_R:spacing_U).x,(0!=spacing_R.y?spacing_R:spacing_U).y);let pos=win.DC.CursorPos.Clone();pos.y+=win.DC.CurrentLineTextBaseOffset;var bb_inner=new Rect(pos,Vec2.Add(pos,spacing_L));this.itemSize(bb_inner);var spacing_D=win.WindowPadding.Clone(),max_x=(flags&SelectableFlags.SpanAllColumns?this.GetWindowContentRegionMax():this.GetContentRegionMax()).x,spacing_U=Math.max(spacing_U.x,win.Pos.x+max_x-spacing_D.x-pos.x),spacing_U=new Vec2(0==spacing_R.x||flags&SelectableFlags.DrawFillAvailWidth?spacing_U:spacing_R.x,(0!=spacing_R.y?spacing_R:spacing_L).y);let bb=new Rect(pos,Vec2.Add(pos,spacing_U));(0==spacing_R.x||flags&SelectableFlags.DrawFillAvailWidth)&&(bb.Max.x+=spacing_D.x);spacing_L=Math.floor(.5*style.ItemSpacing.x),spacing_U=Math.floor(.5*style.ItemSpacing.y),spacing_R=style.ItemSpacing.x-spacing_L,spacing_D=style.ItemSpacing.y-spacing_U;bb.Min.x-=spacing_L,bb.Min.y-=spacing_U,bb.Max.x+=spacing_R,bb.Max.y+=spacing_D;let item_add;if(flags&SelectableFlags.Disabled?(pressed=win.DC.ItemFlags,win.DC.ItemFlags|=ItemFlags.Disabled|ItemFlags.NoNavDefaultFocus,item_add=this.itemAdd(bb,id),win.DC.ItemFlags=pressed):item_add=this.itemAdd(bb,id),!item_add)return flags&SelectableFlags.SpanAllColumns&&win.DC.CurrentColumns&&this.pushColumnClipRect(),!1;let button_flags=0;flags&SelectableFlags.NoHoldingActiveID&&(button_flags|=ButtonFlags.NoHoldingActiveID),flags&SelectableFlags.PressedOnClick&&(button_flags|=ButtonFlags.PressedOnClick),flags&SelectableFlags.PressedOnRelease&&(button_flags|=ButtonFlags.PressedOnRelease),flags&SelectableFlags.Disabled&&(button_flags|=ButtonFlags.Disabled),flags&SelectableFlags.AllowDoubleClick&&(button_flags|=ButtonFlags.PressedOnClickRelease|ButtonFlags.PressedOnDoubleClick),flags&SelectableFlags.AllowItemOverlap&&(button_flags|=ButtonFlags.AllowItemOverlap),flags&SelectableFlags.Disabled&&(col=!1);let hovered=new ValRef,held=new ValRef;var pressed=this.ButtonBehavior(bb,id,hovered,held,button_flags);return(pressed||hovered.get())&&(g.NavDisableMouseHover||g.NavWindow!=win||g.NavLayer!=win.DC.NavLayerCurrent||(g.NavDisableHighlight=!0,this.setNavID(id,win.DC.NavLayerCurrent))),pressed&&this.markItemEdited(id),flags&SelectableFlags.AllowItemOverlap&&this.SetItemAllowOverlap(),(hovered.get()||col)&&(col=style.GetColor(held.get()&&hovered.get()?"HeaderActive":hovered.get()?"HeaderHovered":"Header"),this.renderFrame(bb.Min,bb.Max,col,!1,0),this.renderNavHighlight(bb,id,NavHighlightFlags.TypeThin|NavHighlightFlags.NoRounding)),flags&SelectableFlags.SpanAllColumns&&win.DC.CurrentColumns&&(this.pushColumnClipRect(),bb.Max.x-=this.GetContentRegionMax().x-max_x),flags&SelectableFlags.Disabled&&this.PushStyleColor("Text",g.Style.GetColor("TextDisabled")),this.renderTextClipped(bb_inner.Min,bb_inner.Max,label,null,style.SelectableTextAlign,bb),flags&SelectableFlags.Disabled&&this.PopStyleColor(),!(pressed&&win.Flags&WindowFlags.Popup)||flags&SelectableFlags.DontClosePopups||win.DC.ItemFlags&ItemFlags.SelectableDontClosePopup||this.CloseCurrentPopup(),pressed}},ImguiTooltipMixin={Tooltip(str,maxchars=20){this.SameLine(),this.TextDisabled("?"),this.IsItemHovered()&&(this.BeginTooltip(),this.PushTextWrapPos(this.GetFontSize()*maxchars),this.TextUnformatted(str),this.PopTextWrapPos(),this.EndTooltip())},BeginTooltip(){var tooltip_pos,g=this.guictx;g.DragDropWithinSourceOrTarget?(tooltip_pos=Vec2.AddXY(g.IO.MousePos,16*g.Style.MouseCursorScale,8*g.Style.MouseCursorScale),this.SetNextWindowPos(tooltip_pos),this.SetNextWindowBgAlpha(.6*g.Style.Colors.PopupBg.a),this.beginTooltipEx(0,!0)):this.beginTooltipEx(0,!1)},EndTooltip(){console.assert(this.getCurrentWindowRead().Flags&WindowFlags.Tooltip,"Mismatched BeginTooltip()/EndTooltip() calls"),this.End()},SetTooltip(txt,...args){this.guictx.DragDropWithinSourceOrTarget?this.BeginTooltip():this.beginTooltipEx(0,!0),this.TextV(txt,args),this.EndTooltip()},beginTooltipEx(extra_flags,flags=!0){let g=this.guictx,window_name="##Tooltip_"+g.TooltipOverrideCount;if(flags){let win=this.findWindowByName(window_name);win&&win.Active&&(win.Hidden=!0,win.HiddenFramesCanSkipItems=1,window_name="##Tooltip_"+ ++g.TooltipOverrideCount)}flags=WindowFlags.Tooltip|WindowFlags.NoInputs|WindowFlags.NoTitleBar|WindowFlags.NoMove|WindowFlags.NoResize|WindowFlags.NoSavedSettings|WindowFlags.AlwaysAutoResize;this.Begin(window_name,null,flags|extra_flags)}},SliderFlags={None:0,Vertical:1};const SliderFFmt="%0.2f",SliderIFmt="%d";var ImguiSliderMixin={SliderFloat(label,v,v_min,v_max,format=null,power=1,onChange=null){return null==format&&(format=SliderFFmt),this.SliderScalar(label,v,v_min,v_max,format,power,onChange)},SliderFloat2(label,v,v_min,v_max,format=null,power=1,onChange=null){return null==format&&(format=SliderFFmt),this.SliderScalarN(label,2,v,v_min,v_max,format,power,onChange)},SliderFloat3(label,v,v_min,v_max,format=null,power=1,onChange=null){return null==format&&(format=SliderFFmt),this.SliderScalarN(label,3,v,v_min,v_max,format,power,onChange)},SliderFloat4(label,v,v_min,v_max,format=null,power=1,onChange=null){return null==format&&(format=SliderFFmt),this.SliderScalarN(label,4,v,v_min,v_max,format,power,onChange)},SliderAngle(label,v_rad,v_degrees_min,v_degrees_max,format=null,onChange){null==format&&(format=SliderIFmt);var v_deg=360*v_rad/(2*Math.PI);return this.SliderFloat(label,v_deg,v_degrees_min,v_degrees_max,format,1,function(deg){v_rad=2*deg*Math.PI/360,onChange&&onChange(v_rad)})},SliderInt(label,v,v_min,v_max,format=null,onChange=null){return null==format&&(format=SliderIFmt),this.SliderScalar(label,v,v_min,v_max,format,1,onChange)},SliderInt2(label,v,v_min,v_max,format=null,onChange=null){return null==format&&(format=SliderIFmt),this.SliderScalarN(label,2,v,v_min,v_max,format,1,onChange)},SliderInt3(label,v,v_min,v_max,format=null,onChange=null){return null==format&&(format=SliderIFmt),this.SliderScalarN(label,3,v,v_min,v_max,format,1,onChange)},SliderInt4(label,v,v_min,v_max,format=null,onChange=null){return null==format&&(format=SliderIFmt),this.SliderScalarN(label,4,v,v_min,v_max,format,1,onChange)},SliderScalar(label,v,v_min,v_max,format,value_changed=1,onChange=null){let win=this.getCurrentWindow();if(win.SkipItems)return!1;let g=this.guictx;const style=g.Style;var id=win.GetID(label),grab_bb=this.CalcItemWidth(),label_size=this.CalcTextSize(label,!0),frame_bb=new Rect(win.DC.CursorPos,Vec2.AddXY(win.DC.CursorPos,grab_bb,label_size.y+2*style.FramePadding.y)),hovered=new Rect(frame_bb.Min,Vec2.AddXY(frame_bb.Max,0<label_size.x?style.ItemInnerSpacing.x+label_size.x:0,0));if(this.itemSize(hovered,style.FramePadding.y),!this.itemAdd(hovered,id,frame_bb))return!1;let start_text_input=!1;grab_bb=this.focusableItemRegister(win,id),hovered=this.itemHoverable(frame_bb,id);if((grab_bb||hovered&&g.IO.MouseClicked[0]||g.NavActivateId==id||g.NavInputId==id&&g.ScalarAsInputTextId!=id)&&(this.setActiveID(id,win),this.setFocusID(id,win),this.FocusWindow(win),g.ActiveIdAllowNavDirFlags=1<<Dir.Up|1<<Dir.Down,(grab_bb||g.IO.KeyCtrl||g.NavInputId==id)&&(start_text_input=!0,g.ScalarAsInputTextId=0)),start_text_input||g.ActiveId==id&&g.ScalarAsInputTextId==id)return win.DC.CursorPos=frame_bb.Min,this.focusableItemUnregister(win),this.inputScalarAsWidgetReplacement(frame_bb,id,label,v,format,onChange);grab_bb=style.GetColor(g.ActiveId==id?"FrameBgActive":g.HoveredId==id?"FrameBgHovered":"FrameBg");this.renderNavHighlight(frame_bb,id),this.renderFrame(frame_bb.Min,frame_bb.Max,grab_bb,!0,g.Style.FrameRounding);grab_bb=new Rect;let valstr=FormatValues(format,[v]);value_changed=this.sliderBehavior(frame_bb,id,v,v_min,v_max,format,value_changed,SliderFlags.None,grab_bb,function(newVal){valstr=FormatValues(format,[newVal]),onChange&&onChange(newVal)});return value_changed&&this.markItemEdited(id),win.DrawList.AddRectFilled(grab_bb.Min,grab_bb.Max,style.GetColor(g.ActiveId==id?"SliderGrabActive":"SliderGrab"),style.GrabRounding),this.renderTextClipped(frame_bb.Min,frame_bb.Max,valstr,null,new Vec2(.5,.5)),0<label_size.x&&this.renderText(new Vec2(frame_bb.Max.x+style.ItemInnerSpacing.x,frame_bb.Min.y+style.FramePadding.y),label),value_changed},SliderScalarN(label,components,v,v_min,v_max,format,power=1,onChange=null){let saveV=null;if(Array.isArray(v)||(null!=v.x&&(saveV=v,v=[saveV.x]),null!=saveV.y&&v.push(saveV.y),null!=saveV.z&&v.push(saveV.z),null!=saveV.a&&v.push(saveV.a)),console.assert(v.length>=components),this.getCurrentWindow().SkipItems)return!1;var g=this.guictx;let value_changed=!1;this.BeginGroup(),this.PushID(label),this.pushMultiItemsWidths(components);for(let i=0;i<components;i++)this.PushID(i),value_changed|=this.SliderScalar("",v[i],v_min,v_max,format,power,newVal=>v[i]=newVal),this.SameLine(0,g.Style.ItemInnerSpacing.x),this.PopID(),this.PopItemWidth();return this.PopID(),this.textEx(label),this.EndGroup(),value_changed&&(null!=saveV&&(saveV.x=v[0],null!=saveV.y&&(saveV.y=v[1]),null!=saveV.z&&(saveV.z=v[2]),null!=saveV.a&&(saveV.a=v[3])),onChange&&onChange(v)),value_changed},VSliderFloat(label,size,v,v_min,v_max,format=null,power=1,onChange=null){null==format&&(format=SliderFFmt),this.VSliderScalar(label,size,v,v_min,v_max,format,power,onChange)},VSliderInt(label,size,v,v_min,v_max,format=null,onChange=null){null==format&&(format=SliderIFmt),this.VSliderScalar(label,size,v,v_min,v_max,format,1,onChange)},VSliderScalar(label,grab_bb,v,v_min,v_max,format,value_changed,onChange){let win=this.getCurrentWindow();if(win.SkipItems)return!1;let g=this.guictx;const style=g.Style;var id=win.GetID(label),label_size=this.CalcTextSize(label,!0),frame_bb=new Rect(win.DC.CursorPos,Vec2.Add(win.DC.CursorPos,grab_bb)),grab_bb=new Rect(frame_bb.Min,Vec2.AddXY(frame_bb.Max,0<label_size.x?style.ItemInnerSpacing.x+label_size.x:0,0));if(this.itemSize(grab_bb,style.FramePadding.y),!this.itemAdd(frame_bb,id))return!1;(this.itemHoverable(frame_bb,id)&&g.IO.MouseClicked[0]||g.NavActivateId==id||g.NavInputId==id)&&(this.setActiveID(id,win),this.setFocusID(id,win),this.FocusWindow(win),g.ActiveIdAllowNavDirFlags=1<<Dir.Left|1<<Dir.Right);grab_bb=style.GetColor(g.ActiveId==id?"FrameBgActive":g.HoveredId==id?"FrameBgHovered":"FrameBg");this.renderNavHighlight(frame_bb,id),this.renderFrame(frame_bb.Min,frame_bb.Max,grab_bb,!0,g.Style.FrameRounding);grab_bb=new Rect;let valstr=FormatValues(format,[v]);value_changed=this.sliderBehavior(frame_bb,id,v,v_min,v_max,format,value_changed,SliderFlags.Vertical,grab_bb,function(newval){valstr=FormatValues(format,[newval]),onChange&&onChange(newval)});return value_changed&&this.markItemEdited(id),grab_bb.Max.y>grab_bb.Min.y&&win.DrawList.AddRectFilled(grab_bb.Min,grab_bb.Max,style.GetColor(g.ActiveId==id?"SliderGrabActive":"SliderGrab"),style.GrabRounding),this.renderTextClipped(new Vec2(frame_bb.Min.x,frame_bb.Min.y+style.FramePadding.y),frame_bb.Max,valstr,null,new Vec2(.5,0)),0<label_size.x&&this.renderText(new Vec2(frame_bb.Max.x+style.ItemInnerSpacing.x,frame_bb.Min.y+style.FramePadding.y),label),value_changed},sliderBehavior(bb,id,v,v_min,v_max,format,power,delta2,out_grab_bb,onChange=null){var g=this.guictx,slider_usable_pos_min=g.Style;console.assert("number"==typeof v);var precision=ParseFormatPrecision(format),axis=delta2&SliderFlags.Vertical?"y":"x",is_decimal=0!=precision,v_new_off_round=1!=power&&is_decimal,grab_pos=bb.Max[axis]-bb.Min[axis]-4;let grab_sz=slider_usable_pos_min.GrabMinSize;var v_range=v_min<v_max?v_max-v_min:v_min-v_max;!is_decimal&&0<=v_range&&(grab_sz=Math.max(grab_pos/(1+v_range),slider_usable_pos_min.GrabMinSize)),grab_sz=Math.min(grab_sz,grab_pos);var mouse_abs_pos,delta2=grab_pos-grab_sz,slider_usable_pos_min=bb.Min[axis]+2+.5*grab_sz,grab_pos=bb.Max[axis]-2-.5*grab_sz;let linear_zero_pos;linear_zero_pos=v_new_off_round&&v_min*v_max<0?(mouse_abs_pos=Math.pow(0<=v_min?v_min:-v_min,1/power))/(mouse_abs_pos+Math.pow(0<=v_max?v_max:-v_max,1/power)):v_min<0?1:0;let value_changed=!1;if(g.ActiveId==id){let set_new_value=!1,clicked_t=0;if(g.ActiveIdSource==InputSource.Mouse)g.IO.MouseDown[0]?(mouse_abs_pos=g.IO.MousePos[axis],clicked_t=0<delta2?Vec1.Clamp((mouse_abs_pos-slider_usable_pos_min)/delta2,0,1):0,"y"==axis&&(clicked_t=1-clicked_t),set_new_value=!0):this.clearActiveID();else if(g.ActiveIdSource==InputSource.Nav){delta2=this.getNavInputAmount2d(NavDirSourceFlags.Keyboard|NavDirSourceFlags.PadDPad,InputReadMode.RepeatFast,0,0);let delta=axis==Axis.X?delta2.x:-delta2.y;g.NavActivatePressedId!=id||g.ActiveIdIsJustActivated?0!=delta&&(clicked_t=this.sliderCalcRatioFromValue(v,v_min,v_max,power,linear_zero_pos),0<ParseFormatPrecision(format)||v_new_off_round?(delta/=100,this.isNavInputDown(NavInput.TweakSlow)&&(delta/=10)):-100<=v_range&&v_range<=100||this.isNavInputDown(NavInput.TweakSlow)?delta=(delta<0?-1:1)/v_range:delta/=100,this.isNavInputDown(NavInput.TweakFast)&&(delta*=10),set_new_value=!0,1<=clicked_t&&0<delta||clicked_t<=0&&delta<0?set_new_value=!1:clicked_t=Vec1.Saturate(clicked_t+delta)):this.clearActiveID()}if(set_new_value){let v_new;if(v_new_off_round)if(clicked_t<linear_zero_pos){var v_new_off_floor=1-clicked_t/linear_zero_pos,v_new_off_floor=Math.pow(v_new_off_floor,power);v_new=Vec1.Lerp(Math.min(v_max,0),v_min,v_new_off_floor)}else{let a;a=1e-6<Math.abs(linear_zero_pos-1)?(clicked_t-linear_zero_pos)/(1-linear_zero_pos):clicked_t,a=Math.pow(a,power),v_new=Vec1.Lerp(Math.max(v_min,0),v_max,a)}else v_new=is_decimal?Vec1.Lerp(v_min,v_max,clicked_t):(v_new_off_round=(v_max-v_min)*clicked_t,v_new_off_floor=Math.floor(v_new_off_round),v_new_off_round=Math.round(v_new_off_round),!is_decimal&&v_new_off_floor<v_new_off_round?v_min+v_new_off_round:v_min+v_new_off_floor);v_new=RoundScalarToPrecision(v_new,precision),v!=v_new&&(v=v_new,value_changed=!0)}}let grab_t=this.sliderCalcRatioFromValue(v,v_min,v_max,power,linear_zero_pos);"y"==axis&&(grab_t=1-grab_t);grab_pos=Vec1.Lerp(slider_usable_pos_min,grab_pos,grab_t);if(null!=out_grab_bb){let min,max;max="x"==axis?(min=new Vec2(grab_pos-.5*grab_sz,bb.Min.y+2),new Vec2(grab_pos+.5*grab_sz,bb.Max.y-2)):(min=new Vec2(bb.Min.x+2,grab_pos-.5*grab_sz),new Vec2(bb.Max.x-2,grab_pos+.5*grab_sz)),out_grab_bb.Min=min,out_grab_bb.Max=max}return value_changed&&onChange&&onChange(v),value_changed},sliderCalcRatioFromValue(v_clamped,v_min,v_max,power,linear_zero_pos){if(v_min==v_max)return 0;var f=1!=power,v_clamped=v_min<v_max?Vec1.Clamp(v_clamped,v_min,v_max):Vec1.Clamp(v_clamped,v_max,v_min);if(f){if(v_clamped<0){f=1-(v_clamped-v_min)/(Math.min(0,v_max)-v_min);return(1-Math.pow(f,1/power))*linear_zero_pos}{const f=(v_clamped-Math.max(0,v_min))/(v_max-Math.max(0,v_min));return linear_zero_pos+Math.pow(f,1/power)*(1-linear_zero_pos)}}return(v_clamped-v_min)/(v_max-v_min)}},TextFlags={None:0,CharsDecimal:1,CharsHexadecimal:2,CharsUppercase:4,CharsNoBlank:8,AutoSelectAll:16,EnterReturnsTrue:32,CallbackCompletion:64,CallbackHistory:128,CallbackAlways:256,CallbackCharFilter:512,AllowTabInput:1024,CtrlEnterForNewLine:2048,NoHorizontalScroll:4096,AlwaysInsertMode:8192,ReadOnly:16384,Password:32768,NoUndoRedo:65536,CharsScientific:1<<17,CallbackResize:1<<18,AsHyperText:1<<19,UseLabelWidth:1<<20,Multiline:1<<21};class TextFilter{constructor(imgui,defaultFilter=""){this.imgui=imgui,this.filter=new MutableString(defaultFilter),this.regexp=null,this.regexpErr=null}Set(f){this.filter.Set(f),this.updateRegexp()}Get(){return this.filter.Get()}Draw(label="Filter",width=0,value_changed=0){0!=width&&this.imgui.PushItemWidth(width);value_changed=this.imgui.InputText(label,this.filter,value_changed);if(0!=width&&this.imgui.PopItemWidth(),value_changed&&this.updateRegexp(),this.regexpErr){const style=this.imgui.guictx.Style;this.imgui.SameLine(),this.imgui.PushFont(style.GetFont("Small")),this.imgui.TextColored(style.GetColor("TextError"),this.regexpErr),this.imgui.PopFont()}return value_changed}updateRegexp(){try{var r=new RegExp(this.filter.toString());this.regexp=r,this.regexpErr=null}catch(err){this.regexpErr=err.message}}IsActive(){return 0<this.filter.Length()}PassFilter(input){if(0<this.filter.Length()&&this.regexp){if(input){if(!Array.isArray(input))return this.regexp.test(input);for(var str of input)if(this.regexp.test(str))return!0}else if("<undefined>"==this.filter.Get()||"<unknown>"==this.filter.Get())return!0;return!1}return!0}Clear(){this.filter.Set("")}}var ImguiTextMixin={GetTextLineHeight(){return this.guictx.FontLineHeight},GetTextLineHeightWithSpacing(){return this.guictx.FontLineHeight+this.guictx.Style.ItemSpacing.y},HyperMenu(txt,flags=0){var fields=txt.split("##");return txt=fields[0]+" "+this.guictx.Style._UIcons.SmallDownArrow,2==fields.length&&(txt+="##"+fields[1]),this.HyperText(txt,flags)},HyperText(txt,txtflags=0,buttonflags=0){return this.textEx(txt,txtflags|TextFlags.NoWidthForLargeClippedText|TextFlags.AsHyperText,buttonflags)},TextUnformatted(txt,flags=0){this.textEx(txt,flags|TextFlags.NoWidthForLargeClippedText)},Text(fmt,...args){return this.TextV(fmt,args)},TextV(fmt,str){if(this.getCurrentWindow().SkipItems)return!1;str=this.formatText(fmt,str);return this.textEx(str,TextFlags.NoWidthForLargeClippedText)},TextColored(col,fmt,...args){return this.TextColoredV(col,fmt,args)},TextColoredV(col,fmt,ret){this.PushStyleColor("Text",col);ret=this.TextV(fmt,ret);return this.PopStyleColor(),ret},TextDisabled(fmt,...args){return this.TextDisabledV(fmt,args)},TextDisabledV(fmt,ret){this.PushStyleColor("Text",this.guictx.Style.Colors.TextDisabled);ret=this.TextV(fmt,ret);return this.PopStyleColor(),ret},TextEmphasized(fmt,...args){return this.TextEmphasizedV(fmt,args)},TextEmphasizedV(fmt,ret){this.PushStyleColor("Text",this.guictx.Style.Colors.TextEmphasized);ret=this.TextV(fmt,ret);return this.PopStyleColor(),ret},TextWrapped(fmt,...args){return this.TextWrappedV(fmt,args)},TextWrappedV(fmt,ret){var need_backup=this.guictx.CurrentWindow.DC.TextWrapPos<0;need_backup&&this.PushTextWrapPos(0);ret=this.TextV(fmt,ret);return need_backup&&this.PopTextWrapPos(),ret},LabelDisabled(label,txtflags=TextFlags.UseLabelWidth){this.PushStyleColor("Text",this.guictx.Style.Colors.TextDisabled),this.Label(label,txtflags),this.PopStyleColor()},Label(label,key=TextFlags.UseLabelWidth){var labelBB=this.getCurrentWindow();if(!labelBB.SkipItems){let g=this.guictx;var tpos=g.Style;let mtext=label;key&TextFlags.UseLabelWidth&&(mtext=tpos.LabelWidth);key=mtext+g.Font.AsStr();this.labelSizeCache||(this.labelSizeCache={});let labelSize=this.labelSizeCache[key];labelSize||(labelSize=this.CalcTextSize(mtext,!1),this.labelSizeCache[key]=labelSize);labelBB=new Rect(labelBB.DC.CursorPos,Vec2.AddXY(labelBB.DC.CursorPos,labelSize.x+tpos.FramePadding.x,labelSize.y+2*tpos.FramePadding.y));this.itemSize(labelBB,tpos.FramePadding.y),this.itemAdd(labelBB,0)&&(tpos=new Vec2(labelBB.Min.x,labelBB.Min.y+tpos.FramePadding.y),this.renderText(tpos,label))}},LabelText(label,fmt,...args){this.LabelTextV(label,fmt,args)},LabelTextV(label,fmt,valueTxt){var style,label_size,value_bb,total_bb,win=this.getCurrentWindow();win.SkipItems||(style=this.guictx.Style,total_bb=this.CalcItemWidth(),label_size=this.CalcTextSize(label,!0),value_bb=new Rect(win.DC.CursorPos,Vec2.AddXY(win.DC.CursorPos,total_bb,label_size.y+2*style.FramePadding.y)),total_bb=new Rect(win.DC.CursorPos,Vec2.Add(Vec2.AddXY(win.DC.CursorPos,total_bb+(0<label_size.x?style.ItemInnerSpacing.x:0),2*style.FramePadding.y),label_size)),this.itemSize(total_bb,style.FramePadding.y),this.itemAdd(total_bb,0)&&(fmt&&(valueTxt=this.formatText(fmt,valueTxt),this.renderTextClipped(value_bb.Min,value_bb.Max,valueTxt,null,new Vec2(0,.5))),0<label_size.x&&this.renderText(new Vec2(value_bb.Max.x+style.ItemInnerSpacing.x,value_bb.Min.y+style.FramePadding.y),label)))},BulletText(fmt,...args){this.BulletTextV(fmt,args)},BulletTextV(text_base_offset_y,line_height){var g,style,text,bb,win=this.getCurrentWindow();win.SkipItems||(style=(g=this.guictx).Style,text=this.formatText(text_base_offset_y,line_height),bb=this.CalcTextSize(text,!1),text_base_offset_y=Math.max(0,win.DC.CurrentLineTextBaseOffset),line_height=Math.max(Math.min(win.DC.CurrentLineHeight,g.FontLineHeight+2*g.Style.FramePadding.y),g.FontSize),bb=new Rect(win.DC.CursorPos,Vec2.AddXY(win.DC.CursorPos,g.FontSize+(0<bb.x?bb.x+2*style.FramePadding.x:0),Math.max(line_height,bb.y))),this.itemSize(bb),this.itemAdd(bb,0)&&(this.renderBullet(Vec2.AddXY(bb.Min,style.FramePadding.x+.5*g.FontSize,.5*g.FontSize)),this.renderText(Vec2.AddXY(bb.Min,g.FontSize+2*style.FramePadding.x,text_base_offset_y),text,!1)))},textEx(txt,flags,stylenm=0){let win=this.getCurrentWindow();if(win.SkipItems)return!1;let id;flags&TextFlags.AsHyperText&&(id=win.GetID(txt),txt=txt.split("##")[0]);let ret=!1;var bb=new Vec2(win.DC.CursorPos.x,win.DC.CursorPos.y+win.DC.CurrentLineTextBaseOffset),text_size=win.DC.TextWrapPos,wrap_width=!(flags&TextFlags.NoWidthForLargeClippedText)&&0<=text_size;if(2e3<txt.length&&!wrap_width)console.assert(0,"long text not implemented");else{let style=this.GetStyle();wrap_width=wrap_width?this.calcWrapWidthForPos(win.DC.CursorPos,text_size):0;let stxt=txt;flags&TextFlags.UseLabelWidth&&(stxt=style.LabelWidth);text_size=this.CalcTextSize(stxt,!1,wrap_width),bb=new Rect(bb,Vec2.Add(bb,text_size));if(this.itemSize(text_size),!this.itemAdd(bb,0))return ret;if(flags&TextFlags.AsHyperText){let hovered=new ValRef,held=new ValRef;win.DC.ItemFlags&ItemFlags.ButtonRepeat&&(stylenm|=ButtonFlags.Repeat),ret=this.ButtonBehavior(bb,id,hovered,held,stylenm),ret&&this.markItemEdited(id);stylenm=stylenm&ButtonFlags.Disabled?"TextDisabled":held.get()?"LinkActive":hovered.get()?"LinkHovered":"Link";this.PushStyleColor("Text",style.GetColor(stylenm))}this.renderTextWrapped(bb.Min,txt,wrap_width),flags&TextFlags.AsHyperText&&this.PopStyleColor()}return ret},formatNumber(n,radix=10,pad=0,pad_char="0"){return 0<pad?(pad_char.repeat(pad)+n.toString(radix)).substr(-pad):n.toString(radix)},formatNumberDec(n,pad=0,pad_char="0"){return this.formatNumber(n,10,pad,pad_char)},formatNumberHex(n,pad,pad_char="0"){return this.formatNumber(n,16,pad,pad_char)},formatText(fmt,args){return FormatValues(fmt,args)}},ColorEditFlags={None:0,NoAlpha:2,NoPicker:4,NoOptions:8,NoSmallPreview:16,NoInputs:32,NoTooltip:64,NoLabel:128,NoSidePreview:256,NoDragDrop:512,AlphaBar:65536,AlphaPreview:1<<17,AlphaPreviewHalf:1<<18,HDR:1<<19,DisplayRGB:1<<20,DisplayHSV:1<<21,DisplayHex:1<<22,Uint8:1<<23,Float:1<<24,PickerHueBar:1<<25,PickerHueWheel:1<<26,InputRGB:1<<27,InputHSV:1<<28};f=ColorEditFlags,f.OptionsDefault=f.Uint8|f.DisplayRGB|f.InputRGB|f.PickerHueBar,f.DisplayMask=f.DisplayRGB|f.DisplayHSV|f.DisplayHex,f.DataTypeMask=f.Uint8|f.Float,f.PickerMask=f.PickerHueWheel|f.PickerHueBar,f.InputMask=f.InputRGB|f.InputHSV;var ImguiColorEditMixin={ColorEdit3(label,col,flags=ColorEditFlags.DisplayRGB){return this.ColorEdit4(label,col,flags|ColorEditFlags.NoAlpha)},ColorEdit4(label,col,flags){let win=this.getCurrentWindow();if(win.SkipItems)return!1;let g=this.guictx;var style=g.Style,square_sz=this.GetFrameHeight(),w_item_one=flags&ColorEditFlags.NoSmallPreview?0:square_sz+style.ItemInnerSpacing.x,w_items_all=this.CalcItemWidth()-w_item_one;this.BeginGroup(),this.PushID(label),label=label.split("##")[0];var picker_flags=flags;(flags=flags&ColorEditFlags.NoInputs?flags&~ColorEditFlags.DisplayMask|ColorEditFlags.DisplayRGB|ColorEditFlags.NoOptions:flags)&ColorEditFlags.NoOptions||this.colorEditOptionsPopup(col,flags),flags&ColorEditFlags.DisplayMask||(flags|=g.ColorEditOptions&ColorEditFlags.DisplayMask),flags&ColorEditFlags.DataTypeMask||(flags|=g.ColorEditOptions&ColorEditFlags.DataTypeMask),flags&ColorEditFlags.PickerMask||(flags|=g.ColorEditOptions&ColorEditFlags.PickerMask),flags&ColorEditFlags.InputMask||(flags|=g.ColorEditOptions&ColorEditFlags.InputMask);var col_v4,c2=0==((flags|=g.ColorEditOptions&~(ColorEditFlags.DisplayMask|ColorEditFlags.DataTypeMask|ColorEditFlags.PickerMask|ColorEditFlags.InputMask))&ColorEditFlags.NoAlpha),hdr=0!=(flags&ColorEditFlags.HDR),components=c2?4:3;let cedit;flags&(ColorEditFlags.DisplayRGB|ColorEditFlags.DisplayHex)?cedit=col.AsRGB(1,!0):flags&ColorEditFlags.DisplayHSV?cedit=col.AsHSV():console.assert(0,"Unimplemented color space for disply"),c2||(cedit=cedit.AsOpaque());let ca=cedit.AsArray(),ica=cedit.AsIArray(),value_changed=!1,value_changed_as_float=!1;if(0!=(flags&(ColorEditFlags.DisplayRGB|ColorEditFlags.DisplayHSV))&&0==(flags&ColorEditFlags.NoInputs)){var w_item_one=Math.max(1,Math.floor((w_items_all-style.ItemInnerSpacing.x*(components-1))/components)),w_item_last=Math.max(1,Math.floor(w_items_all-(w_item_one+style.ItemInnerSpacing.x)*(components-1))),ids=["##X","##Y","##Z","##W"],fmt_table_int=[["%3d","%3d","%3d","%3d"],["R:%3d","G:%3d","B:%3d","A:%3d"],["H:%3d","S:%3d","V:%3d","A:%3d"]],fmt_table_float=[["%0.3f","%0.3f","%0.3f","%0.3f"],["R:%0.3f","G:%0.3f","B:%0.3f","A:%0.3f"],["H:%0.3f","S:%0.3f","V:%0.3f","A:%0.3f"]],fmt_idx=w_item_one<=this.CalcTextSize(flags&ColorEditFlags.Float?"M:0.000":"M:000").x?0:flags&ColorEditFlags.DisplayHSV?2:1;this.PushItemWidth(w_item_one);for(let n=0;n<components;n++)0<n&&this.SameLine(0,style.ItemInnerSpacing.x),n+1==components&&this.PushItemWidth(w_item_last),flags&ColorEditFlags.Float?(value_changed|=this.DragFloat(ids[n],ca[n],1/255,0,hdr?0:1,fmt_table_float[fmt_idx][n],function(newval){ca[n]=newval}),value_changed_as_float|=value_changed):value_changed|=this.DragInt(ids[n],ica[n],1,0,hdr?0:255,fmt_table_int[fmt_idx][n],function(newval){ica[n]=newval}),flags&ColorEditFlags.NoOptions||this.OpenPopupOnItemClick("context");this.PopItemWidth(),this.PopItemWidth()}else 0!=(flags&ColorEditFlags.DisplayHex)&&0==(flags&ColorEditFlags.NoInputs)&&(col_v4=cedit.AsHashStr(!c2),this.PushItemWidth(w_items_all),this.InputText("##Text",col_v4,InputTextFlags.CharsHexadecimal|InputTextFlags.CharsUppercase,newval=>{value_changed=!0;let k=ica[0]=ica[1]=ica[2]=ica[3]=0;for(let j=1;j<newval.length;j+=2)ica[k++]=parseInt(newval.slice(j,j+2),16)}),flags&ColorEditFlags.NoOptions||this.OpenPopupOnItemClick("context"),this.PopItemWidth());let picker_active_window=null;if(flags&ColorEditFlags.NoSmallPreview||(flags&ColorEditFlags.NoInputs||this.SameLine(0,style.ItemInnerSpacing.x),col_v4=Color.FromArray(ca,c2),this.ColorButton("##ColorButton",col_v4,flags)&&(flags&ColorEditFlags.NoPicker||(g.ColorPickerRef=col_v4,this.OpenPopup("picker"),this.SetNextWindowPos(Vec2.AddXY(win.DC.LastItemRect.GetBL(),-1,style.ItemSpacing.y)))),flags&ColorEditFlags.NoOptions||this.OpenPopupOnItemClick("context"),this.BeginPopup("picker")&&(picker_active_window=g.CurrentWindow,0<label.length&&(this.textEx(label),this.Spacing()),picker_flags=picker_flags&(ColorEditFlags.DataTypeMask|ColorEditFlags.PickerMask|ColorEditFlags.InputMask|ColorEditFlags.DIsplayRGB|ColorEditFlags.DIsplayHSV|ColorEditFlags.HDR|ColorEditFlags.NoAlpha|ColorEditFlags.AlphaBar)|ColorEditFlags.NoLabel|ColorEditFlags.AlphaPreviewHalf,this.PushItemWidth(12*square_sz),value_changed|=this.ColorPicker4("##picker",col,picker_flags,g.ColorPickerRef),this.PopItemWidth(),this.EndPopup())),0<label.length&&!(flags&ColorEditFlags.NoLabel)&&(this.SameLine(0,style.ItemInnerSpacing.x),this.textEx(label)),value_changed&&null==picker_active_window){if(!value_changed_as_float)for(let n=0;n<4;n++)ca[n]=ica[n]/255;if(flags&ColorEditFlags.DisplayHSV&&flags&ColorEditFlags.InputRGB){let cc=Color.hsva(ca[0],ca[1],ca[2],ca[3]),cr=cc.AsRGB();ca=cr.AsArray()}if(flags&ColorEditFlags.DisplayRGB&&flags&ColorEditFlags.InputHSV){let cc=Color.rgba(ca[0],ca[1],ca[2],ca[3]),cr=cc.AsHSV();ca=cr.AsArray()}col.x=ca[0],col.y=ca[1],col.z=ca[2],c2&&(col.a=ca[3]),col.Dirty()}if(this.PopID(),this.EndGroup(),win.DC.LastItemStatusFlags&ItemStatusFlags.HoveredRect&&!(flags&ColorEditFlags.NoDragDrop)&&this.BeginDragDropTarget()){let accepted_drag_drop=!1,payload=this.AcceptDragDropPayload(DragPayloads.COLOR_3F);payload&&(col.Copy(payload.Data),value_changed=accepted_drag_drop=!0),payload=this.AcceptDragDropPayload(DragPayloads.COLOR_4F),payload&&(col.Copy(payload.Data),value_changed=accepted_drag_drop=!0),accepted_drag_drop&&flags&ColorEditFlags.InputHSV&&(c2=col.AsHSV(),col.Copy(c2)),this.EndDragDropTarget()}return picker_active_window&&0!=g.ActiveId&&g.ActiveIdWindow==picker_active_window&&(win.DC.LastItemId=g.ActiveId),value_changed&&this.markItemEdited(win.DC.LastItemId),value_changed},ColorButton(desc_id,col,flags=0,rounding=Vec2.Zero()){let win=this.getCurrentWindow();if(win.SkipItems)return!1;var g=this.guictx;const style=g.Style;var id=win.GetID(desc_id),grid_step=this.GetFrameHeight();0==rounding.x&&(rounding.x=grid_step),0==rounding.y&&(rounding.y=grid_step);const bb=new Rect(win.DC.CursorPos,Vec2.Add(win.DC.CursorPos,rounding));if(this.itemSize(bb,rounding.y>=grid_step?g.Style.FramePadding.y:0),!this.itemAdd(bb,id))return!1;let hovered=new ValRef,held=new ValRef;var pressed=this.ButtonBehavior(bb,id,hovered,held);flags&ColorEditFlags.NoAlpha&&(flags&=~(ColorEditFlags.AlphaPreview|ColorEditFlags.AlphaPreviewHalf));let col_rgb=col.AsRGB(1,!0);var col_rgb_noalpha=col_rgb.AsOpaque(),grid_step=Math.min(rounding.x,rounding.y)/2.99,rounding=Math.min(g.Style.FrameRounding,.5*grid_step);let bb_inner=bb.Clone();var col_source;return bb_inner.Expand(-.75),flags&ColorEditFlags.AlphaPreviewHalf&&col_rgb.a<1?(col_source=Math.floor(.5*(bb_inner.Min.x+bb_inner.Max.x)+.5),this.renderColorRectWithAlphaCheckerboard(new Vec2(bb_inner.Min.x+grid_step,bb_inner.Min.y),bb_inner.Max,col_rgb,grid_step,new Vec2(-grid_step-.75,-.75),rounding,CornerFlags.TopRight|CornerFlags.BotRight),win.DrawList.AddRectFilled(bb_inner.Min,new Vec2(col_source,bb_inner.Max.y),col_rgb_noalpha,rounding,CornerFlags.TopLeft|CornerFlags.BotLeft)):(col_source=flags&ColorEditFlags.AlphaPreview?col_rgb:col_rgb_noalpha).a<1?this.renderColorRectWithAlphaCheckerboard(bb_inner.Min,bb_inner.Max,col_source,grid_step,new Vec2(-.75,-.75),rounding):win.DrawList.AddRectFilled(bb_inner.Min,bb_inner.Max,col_source,rounding,CornerFlags.All),this.renderNavHighlight(bb,id),0<g.Style.FrameBorderSize?this.renderFrameBorder(bb.Min,bb.Max,rounding):win.DrawList.AddRect(bb.Min,bb.Max,style.GetColor("FrameBg"),rounding),g.ActiveId!=id||flags&ColorEditFlags.NoDragDrop||!this.BeginDragDropSource()||(flags&ColorEditFlags.NoAlpha?this.SetDragDropPayload(DragPayloads.COLOR_3F,col_rgb_noalpha,CondFlags.Once):this.SetDragDropPayload(DragPayloads.COLOR_4F,col_rgb,CondFlags.Once),this.ColorButton(desc_id,col,flags),this.SameLine(),this.textEx("Color"),this.EndDragDropSource()),flags&ColorEditFlags.NoTooltip||!hovered.get()||this.colorTooltip(desc_id,col,flags&(ColorEditFlags.InputMask|ColorEditFlags.NoAlpha|ColorEditFlags.AlphaPreview|ColorEditFlags.AlphaPreviewHalf)),pressed&&this.markItemEdited(id),pressed},colorTooltip(label,col,flags){var sz=this.guictx;this.beginTooltipEx(0,!0);label=label.split("##")[0];label.length&&(this.textEx(label),this.Separator());sz=new Vec2(3*sz.FontSize+2*sz.Style.FramePadding.y,3*sz.FontLineHeight+2*sz.Style.FramePadding.y);this.ColorButton("##preview",col,flags&(ColorEditFlags.InputMask|ColorEditFlags.NoAlpha|ColorEditFlags.AlphaPreview|ColorEditFlags.AlphaPreviewHalf)|ColorEditFlags.NoTooltip,sz),this.SameLine(),this.Text(col.AsMultiStr(flags&ColorEditFlags.NoAlpha)),this.EndTooltip()}},TextEditMetaKeys={Left:65536,Right:65537,Up:65538,Down:65539,LineStart:65540,LineEnd:65541,TextStart:65542,TextEnd:65543,Delete:65544,Backspace:65545,Undo:65546,Redo:65547,WordLeft:65548,WordRight:65549,ToggleInsert:65550,Insert:65551,Shift:131072};const UndoOp={Insert:1,Replace:2,Delete:4,DoneFlag:8};class UndoRecord{constructor(op,where,insertLen,deleteLen,str){switch(this.op=op,this.where=where,this.insertLen=insertLen,this.deleteLen=deleteLen,this.op){case UndoOp.Insert:this.charStorage=null;break;case UndoOp.Delete:case UndoOp.Replace:this.charStorage=str.GetChars(where,deleteLen)}this.op|=UndoOp.DoneFlag}Undo(str){switch(this.op){case UndoOp.Insert|UndoOp.DoneFlag:this.charStorage=str.GetChars(this.where,this.insertLen),str.DeleteChars(this.where,this.insertLen);break;case UndoOp.Delete|UndoOp.DoneFlag:str.InsertChars(this.where,this.charStorage);break;case UndoOp.Replace|UndoOp.DoneFlag:var newchars=str.GetChars(this.where,this.insertLen);str.DeleteChars(this.where,this.insertLen),str.InsertChars(this.where,this.charStorage),this.charStorage=newchars;break;default:console.assert(0,"most unexpected undo")}this.op&=~UndoOp.DoneFlag}Redo(str){switch(this.op){case UndoOp.Insert:console.assert(this.charStorage),str.InsertChars(this.where,this.charStorage);break;case UndoOp.Delete:console.assert(this.charStorage==str.GetChars(this.where,this.deleteLen)),str.DeleteChars(this.where,this.insertLen);break;case UndoOp.Replace:var oldchars=str.GetChars(this.where,this.deleteLen);str.DeleteChars(this.where,this.deleteLen),str.InsertChars(this.where,this.charStorage),this.charStorage=oldchars;break;default:console.assert(0,"most unexpected redo")}this.op|=UndoOp.DoneFlag}}class UndoMgr{constructor(){this.Clear()}Clear(){this.cmdDeque=[],this.cmdIndex=-1}GetUndoAvailCount(){Math.max(0,this.cmdIndex+1)}GetRedoAvailCount(){Math.max(0,this.cmdDeque.length-this.cmdIndex-1)}PerformUndo(str){0<=this.cmdIndex&&(console.assert(this.cmdIndex<this.cmdDeque.length),this.cmdDeque[this.cmdIndex].Undo(str),this.cmdIndex--)}PerformRedo(str){var redoIndex=this.cmdIndex+1;redoIndex<this.cmdDeque.length&&(this.cmdDeque[redoIndex].Redo(str),this.cmdIndex=redoIndex)}TrackInsert(where,length){this.createUndo(UndoOp.Insert,where,length,0,null)}TrackDelete(str,where,length){this.createUndo(UndoOp.Delete,where,0,length,str)}TrackReplace(str,where,oldLen,newLen){this.createUndo(UndoOp.Replace,where,oldLen,newLen,str)}createUndo(op,pos,insertLen,deleteLen,r){this.cmdIndex<this.cmdDeque.length-1&&(this.cmdDeque.length=this.cmdIndex+1);r=new UndoRecord(op,pos,insertLen,deleteLen,r);return this.cmdDeque.push(r),this.cmdIndex=this.cmdDeque.length-1,r}}class Row{construct(){this.x0=0,this.x1=0,this.baselineYDelta=0,this.ymin=0,this.ymax=0,this.numChars=0}}class FindState{constructor(){this.x=0,this.y=0,this.height=0,this.firstChar=0,this.length=0,this.prevFirst=0}}class TextEditState{constructor(guictx){this.Cursor=-1,this.SelectStart=0,this.SelectEnd=0,this.InsertMode=0,this.guictx=guictx,this.initialized=!1,this.preferredX=void 0,this.singleLine=!1,this.row=new Row,this.finder=new FindState,this.undoMgr=new UndoMgr}Init(singleLine=!0,clearUndo=!0){clearUndo&&this.undoMgr.Clear(),this.singleLine=singleLine,this.SelectEnd=0,this.SelectStart=0,this.Cursor=0,this.preferredX=null,this.cursorAtEndOfLine=0,this.initialized=!0,this.insertMode=0}Click(str,x,y){this.singleLine&&(this.layoutRow(this.row,str,0),y=this.row.ymin),this.Cursor=this.locateCoord(str,x,y),this.SelectStart=this.Cursor,this.SelectEnd=this.Cursor,this.preferredX=null}ClampCursor(n){n=n.Length();this.HasSelection()&&(this.SelectStart>n&&(this.SelectStart=n),this.SelectEnd>n&&(this.SelectEnd=n),this.SelectStart==this.SelectEnd&&(this.Cursor=this.SelectStart)),this.Cursor>n&&(this.Cursor=n)}HasSelection(){return this.SelectStart!=this.SelectEnd}GetSelectedText(str){return this.HasSelection()?(this.sortSelection(),str.GetChars(this.SelectStart,this.SelectEnd-this.SelectStart)):null}ClearSelection(){this.SelectStart=this.SelectEnd=0}SelectAll(str){this.SelectStart=0,this.SelectEnd=this.Cursor=str.Length(),this.preferredX=null}GetUndoAvailCount(){this.undoMgr.GetUndoAvailCount()}GetRedoAvailCount(){this.undoMgr.GetRedoAvailCount()}Drag(str,x,y){var p;this.singleLine&&(this.layoutRow(this.row,str,0),y=this.row.ymin),this.SelectStart==this.SelectEnd&&(this.SelectStart=this.Cursor),p=this.locateCoord(str,x,y),this.Cursor=this.SelectEnd=p}Cut(str){return this.HasSelection()?(this.deleteSelection(str),this.preferredX=null,1):0}Paste(str,len){if(this.ClampCursor(str),this.deleteSelection(str),this.insertChars(str,this.Cursor,len)){len=len.length;return this.undoMgr.TrackInsert(this.Cursor,len),this.Cursor+=len,this.preferredX=null,1}return 0}Key(str,key){var c;switch(key){default:if(null!=(c=this.keyToText(key))){var ch=c;if("\n"==c&&this.singleLine)break;this.insertMode&&!this.HasSelection()&&this.Cursor<str.Length()?(this.undoMgr.TrackReplace(str,this.Cursor,1,1),this.deleteChars(str,this.Cursor,1),this.insertChars(str,this.Cursor,ch)&&(++this.Cursor,this.hasPreferredX=null)):(this.deleteSelection(str),this.insertChars(str,this.Cursor,ch)&&(this.undoMgr.TrackInsert(this.Cursor,1),this.Cursor++,this.preferredX=null))}break;case TextEditMetaKeys.Insert:this.insertMode=!this.insertMode;break;case TextEditMetaKeys.Undo:this.undoMgr.PerformUndo(str),this.preferredX=null,this.ClampCursor(str);break;case TextEditMetaKeys.Redo:this.undoMgr.PerformRedo(str),this.preferredX=null,this.ClampCursor(str);break;case TextEditMetaKeys.Left:this.HasSelection()?this.moveToFirst():0<this.Cursor&&this.Cursor--,this.preferredX=null;break;case TextEditMetaKeys.Right:this.HasSelection()?this.moveToLast(str):this.Cursor++,this.ClampCursor(str),this.preferredX=null;break;case TextEditMetaKeys.Left|TextEditMetaKeys.Shift:this.ClampCursor(str),this.prepSelectionAtCursor(),0<this.SelectEnd&&this.SelectEnd--,this.Cursor=this.SelectEnd,this.preferredX=null;break;case TextEditMetaKeys.WordLeft:this.HasSelection()?this.moveToFirst():(this.Cursor=this.moveWordLeft(str,this.Cursor),this.ClampCursor(str));break;case TextEditMetaKeys.WordLeft|TextEditMetaKeys.Shift:this.HasSelection()&&this.prepSelectionAtCursor(),this.Cursor=this.moveWordLeft(str,this.Cursor),this.SelectEnd=this.Cursor,this.ClampCursor(str);break;case TextEditMetaKeys.WordRight:this.HasSelection()?this.moveToLast(str):(this.Cursor=this.moveWordRight(str,this.Cursor),this.ClampCursor(str));break;case TextEditMetaKeys.WordRight|TextEditMetaKeys.Shift:this.HasSelection()&&this.prepSelectionAtCursor(),this.Cursor=this.moveWordRight(str,this.Cursor),this.SelectEnd=this.Cursor,this.ClampCursor(str);break;case TextEditMetaKeys.Right|TextEditMetaKeys.Shift:this.prepSelectionAtCursor(),this.SelectEnd++,this.ClampCursor(str),this.Cursor=this.SelectEnd,this.preferredX=null;break;case TextEditMetaKeys.Down:case TextEditMetaKeys.Down|TextEditMetaKeys.Shift:{if(this.singleLine)return key=TextEditMetaKeys.Right|key&TextEditMetaKeys.Shift,this.Key(str,key);var n=this.finder,row=this.row;let i,sel=0!=(key&TextEditMetaKeys.Shift);if(sel?this.prepSelectionAtCursor():this.HasSelection&&this.moveToLast(str),this.ClampCursor(str),this.findCharPos(str,this.Cursor,this.singleLine,n),n.length){var goal_x=null!=this.preferredX?this.preferredX:n.x;let x;var start=n.firstChar+n.length;for(this.Cursor=start,this.layoutRow(row,str,this.Cursor),x=row.x0,i=0;i<row.numChars;++i){var dx=this.getWidth(str,start,i);if(x+=dx,x>goal_x)break;this.Cursor++}this.ClampCursor(str),this.preferredX=goal_x,sel&&(this.SelectEnd=this.Cursor)}}break;case TextEditMetaKeys.Up:case TextEditMetaKeys.Up|TextEditMetaKeys.Shift:{if(this.singleLine)return key=TextEditMetaKeys.Left|key&TextEditMetaKeys.Shift,this.Key(str,key);let find=this.finder,row=this.row,i,sel=0!=(key&TextEditMetaKeys.Shift);if(sel?this.prepSelectionAtCursor():this.HasSelection()&&this.moveToFirst(),this.ClampCursor(str),this.findCharPos(str,this.Cursor,this.singleLine,find),find.prevFirst!=find.firstChar){this.Cursor;let goal_x=null!=this.preferredX?this.preferredX:find.x,x;if(this.Cursor=find.prevFirst,this.layoutRow(row,str,this.Cursor),goal_x>row.x1)this.Cursor+=row.numChars-1;else if(0<row.x1)for(x=row.x0,i=0;i<row.numChars;++i){let dx=this.getWidth(str,find.prevFirst,i);if(x+=dx,x>goal_x)break;this.Cursor++}this.ClampCursor(str),this.preferredX=goal_x,sel&&(this.SelectEnd=this.Cursor)}}break;case TextEditMetaKeys.Delete:case TextEditMetaKeys.Delete|TextEditMetaKeys.Shift:this.HasSelection()?this.deleteSelection(str):(n=str.Length(),this.Cursor<n&&this.delete(str,this.Cursor,1)),this.preferredX=null;break;case TextEditMetaKeys.Backspace:case TextEditMetaKeys.Backspace|TextEditMetaKeys.Shift:this.HasSelection()?this.deleteSelection(str):(this.ClampCursor(str),0<this.Cursor&&(this.delete(str,this.Cursor-1,1),this.Cursor--)),this.preferredX=null;break;case TextEditMetaKeys.TextStart:this.Cursor=this.SelectStart=this.SelectEnd=0,this.preferredX=null;break;case TextEditMetaKeys.TextStart|TextEditMetaKeys.Shift:this.prepSelectionAtCursor(),this.Cursor=this.SelectEnd=0,this.preferredX=null;break;case TextEditMetaKeys.TextEnd:this.Cursor=str.Length(),this.SelectStart=this.SelectEnd=0,this.preferredX=null;break;case TextEditMetaKeys.TextEnd|TextEditMetaKeys.Shift:this.prepSelectionAtCursor(),this.Cursor=this.SelectEnd=str.Length(),this.preferredX=null;break;case TextEditMetaKeys.LineStart:if(this.ClampCursor(str),this.moveToFirst(),this.singleLine)this.Cursor=0;else for(;0<this.Cursor&&!str.IsNewLine(this.Cursor-1);)this.Cursor--;this.preferredX=null;break;case TextEditMetaKeys.LineStart|TextEditMetaKeys.Shift:if(this.ClampCursor(str),this.prepSelectionAtCursor(),this.singleLine)this.Cursor=0;else for(;0<this.Cursor&&!str.IsNewLine(this.Cursor-1);)this.Cursor--;this.SelectEnd=this.Cursor,this.preferredX=null;break;case TextEditMetaKeys.LineEnd:{let n=str.Length();if(this.ClampCursor(str),this.moveToFirst(),this.singleLine)this.Cursor=n;else for(;this.Cursor<n&&!str.IsNewLine(this.Cursor);)this.Cursor++;this.preferredX=null}break;case TextEditMetaKeys.LineEnd|TextEditMetaKeys.Shift:{let n=str.Length();if(this.ClampCursor(str),this.prepSelectionAtCursor(),this.singleLine)this.Cursor=n;else for(;this.Cursor<n&&!str.IsNewLine(this.Cursor);)this.Cursor++;this.SelectEnd=this.Cursor,this.preferredX=null}}}layoutRow(row,str,lineStart,ts=!0){ts=this.CalcTextRunSize(str,lineStart,-1,ts);row.x0=0,row.x1=ts.x,row.baselineYDelta=ts.y,row.ymin=0,row.ymax=ts.y,row.numChars=ts.consumed-lineStart}CalcTextRunSize(str,lineStart,lineEnd=-1,stopOnNewline=!0){let g=this.guictx;var lineHeight=g.Font.Size*g.Style.TextLineHeightPct;let ret={x:0,y:0},lineWidth=0,i=lineStart;for(-1==lineEnd&&(lineEnd=str.Length()),g.Font.MeasureBegin();i<lineEnd;){var c=str.GetCharCode(i++);if(10!=c)13!=c&&(lineWidth+=g.Font.MeasureWidth(String.fromCharCode(c)));else if(ret.x=Math.max(ret.x,lineWidth),ret.y+=lineHeight,lineWidth=0,stopOnNewline)break}return ret.consumed=i,g.Font.MeasureEnd(),ret.x<lineWidth&&(ret.x=lineWidth),(0<lineWidth||0==ret.y)&&(ret.y+=lineHeight),ret}getWidth(str,lineStart,c){let g=this.guictx;c=str.GetChar(lineStart+c);return-1!="\n\r".indexOf(c)?0:g.Font.MeasureWidth(c)}keyToText(key){return 65536<=key?null:String.fromCharCode(key)}isWordBoundaryFromRight(str,idx){return 0<idx?str.IsSeparator(idx-1)&&!str.IsSeparator(idx):1}moveWordLeft(str,idx){for(idx--;0<=idx&&!this.isWordBoundaryFromRight(str,idx);)idx--;return idx<0?0:idx}moveWordRight(str,idx){idx++;for(var len=str.Length();idx<len&&!this.isWordBoundaryFromRight(str,idx);)idx++;return len<idx?len:idx}prepSelectionAtCursor(){this.HasSelection()?this.Cursor=this.SelectEnd:this.SelectStart=this.SelectEnd=this.Cursor}deleteChars(str,pos,n){str.DeleteChars(pos,n)}insertChars(str,pos,newchars){return str.InsertChars(pos,newchars),!0}locateCoord(str,x,y){let r=new Row;var n=str.Length();let base_y=0,i=0,k,g=this.guictx;r.x0=r.x1=0,r.ymin=r.ymax=0,r.numChars=0;try{for(g.Font.MeasureBegin();i<n;){if(this.layoutRow(r,str,i),r.numChars<=0)return n;if(0==i&&y<base_y+r.ymin)return 0;if(y<base_y+r.ymax)break;i+=r.numChars,base_y+=r.baselineYDelta}if(i>=n)return n;if(x<r.x0)return i;if(x<r.x1){let prev_x=r.x0;for(k=0;k<r.numChars;++k){var w=this.getWidth(str,i,k),next_x=prev_x+w;if(x<next_x)return x<prev_x+w/2?k+i:k+i+1;prev_x=next_x}}return"\n"==str[i+r.numChars-1]?i+r.numChars-1:i+r.numChars}finally{g.Font.MeasureEnd()}}findCharPos(str,n,singleLine,find){let prev_linestart=0;var z=str.Length();let i=0;var r=this.row;if(n!=z){for(find.y=0;i<str.Length()&&(this.layoutRow(r,str,i),!(n<i+r.numChars));)prev_linestart=i,i+=r.numChars,find.y+=r.baselineYDelta;for(find.firstChar=i,find.length=r.numChars,find.height=r.ymax-r.ymin,find.prevFirst=prev_linestart,find.x=0,i=0;find.firstChar+i<n;++i)find.x+=this.getWidth(str,find.firstChar,i)}else if(singleLine)this.layoutRow(r,str,0),find.y=0,find.firstChar=0,find.length=z,find.height=r.ymax-r.ymin,find.x=r.x1;else{for(find.y=0,find.x=0,find.height=1;i<z;)this.layoutRow(r,str,i),prev_linestart=i,i+=r.numChars;find.firstChar=i,find.length=0,find.prevFirst=prev_linestart}}delete(str,where,len){this.undoMgr.TrackDelete(str,where,len),str.DeleteChars(where,len),this.preferredX=null}deleteSelection(str){this.ClampCursor(str),this.HasSelection()&&(this.SelectStart<this.SelectEnd?(this.delete(str,this.SelectStart,this.SelectEnd-this.SelectStart),this.SelectEnd=this.Cursor=this.SelectStart):(this.delete(str,this.SelectEnd,this.SelectStart-this.SelectEnd),this.SelectStart=this.Cursor=this.SelectEnd),this.preferredX=null)}sortSelection(){var temp;this.SelectEnd<this.SelectStart&&(temp=this.SelectEnd,this.SelectEnd=this.SelectStart,this.SelectStart=temp)}moveToFirst(){this.HasSelection()&&(this.sortSelection(),this.Cursor=this.SelectStart,this.SelectEnd=this.SelectStart,this.preferredX=null)}moveToLast(str){this.HasSelection()&&(this.sortSelection(),this.ClampCursor(str),this.Cursor=this.SelectEnd,this.SelectStart=this.SelectEnd,this.preferredX=null)}}var TreeNodeFlags={None:0,Selected:1,Framed:2,AllowItemOverlap:4,NoTreePushOnOpen:8,NoAutoOpenOnLog:16,DefaultOpen:32,OpenOnDoubleClick:64,OpenOnArrow:128,Leaf:256,Bullet:512,FramePadding:1024,NavLeftJumpsBackHere:8192};TreeNodeFlags.CollapsingHeader=TreeNodeFlags.Framed|TreeNodeFlags.NoTreePushOnOpen|TreeNodeFlags.NoAutoOpenOnLog;var ImguiTreeMixin={TreeNode(label,flags=0){let win=this.getCurrentWindow();if(win.SkipItems)return!1;this.guictx;return this.treeNodeBehavior(win.GetID(label),flags,label.split("##")[0])},TreeNodeEx(label,flags=0){return this.TreeNode(label,flags)},TreePush(str_id=null){let win=this.getCurrentWindow();this.Indent(),win.DC.TreeDepth++,this.PushID(str_id||"#TreePush")},TreePop(){var g=this.guictx;let win=this.getCurrentWindow();this.Unindent(),win.DC.TreeDepth--,g.NavMoveDir==Dir.Left&&g.NavWindow==win&&this.navMoveRequestButNoResultYet()&&g.NavIdIsAlive&&win.DC.TreeDepthMayJumpToParentOnPop&1<<win.DC.TreeDepth&&(this.setNavID(win.IDStack.back(),g.NavLayer),this.navMoveRequestCancel()),win.DC.TreeDepthMayJumpToParentOnPop&=(1<<win.DC.TreeDepth)-1,console.assert(1<win.IDStack.length),this.PopID()},TreeAdvanceToLabelPos(){let g=this.guictx;g.CurrentWindow.DC.CursorPos.x+=this.GetTreeNodeToLabelSpacing()},GetTreeNodeToLabelSpacing(){var g=this.guictx;return g.FontSize+2*g.Style.FramePadding.x},SetNextTreeNodeOpen(is_open,cond){let g=this.guictx;g.CurrentWindow.SkipItems||(g.NextTreeNodeOpenVal=is_open,g.NextTreeNodeOpenCond=cond||CondFlags.Always)},CollapsingHeader(label,flags=0){let win=this.getCurrentWindow();return!win.SkipItems&&this.treeNodeBehavior(win.GetID(label),flags|TreeNodeFlags.CollapsingHeader,label)},CollapsingHeaderO(button_radius,p_open=null,button_center=0){let win=this.getCurrentWindow();if(win.SkipItems)return!1;if(p_open&&!p_open.get())return!1;var id=win.GetID(button_radius),is_open=this.treeNodeBehavior(id,button_center|TreeNodeFlags.CollapsingHeader|(p_open?TreeNodeFlags.AllowItemOverlap:0),button_radius);if(p_open){button_center=this.guictx;let last_item_backup=new ItemHoveredDataBackup(button_center);button_radius=.5*button_center.FontSize,button_center=new Vec2(Math.min(win.DC.LastItemRect.Max.x,win.ClipRect.Max.x)-button_center.Style.FramePadding.x-button_radius,win.DC.LastItemRect.GetCenter().y);this.CloseButton(win.GetID(id+"_1"),button_center,button_radius)?p_open.set(!1):p_open.set(!0),last_item_backup.Restore()}return is_open},treeNodeBehavior(id,flags,label){let win=this.getCurrentWindow();if(win.SkipItems)return!1;var g=this.guictx;const style=g.Style;var display_frame=0!=(flags&TreeNodeFlags.Framed),padding=display_frame||flags&TreeNodeFlags.FramePadding?style.FramePadding:new Vec2(style.FramePadding.x,0),label_size=this.CalcTextSize(label,!1),text_base_offset_y=Math.max(padding.y,win.DC.CurrentLineTextBaseOffset),selected=Math.max(Math.min(win.DC.CurrentLineHeight,g.FontSize+2*style.FramePadding.y),label_size.y+2*padding.y);let frame_bb=Rect.FromXY(win.DC.CursorPos,win.Pos.x+this.GetContentRegionMax().x,win.DC.CursorPos.y+selected);display_frame&&(frame_bb.Min.x-=Math.floor(.5*win.WindowPadding.x)-1,frame_bb.Max.x+=Math.floor(.5*win.WindowPadding.x)-1);var text_offset_x=g.FontSize+(display_frame?3*padding.x:2*padding.x),text_pos=g.FontSize+(0<label_size.x?label_size.x+2*padding.x:0);this.itemSize(new Vec2(text_pos,selected),text_base_offset_y);var nav_highlight_flags=display_frame?frame_bb:Rect.FromXY(frame_bb.Min,frame_bb.Min.x+text_pos+2*style.ItemSpacing.x,frame_bb.Max.y);let is_open=this.treeNodeBehaviorIsOpen(id,flags);var is_leaf=0!=(flags&TreeNodeFlags.Leaf);is_open&&!g.NavIdIsAlive&&flags&TreeNodeFlags.NavLeftJumpsBackHere&&!(flags&TreeNodeFlags.NoTreePushOnOpen)&&(win.DC.TreeDepthMayJumpToParentOnPop|=1<<win.DC.TreeDepth);var col=this.itemAdd(nav_highlight_flags,id);if(win.DC.LastItemStatusFlags|=ItemStatusFlags.HasDisplayRect,win.DC.LastItemDisplayRect=frame_bb,!col)return!is_open||flags&TreeNodeFlags.NoTreePushOnOpen||this.treePushRawID(id),is_open;let button_flags=ButtonFlags.NoKeyModifiers;flags&TreeNodeFlags.AllowItemOverlap&&(button_flags|=ButtonFlags.AllowItemOverlap),flags&TreeNodeFlags.OpenOnDoubleClick&&(button_flags|=ButtonFlags.PressedOnDoubleClick|(flags&TreeNodeFlags.OpenOnArrow?ButtonFlags.PressedOnClickRelease:0)),is_leaf||(button_flags|=ButtonFlags.PressedOnDragDropHold);selected=0!=(flags&TreeNodeFlags.Selected);let hovered=new ValRef,held=new ValRef;text_pos=this.ButtonBehavior(nav_highlight_flags,id,hovered,held,button_flags);let toggled=!1;is_leaf||(text_pos&&(toggled=!(flags&(TreeNodeFlags.OpenOnArrow|TreeNodeFlags.OpenOnDoubleClick))||g.NavActivateId==id,flags&TreeNodeFlags.OpenOnArrow&&(toggled|=this.IsMouseHoveringRect(nav_highlight_flags.Min,new Vec2(nav_highlight_flags.Min.x+text_offset_x,nav_highlight_flags.Max.y))&&!g.NavDisableMouseHover),flags&TreeNodeFlags.OpenOnDoubleClick&&(toggled|=g.IO.MouseDoubleClicked[0]),g.DragDropActive&&is_open&&(toggled=!1)),g.NavId==id&&g.NavMoveRequest&&g.NavMoveDir==Dir.Left&&is_open&&(toggled=!0,this.navMoveRequestCancel()),g.NavId==id&&g.NavMoveRequest&&g.NavMoveDir==Dir.Right&&!is_open&&(toggled=!0,this.navMoveRequestCancel()),toggled&&(is_open=!is_open,win.DC.StateStorage.SetInt(id,is_open))),flags&TreeNodeFlags.AllowItemOverlap&&this.SetItemAllowOverlap();col=style.GetColor(held.get()&&hovered.get()?"HeaderActive":hovered.get()?"HeaderHovered":"Header"),text_pos=Vec2.AddXY(frame_bb.Min,text_offset_x,text_base_offset_y),nav_highlight_flags=NavHighlightFlags.TypeThin;return display_frame?(this.renderFrame(frame_bb.Min,frame_bb.Max,col,!0,style.FrameRounding),this.renderNavHighlight(frame_bb,id,nav_highlight_flags),this.renderArrow(Vec2.AddXY(frame_bb.Min,padding.x,text_base_offset_y),is_open?Dir.Down:Dir.Right,1),g.LogEnabled?(this.LogRenderedText(text_pos,"\n##"),this.renderTextClipped(text_pos,frame_bb.Max,label),this.LogRenderedText(text_pos,"##")):this.renderTextClipped(text_pos,frame_bb.Max,label,label_size)):((hovered.get()||selected)&&(this.renderFrame(frame_bb.Min,frame_bb.Max,col,!1),this.renderNavHighlight(frame_bb,id,nav_highlight_flags)),flags&TreeNodeFlags.Bullet?this.renderBullet(Vec2.AddXY(frame_bb.Min,.5*text_offset_x,.5*g.FontSize+text_base_offset_y)):is_leaf||this.renderArrow(Vec2.AddXY(frame_bb.Min,padding.x,.15*g.FontSize+text_base_offset_y),is_open?Dir.Down:Dir.Right,.7),this.renderText(text_pos,label,!1)),!is_open||flags&TreeNodeFlags.NoTreePushOnOpen||this.treePushRawID(id),is_open},treeNodeBehaviorIsOpen(id,flags){if(flags&TreeNodeFlags.Leaf)return!0;let g=this.guictx;var def,win=g.CurrentWindow;let storage=win.DC.StateStorage,is_open;return 0!=g.NextTreeNodeOpenCond?(g.NextTreeNodeOpenCond&CondFlags.Always||-1==(def=storage.GetInt(id,-1))?(is_open=g.NextTreeNodeOpenVal,storage.SetInt(id,is_open)):is_open=0!=def,g.NextTreeNodeOpenCond=0):(def=flags&TreeNodeFlags.DefaultOpen?1:0,is_open=0!=storage.GetInt(id,def)),g.LogEnabled&&!(flags&TreeNodeFlags.NoAutoOpenOnLog)&&win.DC.TreeDepth-g.LogDepthRef<g.LogDepthToExpand&&(is_open=!0),is_open},treePushRawID(id){let w=this.getCurrentWindow();this.Indent(),w.DC.TreeDepth++,w.IDStack.push(id)}},PlotType={Lines:0,Histogram:1,Signal:2},PlotFlags={Default:0,NoTip:1},ImguiPlotMixin={PlotLines(label,values,values_offset=0,overlay_text=null,scale_min=Number.MAX_VALUE,scale_max=Number.MAX_VALUE,graph_size=Vec2.Zero(),stride=1,flags=0){this.plotEx(PlotType.Lines,label,function(i){return values[i*stride]},values.length,values_offset,overlay_text,scale_min,scale_max,graph_size,flags)},PlotLinesCB(label,getter,values_count,values_offset=0,overlay_text=null,scale_min=Number.MAX_VALUE,scale_max=Number.MAX_VALUE,graph_size=Vec2.Zero(),roi=null,flags=0){this.plotEx(PlotType.Lines,label,getter,values_count,values_offset,overlay_text,scale_min,scale_max,graph_size,roi,flags)},PlotSignal(label,values,values_offset=0,overlay_text=null,scale_min=Number.MAX_VALUE,scale_max=Number.MAX_VALUE,graph_size=Vec2.Zero(),roi=null,flags=0){this.plotEx(PlotType.Signal,label,function(i){return values[i]},values.length,values_offset,overlay_text,scale_min,scale_max,graph_size,roi,flags)},PlotSignalCB(label,getter,values,values_offset=0,overlay_text=null,scale_min=Number.MAX_VALUE,scale_max=Number.MAX_VALUE,graph_size=Vec2.Zero(),roi=null,flags=0){this.plotEx(PlotType.Signal,label,getter,values.length,values_offset,overlay_text,scale_min,scale_max,graph_size,roi,flags)},PlotHistogram(label,values,values_offset=0,overlay_text=null,scale_min=Number.MAX_VALUE,scale_max=Number.MAX_VALUE,graph_size=Vec2.Zero(),stride=1,roi=null,flags=0){this.plotEx(PlotType.Histogram,label,function(i){return values[i*stride]},values.length,values_offset,overlay_text,scale_min,scale_max,graph_size,roi,flags)},PlotHistogramCB(label,getter,values_count,values_offset=0,overlay_text=null,scale_min=Number.MAX_VALUE,scale_max=Number.MAX_VALUE,graph_size=Vec2.Zero(),roi=null,flags=0){this.plotEx(PlotType.Histogram,label,getter,values_count,values_offset,overlay_text,scale_min,scale_max,graph_size,roi,flags)},plotEx(plotType,label,getter,values_count,values_offset,overlay_text,scale_min,scale_max,frame_size,roi,flags){let win=this.getCurrentWindow();if(!win.SkipItems){var t=this.guictx;const style=t.Style;var v0=win.GetID(label),label_size=this.CalcTextSize(label,!0);0==frame_size.x&&(frame_size.x=this.getNextItemWidth()),0==frame_size.y&&(frame_size.y=label_size.y+2*style.FramePadding.y);var frame_bb=new Rect(win.DC.CursorPos,Vec2.Add(win.DC.CursorPos,frame_size));const inner_bb=new Rect(Vec2.Add(frame_bb.Min,style.FramePadding),Vec2.Subtract(frame_bb.Max,style.FramePadding));var total_bb=new Rect(frame_bb.Min,Vec2.AddXY(frame_bb.Max,0<label_size.x?style.ItemInnerSpacing.x+label_size.x:0,0));if(this.itemSize(total_bb,style.FramePadding.y),this.itemAdd(total_bb,0,frame_bb)){v0=this.itemHoverable(frame_bb,v0);if(scale_min==Number.MAX_VALUE||scale_max==Number.MAX_VALUE){let v_min=Number.MAX_VALUE,v_max=-Number.MAX_VALUE;for(let i=0;i<values_count;i++){var v=getter(i);isNaN(v)||(v_min=Math.min(v_min,v),v_max=Math.max(v_max,v))}scale_min==Number.MAX_VALUE&&(scale_min=v_min),scale_max==Number.MAX_VALUE&&(scale_max=v_max)}if(this.renderFrame(frame_bb.Min,frame_bb.Max,style.GetColor("PlotBg"),!0,style.FrameRounding),(plotType==PlotType.Lines?2:1)<=values_count){var res_w=Math.min(Math.floor(frame_size.x),values_count)+(plotType==PlotType.Lines?-1:0),item_count=values_count+(plotType==PlotType.Lines?-1:0);let roiPx,colHovered,col,colDimmed;switch(roi&&(roiPx=[roi[0]*res_w,roi[1]*res_w]),plotType){case PlotType.Lines:col=style.GetColor("PlotLines"),colHovered=style.GetColor("PlotLinesHovered"),colDimmed=roiPx?style.GetColor("PlotLinesDimmed"):col;break;case PlotType.Signal:col=style.GetColor("PlotSignal"),colHovered=style.GetColor("PlotSignalHovered"),colDimmed=roiPx?style.GetColor("PlotSignalDimmed"):col;break;case PlotType.Histogram:col=style.GetColor("PlotHistogram"),colHovered=style.GetColor("PlotHistogramHovered"),colDimmed=roiPx?style.GetColor("PlotHistogramDimmed"):col}let v_hovered=-1;if(!(flags&PlotFlags.NoTip)&&v0&&inner_bb.Contains(t.IO.MousePos)){var t=Vec1.Clamp((t.IO.MousePos.x-inner_bb.Min.x)/(inner_bb.Max.x-inner_bb.Min.x),0,.9999),v_idx=Math.floor(t*item_count);console.assert(0<=v_idx&&v_idx<values_count);const v0=getter((v_idx+values_offset)%values_count);var v1=getter((v_idx+1+values_offset)%values_count);switch(plotType){case PlotType.Lines:this.SetTooltip("%d: %8.4g\n%d: %8.4g",v_idx,v0,v_idx+1,v1);break;case PlotType.Signal:case PlotType.Histogram:this.SetTooltip("%d: %8.4g",v_idx,v0)}v_hovered=v_idx}var t_step=1/res_w,inv_scale=scale_min==scale_max?0:1/(scale_max-scale_min),v0=getter((0+values_offset)%values_count);let t0=0,tp0=new Vec2(t0,1-Vec1.Saturate((v0-scale_min)*inv_scale));var histogram_zero_line_t=scale_min*scale_max<0?-scale_min*inv_scale:scale_min<0?0:1;let tp1=new Vec2,lines=[];for(let n=0;n<res_w;n++){var t1=t0+t_step,v1_idx=Math.floor(t0*item_count+.5);console.assert(0<=v1_idx&&v1_idx<values_count);const v1=getter((v1_idx+values_offset+1)%values_count);tp1.x=t1,tp1.y=1-Vec1.Saturate((v1-scale_min)*inv_scale);let pos0,pos1,c;switch(c=v_hovered==v1_idx?colHovered:roiPx&&(n<roiPx[0]||n>roiPx[1])?colDimmed:col,plotType){case PlotType.Lines:pos0=Vec2.Lerp(inner_bb.Min,inner_bb.Max,tp0),pos1=Vec2.Lerp(inner_bb.Min,inner_bb.Max,tp1),lines.push([pos0,pos1,c.AsStr()]);break;case PlotType.Signal:pos0=Vec2.Lerp(inner_bb.Min,inner_bb.Max,tp0),tp0.y=1-Vec1.Saturate((-v1-scale_min)*inv_scale),pos1=Vec2.Lerp(inner_bb.Min,inner_bb.Max,tp0),lines.push([pos0,pos1,c.AsStr()]);break;case PlotType.Histogram:pos0=Vec2.Lerp(inner_bb.Min,inner_bb.Max,tp0),pos1=Vec2.Lerp(inner_bb.Min,inner_bb.Max,new Vec2(tp1.x,histogram_zero_line_t)),pos1.x>=pos0.x+2&&--pos1.x,win.DrawList.AddRectFilled(pos0,pos1,c)}t0=t1,tp0.Copy(tp1)}lines.length&&win.DrawList.AddLines(lines)}overlay_text&&this.renderTextClipped(new Vec2(frame_bb.Min.x,frame_bb.Min.y+style.FramePadding.y),frame_bb.Max,overlay_text,null,new Vec2(.5,0)),0<label_size.x&&this.renderText(new Vec2(frame_bb.Max.x+style.ItemInnerSpacing.x,inner_bb.Min.y),label)}}}},PopupPositionPolicy={Default:0,ComboBox:1};class PopupRef{constructor(){this.Window=null,this.PopupId=-1,this.ParentWindow=null,this.OpenFrameCount=-1,this.OpenParentId=-1,this.OpenPopupPos=null,this.OpenMousePos=null}}var ImguiPopupMixin={OpenPopup(str_id){this.openPopupEx(this.guictx.CurrentWindow.GetID(str_id))},BeginPopup(str_id,flags=0){let g=this.guictx;return g.OpenPopupStack.length<=g.BeginPopupStack.length?(g.NextWindowData.Clear(),!1):(flags|=WindowFlags.AlwaysAutoResize|WindowFlags.NoTitleBar|WindowFlags.NoSavedSettings,this.beginPopupEx(g.CurrentWindow.GetID(str_id),flags))},BeginPopupModal(name,p_open,is_open=0){let g=this.guictx,win=g.CurrentWindow;var id=win.GetID(name);if(!this.isPopupOpen(id))return g.NextWindowData.Clear(),!1;0==g.NextWindowData.PosCond&&this.SetNextWindowPos(Vec2.Mult(g.IO.DisplaySize,.5),CondFlags.Appearing,new Vec2(.5,.5)),is_open|=WindowFlags.Popup|WindowFlags.Modal|WindowFlags.NoCollapse|WindowFlags.NoSavedSettings;is_open=this.Begin(name,p_open,is_open);return!is_open||p_open&&!p_open.get()?(this.EndPopup(),is_open&&this.closePopupToLevel(g.BeginPopupStack.length,!0),!1):is_open},EndPopup(){var g=this.guictx;console.assert(g.CurrentWindow.Flags&WindowFlags.Popup,"Mismatched BeginPopup()/EndPopup() calls, length:"+g.BeginPopupStack.length),this.navMoveRequestTryWrapping(g.CurrentWindow,NavMoveFlags.LoopY),this.End()},BeginPopupContextItem(id,mouse_button=1){let win=this.guictx.CurrentWindow;id=id?win.GetID(id):win.DC.LastItemId;return console.assert(0!=id,"You cannot pass a NULL str_id if the last item has no identifier (e.g. a Text() item)"),this.IsMouseReleased(mouse_button)&&this.IsItemHovered(HoveredFlags.AllowWhenBlockedByPopup)&&this.openPopupEx(id),this.beginPopupEx(id,WindowFlags.AlwaysAutoResize|WindowFlags.NoTitleBar|WindowFlags.NoSavedSettings)},BeginPopupContextWindow(id,mouse_button=1,also_over_items=!0){id=this.guictx.CurrentWindow.GetID(id=id||"window_context");return this.IsMouseReleased(mouse_button)&&this.IsWindowHovered(HoveredFlags.AllowWhenBlockedByPopup)&&(!also_over_items&&this.IsAnyItemHovered()||this.openPopupEx(id)),this.beginPopupEx(id,WindowFlags.AlwaysAutoResize|WindowFlags.NoTitleBar|WindowFlags.NoSavedSettings)},BeginPopupContextVoid(id,mouse_button=1){id=this.guictx.CurrentWindow.GetID(id=id||"void_context");return this.IsMouseReleased(mouse_button)&&!this.IsWindowHovered(HoveredFlags.AnyWindow)&&this.openPopupEx(id),this.beginPopupEx(id,WindowFlags.AlwaysAutoResize|WindowFlags.NoTitleBar|WindowFlags.NoSavedSettings)},OpenPopupOnItemClick(id,mouse_button=1){let win=this.guictx.CurrentWindow;if(this.IsMouseReleased(mouse_button)&&this.IsItemHovered(HoveredFlags.AllowWhenBlockedByPopup)){id=id?win.GetID(id):win.DC.LastItemId;return console.assert(0!=id,"You cannot pass a NULL str_id if the last item has no identifier (e.g. a Text() item"),this.openPopupEx(id),!0}return!1},IsPopupOpen(id){return"string"==typeof id?this.isPopupOpen(this.guictx.CurrentWindow.GetID(id)):this.isPopupOpen(id)},CloseCurrentPopup(){let g=this.guictx,popup_idx=g.BeginPopupStack.length-1;if(!(popup_idx<0||popup_idx>=g.OpenPopupStack.length||g.BeginPopupStack[popup_idx].PopupId!=g.OpenPopupStack[popup_idx].PopupId)){for(;0<popup_idx;){var popup_window=g.OpenPopupStack[popup_idx].Window,parent_popup_window=g.OpenPopupStack[popup_idx-1].Window;let close_parent=!1;if(popup_window&&popup_window.Flags&WindowFlags.ChildMenu&&(null!=parent_popup_window&&parent_popup_window.Flags&WindowFlags.Modal||(close_parent=!0)),!close_parent)break;popup_idx--}this.closePopupToLevel(popup_idx,!0),g.NavWindow&&(g.NavWindow.DC.NavHideHighlightOneFrame=!0)}},isPopupOpen(id){var g=this.guictx;return g.OpenPopupStack.length>g.BeginPopupStack.length&&g.OpenPopupStack[g.BeginPopupStack.length].PopupId==id},getFrontMostPopupModal(){var g=this.guictx;for(let n=g.OpenPopupStack.length-1;0<=n;n--){var popup=g.OpenPopupStack[n].Window;if(popup&&popup.Flags&WindowFlags.Modal)return popup}return null},openPopupEx(id,openPos){let g=this.guictx,parent_window=g.CurrentWindow;var current_stack_size=g.BeginPopupStack.length;let popup_ref=new PopupRef;popup_ref.PopupId=id,popup_ref.Window=null,popup_ref.ParentWindow=parent_window,popup_ref.OpenFrameCount=g.FrameCount,popup_ref.OpenParentId=parent_window.IDStack.back(),popup_ref.OpenPopupPos=void 0===openPos?this.navCalcPreferredRefPos():openPos,popup_ref.OpenMousePos=this.IsMousePosValid(g.IO.MousePos)?g.IO.MousePos:popup_ref.OpenPopupPos,g.OpenPopupStack.length<current_stack_size+1?g.OpenPopupStack.push(popup_ref):g.OpenPopupStack[current_stack_size].PopupId==id&&g.OpenPopupStack[current_stack_size].OpenFrameCount==g.FrameCount-1?g.OpenPopupStack[current_stack_size].OpenFrameCount=popup_ref.OpenFrameCount:(g.OpenPopupStack.resize(current_stack_size+1),g.OpenPopupStack[current_stack_size]=popup_ref)},closePopupsOverWindow(refwin){var g=this.guictx;if(0!=g.OpenPopupStack.length){let popup_count_to_keep=0;if(refwin)for(;popup_count_to_keep<g.OpenPopupStack.length;popup_count_to_keep++){var popup=g.OpenPopupStack[popup_count_to_keep];if(popup.Window&&(console.assert(0!=(popup.Window.Flags&WindowFlags.Popup)),!(popup.Window.Flags&WindowFlags.ChildWindow))){let popup_or_descendent_has_focus=!1;for(let m=popup_count_to_keep;m<g.OpenPopupStack.length&&!popup_or_descendent_has_focus;m++)g.OpenPopupStack[m].Window&&g.OpenPopupStack[m].Window.RootWindow==refwin.RootWindow&&(popup_or_descendent_has_focus=!0);if(!popup_or_descendent_has_focus)break}}popup_count_to_keep<g.OpenPopupStack.length&&this.closePopupToLevel(popup_count_to_keep,!1)}},closePopupToLevel(remaining,applyFocusToWindowUnder){console.assert(0<=remaining);let g=this.guictx,focus_window=0<remaining?g.OpenPopupStack[remaining-1].Window:g.OpenPopupStack[0].ParentWindow;g.OpenPopupStack.length=remaining,applyFocusToWindowUnder&&(0==g.NavLayer&&(focus_window=this.navRestoreLastChildNavWindow(focus_window)),this.FocusWindow(focus_window))},beginPopupEx(id,is_open){console.assert("string"!=typeof id);let g=this.guictx;if(!this.isPopupOpen(id))return g.NextWindowData.Clear(),!1;let name;name=is_open&WindowFlags.ChildMenu?`##Menu_${g.BeginPopupStack.length}`:`##Popup_${id}`;is_open=this.Begin(name,null,is_open|WindowFlags.Popup);return is_open||this.EndPopup(),is_open},findBestWindowPosForPopup(win){var g=this.guictx,r_outer=this.getWindowAllowedExtentRect(win);if(win.Flags&WindowFlags.ChildMenu){console.assert(g.CurrentWindow==win);let parent_window=g.CurrentWindowStack[g.CurrentWindowStack.length-2];var sc=g.Style.ItemInnerSpacing.x;let r_avoid;r_avoid=parent_window.DC.MenuBarAppending?new Rect(-Number.MAX_VALUE,parent_window.Pos.y+parent_window.TitleBarHeight(),Number.MAX_VALUE,parent_window.Pos.y+parent_window.TitleBarHeight()+parent_window.MenuBarHeight()):new Rect(parent_window.Pos.x+sc,-Number.MAX_VALUE,parent_window.Pos.x+parent_window.Size.x-sc-parent_window.ScrollbarSizes.x,Number.MAX_VALUE);let lastAutoPos=new ValRef(win.AutoPosLastDirection);sc=this.findBestWindowPosForPopupEx(win.Pos,win.Size,lastAutoPos,r_outer,r_avoid);return win.AutoPosLastDirection=lastAutoPos.get(),sc}if(win.Flags&WindowFlags.Popup){var ref_pos=new Rect(win.Pos.x-1,win.Pos.y-1,win.Pos.x+1,win.Pos.y+1);let lastAutoPos=new ValRef(win.AutoPosLastDirection),pos=this.findBestWindowPosForPopupEx(win.Pos,win.Size,lastAutoPos,r_outer,ref_pos);return win.AutoPosLastDirection=lastAutoPos.get(),pos}if(win.Flags&WindowFlags.Tooltip){sc=g.Style.MouseCursorScale,ref_pos=this.navCalcPreferredRefPos();let r_avoid;r_avoid=g.NavDisableHighlight||!g.NavDisableMouseHover||g.IO.ConfigFlags&ConfigFlags.NavEnableSetMousePos?new Rect(ref_pos.x-16,ref_pos.y-8,ref_pos.x+24*sc,ref_pos.y+24*sc):new Rect(ref_pos.x-16,ref_pos.y-8,ref_pos.x+16,ref_pos.y+8);let lastAutoPos=new ValRef(win.AutoPosLastDirection),pos=this.findBestWindowPosForPopupEx(ref_pos,win.Size,lastAutoPos,r_outer,r_avoid);return win.AutoPosLastDirection=lastAutoPos.get(),win.AutoPosLastDirection==Dir.None&&(pos=Vec2.AddXY(ref_pos,2,2)),pos}return console.assert(0,"shouldn't reach here"),win.Pos},findBestWindowPosForPopupEx(ref_pos,size,last_dir,r_outer,r_avoid,policy=PopupPositionPolicy.Default){null==last_dir.value&&console.assert(last_dir.value,"last_dir must be a ValRef");var base_pos_clamped=Vec2.Clamp(ref_pos,r_outer.Min,Vec2.Subtract(r_outer.Max,size));if(policy==PopupPositionPolicy.ComboBox){const dirOrder=[Dir.Down,Dir.Right,Dir.Left,Dir.Up];for(let n=last_dir.get()!=Dir.None?-1:0;n<dirOrder.length;n++){var dir=-1==n?last_dir.get():dirOrder[n];if(-1==n||dir!=last_dir.get()){let pos;switch(dir){case Dir.Down:pos=new Vec2(r_avoid.Min.x,r_avoid.Max.y);break;case Dir.Right:pos=new Vec2(r_avoid.Min.x,r_avoid.Min.y-size.y);break;case Dir.Left:pos=new Vec2(r_avoid.Max.x-size.x,r_avoid.Max.y);break;case Dir.Up:pos=new Vec2(r_avoid.Max.x-size.x,r_avoid.Min.y-size.y)}if(r_outer.Contains(new Rect(pos,Vec2.Add(pos,size))))return last_dir.set(dir),pos}}}const dirOrder=[Dir.Right,Dir.Down,Dir.Up,Dir.Left];for(let n=last_dir.get()!=Dir.None?-1:0;n<dirOrder.length;n++){const dir=-1==n?last_dir.get():dirOrder[n];if(-1==n||dir!=last_dir.get()){var avail_w=(dir==Dir.Left?r_avoid.Min:r_outer.Max).x-(dir==Dir.Right?r_avoid.Max:r_outer.Min).x,avail_h=(dir==Dir.Up?r_avoid.Min:r_outer.Max).y-(dir==Dir.Down?r_avoid.Max:r_outer.Min).y;if(!(avail_w<size.x||avail_h<size.y)){let pos=new Vec2;return pos.x=dir==Dir.Left?r_avoid.Min.x-size.x:(dir==Dir.Right?r_avoid.Max:base_pos_clamped).x,pos.y=dir==Dir.Up?r_avoid.Min.y-size.y:(dir==Dir.Down?r_avoid.Max:base_pos_clamped).y,last_dir.set(dir),pos}}}last_dir.set(Dir.None);let pos=ref_pos.Clone();return pos.x=Math.max(Math.min(pos.x+size.x,r_outer.Max.x)-size.x,r_outer.Min.x),pos.y=Math.max(Math.min(pos.y+size.y,r_outer.Max.y)-size.y,r_outer.Min.y),pos}},ComboFlags={None:0,PopupAlignLeft:1,HeightSmall:2,HeightRegular:4,HeightLarge:8,HeightLargest:16,NoArrowButton:32,NoPreview:64};ComboFlags.HeightMask_=ComboFlags.HeightSmall|ComboFlags.HeightRegular|ComboFlags.HeightLarge|ComboFlags.HeightLargest;var ImguiComboMixin={BeginCombo(label,preview_value,flags=0){let g=this.guictx;var backup_next_window_size_constraint=g.NextWindowData.SizeConstraintCond;g.NextWindowData.SizeConstraintCond=0;let win=this.getCurrentWindow();if(win.SkipItems)return!1;console.assert((flags&(ComboFlags.NoArrowButton|ComboFlags.NoPreview))!=(ComboFlags.NoArrowButton|ComboFlags.NoPreview));let style=g.Style;var id=win.GetID(label),arrow_size=flags&ComboFlags.NoArrowButton?0:this.GetFrameHeight(),label_size=this.CalcTextSize(label,!0),frame_col=this.getNextItemWidth(),name=flags&ComboFlags.NoPreview?arrow_size:frame_col;const frame_bb=new Rect(win.DC.CursorPos,Vec2.AddXY(win.DC.CursorPos,name,label_size.y+2*style.FramePadding.y));var value_x2=new Rect(frame_bb.Min,Vec2.AddXY(frame_bb.Max,0<label_size.x?style.ItemInnerSpacing.x+label_size.x:0,0));if(this.itemSize(value_x2,style.FramePadding.y),!this.itemAdd(value_x2,id,frame_bb))return!1;var open_pos=this.GetCursorPos();let hovered=new ValRef,held=new ValRef;var pressed=this.ButtonBehavior(frame_bb,id,hovered,held);let popup_open=this.IsPopupOpen(id);frame_col=style.GetColor(hovered.get()?"FrameBgHovered":"FrameBg"),value_x2=Math.max(frame_bb.Min.x,frame_bb.Max.x-arrow_size);if(this.renderNavHighlight(frame_bb,id),flags&ComboFlags.NoPreview||win.DrawList.AddRectFilled(frame_bb.Min,new Vec2(value_x2,frame_bb.Max.y),frame_col,style.FrameRounding,CornerFlags.Left),flags&ComboFlags.NoArrowButton||(win.DrawList.AddRectFilled(new Vec2(value_x2,frame_bb.Min.y),frame_bb.Max,style.GetColor(popup_open||hovered.get()?"ButtonHovered":"Button"),style.FrameRounding,name<=arrow_size?CornerFlags.All:CornerFlags.Right),this.renderArrow(new Vec2(value_x2+style.FramePadding.y,frame_bb.Min.y+style.FramePadding.y),Dir.Down)),this.renderFrameBorder(frame_bb.Min,frame_bb.Max,style.FrameRounding),null==preview_value||flags&ComboFlags.NoPreview||this.renderTextClipped(Vec2.Add(frame_bb.Min,style.FramePadding),new Vec2(value_x2,frame_bb.Max.y),preview_value,null,Vec2.Zero()),0<label_size.x&&this.renderText(new Vec2(frame_bb.Max.x+style.ItemInnerSpacing.x,frame_bb.Min.y+style.FramePadding.y),label),!pressed&&g.NavActivateId!=id||popup_open||(0==win.DC.NavLayerCurrent&&(win.NavLastIds[0]=id),this.openPopupEx(id,open_pos),popup_open=!0),!popup_open)return!1;if(backup_next_window_size_constraint)g.NextWindowData.SizeConstraintCond=backup_next_window_size_constraint,g.NextWindowData.SizeConstraintRect.Min.x=Math.max(g.NextWindowData.SizeConstraintRect.Min.x,name);else{0==(flags&ComboFlags.HeightMask_)&&(flags|=ComboFlags.HeightRegular),console.assert(IsPowerOfTwo(flags&ComboFlags.HeightMask_));let popup_max_height_in_items=-1;flags&ComboFlags.HeightRegular?popup_max_height_in_items=8:flags&ComboFlags.HeightSmall?popup_max_height_in_items=4:flags&ComboFlags.HeightLarge&&(popup_max_height_in_items=20);var size_expected=this.calcMaxPopupHeightFromItemCount(popup_max_height_in_items);this.SetNextWindowSizeConstraints(new Vec2(name,0),new Vec2(Number.MAX_VALUE,size_expected))}name="##Combo_"+g.BeginPopupStack.length;let popup_win=this.findWindowByName(name);if(popup_win&&popup_win.WasActive){size_expected=this.calcWindowExpectedSize(popup_win);flags&ComboFlags.PopupAlignLeft&&(popup_win.AutoPosLastDirection=Dir.Left);var ret=this.getWindowAllowedExtentRect(popup_win);let lastAutoPos=new ValRef(popup_win.AutoPosLastDirection);ret=this.findBestWindowPosForPopupEx(frame_bb.GetBL(),size_expected,lastAutoPos,ret,frame_bb,PopupPositionPolicy.ComboBox);popup_win.AutoPosLastDirection=lastAutoPos.get(),this.SetNextWindowPos(ret)}ret=WindowFlags.AlwaysAutoResize|WindowFlags.Popup|WindowFlags.NoTitleBar|WindowFlags.NoResize|WindowFlags.NoSavedSettings;this.PushStyleVar("WindowPadding",new Vec2(style.FramePadding.x,style.WindowPadding.y));ret=this.Begin(name,null,ret);return this.PopStyleVar(),!!ret||(this.EndPopup(),console.assert(0),!1)},EndCombo(){this.EndPopup()},Combo(label,current_item,items,maxItems=-1,onChange){this.guictx;"function"==typeof maxItems&&null==onChange&&(onChange=maxItems,maxItems=-1),console.assert("number"==typeof maxItems);return this.ComboCB(label,current_item,function(i){return items[i]},items.length,maxItems,onChange)},ComboCB(label,current_item,getter,numItems,h=-1,onChange){var g=this.guictx;let item=current_item<0?null:getter(current_item);console.assert("number"==typeof h),-1==h||g.NextWindowData.SizeConstraintCond||(h=this.calcMaxPopupHeightFromItemCount(h),this.SetNextWindowSizeConstraints(new Vec2(0,0),new Vec2(Number.MAX_VALUE,h)));let value_changed=!1;if(!this.BeginCombo(label,null!=item?item.toString():""))return value_changed;for(let i=0;i<numItems;i++){let iitem=getter(i);this.PushID(i);var item_selected=i==current_item;let item_text;item_text=null==iitem||null==iitem?"*Unknown item*":iitem.toString(),this.Selectable(item_text,item_selected)&&(value_changed=!0,current_item=i),item_selected&&this.SetItemDefaultFocus(),this.PopID()}return this.EndCombo(),value_changed&&onChange&&onChange(current_item),value_changed},calcMaxPopupHeightFromItemCount(items_count){var g=this.guictx;return items_count<=0?Number.MAX_VALUE:(g.FontLineHeight+g.Style.ItemSpacing.y)*items_count-g.Style.ItemSpacing.y+2*g.Style.WindowPadding.y}},InputTextFlags={None:0,CharsDecimal:1,CharsHexadecimal:2,CharsUppercase:4,CharsNoBlank:8,AutoSelectAll:16,EnterReturnsTrue:32,CallbackCompletion:64,CallbackHistory:128,CallbackAlways:256,CallbackCharFilter:512,AllowTabInput:1024,CtrlEnterForNewLine:2048,NoHorizontalScroll:4096,AlwaysInsertMode:8192,ReadOnly:16384,Password:32768,NoUndoRedo:65536,CharsScientific:1<<17,CallbackResize:1<<18,Multiline:1<<20};const ValidChars={Decimal:"0123456789.-+*/",Scientific:"0123456789.-+*/eE",Hex:"0123456789AaBbCcDdEeFf"},MaxDisplayLength=2097152;let DOMTextEditing=null;class InputTextState{constructor(imgui){this.imgui=imgui,this.ID=0,this.Text=null,this.TextIsValid=!1,this.CurrentLen=0,this.InitialText=null,this.ScrollX=0,this.EditState=new TextEditState(imgui),this.CursorAnim=0,this.CursorFollow=!1,this.SelectedAllMouseLock=!1,this.UserFlags=0,this.UserCallback=null,(this.UserCallbackData=null)==DOMTextEditing&&(DOMTextEditing=App.IsMobileDevice())}Init(text){text.IsMutable?(this.Text=text.Clone(),this.InitialText=text.toString()):(this.Text=new MutableString(text),this.InitialText=text)}InitTextEdit(singleLine,fontScale){this.EditState.Init(singleLine,fontScale)}Update(imgui,id,frame,rad,multiline){if(DOMTextEditing){this.domElements||(this.domElements={});let eltype;eltype=multiline?"_multi":"_single";var idstr=`imgui_inputtext${eltype}`;let domEl=this.domElements[eltype];if(rad){var io=imgui.GetIO();if(!domEl){let style=imgui.GetStyle();var bgcolor=style.GetColor("FrameBg").AsHashStr(!0),txtcolor=style.GetColor("Text").AsStr(),bordercolor=style.GetColor("Border").AsStr(),rad=style.FrameRounding;multiline?domEl=document.createElement("textarea"):(domEl=document.createElement("input"),domEl.setAttribute("type","text")),this.domElements[eltype]=domEl,domEl.style.position="absolute",domEl.style.display="inline",domEl.style.backgroundColor=bgcolor,domEl.style.color=txtcolor,domEl.style.borderRadius=`${rad}px ${rad}px`,domEl.style.borderWidth=".5px",domEl.style.borderColor=bordercolor,domEl.onkeyup=evt=>{13!=evt.keyCode||multiline?multiline&&this.Text.Set(domEl.value):(this.Text.Set(domEl.value),domEl.blur(),domEl.style.display="none",imgui.FocusWindow(null))},document.body.appendChild(domEl)}domEl.setAttribute("id",idstr);let el=io.canvas,top=el.offsetTop,left=el.offsetLeft;for(;el.offsetParent;)el=el.offsetParent,top+=el.offsetTop,left+=el.offsetLeft;domEl.style.left=left+frame.Min.x+"px",domEl.style.top=top+frame.Min.y+"px",domEl.style.width=frame.Max.x-frame.Min.x+"px",domEl.style.height=frame.Max.y-frame.Min.y+"px",domEl.style.display="inline",domEl.value=this.Text.Get(),domEl.focus()}else domEl&&domEl.id==idstr&&(domEl.style.display="none")}}CursorAnimReset(){this.CursorAnim=-.3}CursorClamp(){this.EditState.ClampCursor(this.Text)}Cut(){this.EditState.Cut(this.Text)}Paste(pasteTxt){this.EditState.Paste(this.Text,pasteTxt)}HasSelection(){return this.EditState.HasSelection()}GetSelectedText(){return this.EditState.GetSelectedText(this.Text)}ClearSelection(){return this.EditState.ClearSelection()}SelectAll(){this.EditState.SelectAll(this.Text)}GetUndoAvailCount(){return this.EditState.GetUndoAvailCount()}GetRedoAvailCount(){return this.EditState.GetRedoAvailCount()}Click(x,y){this.EditState.Click(this.Text,x,y)}Drag(x,y){return this.EditState.Drag(this.Text,x,y)}OnKeyPressed(key){this.EditState.Key(this.Text,key),this.CursorFollow=!0,this.CursorAnimReset()}}class InputTextCallbackData{constructor(){this.EventFlag=0,this.Flags=0,this.UserData=null,this.EventChar=0,this.EventKey=0,this.Text=null,this.TextDirty=!1,this.CursorPos=0,this.SelectionStart=0,this.SelectionEnd=0}ImGuiInputTextCallbackData(){}DeleteChars(pos,num){}InsertChars(pos,text){}HasSelection(){return this.SelectionStart!=this.SelectionEnd}}const InputtextIFmt="%d",InputtextFFmt="%.3f",InputtextDFmt="%.6f",InputtextHFmt="%.8x";var ImguiInputMixin={InputText(label,mstr,flags=0,onEdit=null,editData=null,onChange=null){return console.assert(!(flags&InputTextFlags.Multiline)),this.inputTextEx(label,null,mstr,new Vec2(0,0),flags,onEdit,editData,onChange)},InputTextMultiline(label,mstr,size,flags=0,onEdit=null,editData=null){return this.inputTextEx(label,null,mstr,size,flags|InputTextFlags.Multiline,onEdit,editData)},InputTextWithHint(label,hint,mstr,flags,onEdit,editData){return console.assert(!(flags&InputTextFlags.Multiline)),this.inputTextEx(label,hint,mstr,new Vec2(0,0),flags,onEdit,editData)},InputFloat(label,v,step=0,step_fast=0,format=null,flags=0,onChange){return null==format&&(format=InputtextFFmt),flags|=InputTextFlags.CharsScientific,this.InputScalar(label,DataType.Float,v,0<step?step:null,0<step_fast?step_fast:null,format,flags,onChange)},InputDouble(label,v,step=0,step_fast=0,format=null,flags=0,onChange){return null==format&&(format=InputtextDFmt),this.InputFloat(label,v,step,step_fast,format,flags,onChange)},InputFloat2(label,v,format=null,flags=0,onChange){return null==format&&(format=InputtextFFmt),this.InputScalarN(label,DataType.Float,v,2,null,null,format,flags,onChange)},InputFloat3(label,v,format=null,flags=0,onChange){return null==format&&(format=InputtextFFmt),this.InputScalarN(label,DataType.Float,v,3,null,null,format,flags,onChange)},InputFloat4(label,v,format=null,flags=0,onChange){return null==format&&(format=InputtextFFmt),this.InputScalarN(label,DataType.Float,v,4,null,null,format,flags,onChange)},InputInt(label,v,step=1,step_fast=100,flags=0,onChange){var format=flags&InputTextFlags.CharsHexadecimal?InputtextHFmt:InputtextIFmt;return this.InputScalar(label,DataType.S32,v,0<step?step:null,0<step_fast?step_fast:null,format,flags,onChange)},InputInt2(label,v,flags=0,onChange){return this.InputScalarN(label,DataType.S32,v,2,null,null,InputtextIFmt,flags,onChange)},InputInt3(label,v,flags=0,onChange){return this.InputScalarN(label,DataType.S32,v,3,null,null,InputtextIFmt,flags,onChange)},InputInt4(label,v,flags=0,onChange){return this.InputScalarN(label,DataType.S32,v,4,null,null,InputtextIFmt,flags,onChange)},InputScalarN(label,data_type,v,nch,step,step_fast,fmt,flags,onChange){if(this.getCurrentWindow().SkipItems)return!1;var g=this.guictx;let value_changed=!1;this.BeginGroup(),this.PushID(label),this.pushMultiItemsWidths(nch,this.getNextItemWidth());for(let i=0;i<nch;i++)this.PushID(i),value_changed|=this.InputScalar("",data_type,v[i],step,step_fast,fmt,flags,function(newval){v[i]=newval}),this.SameLine(0,g.Style.ItemInnerSpacing.x),this.PopID(),this.PopItemWidth();return this.PopID(),this.textEx(label.split("##")[0]),this.EndGroup(),value_changed&&onChange&&onChange(v),value_changed},InputScalar(label,data_type,backup_frame_padding,step,step_fast,format=null,flags=0,onChange=null){if(this.getCurrentWindow().SkipItems)return!1;var g=this.guictx;let style=g.Style,buf=FormatValues(format=null==format?data_type==DataType.Float?InputtextFFmt:InputtextIFmt:format,[backup_frame_padding]),value_changed=!1;0==(flags&(InputTextFlags.CharsHexadecimal|InputTextFlags.CharsScientific))&&(flags|=InputTextFlags.CharsDecimal),flags|=InputTextFlags.AutoSelectAll;let origStr=g.InputTextState.InitialText;if(null!=step&&0!=step){var button_size=this.GetFrameHeight();this.BeginGroup(),this.PushID(label),this.SetNextItemWidth(Math.max(1,this.getNextItemWidth()-2*(button_size+style.ItemInnerSpacing.x))),this.InputText("",buf,flags,null,null,function(newval){value_changed=DataTypeApplyOpFromText(newval,origStr,data_type,format,newval=>{buf=newval})});backup_frame_padding=style.FramePadding.Clone();style.FramePadding.x=style.FramePadding.y;let button_flags=ButtonFlags.Repeat|ButtonFlags.DontClosePopups;flags&InputTextFlags.ReadOnly&&(button_flags|=ButtonFlags.Disabled),this.SameLine(0,style.ItemInnerSpacing.x),this.ButtonEx("-",new Vec2(button_size,button_size),button_flags)&&(buf=DataTypeApplyOp(data_type,"-",buf,g.IO.KeyCtrl&&step_fast?step_fast:step),value_changed=!0),this.SameLine(0,style.ItemInnerSpacing.x),this.ButtonEx("+",new Vec2(button_size,button_size),button_flags)&&(buf=DataTypeApplyOp(data_type,"+",buf,g.IO.KeyCtrl&&step_fast?step_fast:step),value_changed=!0),this.SameLine(0,style.ItemInnerSpacing.x),this.textEx(label.split("##")[0]),style.FramePadding=backup_frame_padding,this.PopID(),this.EndGroup()}else this.InputText(label,buf,flags,null,null,function(newval){value_changed=DataTypeApplyOpFromText(newval,origStr,data_type,format,newval=>buf=newval)});return value_changed&&onChange&&onChange(buf),value_changed},inputScalarAsWidgetReplacement(bb,id,label,datatype,val,format){return 0==this.guictx.ScalarAsInputTextId&&this.clearActiveID(),console.assert(0,"implement me"),!1},inputTextEx(label,scroll_increment_x,val,ctrl_nl,flags,onEdit,editData,onChange){let win=this.getCurrentWindow();if(win.SkipItems)return!1;console.assert(!(flags&InputTextFlags.CallbackHistory&&flags&InputTextFlags.Multiline)),console.assert(!(flags&InputTextFlags.CallbackCompletion&&flags&InputTextFlags.AllowTabInput));let g=this.guictx,io=g.IO;const style=g.Style;var ismultiline=flags&InputTextFlags.Multiline,is_multiline=0!=(flags&InputTextFlags.Multiline),is_readonly=0!=(flags&InputTextFlags.ReadOnly),is_password=0!=(flags&InputTextFlags.Password),is_redo=0==(flags&InputTextFlags.NoUndoRedo);0!=(flags&InputTextFlags.CallbackResize)&&console.assert(null!=onEdit),is_multiline&&this.BeginGroup();var id=win.GetID(label),label_size=this.CalcTextSize(label,!0);let size=this.calcItemSize(ctrl_nl,this.getNextItemWidth(),(is_multiline?8*this.GetTextLineHeight():label_size.y)+2*style.FramePadding.y);const frame_bb=new Rect(win.DC.CursorPos,Vec2.Add(win.DC.CursorPos,size));var is_osx_shift_shortcut=new Rect(frame_bb.Min,Vec2.AddXY(frame_bb.Max,0<label_size.x?style.ItemInnerSpacing.x+label_size.x:0,0));let draw_window=win;if(is_multiline){if(!this.itemAdd(is_osx_shift_shortcut,id,frame_bb))return this.itemSize(is_osx_shift_shortcut,style.FramePadding.y),this.EndGroup(),!1;if(!this.BeginChildFrame(id,frame_bb.GetSize()))return this.EndChildFrame(),this.EndGroup(),!1;draw_window=this.getCurrentWindow(),draw_window.DC.NavLayerActiveMaskNext|=draw_window.DC.NavLayerCurrentMask,size.x-=draw_window.ScrollbarSizes.x}else if(this.itemSize(is_osx_shift_shortcut,style.FramePadding.y),!this.itemAdd(is_osx_shift_shortcut,id,frame_bb))return!1;var is_wordmove_key_down=this.itemHoverable(frame_bb,id);is_wordmove_key_down&&(g.MouseCursor=MouseCursor.TextInput);let istate=null;g.InputTextState.ID==id&&(istate=g.InputTextState);var is_shortcut_key=this.focusableItemRegister(win,id),cursor_screen_pos=is_shortcut_key&&g.FocusRequestCurrWindow==win&&g.FocusRequestCurrCounterAll==win.DC.FocusCounterAll,enter_returns_true=is_shortcut_key&&!cursor_screen_pos,val_display_from_state=is_wordmove_key_down&&io.MouseClicked[0],selTxt=g.ActiveId!=id&&(g.NavInputId==id||g.NavActivateId==id&&g.NavInputSource==InputSource.NavKeyboard),ctrl_nl=is_multiline&&null!=istate&&0==g.ActiveId&&g.ActiveIdPreviousFrame==this.getScrollbarID(draw_window,Axis.Y),is_osx_shift_shortcut=is_multiline&&null!=istate&&g.ActiveId==this.getScrollbarID(draw_window,Axis.Y);let clear_active_id=!1,select_all=g.ActiveId!=id&&(0!=(flags&InputTextFlags.AutoSelectAll)||selTxt)&&!is_multiline;is_shortcut_key=is_shortcut_key||val_display_from_state||ctrl_nl||selTxt,ctrl_nl=is_shortcut_key||is_osx_shift_shortcut;ctrl_nl&&g.ActiveId!=id&&(istate=g.InputTextState,istate.CursorAnimReset(),istate.Init(val),istate.ID==id?istate.CursorClamp():(istate.ID=id,istate.ScrollX=0,istate.InitTextEdit(!is_multiline),!is_multiline&&cursor_screen_pos&&(select_all=!0)),istate.EditState.InsertMode=flags&InputTextFlags.AlwaysInsertMode,!is_multiline&&(enter_returns_true||val_display_from_state&&io.KeyCtrl)&&(select_all=!0)),g.ActiveId!=id&&is_shortcut_key&&(console.assert(istate&&istate.ID==id),this.setActiveID(id,win),this.setFocusID(id,win),this.FocusWindow(win),istate.Update(this,id,frame_bb,!0,ismultiline),console.assert(NavInput.COUNT<32),g.ActiveIdBlockNavInputFlags=1<<NavInput.Cancel,flags&(InputTextFlags.CallbackCompletion|InputTextFlags.AllowTabInput)&&(g.ActiveIdBlockNavInputFlags|=1<<NavInput.KeyTab),is_multiline||flags&InputTextFlags.CallbackHistory||(g.ActiveIdAllowNavDirFlags=1<<Dir.Up|1<<Dir.Down),App.IsMobileDevice()),g.ActiveId==id&&null==istate&&this.clearActiveID(),g.ActiveId!=id||!io.MouseClicked[0]||ctrl_nl||is_shortcut_key||(clear_active_id=!0);cursor_screen_pos=g.ActiveId==id||istate&&is_osx_shift_shortcut;let render_selection=istate&&istate.HasSelection()&&cursor_screen_pos,value_changed=!1,enter_pressed=!1;enter_returns_true=0!=(flags&InputTextFlags.EnterReturnsTrue);is_readonly&&null!=istate&&(cursor_screen_pos||render_selection)&&(istate.Init(val),istate.CursorClamp(),render_selection&=istate.HasSelection());val_display_from_state=(cursor_screen_pos||render_selection||g.ActiveId==id)&&!is_readonly&&istate&&istate.TextIsValid;let is_displaying_hint=!1;if(null!=scroll_increment_x&&(is_displaying_hint=val_display_from_state?0==istate.Text.Length():0==val.Length()),is_password&&!is_displaying_hint&&this.PushFont(g.InputTextPasswordFont),g.ActiveId==id){console.assert(null!=istate),istate.UserFlags=flags,istate.UserCallback=onEdit,istate.UserCallbackData=editData,g.ActiveIdAllowOverlap=!io.MouseDown[0],g.WantTextInputNextFrame=1;var is_startend_key_down=io.MousePos.x-frame_bb.Min.x-style.FramePadding.x+istate.ScrollX,is_paste=is_multiline?io.MousePos.y-draw_window.DC.CursorPos.y-style.FramePadding.y:.5*g.FontLineHeight,is_undo=io.ConfigMacOSXBehaviors;select_all||is_wordmove_key_down&&!is_undo&&io.MouseDoubleClicked[0]?(istate.SelectAll(),istate.SelectedAllMouseLock=!0):is_wordmove_key_down&&is_undo&&io.MouseDoubleClicked[0]?(istate.OnKeyPressed(TextEditMetaKeys.WordLeft),istate.OnKeyPressed(TextEditMetaKeys.WordRight|TextEditMetaKeys.Shift)):io.MouseClicked[0]&&!istate.SelectedAllMouseLock?is_wordmove_key_down&&(istate.Click(is_startend_key_down,is_paste),istate.CursorAnimReset()):!io.MouseDown[0]||istate.SelectedAllMouseLock||0==io.MouseDelta.x&&0==io.MouseDelta.y||(istate.Drag(is_startend_key_down,is_paste),istate.CursorAnimReset(),istate.CursorFollow=!0),istate.SelectedAllMouseLock&&!io.MouseDown[0]&&(istate.SelectedAllMouseLock=!1);var is_cut=io.KeyCtrl&&!io.KeyAlt||is_undo&&io.KeySuper;if(flags&InputTextFlags.AllowTabInput&&this.isKeyPressedMap(Key.Tab)&&!is_cut&&!io.KeyShift&&!is_readonly){let c=this.inputTextFilterChar("\t",flags,onEdit,editData);c&&istate.OnKeyPressed(c.charCodeAt(0))}if(0<io.InputKeyEvents.length){if(!is_cut&&!is_readonly&&!selTxt)for(let n=0;n<io.InputKeyEvents.length;n++){var evt=io.InputKeyEvents[n],key=evt.key,keyCode=evt.keyCode;if((9!=keyCode||!evt.shiftKey)&&(!(evt.ctrlKey||evt.metaKey||evt.altKey)&&null==io.NavKeys[key])){let char=this.inputTextFilterChar(key,flags,onEdit,editData);char&&istate.OnKeyPressed(char.charCodeAt(0))}}io.InputKeyEvents.resize(0)}}let cancel_edit=!1;if(g.ActiveId==id&&!g.ActiveIdIsJustActivated&&!clear_active_id){console.assert(null!=istate);ctrl_nl=io.KeyShift?TextEditMetaKeys.Shift:0;const is_osx=io.ConfigMacOSXBehaviors;is_shortcut_key=(is_osx?io.KeySuper&&!io.KeyCtrl:io.KeyCtrl&&!io.KeySuper)&&!io.KeyAlt&&!io.KeyShift,is_osx_shift_shortcut=is_osx&&io.KeySuper&&io.KeyShift&&!io.KeyCtrl&&!io.KeyAlt,is_wordmove_key_down=is_osx?io.KeyAlt:io.KeyCtrl,is_startend_key_down=is_osx&&io.KeySuper&&!io.KeyCtrl&&!io.KeyAlt,is_paste=io.KeyCtrl&&!io.KeyShift&&!io.KeyAlt&&!io.KeySuper,is_undo=io.KeyShift&&!io.KeyCtrl&&!io.KeyAlt&&!io.KeySuper,is_cut=(is_shortcut_key&&this.isKeyPressedMap(Key.X)||is_undo&&this.isKeyPressedMap(Key.Delete))&&!is_readonly&&!is_password&&(!is_multiline||istate.HasSelection()),selTxt=(is_shortcut_key&&this.isKeyPressedMap(Key.C)||is_paste&&this.isKeyPressedMap(Key.Insert))&&!is_password&&(!is_multiline||istate.HasSelection()),is_paste=(is_shortcut_key&&this.isKeyPressedMap(Key.V)||is_undo&&this.isKeyPressedMap(Key.Insert))&&!is_readonly,is_undo=is_shortcut_key&&this.isKeyPressedMap(Key.Z)&&!is_readonly&&is_redo,is_redo=(is_shortcut_key&&this.isKeyPressedMap(Key.Y)||is_osx_shift_shortcut&&this.isKeyPressedMap(Key.Z))&&!is_readonly&&is_redo;if(this.isKeyPressedMap(Key.LeftArrow))istate.OnKeyPressed((is_startend_key_down?TextEditMetaKeys.LineStart:is_wordmove_key_down?TextEditMetaKeys.WordLeft:TextEditMetaKeys.Left)|ctrl_nl);else if(this.isKeyPressedMap(Key.RightArrow))istate.OnKeyPressed((is_startend_key_down?TextEditMetaKeys.LineEnd:is_wordmove_key_down?TextEditMetaKeys.WordRight:TextEditMetaKeys.Right)|ctrl_nl);else if(this.isKeyPressedMap(Key.UpArrow)&&is_multiline)io.KeyCtrl?draw_window.SetWindowScrollY(Math.max(draw_window.Scroll.y-g.FontLineHeight,0)):istate.OnKeyPressed((is_startend_key_down?TextEditMetaKeys.TextStart:TextEditMetaKeys.Up)|ctrl_nl);else if(this.isKeyPressedMap(Key.DownArrow)&&is_multiline)io.KeyCtrl?draw_window.SetWindowScrollY(Math.max(draw_window.Scroll.y+g.FontLineHeight,this.GetScrollMaxY())):istate.OnKeyPressed((is_startend_key_down?TextEditMetaKeys.TextEnd:TextEditMetaKeys.Down)|ctrl_nl);else if(this.isKeyPressedMap(Key.Home))istate.OnKeyPressed(io.KeyCtrl?TextEditMetaKeys.TextStart|ctrl_nl:TextEditMetaKeys.LineStart|ctrl_nl);else if(this.isKeyPressedMap(Key.End))istate.OnKeyPressed(io.KeyCtrl?TextEditMetaKeys.TextEnd|ctrl_nl:TextEditMetaKeys.LineEnd|ctrl_nl);else if(this.isKeyPressedMap(Key.Delete)&&!is_readonly)istate.OnKeyPressed(TextEditMetaKeys.Delete|ctrl_nl);else if(this.isKeyPressedMap(Key.Backspace)&&!is_readonly)istate.HasSelection()||(is_wordmove_key_down?istate.OnKeyPressed(TextEditMetaKeys.WordLeft|TextEditMetaKeys.Shift):is_osx&&io.KeySuper&&!io.KeyAlt&&!io.KeyCtrl&&istate.OnKeyPressed(TextEditMetaKeys.LineStart|TextEditMetaKeys.Shift)),istate.OnKeyPressed(TextEditMetaKeys.Backspace|ctrl_nl);else if(this.isKeyPressedMap(Key.Enter)){ctrl_nl=0!=(flags&InputTextFlags.CtrlEnterForNewLine);if(!is_multiline||ctrl_nl&&!io.KeyCtrl||!ctrl_nl&&io.KeyCtrl)enter_pressed=clear_active_id=!0;else if(!is_readonly){let c=this.inputTextFilterChar("\n",flags,onEdit,editData);c&&istate.OnKeyPressed(c.charCodeAt(0))}}else this.isKeyPressedMap(Key.Escape)?clear_active_id=cancel_edit=!0:is_undo||is_redo?(istate.OnKeyPressed(is_undo?TextEditMetaKeys.Undo:TextEditMetaKeys.Redo),istate.ClearSelection()):is_shortcut_key&&this.isKeyPressedMap(Key.A)?(istate.SelectAll(),istate.CursorFollow=!0):is_cut||selTxt?(null!=(selTxt=istate.GetSelectedText())&&this.SetClipboardText(selTxt),is_cut&&(istate.HasSelection()||istate.SelectAll(),istate.CursorFollow=!0,istate.Cut())):is_paste&&this.GetClipboardText(clipboard=>{if(clipboard&&clipboard.length){let clipFiltered=[];for(let i=0;i<clipboard.length;i++){let c=clipboard[i];var code=c.charCodeAt(0);if(0==code)break;65536<=code||(c=this.inputTextFilterChar(c,flags,onEdit,editData),c&&clipFiltered.push(c))}clipFiltered=clipFiltered.join(""),0<clipFiltered.length&&(istate.Paste(clipFiltered),istate.CursorFollow=!0)}else console.debug("empty clipboard")});render_selection|=istate.HasSelection()&&cursor_screen_pos}if(g.ActiveId==id){console.assert(null!=istate);let apply_new_text=null;if(cancel_edit&&(is_readonly||val==istate.InitialText||(apply_new_text=istate.InitialText)),!cancel_edit||enter_pressed&&enter_returns_true){if(is_readonly||(istate.TextIsValid=!0),0!=(flags&(InputTextFlags.CallbackCompletion|InputTextFlags.CallbackHistory|InputTextFlags.CallbackAlways))){console.assert(null!=onEdit||enter_returns_true);let event_flag=0,event_key=Key.COUNT;if(0!=(flags&InputTextFlags.CallbackCompletion)&&this.isKeyPressedMap(Key.Tab)?(event_flag=InputTextFlags.CallbackCompletion,event_key=Key.Tab):0!=(flags&InputTextFlags.CallbackHistory)&&this.isKeyPressedMap(Key.UpArrow)?(event_flag=InputTextFlags.CallbackHistory,event_key=Key.UpArrow):0!=(flags&InputTextFlags.CallbackHistory)&&this.isKeyPressedMap(Key.DownArrow)?(event_flag=InputTextFlags.CallbackHistory,event_key=Key.DownArrow):flags&InputTextFlags.CallbackAlways&&(event_flag=InputTextFlags.CallbackAlways),event_flag){let callback_data=new InputTextCallbackData;callback_data.EventFlag=event_flag,callback_data.Flags=flags,callback_data.UserData=editData,callback_data.EventKey=event_key,callback_data.Text=istate.Text,callback_data.TextDirty=!1,callback_data.CursorPos=istate.EditState.Cursor,callback_data.SelectionStart=istate.EditState.SelectionStart,callback_data.SelectionEnd=istate.EditState.SelectionEnd,onEdit?onEdit(callback_data):event_key==Key.Tab&&enter_returns_true&&(enter_pressed=clear_active_id=!0),console.assert(callback_data.Flags==flags),istate.EditState.Cursor=callback_data.CursorPos,istate.EditState.SelectionStart=callback_data.SelectionStart,istate.EditState.SelectionEnd=callback_data.SelectionEnd,callback_data.TextDirty&&istate.CursorAnimReset()}}is_readonly||istate.Text.Equals(val)||(apply_new_text=istate.Text)}apply_new_text&&(null!=val.Copy&&val.Copy(apply_new_text),value_changed=!0),istate.UserFlags=0,istate.UserCallback=null,istate.UserCallbackData=null}clear_active_id&&g.ActiveId==id&&(this.clearActiveID(),istate.Update(this,id,frame_bb,!1,ismultiline)),is_multiline||(this.renderNavHighlight(frame_bb,id),this.renderFrame(frame_bb.Min,frame_bb.Max,style.GetColor("FrameBg"),!0,style.FrameRounding));var clip_rect=Rect.FromXY(frame_bb.Min.x,frame_bb.Min.y,frame_bb.Min.x+size.x,frame_bb.Min.y+size.y);let draw_pos=is_multiline?draw_window.DC.CursorPos.Clone():Vec2.Add(frame_bb.Min,style.FramePadding),text_size=Vec2.Zero(),val_display=val_display_from_state?istate.Text:val,val_display_length=0;if(is_displaying_hint&&(val_display=scroll_increment_x),cursor_screen_pos||render_selection){console.assert(null!=istate);let cursor_offset=new Vec2,select_start_offset=new Vec2;{let searches_input_offset=[0,0],searches_result_line_no=[-1e3,-1e3],searches_remaining=0;cursor_screen_pos&&(searches_input_offset[0]=istate.EditState.Cursor,searches_result_line_no[0]=-1,searches_remaining++),render_selection&&(searches_input_offset[1]=Math.min(istate.EditState.SelectStart,istate.EditState.SelectEnd),searches_result_line_no[1]=-1,searches_remaining++),searches_remaining+=is_multiline?1:0;let line_count=0;for(let i=0;i<istate.Text.Length();i++)if(istate.Text.IsNewline(i)){if(line_count++,-1==searches_result_line_no[0]&&i>=searches_input_offset[0]&&(searches_result_line_no[0]=line_count,--searches_remaining<=0))break;if(-1==searches_result_line_no[1]&&i>=searches_input_offset[1]&&(searches_result_line_no[1]=line_count,--searches_remaining<=0))break}line_count++,-1==searches_result_line_no[0]&&(searches_result_line_no[0]=line_count),-1==searches_result_line_no[1]&&(searches_result_line_no[1]=line_count);var scroll_increment_x=istate.Text.FindLineBegin(searches_input_offset[0]);cursor_offset.x=istate.EditState.CalcTextRunSize(istate.Text,scroll_increment_x,searches_input_offset[0],!0).x,cursor_offset.y=searches_result_line_no[0]*g.FontLineHeight,0<=searches_result_line_no[1]&&(scroll_increment_x=istate.Text.FindLineBegin(searches_input_offset[1]),select_start_offset.x=istate.EditState.CalcTextRunSize(istate.Text,scroll_increment_x,searches_input_offset[1],!0).x,select_start_offset.y=searches_result_line_no[1]*g.FontLineHeight),is_multiline&&(text_size=new Vec2(size.x,line_count*g.FontLineHeight))}if(cursor_screen_pos&&istate.CursorFollow){if(flags&InputTextFlags.NoHorizontalScroll?istate.ScrollX=0:(scroll_increment_x=.25*size.x,cursor_offset.x<istate.ScrollX?istate.ScrollX=Math.floor(Math.max(0,cursor_offset.x-scroll_increment_x)):cursor_offset.x-size.x>=istate.ScrollX&&(istate.ScrollX=Math.floor(cursor_offset.x-size.x+scroll_increment_x))),is_multiline){let scroll_y=draw_window.Scroll.y;cursor_offset.y-g.FontLineHeight<scroll_y?scroll_y=Math.max(0,cursor_offset.y-g.FontLineHeight):cursor_offset.y-size.y>=scroll_y&&(scroll_y=cursor_offset.y-size.y),draw_window.DC.CursorPos.y+=draw_window.Scroll.y-scroll_y,draw_window.Scroll.y=scroll_y,draw_pos.y=draw_window.DC.CursorPos.y}istate.CursorFollow=!1}var draw_scroll=new Vec2(istate.ScrollX,0);if(render_selection){var str=Math.min(istate.EditState.SelectStart,istate.EditState.SelectEnd),text_selected_end=Math.max(istate.EditState.SelectStart,istate.EditState.SelectEnd),bg_color=style.GetColor("TextSelectedBg",cursor_screen_pos?1:.6),bg_offy_up=is_multiline?0:-1,bg_offy_dn=is_multiline?0:2;let rect_pos=Vec2.Subtract(Vec2.Add(draw_pos,select_start_offset),draw_scroll);g.Font.MeasureBegin();for(let p=str;p<text_selected_end&&!(rect_pos.y>clip_rect.w+g.FontLineHeight);){if(rect_pos.y<clip_rect.y)for(;p<text_selected_end&&!istate.Text.IsNewline(p++););else{let ret=istate.EditState.CalcTextRunSize(istate.Text,p,text_selected_end,!0);p=ret.lastIndex,ret.x<=0&&(ret.x=Math.floor(.5*g.Font.MeasureWidth(" ")));let rect=new Rect(Vec2.AddXY(rect_pos,0,bg_offy_up-g.FontLineHeight),Vec2.AddXY(rect_pos,ret.x,bg_offy_dn));rect.ClipWith(clip_rect),rect.Overlaps(clip_rect)&&draw_window.DrawList.AddRectFilled(rect.Min,rect.Max,bg_color)}rect_pos.x=draw_pos.x-draw_scroll.x,rect_pos.y+=g.FontLineHeight}g.Font.MeasureEnd()}if((is_multiline||val_display_length<MaxDisplayLength)&&(cursor_is_visible=style.GetColor(is_displaying_hint?"TextDisabled":"Text"),str=val_display.toString(),draw_window.DrawList.AddText(str,Vec2.Subtract(draw_pos,draw_scroll),g.Font,g.FontLineHeight,cursor_is_visible,0,is_multiline?null:clip_rect)),cursor_screen_pos){istate.CursorAnim+=io.DeltaTime;var cursor_is_visible=!g.IO.ConfigInputTextCursorBlink||istate.CursorAnim<=0||istate.CursorAnim%1.2<=.8,cursor_screen_pos=Vec2.Subtract(Vec2.Add(draw_pos,cursor_offset),draw_scroll);let cursor_screen_rect=Rect.FromXY(cursor_screen_pos.x,cursor_screen_pos.y-g.FontLineHeight+.5,cursor_screen_pos.x+1,cursor_screen_pos.y-1.5);cursor_is_visible&&cursor_screen_rect.Overlaps(clip_rect)&&draw_window.DrawList.AddLine(cursor_screen_rect.Min,cursor_screen_rect.GetBL(),style.GetColor("Text")),is_readonly||(g.PlatformImePos=new Vec2(cursor_screen_pos.x-1,cursor_screen_pos.y-g.FontLineHeight))}}else{let str=val_display.toString();if(is_multiline?text_size=new Vec2(size.x,this.calcTextLineCount(val_display)*g.FontLineHeight):val_display_length=str?str.length:0,is_multiline||val_display_length<MaxDisplayLength){let col=style.GetColor(is_displaying_hint?"TextDisabled":"Text");draw_window.DrawList.AddText(str,draw_pos,g.Font,g.FontLineHeight,col,0,is_multiline?null:clip_rect)}}return is_multiline&&(this.Dummy(Vec2.AddXY(text_size,0,g.FontLineHeight)),this.EndChildFrame(),this.EndGroup()),is_password&&!is_displaying_hint&&this.PopFont(),!g.LogEnabled||is_password&&!is_displaying_hint||this.logRenderedText(draw_pos,val_display),0<label_size.x&&this.renderText(new Vec2(frame_bb.Max.x+style.ItemInnerSpacing.x,frame_bb.Min.y+style.FramePadding.y),label),value_changed&&(this.markItemEdited(id),onChange&&onChange(istate.Text.toString())),0!=(flags&InputTextFlags.EnterReturnsTrue)?enter_pressed:value_changed},calcTextLineCount(mstr){return mstr.CountLines()},inputTextFilterChar(c,flags,onEdit,userdata){var ccode=c.charCodeAt(0);if(ccode<32){var pass=!1;if(pass|="\n"==c&&flags&InputTextFlags.Multiline,!(pass|="\t"==c&&flags&InputTextFlags.AllowTabInput))return null}if(57344<=ccode&&ccode<=63743)return null;if(flags&(InputTextFlags.CharsDecimal|InputTextFlags.CharsHexadecimal|InputTextFlags.CharsUppercase|InputTextFlags.CharsNoBlank|InputTextFlags.CharsScientific)){if(flags&InputTextFlags.CharsDecimal&&-1==ValidChars.Decimal.indexOf(c))return null;if(flags&InputTextFlags.CharsScientific&&-1==ValidChars.Scientific.indexOf(c))return null;if(flags&InputTextFlags.CharsHexadecimal&&-1==ValidChars.Hex.indexOf(c))return null;if(flags&InputTextFlags.CharsUppercase&&"a"<=c&&c<="z"&&(c=c.toUpperCase()),flags&InputTextFlags.CharsNoBlank&&/\s/.test(c))return null}if(flags&InputTextFlags.CallbackCharFilter){let callback_data=new InputTextCallbackData;if(callback_data.EventFlag=InputTextFlags.CallbackCharFilter,callback_data.EventChar=c,callback_data.Flags=flags,callback_data.UserData=userdata,0!=onEdit(callback_data))return null;if(!callback_data.EventChar)return null;callback_data.EventChar!=c&&(c=callback_data.EventChar)}return c}};class MenuColumns{constructor(){this.Spacing=0,this.Width=0,this.NextWidth=0,this.Pos=[0,0,0],this.NextWidths=[0,0,0]}Update(count,spacing,clear){this.Pos.length=count,this.NextWidths.length=count,this.Width=0,this.NextWidth=0,this.Spacing=spacing,clear&&(this.NextWidths=[0,0,0]);for(let i=0;i<this.Pos.length;i++)0<i&&0<this.NextWidths[i]&&(this.Width+=this.Spacing),this.Pos[i]=Math.floor(this.Width),this.Width+=this.NextWidths[i],this.NextWidths[i]=0}DeclColumns(w0,w1,w2){this.NextWidth=0,this.NextWidths[0]=Math.max(this.NextWidths[0],w0),this.NextWidths[1]=Math.max(this.NextWidths[1],w1),this.NextWidths[2]=Math.max(this.NextWidths[2],w2);for(let i=0;i<this.Pos.length;i++)this.NextWidth+=this.NextWidths[i]+(0<i&&0<this.NextWidths[i]?this.Spacing:0);return Math.max(this.Width,this.NextWidth)}CalcExtraSpace(availW){return Math.max(0,availW-this.Width)}}var ImguiMenuMixin={BeginMainMenuBar(){let g=this.guictx;g.NextWindowData.MenuBarOffsetMinVal=new Vec2(g.Style.DisplaySafeAreaPadding.x,Math.max(g.Style.DisplaySafeAreaPadding.y-g.Style.FramePadding.y,0)),this.SetNextWindowPos(new Vec2(0,0)),this.SetNextWindowSize(new Vec2(g.IO.DisplaySize.x,g.NextWindowData.MenuBarOffsetMinVal.y+g.FontBaseSize+g.Style.FramePadding.y)),this.PushStyleVar("WindowRounding",0),this.PushStyleVar("WindowMinSize",Vec2.Zero());var is_open=WindowFlags.NoTitleBar|WindowFlags.NoResize|WindowFlags.NoMove|WindowFlags.NoScrollbar|WindowFlags.NoSavedSettings|WindowFlags.MenuBar,is_open=this.Begin("##MainMenuBar",null,is_open)&&this.BeginMenuBar();return this.PopStyleVar(2),g.NextWindowData.MenuBarOffsetMinVal=new Vec2(0,0),!!is_open||(this.End(),!1)},EndMainMenuBar(){this.EndMenuBar();var g=this.guictx;g.CurrentWindow==g.NavWindow&&0==g.NavLayer&&this.focusPreviousWindowIgnoringOne(g.NavWindow),this.End()},BeginMenuBar(){let win=this.getCurrentWindow();if(win.SkipItems)return!1;if(!(win.Flags&WindowFlags.MenuBar))return!1;console.assert(!win.DC.MenuBarAppending),this.BeginGroup(),this.PushID("##menubar");var bar_rect=win.MenuBarRect();let clip_rect=Rect.FromXY(Math.floor(bar_rect.Min.x+.5),Math.floor(bar_rect.Min.y+win.WindowBorderSize+.5),Math.floor(Math.max(bar_rect.Min.x,bar_rect.Max.x-win.WindowRounding)+.5),Math.floor(bar_rect.Max.y+.5));return clip_rect.ClipWith(win.OuterRectClipped),this.PushClipRect(clip_rect.Min,clip_rect.Max,!1),win.DC.CursorPos=new Vec2(bar_rect.Min.x+win.DC.MenuBarOffset.x,bar_rect.Min.y+win.DC.MenuBarOffset.y),win.DC.LayoutType=LayoutType.Horizontal,win.DC.NavLayerCurrent=NavLayer.Menu,win.DC.NavLayerCurrentMask=1<<NavLayer.Menu,win.DC.MenuBarAppending=!0,this.AlignTextToFramePadding(),!0},EndMenuBar(){let win=this.getCurrentWindow();if(!win.SkipItems){let g=this.guictx;if(this.navMoveRequestButNoResultYet()&&(g.NavMoveDir==Dir.Left||g.NavMoveDir==Dir.Right)&&g.NavWindow.Flags&WindowFlags.ChildMenu){let nav_earliest_child=g.NavWindow;for(;nav_earliest_child.ParentWindow&&nav_earliest_child.ParentWindow.Flags&WindowFlags.ChildMenu;)nav_earliest_child=nav_earliest_child.ParentWindow;nav_earliest_child.ParentWindow==win&&nav_earliest_child.DC.ParentLayoutType==LayoutType.Horizontal&&g.NavMoveRequestForward==NavForward.None&&(console.assert(2&win.DC.NavLayerActiveMaskNext),this.FocusWindow(win),this.setNavIDWithRectRel(win.NavLastIds[1],1,win.NavRectRel[1]),g.NavLayer=NavLayer.Menu,g.NavDisableHighlight=!0,g.NavMoveRequestForward=NavForward.ForwardQueued,this.navMoveRequestCancel())}console.assert(win.Flags&WindowFlags.MenuBar),console.assert(win.DC.MenuBarAppending),this.PopClipRect(),this.PopID(),win.DC.MenuBarOffset.x=win.DC.CursorPos.x-win.MenuBarRect().Min.x;let grp=win.DC.GroupStack[win.DC.GroupStack.length-1];grp.AdvanceCursor=!1,this.EndGroup(),win.DC.LayoutType=LayoutType.Vertical,win.DC.NavLayerCurrent=NavLayer.Main,win.DC.NavLayerCurrentMask=1<<NavLayer.Main,win.DC.MenuBarAppending=!1}},BeginMenu(label,enabled=!0){let win=this.getCurrentWindow();if(win.SkipItems)return!1;let g=this.guictx;var style=g.Style,id=win.GetID(label),label_size=this.CalcTextSize(label,!0);let pressed,menu_is_open=this.isPopupOpen(id);var menuset_is_open=!(win.Flags&WindowFlags.Popup)&&g.OpenPopupStack.length>g.BeginPopupStack.length&&g.OpenPopupStack[g.BeginPopupStack.length].OpenParentId==win.IDStack[win.IDStack.length-1],extra=g.NavWindow;menuset_is_open&&(g.NavWindow=win);let popup_pos,pos=win.DC.CursorPos.Clone();if(win.DC.LayoutType==LayoutType.Horizontal){popup_pos=new Vec2(pos.x-1-Math.floor(.5*style.ItemSpacing.x),pos.y-style.FramePadding.y+win.MenuBarHeight()),win.DC.CursorPos.x+=Math.floor(.5*style.ItemSpacing.x),this.PushStyleVar("ItemSpacing",Vec2.Mult(style.ItemSpacing,2));var w=label_size.x;pressed=this.Selectable(label,menu_is_open,SelectableFlags.NoHoldingActiveID|SelectableFlags.PressedOnClick|SelectableFlags.DontClosePopups|(enabled?0:SelectableFlags.Disabled),new Vec2(w,0)),this.PopStyleVar(),win.DC.CursorPos.x+=Math.floor(-.5*style.ItemSpacing.x)}else{popup_pos=new Vec2(pos.x,pos.y-style.WindowPadding.y);let w=win.MenuColumns.DeclColumns(label_size.x,0,Math.floor(1.2*g.FontSize));var hovered=Math.max(0,this.GetContentRegionAvail().x-w);pressed=this.Selectable(label,menu_is_open,SelectableFlags.NoHoldingActiveID|SelectableFlags.PressedOnClick|SelectableFlags.DontClosePopups|SelectableFlags.DrawFillAvailWidth|(enabled?0:SelectableFlags.Disabled),new Vec2(w,0)),enabled||this.PushStyleColor("Text",g.Style.Colors.TextDisabled),this.renderArrow(Vec2.AddXY(pos,win.MenuColumns.Pos[2]+hovered+.3*g.FontSize,0),Dir.Right),enabled||this.PopStyleColor()}hovered=enabled&&this.itemHoverable(win.DC.LastItemRect,id);menuset_is_open&&(g.NavWindow=extra);let want_open=!1,want_close=!1;if(win.DC.LayoutType==LayoutType.Vertical){let inOpenTri=!1;if(g.HoveredWindow==win&&g.OpenPopupStack.length>g.BeginPopupStack.length&&g.OpenPopupStack[g.BeginPopupStack.length].ParentWindow==win&&!(win.Flags&WindowFlags.MenuBar)){let next_window=g.OpenPopupStack[g.BeginPopupStack.length].Window;if(next_window){let next_window_rect=next_window.Rect(),ta=Vec2.Subtract(g.IO.MousePos,g.IO.MouseDelta),tb=win.Pos.x<next_window.Pos.x?next_window_rect.GetTL():next_window_rect.GetTR(),tc=win.Pos.x<next_window.Pos.x?next_window_rect.GetBL():next_window_rect.GetBR();extra=Vec1.Clamp(.3*Math.abs(ta.x-tb.x),5,30);ta.x+=win.Pos.x<next_window.Pos.x?-.5:.5,tb.y=ta.y+Math.max(tb.y-extra-ta.y,-100),tc.y=ta.y+Math.min(tc.y+extra-ta.y,100),inOpenTri=TriangleContainsPoint(ta,tb,tc,g.IO.MousePos)}}want_close=menu_is_open&&!hovered&&g.HoveredWindow==win&&0!=g.HoveredIdPreviousFrame&&g.HoveredIdPreviousFrame!=id&&!inOpenTri,want_open=!menu_is_open&&hovered&&!inOpenTri||!menu_is_open&&hovered&&pressed,g.NavActivateId==id&&(want_close=menu_is_open,want_open=!menu_is_open),g.NavId==id&&g.NavMoveRequest&&g.NavMoveDir==Dir.Right&&(want_open=!0,this.navMoveRequestCancel())}else menu_is_open&&pressed&&menuset_is_open?(want_close=!0,want_open=menu_is_open=!1):pressed||hovered&&menuset_is_open&&!menu_is_open?want_open=!0:g.NavId==id&&g.NavMoveRequest&&g.NavMoveDir==Dir.Down&&(want_open=!0,this.navMoveRequestCancel());if(enabled||(want_close=!0),want_close&&this.isPopupOpen(id)&&this.closePopupToLevel(g.BeginPopupStack.length,!0),!menu_is_open&&want_open&&g.OpenPopupStack.length>g.BeginPopupStack.length)return this.OpenPopup(label),!1;if(menu_is_open|=want_open,want_open&&this.OpenPopup(label),menu_is_open){this.SetNextWindowPos(popup_pos,CondFlags.Always);let flags=WindowFlags.ChildMenu|WindowFlags.AlwaysAutoResize|WindowFlags.NoMove|WindowFlags.NoTitleBar|WindowFlags.NoSavedSettings|WindowFlags.NoNavFocus;win.Flags&(WindowFlags.Popup|WindowFlags.ChildMenu)&&(flags|=WindowFlags.ChildWindow),menu_is_open=this.beginPopupEx(id,flags)}return menu_is_open},EndMenu(){var g=this.guictx,win=g.CurrentWindow;g.NavWindow&&g.NavWindow.ParentWindow==win&&g.NavMoveDir==Dir.Left&&this.navMoveRequestButNoResultYet()&&win.DC.LayoutType==LayoutType.Vertical&&(this.closePopupToLevel(g.BeginPopupStack.length,!0),this.navMoveRequestCancel()),this.EndPopup()},MenuItem(label,shortcut=null,selected=!1,enabled=!0){let win=this.getCurrentWindow();if(win.SkipItems)return!1;let g=this.guictx;var shortcut_size=g.Style,pos=win.DC.CursorPos.Clone(),extra_w=this.CalcTextSize(label,!0),flags=SelectableFlags.PressedOnRelease|(enabled?0:SelectableFlags.Disabled);let pressed;if(win.DC.LayoutType==LayoutType.Horizontal){var w=extra_w.x;win.DC.CursorPos.x+=Math.floor(.5*shortcut_size.ItemSpacing.x),this.PushStyleVar("ItemSpacing",2*shortcut_size.ItemSpacing),pressed=this.Selectable(label,!1,flags,new Vec2(w,0)),this.PopStyleVar(),win.DC.CursorPos.x+=Math.floor(-.5*shortcut_size.ItemSpacing.x)}else{shortcut_size=shortcut?this.CalcTextSize(shortcut):Vec2.Zero();let w=win.MenuColumns.DeclColumns(extra_w.x,shortcut_size.x,Math.floor(1.2*g.FontSize));extra_w=Math.max(0,this.GetContentRegionAvail().x-w);pressed=this.Selectable(label,!1,flags|SelectableFlags.DrawFillAvailWidth,new Vec2(w,0)),0<shortcut_size.x&&(this.PushStyleColor("Text",g.Style.Colors.TextDisabled),this.renderText(Vec2.AddXY(pos,win.MenuColumns.Pos[1]+extra_w,0),shortcut,!1),this.PopStyleColor()),("boolean"==typeof selected?selected:selected.get())&&this.renderCheckMark(Vec2.AddXY(pos,win.MenuColumns.Pos[2]+extra_w+.4*g.FontSize,.134*g.FontLineHeight*.5),g.Style.GetColor(enabled?"Text":"TextDisabled"),.866*g.FontSize)}return pressed&&"boolean"!=typeof selected&&selected.set(!selected.get()),pressed}},ImguiColorPickerMixin={ColorPicker3(label,col,flags,onChange){let col4=col.Clone();return col4.a=1,!!this.ColorPicker4(label,col4,flags|ColorEditFlags.NoAlpha,onChange)&&(col.x=col4.x,col.y=col4,col.z=col4.z,!0)},ColorPicker4(label,col,flags,hueBarR=null,onChange){var colOpaque=this.guictx;let win=this.getCurrentWindow();if(win.SkipItems)return!1;let draw_list=win.DrawList;var style=colOpaque.Style,io=colOpaque.IO;this.PushID(label),this.BeginGroup(),flags&ColorEditFlags.NoSidePreview||(flags|=ColorEditFlags.NoSmallPreview),ColorEditFlags.NoOptions,this.colorPickerOptionsPopup(col,flags),flags&ColorEditFlags.PickerMask||(flags|=(colOpaque.ColorEditOptions&ColorEditFlags.PickerMask?colOpaque.ColorEditOptions:ColorEditFlags.OptionsDefault)&ColorEditFlags.PickerMask),flags&ColorEditFlags.InputMask||(flags|=(colOpaque.ColorEditOptions&ColorEditFlags.InputMask?colOpaque.ColorEditOptions:ColorEditFlags.OptionsDefault)&ColorEditFlags.InputMask),console.assert(IsPowerOfTwo(flags&ColorEditFlags.PickerMask)),console.assert(IsPowerOfTwo(flags&ColorEditFlags.InputMask)),flags&ColorEditFlags.NoOptions||(flags|=colOpaque.ColorEditOptions&ColorEditFlags.AlphaBar);ColorEditFlags.NoAlpha;var alpha=flags&ColorEditFlags.AlphaBar&&!(flags&ColorEditFlags.NoAlpha),picker_pos=win.DC.CursorPos.Clone(),square_sz=this.GetFrameHeight(),bars_width=square_sz,bar1_line_y=Math.max(+bars_width,this.CalcItemWidth()-(alpha?2:1)*(bars_width+style.ItemInnerSpacing.x)),bar0_pos_x=picker_pos.x+bar1_line_y+style.ItemInnerSpacing.x,bar1_pos_x=bar0_pos_x+bars_width+style.ItemInnerSpacing.x,bars_triangles_half_sz=Math.floor(.2*bars_width);let backup_initial_col=col.Clone(),hsv,rgb;flags&ColorEditFlags.InputRGB?(rgb=col,hsv=col.AsHSV()):flags&ColorEditFlags.InputHSV&&(hsv=col,rgb=col.AsRGB());let value_changed=!1,value_changed_h=!1,value_changed_sv=!1;if(this.PushItemFlag(ItemFlags.NoNav,!0),flags&ColorEditFlags.PickerHueWheel?console.assert("picker hue wheel not supported"):flags&ColorEditFlags.PickerHueBar&&(this.InvisibleButton("sv",new Vec2(bar1_line_y,bar1_line_y)),this.IsItemActive()&&(hsv.y=Vec1.Saturate((io.MousePos.x-picker_pos.x)/(bar1_line_y-1)),hsv.z=1-Vec1.Saturate((io.MousePos.y-picker_pos.y)/(bar1_line_y-1)),value_changed=value_changed_sv=!0),this.SetCursorScreenPos(new Vec2(bar0_pos_x,picker_pos.y)),this.InvisibleButton("hue",new Vec2(bars_width,bar1_line_y)),this.IsItemActive()&&(hsv.x=Vec1.Saturate((io.MousePos.y-picker_pos.y)/(bar1_line_y-1)),value_changed=value_changed_h=!0)),alpha&&(this.SetCursorScreenPos(new Vec2(bar1_pos_x,picker_pos.y)),this.InvisibleButton("alpha",new Vec2(bars_width,bar1_line_y)),this.IsItemActive()&&(col.a=1-Vec1.Saturate((io.MousePos.y-picker_pos.y)/(bar1_line_y-1)),value_changed=!0)),this.PopItemFlag(),flags&ColorEditFlags.NoSidePreview||(this.SameLine(0,style.ItemInnerSpacing.x),this.BeginGroup()),flags&ColorEditFlags.NoLabel||(sub_flags_to_forward=label.split("##")[0]).length&&(flags&ColorEditFlags.NoSidePreview&&this.SameLine(0,style.ItemInnerSpacing.x),this.textEx(sub_flags_to_forward)),!(flags&ColorEditFlags.NoSidePreview)){this.PushItemFlag(ItemFlags.NoNavDefaultFocus,!0);let col_v4=col.Clone();flags&ColorEditFlags.NoAlpha&&(col_v4.a=1),flags&ColorEditFlags.NoLabel&&this.Text("Current");var sub_flags_to_forward=ColorEditFlags.InputMask|ColorEditFlags.HDR|ColorEditFlags.AlphaPreview|ColorEditFlags.AlphaPreviewHalf|ColorEditFlags.NoTooltip;if(this.ColorButton("##current",col_v4,flags&sub_flags_to_forward,new Vec2(3*square_sz,2*square_sz)),null!=hueBarR){this.Text("Original");let ref_col_v4=hueBarR.Clone();flags&ColorEditFlags.NoAlpha&&(ref_col_v4.a=1),this.ColorButton("##original",ref_col_v4,flags&sub_flags_to_forward,new Vec2(3*square_sz,2*square_sz))&&(col.Copy(hueBarR),value_changed=!0)}this.PopItemFlag(),this.EndGroup()}(value_changed_h||value_changed_sv)&&(flags&ColorEditFlags.InputRGB?col.Copy(hsv.AsRGB()):flags&ColorEditFlags.InputHSV&&col.Copy(hsv));let value_changed_fix_hue_wrap=!1;if(0==(flags&ColorEditFlags.NoInputs)){this.PushItemWidth((alpha?bar1_pos_x:bar0_pos_x)+bars_width-picker_pos.x);let sub_flags_to_forward=ColorEditFlags.DataTypeMask|ColorEditFlags.InputMask|ColorEditFlags.HDR|ColorEditFlags.NoAlpha|ColorEditFlags.NoOptions|ColorEditFlags.NoSmallPreview|ColorEditFlags.AlphaPreview|ColorEditFlags.AlphaPreviewHalf;var colClear=flags&sub_flags_to_forward|ColorEditFlags.NoPicker;(flags&ColorEditFlags.DisplayRGB||0==(flags&ColorEditFlags.DisplayMask))&&this.ColorEdit4("##rgb",col,colClear|ColorEditFlags.DisplayRGB)&&(value_changed_fix_hue_wrap=0!=colOpaque.ActiveId&&!colOpaque.ActiveIdAllowOverlap,value_changed=!0),(flags&ColorEditFlags.DisplayHSV||0==(flags&ColorEditFlags.DisplayMask))&&(value_changed|=this.ColorEdit4("##hsv",col,colClear|ColorEditFlags.DisplayHSV)),(flags&ColorEditFlags.DisplayHex||0==(flags&ColorEditFlags.DisplayMask))&&(value_changed|=this.ColorEdit4("##hex",col,colClear|ColorEditFlags.DisplayHex)),this.PopItemWidth()}if(value_changed_fix_hue_wrap&&flags&ColorEditFlags.InputRGB){let newhsv=col.AsHSV();newhsv.x<=0&&0<hsv.x&&(console.assert(0,"unverified"),newhsv.z<=0&&hsv.z!=newhsv.z?(newhsv.x=hsv.x,newhsv.y=hsv.y,newhsv.z=.5*hsv.z,col=newhsv.AsRGB()):newhsv.y<=0&&(newhsv.x=hsv.x,newhsv.y=.5*hsv.y,col=newhsv.AsRGB()))}value_changed&&(flags&ColorEditFlags.InputRGB?hsv=col.AsHSV():flags&ColorEditFlags.InputHSV&&(rgb=col.AsRGB()));hueBarR=new Color(hsv.x,1,1,1,"hsv").AsRGB(),colOpaque=rgb.AsOpaque(),colClear=Colors.clear;let sv_cursor_pos=new Vec2;flags&ColorEditFlags.PickerHueWheel?console.assert(0,"hue wheel not implemented"):flags&ColorEditFlags.PickerHueBar&&(sv_cursor_rad=new Rect(picker_pos,Vec2.AddXY(picker_pos,bar1_line_y,bar1_line_y)),draw_list.AddRectFilledMultiColor(sv_cursor_rad.Min,sv_cursor_rad.Max,Colors.white,hueBarR,hueBarR,Colors.white),draw_list.AddRectFilledMultiColor(sv_cursor_rad.Min,sv_cursor_rad.Max,Colors.clear,Colors.clear,Colors.black,Colors.black),this.renderFrameBorder(sv_cursor_rad.Min,sv_cursor_rad.Max,0),sv_cursor_pos.x=Vec1.Clamp(Math.floor(picker_pos.x+Vec1.Saturate(hsv.y)*bar1_line_y+.5),picker_pos.x+2,picker_pos.x+bar1_line_y-2),sv_cursor_pos.y=Vec1.Clamp(Math.floor(picker_pos.y+Vec1.Saturate(1-hsv.z)*bar1_line_y+.5),picker_pos.y+2,picker_pos.y+bar1_line_y-2),hueBarR=new Rect(new Vec2(bar0_pos_x,picker_pos.y),new Vec2(bar0_pos_x+bars_width,picker_pos.y+bar1_line_y)),draw_list.AddRectRamp(hueBarR.Min,hueBarR.Max,HueRampStr,!0),sv_cursor_rad=Math.floor(picker_pos.y+hsv.x*bar1_line_y+.5),this.renderFrameBorder(hueBarR.Min,hueBarR.Max,0),this.renderArrowsForVerticalBar(draw_list,new Vec2(bar0_pos_x-1,sv_cursor_rad),new Vec2(bars_triangles_half_sz+1,bars_triangles_half_sz),bars_width+2));var sv_cursor_rad=value_changed_sv?4:2;if(draw_list.AddCircleFilled(sv_cursor_pos,sv_cursor_rad,colOpaque),draw_list.AddCircle(sv_cursor_pos,1+sv_cursor_rad,Colors.gray),draw_list.AddCircle(sv_cursor_pos,sv_cursor_rad,Colors.white),alpha){alpha=Vec1.Saturate(col.a);let bar1_bb=Rect.FromXY(bar1_pos_x,picker_pos.y,bar1_pos_x+bars_width,picker_pos.y+bar1_line_y);this.renderColorRectWithAlphaCheckerboard(bar1_bb.Min,bar1_bb.Max,Colors.clear,bar1_bb.GetWidth()/2,Vec2.Zero()),draw_list.AddRectFilledMultiColor(bar1_bb.Min,bar1_bb.Max,colOpaque,colOpaque,colClear,colClear);bar1_line_y=Math.floor(picker_pos.y+(1-alpha)*bar1_line_y+.5);this.renderFrameBorder(bar1_bb.Min,bar1_bb.Max,0),this.renderArrowsForVerticalBar(draw_list,new Vec2(bar1_pos_x-1,bar1_line_y),new Vec2(bars_triangles_half_sz+1,bars_triangles_half_sz),bars_width+2)}return this.EndGroup(),value_changed&&backup_initial_col.Equals(col)&&(value_changed=!1),value_changed&&this.markItemEdited(win.DC.LastItemId),this.PopID(),value_changed},SetColorEditOptions(flags){let g=this.guictx;0==(flags&ColorEditFlags.DisplayMask)&&(flags|=ColorEditFlags.OptionsDefault&ColorEditFlags.DisplayMask),0==(flags&ColorEditFlags.DataTypeMask)&&(flags|=ColorEditFlags.OptionsDefault&ColorEditFlags.DataTypeMask),0==(flags&ColorEditFlags.PickerMask)&&(flags|=ColorEditFlags.OptionsDefault&ColorEditFlags.PickerMask),0==(flags&ColorEditFlags.InputMask)&&(flags|=ColorEditFlags.OptionsDefault&ColorEditFlags.InputMask),console.assert(IsPowerOfTwo(flags&ColorEditFlags.DisplayMask)),console.assert(IsPowerOfTwo(flags&ColorEditFlags.DataTypeMask)),console.assert(IsPowerOfTwo(flags&ColorEditFlags.PickerMask)),console.assert(IsPowerOfTwo(flags&ColorEditFlags.InputMask)),g.ColorEditOptions=flags},colorEditOptionsPopup(col,flags){var allow_opt_inputs=!(flags&ColorEditFlags.DisplayMask),allow_opt_datatype=!(flags&ColorEditFlags.DataTypeMask);if((allow_opt_inputs||allow_opt_datatype)&&this.BeginPopup("context")){let g=this.guictx,opts=g.ColorEditOptions;if(allow_opt_inputs&&(this.RadioButton("RGB",0!=(opts&ColorEditFlags.DisplayRGB))&&(opts=opts&~ColorEditFlags.DisplayMask|ColorEditFlags.DisplayRGB),this.RadioButton("HSV",0!=(opts&ColorEditFlags.DisplayHSV))&&(opts=opts&~ColorEditFlags.DisplayMask|ColorEditFlags.DisplayHSV),this.RadioButton("Hex",0!=(opts&ColorEditFlags.DisplayHex))&&(opts=opts&~ColorEditFlags.DisplayMask|ColorEditFlags.DisplayHex)),allow_opt_datatype&&(allow_opt_inputs&&this.Separator(),this.RadioButton("0..255",0!=(opts&ColorEditFlags.Uint8))&&(opts=opts&~ColorEditFlags.DataTypeMask|ColorEditFlags.Uint8),this.RadioButton("0.00..1.00",0!=(opts&ColorEditFlags.Float))&&(opts=opts&~ColorEditFlags.DataTypeMask|ColorEditFlags.Float)),(allow_opt_inputs||allow_opt_datatype)&&this.Separator(),this.Button("Copy as..",new Vec2(-1,0))&&this.OpenPopup("Copy"),this.BeginPopup("Copy")){let cc=col.Array(),buf=cc.AsFloatStr();this.Selectable(buf)&&this.SetClipboardText(buf),buf=cc.AsIntStr(),this.Selectable(buf)&&this.SetClipboardText(buf),buf=cc.asHexStr(flags&ColorEditFlags.NoAlpha),this.Selectable(buf)&&this.SetClipboardText(buf),this.EndPopup()}g.ColorEditOptions=opts,this.EndPopup()}},renderArrowsForVerticalBar(draw_list,pos,half_sz,bar_w){this.renderArrowPointingAt(draw_list,new Vec2(pos.x+half_sz.x+1,pos.y),new Vec2(half_sz.x+2,half_sz.y+1),Dir.Right,Colors.black),this.renderArrowPointingAt(draw_list,new Vec2(pos.x+half_sz.x,pos.y),half_sz,Dir.Right,Colors.white),this.renderArrowPointingAt(draw_list,new Vec2(pos.x+bar_w-half_sz.x-1,pos.y),new Vec2(half_sz.x+2,half_sz.y+1),Dir.Left,Colors.black),this.renderArrowPointingAt(draw_list,new Vec2(pos.x+bar_w-half_sz.x,pos.y),half_sz,Dir.Left,Colors.white)},colorPickerOptionsPopup(){}},DragPayloads={COLOR_3F:"_COL3F",COLOR_4F:"_COL4F"},DragFlags={None:0,Vertical:1,AsHyperText:2,LongPress:4};const DragFFmt="%.3f",DragIFmt="%d";var ImguiDragMixin={DragFloat(label,val,v_speed=1,v_min=0,v_max=0,format=null,power=1,onChange=null,onDone=null,flags=0){return null==format&&(format=DragFFmt),this.DragScalar(label,DataType.Float,val,v_speed,v_min,v_max,format,power,onChange,onDone,flags)},DragVec2(label,val,v_speed=1,v_min=0,v_max=0,format=null,power=1,onChange=null,onDone=null,value_changed=0){value_changed=this.DragFloat2(label,[val.x,val.y],v_speed,v_min,v_max,format,power,newval=>{val.x=newval[0],val.y=newval[1]},onDone,value_changed);return value_changed&&onChange&&onChange(val),value_changed},DragFloat2(label,val,v_speed=1,v_min=0,v_max=0,format=null,power=1,onChange=null,onDone=null,flags=0){return null==format&&(format=DragFFmt),this.DragScalarN(label,DataType.Float,val,2,v_speed,v_min,v_max,format,power,onChange,onDone,flags)},DragFloat3(label,val,v_speed=1,v_min=0,v_max=0,format=null,power=1,onChange=null,onDone=null,flags=0){return null==format&&(format=DragFFmt),this.DragScalarN(label,DataType.Float,val,3,v_speed,v_min,v_max,format,power,onChange,onDone,flags)},DragFloat4(label,val,v_speed=1,v_min=0,v_max=0,format=null,va=1,onChange=null,onDone=null,flags=0){if(null==format&&(format=DragFFmt),null==val.AsArray)return this.DragScalarN(label,DataType.Float,val,4,v_speed,v_min,v_max,format,va,onChange,onDone,flags);va=val.AsArray();return this.DragScalarN(label,DataType.Float,va,4,v_speed,v_min,v_max,format,1,function(newval){val.CopyArray(newval),onChange&&onChange(val)},onDone,flags)},DragFloatRange2(label,v_current_min,v_current_max,v_speed=1,v_min=0,v_max=0,format=null,format_max=null,power=1,onChange=null,onDone=null,flags=0){if(this.getCurrentWindow().SkipItems)return!1;var g=this.guictx;this.PushID(label),this.BeginGroup(),this.PushMultiItemsWidths(2,this.getNextItemWidth());var value_changed=this.DragFloat("##min",v_current_min,v_speed,v_max<=v_min?-Number.MAX_VALUE:v_min,v_max<=v_min?v_current_max:Math.min(v_max,v_current_max),format,power,newval=>v_current_min=newval,onDone,flags);return this.PopItemWidth(),this.SameLine(0,g.Style.ItemInnerSpacing.x),value_changed|=this.DragFloat("##max",v_current_max,v_speed,v_max<=v_min?v_current_min:Math.max(v_min,v_current_min),v_max<=v_min?Number.MAX_VALUE:v_max,format_max||format,power,newval=>v_current_max=newval,onDone,flags),this.PopItemWidth(),this.SameLine(0,g.Style.ItemInnerSpacing.x),this.textEx(label.split("##")[0]),this.EndGroup(),this.PopID(),value_changed&&onChange&&onChange(v_current_min,v_current_max),value_changed},DragInt(label,v,v_speed=1,v_min=0,v_max=0,format=null,onChange=null,onDone=null,flags=0){return null==format&&(format=DragIFmt),this.DragScalar(label,DataType.S32,v,v_speed,v_min,v_max,format,1,onChange,onDone,flags)},DragInt2(label,v,v_speed=1,v_min=0,v_max=0,format=null,onChange=null,onDone=null,flags=0){return null==format&&(format=DragIFmt),this.DragScalarN(label,DataType.S32,v,2,v_speed,v_min,v_max,format,1,onChange,onDone,flags)},DragInt3(label,v,v_speed=1,v_min=0,v_max=0,format=null,onChange=null,onDone=null,flags=0){return null==format&&(format=DragIFmt),this.DragScalarN(label,DataType.S32,v,3,v_speed,v_min,v_max,format,1,onChange,onDone,flags)},DragInt4(label,v,v_speed=1,v_min=0,v_max=0,format=null,onChange=null,onDone=null,flags=0){return null==format&&(format=DragIFmt),this.DragScalarN(label,DataType.S32,v,4,v_speed,v_min,v_max,format,1,onChange,onDone,flags)},DragIntRange2(label,v_current_min,v_current_max,v_speed=1,v_min=0,v_max=0,format=null,format_max=null,onChange=null,onDone=null,flags=0){if(this.getCurrentWindow().SkipItems)return!1;var g=this.guictx;this.PushID(label),this.BeginGroup(),this.PushMultiItemsWidths(2,this.getNextItemWidth());var value_changed=this.DragInt("##min",v_current_min,v_speed,v_max<=v_min?-Number.MAX_SAFE_INTEGER:v_min,v_max<=v_min?v_current_max:Math.min(v_max,v_current_max),format,newval=>{v_current_min=newval},onDone,flags);return this.PopItemWidth(),this.SameLine(0,g.Style.ItemInnerSpacing.x),value_changed|=this.DragInt("##max",v_current_max,v_speed,v_max<=v_min?v_current_min:Math.max(v_min,v_current_min),v_max<=v_min?Number.MAX_SAFE_INTEGER:v_max,format_max||format,newval=>v_current_max=newval,onDone,flags),this.PopItemWidth(),this.SameLine(0,g.Style.ItemInnerSpacing.x),this.textEx(label.split("##")[0]),this.EndGroup(),this.PopID(),value_changed&&onChange&&onChange(v_current_min,v_current_max),value_changed},DragScalar(label,data_type,v,v_speed=1,v_min=0,v_max=0,valstr=null,value_changed=1,onChange=null,onDone=null,flags=0){let win=this.getCurrentWindow();if(win.SkipItems)return!1;1!=value_changed&&console.assert(null!=v_min&&null!=v_max);let g=this.guictx;const style=g.Style;var id=win.GetID(label),focus_requested=this.CalcItemWidth(),label_size=this.CalcTextSize(label,!0);let frame_bb,total_bb;if(flags&DragFlags.AsHyperText){if(hovered=new Vec2(win.DC.CursorPos.x,win.DC.CursorPos.y+win.DC.CurrentLineTextBaseOffset),frame_bb=new Rect(hovered,Vec2.AddXY(hovered,focus_requested,label_size.y)),total_bb=new Rect(frame_bb.Min,Vec2.AddXY(frame_bb.Max,0<label_size.x?style.ItemInnerSpacing.x+label_size.x:0,0)),this.itemSize(total_bb),!this.itemAdd(total_bb,id,frame_bb))return!1}else if(frame_bb=new Rect(win.DC.CursorPos,Vec2.AddXY(win.DC.CursorPos,focus_requested,label_size.y+2*style.FramePadding.y)),total_bb=new Rect(frame_bb.Min,Vec2.AddXY(frame_bb.Max,0<label_size.x?style.ItemInnerSpacing.x+label_size.x:0,0)),this.itemSize(total_bb,style.FramePadding.y),!this.itemAdd(total_bb,id,frame_bb))return!1;var hovered=this.itemHoverable(frame_bb,id);let start_text_input=!1;focus_requested=this.focusableItemRegister(win,id);if((focus_requested||hovered&&(g.IO.MouseClicked[0]||g.IO.MouseDoubleClicked[0])||g.NavActivateId==id||g.NavInputId==id&&g.ScalarAsInputTextId!=id)&&(this.setActiveID(id,win),this.setFocusID(id,win),this.FocusWindow(win),g.ActiveIdAllowNavDirFlags=1<<Dir.Up|1<<Dir.Down,(focus_requested||g.IO.KeyCtrl||g.IO.MouseDoubleClicked[0]||g.NavInputId==id)&&(start_text_input=!0,g.ScalarAsInputTextId=0)),start_text_input||g.ActiveId==id&&g.ScalarAsInputTextId==id)return win.DC.CursorPos=frame_bb.Min.Clone(),this.focusableItemUnregister(win),this.inputScalarAsWidgetReplacement(frame_bb,id,label,data_type,v,valstr);value_changed=this.dragBehavior(id,data_type,v,v_speed,v_min,v_max,valstr,value_changed,flags,function(newval){v=newval,onChange&&onChange(v)},function(){onDone&&onDone()});value_changed&&this.markItemEdited(id);var frame_col,valstr=FormatValues(valstr,[v]);return flags&DragFlags.AsHyperText?(this.renderFrameBorder(frame_bb.Min,frame_bb.Max,0,.5),frame_col=g.ActiveId==id&&g.ActiveIdSource==InputSource.Mouse&&g.IO.MouseDown[0],frame_col=style.GetColor(frame_col||hovered?"LinkHovered":"Link"),this.PushStyleColor("Text",frame_col),this.renderTextClipped(frame_bb.Min,frame_bb.Max,valstr,null,new Vec2(.5,.5)),this.PopStyleColor()):(frame_col=style.GetColor(g.ActiveId==id?"FrameBgActive":g.HoveredId==id?"FrameBgHovered":"FrameBg"),this.renderNavHighlight(frame_bb,id),this.renderFrame(frame_bb.Min,frame_bb.Max,frame_col,!0,style.FrameRounding),this.renderTextClipped(frame_bb.Min,frame_bb.Max,valstr,null,new Vec2(.5,.5))),0<label_size.x&&this.renderText(new Vec2(frame_bb.Max.x+style.ItemInnerSpacing.x,frame_bb.Min.y+style.FramePadding.y),label),value_changed},DragScalarN(label,data_type,v,components,v_speed=1,v_min=0,v_max=0,format=null,power=1,onChange=null,onDone=null,flags=0){if(this.getCurrentWindow().SkipItems)return!1;var g=this.guictx;let value_changed=!1;this.BeginGroup(),this.PushID(label),this.PushMultiItemsWidths(components,this.getNextItemWidth());for(let i=0;i<components;i++)this.PushID(i),this.DragScalar("",data_type,v[i],v_speed,v_min,v_max,format,power,function(newval){v[i]=newval,value_changed=!0},onDone,flags),this.SameLine(0,g.Style.ItemInnerSpacing.x),this.PopID(),this.PopItemWidth();return this.PopID(),this.textEx(label.split("##")[0]),this.EndGroup(),value_changed&&onChange&&onChange(v),value_changed},dragBehavior(has_min_max,is_power,v,v_old_norm_curved,v_min,v_max,precision,v_cur_norm_curved,flags,onChange,isfloat){let g=this.guictx;if(g.ActiveId==has_min_max&&(g.ActiveIdSource==InputSource.Mouse&&!g.IO.MouseDown[0]||g.ActiveIdSource==InputSource.Nav&&g.NavActivatePressedId==has_min_max&&g.ActiveIdIsJustActivated)&&(this.clearActiveID(),isfloat&&isfloat()),g.ActiveId!=has_min_max)return!1;var v_new_norm_curved=flags&DragFlags.Vertical?Axis.Y:Axis.X,is_just_activated=flags&DragFlags.Vertical?"y":"x",isfloat=is_power==DataType.Float,has_min_max=v_min!=v_max,is_power=1!=v_cur_norm_curved&&isfloat&&has_min_max&&v_max-v_min<Number.MAX_VALUE,precision=isfloat?ParseFormatPrecision(precision):0;0==v_old_norm_curved&&has_min_max&&v_max-v_min<Number.MAX_VALUE&&(v_old_norm_curved=(v_max-v_min)*g.DragSpeedDefaultRatio);let adjust_delta=0;g.ActiveIdSource==InputSource.Mouse&&this.IsMousePosValid()&&1<g.IO.MouseDragMaxDistanceSqr[0]?flags&DragFlags.LongPress&&!(g.IO.MouseDownDuration[0]>=g.IO.LongPressInterval)||(adjust_delta=g.IO.MouseDelta[is_just_activated],g.IO.KeyAlt&&(adjust_delta*=.01),g.IO.KeyShift&&(adjust_delta*=10)):g.ActiveIdSource==InputSource.Nav&&(adjust_delta=this.getNavInputAmount2d(NavDirSourceFlags.Keyboard|NavDirSourceFlags.PadDPad,InputReadMode.RepeatFast,.1,10)[is_just_activated],v_old_norm_curved=Math.max(v_old_norm_curved,GetMinStepAtFloatPrecision(precision))),adjust_delta*=v_old_norm_curved,v_new_norm_curved==Axis.Y&&(adjust_delta=-adjust_delta);is_just_activated=g.ActiveIdIsJustActivated,v_old_norm_curved=has_min_max&&(v_max<=v&&0<adjust_delta||v<=v_min&&adjust_delta<0),v_new_norm_curved=is_power&&(adjust_delta<0&&0<g.DragCurrentAccum||0<adjust_delta&&g.DragCurrentAccum<0);if(is_just_activated||v_old_norm_curved||v_new_norm_curved?(g.DragCurrentAccum=0,g.DragCurrentAccumDirty=!1):0!=adjust_delta&&(g.DragCurrentAccum+=adjust_delta,g.DragCurrentAccumDirty=!0),!g.DragCurrentAccumDirty)return!1;let v_cur=v,v_old_ref_for_accum_remainder=0;return is_power?(v_new_norm_curved=(v_old_norm_curved=Math.pow((v_cur-v_min)/(v_max-v_min),1/v_cur_norm_curved))+g.DragCurrentAccum/(v_max-v_min),v_cur=v_min+Math.pow(Vec1.Saturate(v_new_norm_curved),v_cur_norm_curved)*(v_max-v_min),v_old_ref_for_accum_remainder=v_old_norm_curved):v_cur+=g.DragCurrentAccum,v_cur=RoundScalarToPrecision(v_cur,precision),g.DragCurrentAccumDirty=!1,is_power?(v_cur_norm_curved=Math.pow((v_cur-v_min)/(v_max-v_min),1/v_cur_norm_curved),g.DragCurrentAccum-=v_cur_norm_curved-v_old_ref_for_accum_remainder):g.DragCurrentAccum-=v_cur-v,v!=v_cur&&has_min_max&&((v_cur<v_min||v_cur>v&&adjust_delta<0&&!isfloat)&&(v_cur=v_min),(v_cur>v_max||v_cur<v&&0<adjust_delta&&!isfloat)&&(v_cur=v_max)),v!=v_cur&&(onChange&&onChange(v_cur),!0)}},ColumnsFlags={None:0,NoBorder:1,NoResize:2,NoPreserveWidths:4,NoForceWithinWindow:8,GrowParentContentsSize:16};class ColumnData{constructor(){this.OffsetNorm=0,this.OffsetNormBeforeResize=0,this.Flags=0,this.ClipRect=null}}const ColumnsHitRectHalfWidth=4;class Columns{constructor(){this.Columns=new ArrayEx,this.Clear()}Clear(){this.ID=0,this.Flags=0,this.IsFirstFrame=!1,this.IsBeingResized=!1,this.Current=0,this.Count=1,this.MinX=this.MaxX=0,this.LineMinY=this.LineMaxY=0,this.BackupCursorPosY=0,this.BackupCurosrMaxPosX=0,this.Columns.resize(0)}}var ImguiColumnMixin={Columns(count=1,id=null,flags=!0){var columns=this.getCurrentWindow();console.assert(1<=count);flags=flags?0:ColumnsFlags.NoBorder,columns=columns.DC.CurrentColumns;null!=columns&&columns.count==count&&columns.Flags==flags||(null!=columns&&this.endColumns(),1!=count&&this.beginColumns(id,count,flags))},NextColumn(){let win=this.getCurrentWindow();if(!win.SkipItems&&null!=win.DC.CurrentColumns){var g=this.guictx;let columns=win.DC.CurrentColumns;if(1==columns.Count)return win.DC.CursorPos.x=Math.floor(win.Pos.x+win.DC.Indent.x+win.DC.ColumnsOffset.x),void console.assert(0==columns.Current);this.PopItemWidth(),this.PopClipRect(),columns.LineMaxY=Math.max(columns.LineMaxY,win.DC.CursorPos.y),++columns.Current<columns.Count?(win.DC.ColumnsOffset.x=this.GetColumnOffset(columns.Current)-win.DC.Indent.x+g.Style.ItemSpacing.x,win.DrawList.ChannelsSetCurrent(columns.Current)):(win.DC.ColumnsOffset.x=0,win.DrawList.ChannelsSetCurrent(0),columns.Current=0,columns.LineMinY=columns.LineMaxY),win.DC.CursorPos.x=Math.floor(win.Pos.x+win.DC.Indent.x+win.DC.ColumnsOffset.x),win.DC.CursorPos.y=columns.LineMinY,win.DC.CurrentLineHeight=0,win.DC.CurrentLineHeightMax=0,win.DC.CurrentLineTextBaseOffset=0,this.pushColumnClipRect(),this.PushItemWidth(.65*this.GetColumnWidth())}},GetColumnIndex(){var win=this.getCurrentWindowRead();return win.DC.CurrentColumns?win.DC.CurrentColumns.Current:0},GetColumnsCount(){var win=this.getCurrentWindowRead();return win.DC.CurrentColumns?win.DC.CurrentColumns.Count:1},offsetNormToPixels(columns,offset_norm){return offset_norm*(columns.MaxX-columns.MinX)},pixelsToOffsetNorm(columns,offset){return offset/(columns.MaxX-columns.MinX)},getDraggedColumnOffset(columns,column_index){var g=this.guictx,win=g.CurrentWindow;console.assert(0<column_index),console.assert(g.ActiveId==columns.ID+column_index);let x=g.IO.MousePos.x-g.ActiveIdClickOffset.x+ColumnsHitRectHalfWidth-win.Pos.x;return x=Math.max(x,this.GetColumnOffset(column_index-1)+g.Style.ColumnsMinSpacing),columns.Flags&ColumnsFlags.NoPreserveWidths&&(x=Math.min(x,this.GetColumnOffset(column_index+1)-g.Style.ColumnsMinSpacing)),x},GetColumnOffset(t=-1){var columns=this.getCurrentWindowRead().DC.CurrentColumns;console.assert(columns),t<0&&(t=columns.Current),console.assert(t<columns.Columns.length);t=columns.Columns[t].OffsetNorm;return Vec1.Lerp(columns.MinX,columns.MaxX,t)},getColumnWidthEx(columns,column_index,before_resize=!1){column_index<0&&(column_index=columns.Current);let offset_norm;return offset_norm=before_resize?columns.Columns[column_index+1].OffsetNormBeforeResize-columns.Columns[column_index].OffsetNormBeforeResize:columns.Columns[column_index+1].OffsetNorm-columns.Columns[column_index].OffsetNorm,this.offsetNormToPixels(columns,offset_norm)},GetColumnWidth(column_index=-1){var columns=this.getCurrentWindowRead().DC.CurrentColumns;return console.assert(columns),column_index<0&&(column_index=columns.Current),this.offsetNormToPixels(columns,columns.Columns[column_index+1].OffsetNorm-columns.Columns[column_index].OffsetNorm)},SetColumnOffset(column_index,offset){var g=this.guictx;let columns=g.CurrentWindow.DC.CurrentColumns;console.assert(columns),column_index<0&&(column_index=columns.Current),console.assert(column_index<columns.Columns.length);var preserve_width=!(columns.Flags&ColumnsFlags.NoPreserveWidths)&&column_index<columns.Count-1,width=preserve_width?this.getColumnWidthEx(columns,column_index,columns.IsBeingResized):0;columns.Flags&ColumnsFlags.NoForceWithinWindow||(offset=Math.min(offset,columns.MaxX-g.Style.ColumnsMinSpacing*(columns.Count-column_index))),columns.Columns[column_index].OffsetNorm=this.pixelsToOffsetNorm(columns,offset-columns.MinX),preserve_width&&this.SetColumnOffset(column_index+1,offset+Math.max(g.Style.ColumnsMinSpacing,width))},SetColumnWidth(column_index,width){var columns=this.getCurrentWindowRead().DC.CurrentColumns;console.assert(columns),column_index<0&&(column_index=columns.Current),this.SetColumnOffset(column_index+1,this.GetColumnOffset(column_index)+width)},pushColumnClipRect(column=-1){var columns=this.getCurrentWindowRead().DC.CurrentColumns;column<0&&(column=columns.Current);column=columns.Columns[column];this.PushClipRect(column.ClipRect.Min,column.ClipRect.Max,!1)},findOrCreateColumns(win,id){for(let n=0;n<win.ColumnsStorage.length;n++)if(win.ColumnsStorage[n].ID==id)return win.ColumnsStorage[n];win.ColumnsStorage.push(new Columns);let columns=win.ColumnsStorage.back();return columns.ID=id,columns},getColumnsID(id,columns_count){let win=this.getCurrentWindow();this.PushID(287454023+(id?0:columns_count));id=win.GetID(id||"columns");return this.PopID(),id},beginColumns(id,columns_count,content_region_width){var g=this.guictx;let win=this.getCurrentWindow();console.assert(1<=columns_count),console.assert(null==win.DC.CurrentColumns);id=this.getColumnsID(id,columns_count);let columns=this.findOrCreateColumns(win,id);console.assert(columns.ID==id),columns.Current=0,columns.Count=columns_count,columns.Flags=content_region_width,win.DC.CurrentColumns=columns;content_region_width=0!=win.SizeContentsExplicit.x?win.SizeContentsExplicit.x:win.InnerClipRect.Max.x-win.Pos.x;if(columns.MinX=win.DC.Indent.x-g.Style.ItemSpacing.x,columns.MaxX=Math.max(content_region_width-win.Scroll.x,columns.MinX+1),columns.BackupCursorPosY=win.DC.CursorPos.y,columns.BackupCursorMaxPosX=win.DC.CursorMaxPos.x,columns.LineMinY=columns.LineMaxY=win.DC.CursorPos.y,win.DC.ColumnsOffset.x=0,win.DC.CursorPos.x=Math.floor(win.Pos.x+win.DC.Indent.x+win.DC.ColumnsOffset.x),0!=columns.Columns.length&&columns.Columns.length!=columns_count+1&&columns.Columns.resize(0),columns.IsFirstFrame=0==columns.Columns.length,0==columns.Columns.length){columns.Columns.length=columns_count+1;for(let n=0;n<columns.Columns.length;n++){let column=new ColumnData;column.OffsetNorm=n/columns_count,columns.Columns[n]=column}}for(let n=0;n<columns_count;n++){let column=columns.Columns[n];var clip_x1=Math.floor(.5+win.Pos.x+this.GetColumnOffset(n)-1),clip_x2=Math.floor(.5+win.Pos.x+this.GetColumnOffset(n+1)-1);column.ClipRect=new Rect(clip_x1,-Number.MAX_VALUE,clip_x2,Number.MAX_VALUE),column.ClipRect.ClipWith(win.ClipRect)}1<columns.Count&&(win.DrawList.ChannelsSplit(columns.Count),this.pushColumnClipRect()),this.PushItemWidth(.65*this.GetColumnWidth())},endColumns(){let g=this.guictx,style=g.Style,win=this.getCurrentWindow(),columns=win.DC.CurrentColumns;console.assert(columns),this.PopItemWidth(),1<columns.Count&&(this.PopClipRect(),win.DrawList.ChannelsMerge()),columns.LineMaxY=Math.max(columns.LineMaxY,win.DC.CursorPos.y),win.DC.CursorPos.y=columns.LineMaxY,columns.Flags&ColumnsFlags.GrowParentContentsSize||(win.DC.CursorMaxPos.x=columns.BackupCursorMaxPosX);let is_being_resized=!1;if(!(columns.Flags&ColumnsFlags.NoBorder||win.SkipItems)){var y1=Math.max(columns.BackupCursorPosY,win.ClipRect.Min.y),y2=Math.min(win.DC.CursorPos.y,win.ClipRect.Max.y);let dragging_column=-1;for(let n=1;n<columns.Count;n++){var col=columns.Columns[n],xi=win.Pos.x+this.GetColumnOffset(n),column_id=columns.ID+n,column_rect=ColumnsHitRectHalfWidth,column_rect=Rect.FromXY(xi-column_rect,y1,xi+column_rect,y2);if(this.keepAliveID(column_id),!this.isClippedEx(column_rect,column_id,!1)){let hovered=new ValRef(!1),held=new ValRef(!1);columns.Flags&ColumnsFlags.NoResize||(this.ButtonBehavior(column_rect,column_id,hovered,held),(hovered.get()||held.get())&&(g.MouseCursor=MouseCursor.ResizeEW),!held.get()||col.Flags&ColumnsFlags.NoResize||(dragging_column=n));col=style.GetColor(held.get()?"SeparatorActive":hovered.get()?"SeparatorHovered":"Separator"),xi=Math.floor(xi);win.DrawList.AddLine(new Vec2(xi,y1+1),new Vec2(xi,y2),col)}}if(-1!=dragging_column){if(!columns.IsBeingResized)for(let n=0;n<columns.Count+1;n++)columns.Columns[n].OffsetNormBeforeResize=columns.Columns[n].OffsetNorm;columns.IsBeingResized=is_being_resized=!0;let x=this.getDraggedColumnOffset(columns,dragging_column);this.SetColumnOffset(dragging_column,x)}}columns.IsBeingResized=is_being_resized,win.DC.CurrentColumns=null,win.DC.ColumnsOffset.x=0,win.DC.CursorPos.x=Math.floor(win.Pos.x+win.DC.Indent.x+win.DC.ColumnsOffset.x)}},ButtonFlags={None:0,Repeat:1,PressedOnClickRelease:2,PressedOnClick:4,PressedOnRelease:8,PressedOnDoubleClick:16,FlattenChildren:32,AllowItemOverlap:64,DontClosePopups:128,Disabled:256,AlignTextBaseLine:512,NoKeyModifiers:1024,NoHoldingActiveID:2048,PressedOnDragDropHold:4096,NoNavFocus:8192,Circle:16384,LongPress:32768},Icons={RightArrow:String.fromCodePoint(9654),RightArrow2:String.fromCodePoint(9658),DownArrow:String.fromCodePoint(9660),Hamburger:String.fromCodePoint(9776),Gear:String.fromCodePoint(9881)},ImguiButtonMixin={ButtonBehavior(bbox,id,out_hovered,out_held,flags=0){var win=this.getCurrentWindow();let g=this.guictx;if(flags&ButtonFlags.Disabled)return out_hovered&&out_hovered.set(!1),out_held&&out_held.set(!1),g.ActiveId==id&&this.clearActiveID(),!1;0==(flags&(ButtonFlags.PressedOnClickRelease|ButtonFlags.PressedOnClick|ButtonFlags.PressedOnRelease|ButtonFlags.PressedOnDoubleClick))&&(flags|=ButtonFlags.PressedOnClickRelease);var nav_activated_by_code,nav_activated_by_inputs=g.HoveredWindow;flags&ButtonFlags.FlattenChildren&&g.HoveredRootWindow==win&&(g.HoveredWindow=win);let pressed=!1,hovered=this.itemHoverable(bbox,id);!hovered||!g.DragDropActive||g.DragDropPayload.SourceId!=id||g.DragDropSourceFlags&DragDropFlags.SourceNoDisableHover||(hovered=!1),g.DragDropActive&&flags&ButtonFlags.PressedOnDragDropHold&&!(g.DragDropSourceFlags&DragDropFlags.SourceNoHoldToOpenOthers)&&this.IsItemHovered(HoveredFlags.AllowWhenBlockedByActiveItem)&&(hovered=!0,this.setHoveredID(id),this.calcTypematicPressedRepeatAmount(g.HoveredIdTimer+1e-4,g.HoveredIdTimer+1e-4-g.IO.DeltaTime,.01,.7)&&(pressed=!0,this.FocusWindow(win))),flags&ButtonFlags.FlattenChildren&&g.HoveredRootWindow==win&&(g.HoveredWindow=nav_activated_by_inputs),hovered&&flags&ButtonFlags.AllowItemOverlap&&g.HoveredIdPreviousFrame!=id&&0!=g.HoveredIdPreviousFrame&&(hovered=!1),hovered&&(flags&ButtonFlags.NoKeyModifiers&&(g.IO.KeyCtrl||g.IO.KeyShift||g.IO.KeyAlt)||(flags&ButtonFlags.PressedOnClickRelease&&g.IO.MouseClicked[0]&&(this.setActiveID(id,win),flags&ButtonFlags.NoNavFocus||this.setFocusID(id,win),this.FocusWindow(win)),(flags&ButtonFlags.PressedOnClick&&g.IO.MouseClicked[0]||flags&ButtonFlags.PressedOnDoubleClick&&g.IO.MouseDoubleClicked[0])&&(pressed=!0,flags&ButtonFlags.NoHoldingActiveID?this.clearActiveID():this.setActiveID(id,win),this.FocusWindow(win)),flags&ButtonFlags.PressedOnRelease&&g.IO.MouseReleased[0]&&(flags&ButtonFlags.LongPress?pressed=g.IO.MouseDownDuration[0]>=g.IO.LongPressInterval:flags&ButtonFlags.Repeat&&g.IO.MouseDownDurationPrev[0]>=g.IO.KeyRepeatDelay||(pressed=!0),this.clearActiveID()),flags&ButtonFlags.Repeat&&g.ActiveId==id&&0<g.IO.MouseDownDuration[0]&&this.IsMouseClicked(0,!0)&&(pressed=!0)),pressed&&(g.NavDisableHighlight=!0)),g.NavId!=id||g.NavDisableHighlight||!g.NavDisableMouseHover||0!=g.ActiveId&&g.ActiveId!=id&&g.ActiveId!=win.MoveId||(hovered=!0),g.NavActivateDownId==id&&(nav_activated_by_code=g.NavActivateId==id,nav_activated_by_inputs=this.isNavInputPressed(NavInput.Activate,flags&ButtonFlags.Repeat?InputReadMode.Repeat:InputReadMode.Pressed),(nav_activated_by_code||nav_activated_by_inputs)&&(pressed=!0),(nav_activated_by_code||nav_activated_by_inputs||g.ActiveId==id)&&(g.NavActivateId=id,this.setActiveID(id,win),!nav_activated_by_code&&!nav_activated_by_inputs||flags&ButtonFlags.NoNavFocus||this.setFocusID(id,win),g.ActiveIdAllowNavDirFlags=1<<Dir.Left|1<<Dir.Right|1<<Dir.Up|1<<Dir.Down));let held=!1;return g.ActiveId==id&&(pressed&&(g.ActiveIdHasBeenPressed=!0),g.ActiveIdSource==InputSource.Mouse?(g.ActiveIdIsJustActivated&&(g.ActiveIdClickOffset=Vec2.Subtract(g.IO.MousePos,bbox.Min)),g.IO.MouseDown[0]?held=!0:(hovered&&flags&ButtonFlags.PressedOnClickRelease&&(flags&ButtonFlags.Repeat&&g.IO.MouseDownDurationPrev[0]>=g.IO.KeyRepeatDelay||g.DragDropActive||flags&ButtonFlags.LongPress&&!(g.IO.MouseDownDurationPrev[0]>=g.IO.LongPressInterval)||(pressed=!0)),this.clearActiveID()),flags&ButtonFlags.NoNavFocus||(g.NavDisableHighlight=!0)):g.ActiveIdSource==InputSource.Nav&&g.NavActivateDownId!=id&&this.clearActiveID()),out_hovered&&out_hovered.set(hovered),out_held&&out_held.set(held),pressed},ButtonEx(label,pressed=null,center=0){let win=this.getCurrentWindow();if(win.SkipItems)return!1;let style=this.guictx.Style;var radius=win.GetID(label),label_size=this.CalcTextSize(label,!0);let pos=win.DC.CursorPos;center&ButtonFlags.AlignTextBaseLine&&style.FramePadding.y<win.DC.CurrentLineTextBaseOffset&&(pos.y+=win.DC.CurrentLineTextBaseOffset-style.FramePadding.y);var col=this.calcItemSize(pressed||Vec2.Zero(),label_size.x+2*style.FramePadding.x,label_size.y+2*style.FramePadding.y),bbox=new Rect(pos,Vec2.Add(pos,col));if(this.itemSize(col,style.FramePadding.y),!this.itemAdd(bbox,radius))return!1;win.DC.ItemFlags&ItemFlags.ButtonRepeat&&(center|=ButtonFlags.Repeat);let hovered=new ValRef,held=new ValRef;pressed=this.ButtonBehavior(bbox,radius,hovered,held,center);pressed&&this.markItemEdited(radius);col=style.GetColor(held.get()&&hovered.get()?"ButtonActive":hovered.get()?"ButtonHovered":"Button");return this.renderNavHighlight(bbox,radius),center&ButtonFlags.Circle?(radius=.65*Math.max(label_size.x,label_size.y),center=new Vec2(bbox.Min.x+radius,bbox.Min.y+radius),win.DrawList.AddCircleFilled(center,Math.max(2,radius),col)):this.renderFrame(bbox.Min,bbox.Max,col,!0,style.FrameRounding),this.renderTextClipped(Vec2.Add(bbox.Min,style.FramePadding),Vec2.Subtract(bbox.Max,style.FramePadding),label.split("##")[0],label_size,style.ButtonTextAlign,bbox),pressed},Button(label,size_arg=null,flags=0){return this.ButtonEx(label,size_arg,flags)},PopupButton(label,size_arg=null,flags=0){var fields=label.split("##");return label=fields[0]+" "+Icons.RightArrow,2==fields.length&&(label+="##"+fields[1]),this.ButtonEx(label,size_arg,flags)},SmallButton(label,pressed=ButtonFlags.AlignTextBaseLine){let g=this.guictx;var backup_padding_y=g.Style.FramePadding.y;g.Style.FramePadding.y=0;pressed=this.ButtonEx(label,Vec2.Zero(),pressed);return g.Style.FramePadding.y=backup_padding_y,pressed},InvisibleButton(size,bbox){let win=this.getCurrentWindow();if(win.SkipItems)return!1;console.assert(0!=bbox.x&&0!=bbox.y);var id=win.GetID(size),size=this.calcItemSize(bbox,0,0),bbox=new Rect(win.DC.CursorPos,Vec2.Add(win.DC.CursorPos,size));return this.itemSize(size),!!this.itemAdd(bbox,id)&&this.ButtonBehavior(bbox,id,null,null)},ArrowButtonEx(pressed,dir,size,col){let win=this.getCurrentWindow();if(win.SkipItems)return!1;size||(disabled=this.GetFrameHeight(),size=new Vec2(disabled,disabled));let g=this.guictx;var id=win.GetID(pressed),bbox=new Rect(win.DC.CursorPos,Vec2.Add(win.DC.CursorPos,size)),disabled=this.GetFrameHeight();if(this.itemSize(bbox,size.y>=disabled?g.Style.FramePadding.y:0),!this.itemAdd(bbox,id))return!1;win.DC.ItemFlags&ItemFlags.ButtonRepeat&&(col|=ButtonFlags.Repeat);let hovered=new ValRef,held=new ValRef;pressed=this.ButtonBehavior(bbox,id,hovered,held,col),disabled=col&ButtonFlags.Disabled,col=g.Style.GetColor(held.get()&&hovered.get()?"ButtonActive":hovered.get()?"ButtonHovered":"Button");return this.renderNavHighlight(bbox,id),this.renderFrame(bbox.Min,bbox.Max,col,!0,g.Style.FrameRounding),this.renderArrow(Vec2.Add(bbox.Min,new Vec2(Math.max(0,.5*(size.x-g.FontSize)),Math.max(0,.5*(size.y-g.FontSize)))),dir,1,disabled),pressed},ArrowButton(str_id,dir){var sz=this.GetFrameHeight();return this.ArrowButtonEx(str_id,dir,new Vec2(sz,sz),0)},IconButton(pressed,icon){let win=this.getCurrentWindow();if(win.SkipItems)return!1;let flags=0;var col=this.GetFrameHeight(),size=new Vec2(col,col);let g=this.guictx;var id=win.GetID(pressed),bbox=new Rect(win.DC.CursorPos,Vec2.Add(win.DC.CursorPos,size)),col=this.GetFrameHeight();if(this.itemSize(bbox,size.y>=col?g.Style.FramePadding.y:0),!this.itemAdd(bbox,id))return!1;win.DC.ItemFlags&ItemFlags.ButtonRepeat&&(flags|=ButtonFlags.Repeat);let hovered=new ValRef,held=new ValRef;pressed=this.ButtonBehavior(bbox,id,hovered,held,flags),col=g.Style.GetColor(held.get()&&hovered.get()?"ButtonActive":hovered.get()?"ButtonHovered":"Button");return this.renderNavHighlight(bbox,id),this.renderFrame(bbox.Min,bbox.Max,col,!0,g.Style.FrameRounding),this.renderIcon(icon,Vec2.AddXY(bbox.Min,Math.max(0,.5*(size.x-g.FontSize)),Math.max(0,.5*(size.y-g.FontSize)))),pressed},IconButtonAlt(ret,icon){this.PushFont(this.guictx.Style.GetFont("Icons"));ret=this.Button(`${icon}##${ret}`);return this.PopFont(),ret},CloseButton(center=null,cross_extent=null,cross_col=6){let g=this.guictx,win=g.CurrentWindow;null==center&&(center=win.GetID("#CLOSE"));let restorePos=null;if(!cross_extent){restorePos=this.GetCursorPosY(),isNaN(restorePos)&&(restorePos=null);let startPos=this.GetCursorScreenStartPos();cross_extent=startPos.AddXY(this.GetWindowWidth()-4*cross_col,2*cross_col)}var pressed=new Vec2(cross_col,cross_col);let bbox=new Rect(Vec2.Subtract(cross_extent,pressed),Vec2.Add(cross_extent,pressed));cross_extent=!this.itemAdd(bbox,center);restorePos&&this.SetCursorPosY(restorePos);let hovered=new ValRef,held=new ValRef;pressed=this.ButtonBehavior(bbox,center,hovered,held);if(cross_extent)return pressed;center=bbox.GetCenter();hovered.get()&&win.DrawList.AddCircleFilled(center,Math.max(2,cross_col),g.Style.GetColor(held?"ButtonActive":"ButtonHovered"));cross_extent=.7071*cross_col-1,cross_col=g.Style.GetColor("Text");return win.DrawList.AddLine(Vec2.AddXY(center,cross_extent,cross_extent),Vec2.AddXY(center,-cross_extent,-cross_extent),cross_col,1),win.DrawList.AddLine(Vec2.AddXY(center,cross_extent,-cross_extent),Vec2.AddXY(center,-cross_extent,cross_extent),cross_col,1),pressed},CollapseButton(pressed,col){let g=this.guictx,win=g.CurrentWindow,id;id="string"==typeof pressed?win.GetID(pressed):pressed;let bbox=new Rect(col,Vec2.Add(Vec2.AddXY(col,g.FontSize,g.FontSize),Vec2.Mult(g.Style.FramePadding,2)));this.itemAdd(bbox,id);let hovered=new ValRef,held=new ValRef;pressed=this.ButtonBehavior(bbox,id,hovered,held,ButtonFlags.None),col=g.Style.GetColor(held.get()&&hovered.get()?"ButtonActive":hovered.get()?"ButtonHovered":"Button");(hovered.get()||held.get())&&win.DrawList.AddCircleFilled(bbox.GetCenter(),.5*g.FontSize+2,col);let apos=bbox.Min.Add(g.Style.FramePadding);return apos.x+=.5,this.renderArrow(apos,win.Collapsed?Dir.Right:Dir.Down),this.IsItemActive()&&this.IsMouseDragging()&&this.startMouseMovingWindow(win),pressed},Checkbox(label,selected,toggleFunc=null){let win=this.getCurrentWindow();if(win.SkipItems)return!1;var g=this.guictx;const style=g.Style;var pad=win.GetID(label),label_size=this.CalcTextSize(label,!0),square_sz=this.GetFrameHeight(),check_bb=win.DC.CursorPos.Clone(),total_bb=new Vec2(square_sz+(0<label_size.x?style.ItemInnerSpacing.x+label_size.x:0),label_size.y+2*style.FramePadding.y),pressed=Vec2.Add(check_bb,total_bb),total_bb=new Rect(check_bb,pressed);if(this.itemSize(total_bb,style.FramePadding.y),!this.itemAdd(total_bb,pad))return!1;let hovered=new ValRef,held=new ValRef;pressed=this.ButtonBehavior(total_bb,pad,hovered,held);let sel=null==selected.value?selected:selected.get();pressed&&(sel=!sel,null!=selected.value?selected.set(sel):toggleFunc&&toggleFunc(sel),this.markItemEdited(pad));check_bb=new Rect(check_bb,Vec2.AddXY(check_bb,square_sz,square_sz));return this.renderNavHighlight(total_bb,pad),this.renderFrame(check_bb.Min,check_bb.Max,style.GetColor(held.get()&&hovered.get()?"FrameBgActive":hovered.get()?"FrameBgHovered":"FrameBg"),!0,style.FrameRounding),sel&&(pad=Math.max(1,Math.floor(square_sz/6)),this.renderCheckMark(Vec2.Add(check_bb.Min,pad),style.GetColor("CheckMark"),square_sz-2*pad)),g.LogEnabled&&this.logRenderedText(total_bb.Min,selected?"[x]":"[ ]"),0<label_size.x&&this.renderText(new Vec2(check_bb.Max.x+style.ItemInnerSpacing.x,check_bb.Min.y+style.FramePadding.y),label),pressed},CheckboxFlags(pressed,flags,flags_bit,onChange=null){let v=new ValRef((flags&flags_bit)==flags_bit);pressed=this.Checkbox(pressed,v);return pressed&&onChange&&(v.get()?flags|=flags_bit:flags&=~flags_bit,onChange(flags)),pressed},RadioButton(label,active){let win=this.getCurrentWindow();if(win.SkipItems)return!1;var g=this.guictx;const style=g.Style;var id=win.GetID(label),label_size=this.CalcTextSize(label,!0),pad=this.GetFrameHeight(),pressed=win.DC.CursorPos;const check_bb=new Rect(pressed,Vec2.AddXY(pressed,pad,pad));var total_bb=new Rect(pressed,Vec2.AddXY(pressed,pad+(0<label_size.x?style.ItemInnerSpacing.x+label_size.x:0),label_size.y+2*style.FramePadding.y));if(this.itemSize(total_bb,style.FramePadding.y),!this.itemAdd(total_bb,id))return!1;let center=check_bb.GetCenter();center.x=Math.floor(center.x+.5),center.y=Math.floor(center.y+.5);var radius=.5*(pad-1);let hovered=new ValRef,held=new ValRef;pressed=this.ButtonBehavior(total_bb,id,hovered,held);return pressed&&this.markItemEdited(id),this.renderNavHighlight(total_bb,id),win.DrawList.AddCircleFilled(center,radius,style.GetColor(held.get()&&hovered.get()?"FrameBgActive":hovered.get()?"FrameBgHovered":"FrameBg"),16),active&&(pad=Math.max(1,Math.floor(pad/6)),win.DrawList.AddCircleFilled(center,radius-pad,style.GetColor("CheckMark"),16)),0<style.FrameBorderSize&&(win.DrawList.AddCircle(Vec2.AddXY(center,1,1),radius,style.GetColor("BorderShadow"),16,style.FrameBorderSize),win.DrawList.AddCircle(center,radius,style.GetColor("Border"),16,style.FrameBorderSize)),g.LogEnabled&&this.LogRenderedText(total_bb.Min,active?"(x)":"( )"),0<label_size.x&&this.renderText(new Vec2(check_bb.Max.x+style.ItemInnerSpacing.x,check_bb.Min.y+style.FramePadding.y),label),pressed},Bullet(){var g,style,bb,win=this.getCurrentWindow();win.SkipItems||(style=(g=this.guictx).Style,bb=Math.max(Math.min(win.DC.CurrentLineHeight,g.FontLineHeight+2*g.Style.FramePadding.y),g.FontLineHeight),bb=new Rect(win.DC.CursorPos,Vec2.AddXY(win.DC.CursorPos,g.FontSize,bb)),this.itemSize(bb),this.itemAdd(bb,0)&&this.renderBullet(Vec2.AddXY(bb.Min,style.FramePadding.x+.5*g.FontSize,.5*g.FontSize)),this.SameLine(0,2*style.FramePadding.x))},ProgressBar(overlay_size,size_arg,overlay){var win=this.getCurrentWindow();if(!win.SkipItems){var fill_br=this.guictx;const style=fill_br.Style;var pos=win.DC.CursorPos,fill_br=this.calcItemSize(size_arg,this.CalcItemWidth(),fill_br.FontSize+2*style.FramePadding.y);let bb=new Rect(pos,Vec2.Add(pos,fill_br));if(this.itemSize(bb,style.FramePadding.y),this.itemAdd(bb,1)){overlay_size=Vec1.Saturate(overlay_size),this.renderFrame(bb.Min,bb.Max,style.GetColor("FrameBg"),!0,style.FrameRounding),bb.expandXY(-style.FrameBorderSize,-style.FrameBorderSize);fill_br=new Vec2(Vec1.Lerp(bb.Min.x,bb.Max.x,overlay_size),bb.Max.y);this.renderRectFilledRangeH(win.DrawList,bb,style.GetColor("PlotHistogram"),0,overlay_size,style.FrameRounding),overlay=overlay||`${Math.floor(100.01*overlay_size)}%`;overlay_size=this.CalcTextSize(overlay);if(0<overlay_size.x){let pos=new Vec2;pos.x=Vec1.Clamp(fill_br.x+style.ItemSpacing.x,bb.Min.x,bb.Max.x-overlay_size.x-style.ItemInnerSpacing.x),pos.y=bb.Min.y,this.renderTextClipped(pos,bb.Max,overlay,overlay_size,new Vec2(0,.5),bb)}}}},getImage(url,onerror=null){this.imageCache||(this.imageCache={});let cache=this.imageCache,img=cache[url];return null==img?(img=new Image,cache[url]=img,img.addEventListener("load",function(){img._loaded=!0}),img.addEventListener("error",function(){img._loaded=!1,img._error=!0,onerror&&onerror(url,cache)}),img.src=url,null):img._loaded?img:img._error?this.getImage("img/404.png"):null},Image(img,size,uv0=null,uv1=null,tint_col=null,border_col=null,bg_col=null,onError=null){let win=this.getCurrentWindow(),bb=new Rect(win.DC.CursorPos,Vec2.Add(win.DC.CursorPos,size));if(null!=border_col&&0<border_col.a&&bb.Max.AddXY(2,2),this.itemSize(bb),this.itemAdd(bb,0)){img="string"==typeof img?this.getImage(url,onError):img;return null!=bg_col&&0<bg_col.a&&win.DrawList.AddRectFilled(bb.Min,bb.Max,bg_col,0),null!=border_col&&0<border_col.a?(win.DrawList.AddRect(bb.Min,bb.Max,border_col,0),img&&win.DrawList.AddImage(img,bb.Expand(-1),uv0,uv1,tint_col)):img&&win.DrawList.AddImage(img,bb,uv0,uv1,tint_col),img}},ImageButton(img,image_bb,uv0=null,uv1=null,bb=0,bg_col=null,tint_col=null,pressed=0,col=null){let win=this.getCurrentWindow();if(win.SkipItems)return!1;const style=this.guictx.Style;this.PushID(img);var id=win.GetID("#image");this.PopID();var padding=0<=bb?new Vec2(bb,bb):style.FramePadding,bb=Rect.FromXY(win.DC.CursorPos,win.DC.CursorPos.x+image_bb.x+2*padding.x,win.DC.CursorPos.y+image_bb.y+2*padding.y),image_bb=Rect.FromXY(Vec2.Add(win.DC.CursorPos,padding),win.DC.CursorPos.x+padding.x+image_bb.x,win.DC.CursorPos.y+padding.y+image_bb.y);if(this.itemSize(bb),!this.itemAdd(bb,id))return!1;let hovered=new ValRef,held=new ValRef;pressed=this.ButtonBehavior(bb,id,hovered,held,pressed),img=this.getImage(img,col),col=style.GetColor(held.get()&&hovered.get()?"ButtonActive":hovered.get()?"ButtonHovered":"Button");return this.renderNavHighlight(bb,id),this.renderFrame(bb.Min,bb.Max,col,!0,Vec1.Clamp(Math.min(padding.x,padding.y),0,style.FrameRounding)),bg_col&&0<bg_col.w&&win.DrawList.AddRectFilled(image_bb.Min,image_bb.Max,bg_col),img&&win.DrawList.AddImage(img,image_bb,uv0,uv1,tint_col),pressed}};let sLockedScroll={};var ImguiScrollbarMixin={scrollbar(clicked_v_norm){let g=this.guictx,win=g.CurrentWindow;var horizontal=clicked_v_norm==Axis.X;const style=g.Style;var grab_col=this.getScrollbarID(win,clicked_v_norm);this.keepAliveID(grab_col);var grab_h_norm=horizontal?win.ScrollbarY:win.ScrollbarX,previously_held=grab_h_norm?style.ScrollbarSize:0,window_rect=win.Rect(),scroll_v_norm=win.WindowBorderSize;let bb=horizontal?Rect.FromXY(win.Pos.x+scroll_v_norm,window_rect.Max.y-style.ScrollbarSize,window_rect.Max.x-previously_held-scroll_v_norm,window_rect.Max.y-scroll_v_norm):Rect.FromXY(window_rect.Max.x-style.ScrollbarSize,win.Pos.y+scroll_v_norm,window_rect.Max.x-scroll_v_norm,window_rect.Max.y-previously_held-scroll_v_norm);horizontal||(bb.Min.y+=win.TitleBarHeight()+(win.Flags&WindowFlags.MenuBar?win.MenuBarHeight():0));var grab_h_pixels=bb.GetHeight();if(!(bb.GetWidth()<=0||grab_h_pixels<=0)){let alpha=1;if(!(clicked_v_norm==Axis.Y&&grab_h_pixels<g.FontLineHeight+2*g.Style.FramePadding.y&&(alpha=Vec1.Saturate((grab_h_pixels-g.FontLineHeight)/(2*g.Style.FramePadding.y)),alpha<=0))){var mouse_pos_v=1<=alpha;let window_rounding_corners;window_rounding_corners=horizontal?CornerFlags.BotLeft|(grab_h_norm?0:CornerFlags.BotRight):(win.Flags&WindowFlags.NoTitleBar&&!(win.Flags&WindowFlags.MenuBar)?CornerFlags.TopRight:0)|(grab_h_norm?0:CornerFlags.BotRight),win.DrawList.AddRectFilled(bb.Min,bb.Max,style.GetColor("ScrollbarBg"),win.WindowRounding,window_rounding_corners),bb.expandXY(-Vec1.Clamp(Math.floor(.5*(bb.GetWidth()-2)),0,2),-Vec1.Clamp(Math.floor(.5*(bb.GetHeight()-2)),0,2));var scrollbar_size_v=horizontal?bb.GetWidth():bb.GetHeight();let scroll_v=horizontal?win.Scroll.x:win.Scroll.y;var win_size_avail_v=(horizontal?win.SizeFull.x:win.SizeFull.y)-previously_held,scroll_v_norm=horizontal?win.SizeContents.x:win.SizeContents.y;console.assert(0<Math.max(scroll_v_norm,win_size_avail_v));clicked_v_norm=Math.max(scroll_v_norm,win_size_avail_v,1),grab_h_pixels=Vec1.Clamp(scrollbar_size_v*(win_size_avail_v/clicked_v_norm),style.GrabMinSize,scrollbar_size_v),grab_h_norm=grab_h_pixels/scrollbar_size_v;let held=new ValRef(!1),hovered=new ValRef(!1);previously_held=g.ActiveId==grab_col;this.ButtonBehavior(bb,grab_col,hovered,held,ButtonFlags.NoNavFocus);let scroll_max=Math.max(1,scroll_v_norm-win_size_avail_v),scroll_ratio=Vec1.Saturate(scroll_v/scroll_max),grab_v_norm=scroll_ratio*(scrollbar_size_v-grab_h_pixels)/scrollbar_size_v;if(held.get()&&mouse_pos_v&&grab_h_norm<1){clicked_v_norm=horizontal?bb.Min.x:bb.Min.y,mouse_pos_v=horizontal?g.IO.MousePos.x:g.IO.MousePos.y;let apply,getval;getval=horizontal?(apply=function(delta){g.ScrollbarClickDeltaToGrabCenter.x=delta},function(){return g.ScrollbarClickDeltaToGrabCenter.x}):(apply=function(delta){g.ScrollbarClickDeltaToGrabCenter.y=delta},function(){return g.ScrollbarClickDeltaToGrabCenter.y});clicked_v_norm=Vec1.Saturate((mouse_pos_v-clicked_v_norm)/scrollbar_size_v);this.setHoveredID(grab_col);let seek_absolute=!1;previously_held?win.Flags&WindowFlags.LockScrollingContentSize&&(scroll_max=Math.max(1,sLockedScroll[grab_col]-win_size_avail_v),scroll_ratio=Vec1.Saturate(scroll_v/scroll_max),grab_v_norm=scroll_ratio*(scrollbar_size_v-grab_h_pixels)/scrollbar_size_v):(win.Flags&WindowFlags.LockScrollingContentSize&&(sLockedScroll[grab_col]=scroll_v_norm),clicked_v_norm>=grab_v_norm&&clicked_v_norm<=grab_v_norm+grab_h_norm?apply(clicked_v_norm-grab_v_norm-.5*grab_h_norm):(seek_absolute=!0,apply(0)));scroll_v_norm=(clicked_v_norm-getval()-.5*grab_h_norm)/(1-grab_h_norm),scroll_v_norm=Vec1.Saturate(scroll_v_norm);scroll_v=Math.floor(.5+scroll_v_norm*scroll_max),horizontal?win.Scroll.x=scroll_v:win.Scroll.y=scroll_v,scroll_ratio=Vec1.Saturate(scroll_v/scroll_max),grab_v_norm=scroll_ratio*(scrollbar_size_v-grab_h_pixels)/scrollbar_size_v,seek_absolute&&apply(clicked_v_norm-grab_v_norm-.5*grab_h_norm)}else sLockedScroll[grab_col]=0;grab_col=style.GetColor(held.get()?"ScrollbarGrabActive":hovered.get()?"ScrollbarGrabHovered":"ScrollbarGrab",alpha);let grab_rect=null,min;grab_rect=horizontal?(min=Vec1.Lerp(bb.Min.x,bb.Max.x,grab_v_norm),Rect.FromXY(min,bb.Min.y,Math.min(min+grab_h_pixels,window_rect.Max.x),bb.Max.y)):(min=Vec1.Lerp(bb.Min.y,bb.Max.y,grab_v_norm),Rect.FromXY(bb.Min.x,min,bb.Max.x,Math.min(min+grab_h_pixels,window_rect.Max.y))),win.DrawList.AddRectFilled(grab_rect.Min,grab_rect.Max,grab_col,style.ScrollbarRounding)}}},getScrollbarID(win,axis){return win.GetIDNoKeepAlive(axis==Axis.X?"#SCROLLX":"#SCROLLY")}},FileBrowserMode={PickFile:0,PickDir:1,SaveFile:2,ViewOnly:3};const ClientModes=Object.keys(FileBrowserMode),RecentDirs="FileBrowser/RecentDirs",DefaultIcons={RecentDirs:String.fromCodePoint(59530),Filter:String.fromCodePoint(57682),Clock:String.fromCodePoint(128337)};var TheFileBrowser=null;class FileBrowser{constructor(filesys,prefs=null,icons=DefaultIcons){TheFileBrowser=TheFileBrowser||this,this.IsOpen=new ValRef(!1),this.filesys=filesys,this.path=filesys.path,this.opMode=FileBrowserMode.ViewOnly,this.selection="",this.selectionIndex=-1,this.selectionIndexMax=-1,this.clientCB=null,this.clientPrompt="Select file(s)",this.cwd=null,this.cwdList=null,this.cwdSubdirs=null,this.cwdFiles=null,this.filter=null,this.nameEntry=new MutableString,this.mkdirEntry=new MutableString,this.minSize=new Vec2(200,200),this.prefs=prefs,this.icons=icons,this.zIndex=-1,this.recentDirs=[],this.imgui=null}InstallFilesys(filesys){this.filesys=filesys}Begin(imgui){this.imgui=imgui}End(){}GetDir(){return this.cwd}SetDir(driveSpec){let ndir=driveSpec.replace(/\\/g,"/");driveSpec=ndir.indexOf(":");-1!=driveSpec&&(ndir=ndir.slice(driveSpec-1)),this.cwd=ndir,this.cwdFiles=[],this.cwdSubdirs=[],this.cwdErrEntries=[],this.selection="",this.selectionIndex=0,this.selectionType="",this.filter&&this.filter.Clear(),"/"==this.cwd?(this.cwdList=["/"],this.filesys.listVolumes(this.readDirCB.bind(this))):(this.cwdList=this.cwd.split("/"),""==this.cwdList[0]?this.cwdList[0]="/":this.cwdList.unshift("/"),""==this.cwdList[this.cwdList.length-1]&&this.cwdList.pop(),this.cwdSubdirs.push(".."),this.filesys.readdir(this.cwd+"/",{withFileTypes:!0},this.readDirCB.bind(this)))}SetClient(prompt,cb,mode,ext,doopen=!0,zIndex=-1){"string"==typeof mode&&(mode=ClientModes.indexOf(mode)),this.opMode=mode,this.clientCB=cb,this.clientPrompt=prompt||"View files(s)",this.clientExtensions=ext,this.zIndex=zIndex,doopen&&(this.IsOpen.set(!0),this.cwd&&this.SetDir(this.cwd))}GetSelection(asRelative=!0){var str=this.opMode==FileBrowserMode.SaveFile?this.nameEntry.toString():this.selection;return asRelative?str:this.path.join(this.cwd,str).replace(/\\/g,"/")}Show(imgui){if(this.IsOpen.get()){this.filter||(this.filter=new TextFilter(imgui));var dir=imgui.GetFontSize();imgui.SetNextWindowPos(new Vec2(10,10),CondFlags.FirstUseEver),imgui.SetNextWindowSize(new Vec2(400,300),CondFlags.FirstUseEver),-1!=this.zIndex&&imgui.SetNextWindowZIndex(this.zIndex);var pnm=this.clientPrompt+"##File Browser";if(imgui.Begin(pnm,this.IsOpen,WindowFlags.NoCollapse)){var recentDirs=this.prefs?this.prefs.GetValue(RecentDirs,[]):this.recentDirs;if(null==this.cwd){let firstDir;return firstDir=recentDirs.length?recentDirs[0]:"/",this.SetDir(firstDir),void imgui.End()}pnm="RecentDirMenu";if(imgui.SmallButton(this.icons.Clock)&&imgui.OpenPopup(pnm),imgui.BeginPopup(pnm)){for(var d of recentDirs)imgui.MenuItem(d,!1)&&this.SetDir(d);imgui.EndPopup()}imgui.SameLine();let lastX2=0;var winMax=imgui.GetWindowPos().x+imgui.GetWindowContentRegionMax().x;if(0==this.cwdList.length)imgui.SmallButton("/")&&this.SetDir("/");else for(let i=0;i<this.cwdList.length;i++){if(0<i&&50<winMax-lastX2&&imgui.SameLine(),imgui.SmallButton(this.cwdList[i])){let subset=this.cwdList.slice(0,i+1),newpath=subset.join("/");0==newpath.indexOf("//")&&(newpath=newpath.slice(1)),this.SetDir(newpath)}lastX2=imgui.GetItemRectMax().x}if(imgui.Text("Filter"),imgui.SameLine(),this.filter.Draw("",5*dir),imgui.SameLine(),this.showButtons(imgui,dir),this.checkShortcuts(imgui,"header"))return this.doClose(),void imgui.End();imgui.Separator();dir=imgui.GetWindowContentRegionMax().x;let ysize=imgui.GetWindowContentRegionMax().y-imgui.GetCursorPosY();if(0,imgui.BeginChild("##FileDialog_FileList",new Vec2(dir,ysize)),this.checkShortcuts(imgui,"filelist"))return imgui.EndChild(),this.doClose(),void imgui.End();imgui.PushStyleColor("Text",imgui.GetStyleColor("FBDir"));for(let i=0;i<this.cwdSubdirs.length;i++){var p=this.cwdSubdirs[i];this.filter.IsActive()&&!this.filter.PassFilter(p)||"."!=p&&imgui.Selectable(p+"/",p==this.selection,SelectableFlags.AllowDoubleClick)&&(this.selection=p,this.selectionIndex=i,this.updateSelection(),!imgui.IsMouseDoubleClicked([0])&&this.opMode==FileBrowserMode.OpenDir||this.performAction())}imgui.PopStyleColor(),this.opMode==FileBrowserMode.SaveFile&&"/"!=this.cwd&&(dir="Create Folder",imgui.PushStyleColor("Text",imgui.GetStyleColor("FBMkDir")),imgui.Selectable("New folder...",!1)&&(imgui.OpenPopup(dir),this.selectionType,this.mkdirEntry.Set("")),imgui.PopStyleColor(),imgui.BeginPopup(dir)&&(imgui.Text("New Folder:"),imgui.SameLine(),imgui.InputText("##newfolder",this.mkdirEntry,InputTextFlags.EnterReturnsTrue)&&(dir=this.path.join(this.cwd,this.mkdirEntry.toString()),console.info("creating "+this.mkdirEntry.toString()),this.filesys.mkdir(dir,{recursive:!0},err=>{err?console.error(err):(this.mkdirEntry.Set(""),imgui.FocusWindow(null),this.SetDir(this.cwd))})),imgui.EndPopup())),imgui.PushStyleColor("Text",imgui.GetStyleColor("FBFile"));for(let i=0;i<this.cwdFiles.length;i++){let p=this.cwdFiles[i];if((!this.filter.IsActive()||this.filter.PassFilter(p))&&(imgui.Selectable(p,p==this.selection,SelectableFlags.AllowDoubleClick)&&(this.selection=p,this.selectionIndex=i+this.cwdSubdirs.length,this.updateSelection(),imgui.IsMouseDoubleClicked([0])&&this.performAction()),imgui.BeginPopupContextItem("##file"+i))){if(imgui.Selectable("delete "+p+"?")){let fp=this.path.join(this.cwd,p);console.info("deleting "+fp),this.filesys.unlink(fp,err=>{err?console.error(err):console.info(fp+" deleted"),this.SetDir(this.cwd)})}imgui.EndPopup()}}this.selectionIndexMax=this.cwdSubdirs.length+this.cwdFiles.length-1,imgui.PopStyleColor(),imgui.EndChild(),imgui.End()}else imgui.End()}else this.clientCB=null}disableSelection(){return 0==this.selection.length||this.opMode==FileBrowserMode.PickFile&&"file"!=this.selectionType||this.opMode==FileBrowserMode.PickDir&&"dir"!=this.selectionType}performAction(){switch(this.selectionType){case"dir":var np;this.opMode==FileBrowserMode.PickDir?this.performSelection():".."==this.selection?/^[a-zA-Z]:[/]?$/.test(this.cwd)?this.SetDir("/"):this.SetDir(this.path.dirname(this.cwd)):(np=this.path.join(this.cwd,this.selection),np=this.path.normalize(np),this.SetDir(np));break;case"file":this.opMode==FileBrowserMode.PickFile&&this.performSelection()}}performSelection(){var path=this.GetSelection(!1);this.updateRecentDirs(),this.clientCB?this.clientCB(0,path):console.notice("would have selected:"+path)}showButtons(imgui){var disable=this.disableSelection();switch(this.opMode){case FileBrowserMode.PickFile:case FileBrowserMode.PickDir:default:disable&&(imgui.PushItemFlag(ItemFlags.Disabled),imgui.PushStyleVar("Alpha",.5)),imgui.Button("Select")&&this.performSelection(),disable&&(imgui.PopItemFlag(),imgui.PopStyleVar()),imgui.SameLine(),imgui.Text(this.selection);break;case FileBrowserMode.SaveFile:imgui.InputText("##FileName",this.nameEntry),imgui.SameLine(),0==this.nameEntry.Length()&&(imgui.PushItemFlag(ItemFlags.Disabled),imgui.PushStyleVar("Alpha",.5)),imgui.Button("Save")&&this.performSelection(),0==this.nameEntry.Length()&&(imgui.PopItemFlag(),imgui.PopStyleVar())}}updateRecentDirs(){if(this.prefs){let recentDirs=this.prefs?this.prefs.GetValue(RecentDirs,[]):this.recentDirs;var idx=recentDirs.indexOf(this.cwd);0!=idx&&(-1!=idx&&recentDirs.splice(idx,1),recentDirs.unshift(this.cwd),this.prefs&&this.prefs.SetValue(RecentDirs,recentDirs.slice(0,15))),this.recentDirs=recentDirs}}checkShortcuts(imgui){if(!imgui.IsWindowFocused())return!1;var io=imgui.guictx.IO;for(let n=0;n<io.InputKeyEvents.length;n++)switch(io.InputKeyEvents[n].key){case"ArrowUp":0<this.selectionIndex?(this.selectionIndex--,this.updateSelection()):this.selectionIndex=0;break;case"ArrowDown":this.selectionIndex<this.selectionIndexMax&&(this.selectionIndex++,this.updateSelection());break;case"Escape":return!0;case"Return":case"Enter":this.performAction()}}updateSelection(){0<=this.selectionIndex&&this.selectionIndex<=this.selectionIndexMax&&(this.selectionIndex<this.cwdSubdirs.length?(this.selection=this.cwdSubdirs[this.selectionIndex],this.selectionType="dir"):(this.selection=this.cwdFiles[this.selectionIndex-this.cwdSubdirs.length],this.selectionType="file",this.opMode==FileBrowserMode.SaveFile&&this.nameEntry.Set(this.selection)))}doClose(){this.clientCB&&this.clientCB(0,null),this.IsOpen.set(!1)}readDirCB(err,flist){if(err)console.error(err);else{let nfiles=0;for(let i=0;i<flist.length;i++){let f=flist[i],fpath;fpath="/"==this.cwd&&"\\"==this.path.sep?f:this.path.join(this.cwd,f),this.filesys.stat(fpath,(err,stats)=>{err?this.cwdErrEntries.push(f):stats.isDirectory()?this.cwdSubdirs.push(f):stats.isFile()?this.cwdFiles.push(f):console.debug("skipping "+f),nfiles++,nfiles==flist.length-1&&(this.cwdSubdirs.sort((a,b)=>a.toLowerCase().localeCompare(b.toLowerCase())),this.cwdFiles.sort((a,b)=>a.toLowerCase().localeCompare(b.toLowerCase())),this.selectionIndex=0,this.selectionType="dir",this.selection=this.cwdSubdirs[0])})}}}}class DemoLayout{constructor(imgui){this.imgui=imgui}Show(){let imgui=this.imgui;if(imgui.CollapsingHeader("Layout")){if(imgui.TreeNode("Child windows")){imgui.Tooltip("Use child windows to begin into a self-contained independent scrolling/clipping regions within a host window."),null==this.CW_disable_mouse_wheel&&(this.CW_disable_mouse_wheel=!1,this.CW_disable_menu=!1,this.CW_line=50),imgui.Checkbox("Disable Mouse Wheel",this.CW_disable_mouse_wheel)&&(this.CW_disable_mouse_wheel^=1),imgui.Checkbox("Disable Menu",this.CW_disable_menu)&&(this.CW_disable_menu^=1);var goto_line=imgui.Button("Goto");imgui.SameLine(),imgui.SetNextItemWidth(100),goto_line|=imgui.InputInt("##Line",this.CW_line,0,0,InputTextFlags.EnterReturnsTrue,newval=>this.CW_line=newval);var child_rect_max=WindowFlags.HorizontalScrollbar|(this.CW_disable_mouse_wheel?WindowFlags.NoScrollWithMouse:0);imgui.BeginChild("Child1",new Vec2(.5*imgui.GetWindowContentRegionWidth(),260),!1,child_rect_max);for(let i=0;i<100;i++)imgui.Text("%4d: scrollable region",i),goto_line&&this.CW_line==i&&imgui.SetScrollHereY();goto_line&&100<=this.CW_line&&imgui.SetScrollHereY(),imgui.EndChild(),imgui.SameLine(),child_rect_max=(this.CW_disable_mouse_wheel?WindowFlags.NoScrollWithMouse:0)|(this.CW_disable_menu?0:WindowFlags.MenuBar),imgui.PushStyleVar("ChildRounding",5),imgui.BeginChild("Child2",new Vec2(0,260),!0,child_rect_max),!this.CW_disable_menu&&imgui.BeginMenuBar()&&(imgui.BeginMenu("Menu")&&(ExampleFileMenu(imgui),imgui.EndMenu()),imgui.EndMenuBar()),imgui.Columns(2);for(let i=0;i<100;i++)imgui.Button(("000"+i).slice(-3),new Vec2(-1,0)),imgui.NextColumn();imgui.EndChild(),imgui.PopStyleVar(),imgui.Separator(),imgui.SetCursorPosX(50),imgui.PushStyleColor("ChildBg",Color.rgbai(255,0,0,100)),imgui.BeginChild("blah",new Vec2(200,100),!0,WindowFlags.None);for(let n=0;n<50;n++)imgui.Text("Some test %d",n);imgui.EndChild();var child_rect_min=imgui.GetItemRectMin(),child_rect_max=imgui.GetItemRectMax();imgui.PopStyleColor(),imgui.Text("Rect of child window is: (%d,%d) (%d,%d)",child_rect_min.x,child_rect_min.y,child_rect_max.x,child_rect_max.y),imgui.TreePop()}if(imgui.TreeNode("Widgets Width")&&(null==this.WW_f&&(this.WW_f=0),imgui.Text("SetNextItemWidth/PushItemWidth(100)"),imgui.SameLine(),imgui.Tooltip("Fixed width."),imgui.SetNextItemWidth(100),imgui.DragFloat("float##1",this.WW_f,1,0,0,null,1,newval=>this.WW_f=newval),imgui.Text("SetNextItemWidth/PushItemWidth(GetWindowWidth() * 0.5f)"),imgui.SameLine(),imgui.Tooltip("Half of window width."),imgui.SetNextItemWidth(.5*imgui.GetWindowWidth()),imgui.DragFloat("float##2",this.WW_f,1,0,0,null,1,newval=>this.WW_f=newval),imgui.Text("SetNextItemWidth/PushItemWidth(GetContentRegionAvailWidth() * 0.5f)"),imgui.SameLine(),imgui.Tooltip("Half of available width.\n(~ right-cursor_pos)\n(works within a column set)"),imgui.SetNextItemWidth(.5*imgui.GetContentRegionAvailWidth()),imgui.DragFloat("float##3",this.WW_f,1,0,0,null,1,newval=>this.WW_f=newval),imgui.Text("SetNextItemWidth/PushItemWidth(-100)"),imgui.SameLine(),imgui.Tooltip("Align to right edge minus 100"),imgui.SetNextItemWidth(-100),imgui.DragFloat("float##4",this.WW_f,1,0,0,null,1,newval=>this.WW_f=newval),imgui.Text("SetNextItemWidth/PushItemWidth(-1)"),imgui.SameLine(),imgui.Tooltip("Align to right edge"),imgui.PushItemWidth(-1),imgui.DragFloat("float##5a",this.WW_f,1,0,0,null,1,newval=>this.WW_f=newval),imgui.DragFloat("float##5b",this.WW_f,1,0,0,null,1,newval=>this.WW_f=newval),imgui.DragFloat("float##5c",this.WW_f,1,0,0,null,1,newval=>this.WW_f=newval),imgui.PopItemWidth(),imgui.TreePop()),imgui.TreeNode("Basic Horizontal Layout")){imgui.TextWrapped("(Use imgui.SameLine() to keep adding items to the right of the preceding item)"),imgui.Text("Two items: Hello"),imgui.SameLine(),imgui.TextColored(Color.rgba(1,1,0,1),"Sailor"),imgui.Text("More spacing: Hello"),imgui.SameLine(0,20),imgui.TextColored(Color.rgba(1,1,0,1),"Sailor"),imgui.AlignTextToFramePadding(),imgui.Text("Normal buttons"),imgui.SameLine(),imgui.Button("Banana"),imgui.SameLine(),imgui.Button("Apple"),imgui.SameLine(),imgui.Button("Corniflower"),imgui.Text("Small buttons"),imgui.SameLine(),imgui.SmallButton("Like this one"),imgui.SameLine(),imgui.Text("can fit within a text block."),imgui.Text("Aligned"),imgui.SameLine(150),imgui.Text("x=150"),imgui.SameLine(300),imgui.Text("x=300"),imgui.Text("Aligned"),imgui.SameLine(150),imgui.SmallButton("x=150"),imgui.SameLine(300),imgui.SmallButton("x=300"),null==this.HL_c1&&(this.HL_c1=!1,this.HL_c2=!1,this.HL_c3=!1,this.HL_c4=!1),imgui.Checkbox("My",this.HL_c1)&&(this.HL_c1^=1),imgui.SameLine(),imgui.Checkbox("Tailor",this.HL_c2)&&(this.HL_c2^=1),imgui.SameLine(),imgui.Checkbox("Is",this.HL_c3)&&(this.HL_c3^=1),imgui.SameLine(),imgui.Checkbox("Rich",this.HL_c4)&&(this.HL_c4^=1),null==this.HL_f0&&(this.HL_f0=1,this.HL_f1=2,this.HL_f2=3,this.HL_items=["AAAA","BBBB","CCCC","DDDD"],this.HL_item=-1,this.HL_selection=[0,1,2,3]),imgui.PushItemWidth(80),imgui.Combo("Combo",this.HL_item,this.HL_items,newval=>this.HL_item=newval),imgui.SameLine(),imgui.SliderFloat("X",this.HL_f0,0,5,null,1,newval=>this.HL_f0=newval),imgui.SameLine(),imgui.SliderFloat("Y",this.HL_f1,0,5,null,1,newval=>this.HL_f1=newval),imgui.SameLine(),imgui.SliderFloat("Z",this.HL_f2,0,5,null,1,newval=>this.HL_f2=newval),imgui.PopItemWidth(),imgui.PushItemWidth(80),imgui.Text("Lists:");for(let i=0;i<4;i++)0<i&&imgui.SameLine(),imgui.PushID(i),imgui.ListBox("",this.HL_selection[i],this.HL_items),imgui.PopID();imgui.PopItemWidth();var button_sz=new Vec2(40,40);imgui.Button("A",button_sz),imgui.SameLine(),imgui.Dummy(button_sz),imgui.SameLine(),imgui.Button("B",button_sz),imgui.Text("Manually wrapping:");var style=imgui.GetStyle(),window_visible_x2=imgui.GetWindowPos().x+imgui.GetWindowContentRegionMax().x;for(let n=0;n<20;n++){imgui.PushID(n),imgui.Button("Box",button_sz);var next_button_x2=imgui.GetItemRectMax().x+style.ItemSpacing.x+button_sz.x;n+1<20&&next_button_x2<window_visible_x2&&imgui.SameLine(),imgui.PopID()}imgui.TreePop()}if(imgui.TreeNode("Tabs")){if(imgui.TreeNode("Basic")&&(bwidth=TabBarFlags.None,imgui.BeginTabBar("MyTabBar",bwidth)&&(imgui.BeginTabItem("Avocado")&&(imgui.Text("This is the Avocado tab!\nblah blah blah blah blah"),imgui.EndTabItem()),imgui.BeginTabItem("Broccoli")&&(imgui.Text("This is the Broccoli tab!\nblah blah blah blah blah"),imgui.EndTabItem()),imgui.BeginTabItem("Cucumber")&&(imgui.Text("This is the Cucumber tab!\nblah blah blah blah blah"),imgui.EndTabItem()),imgui.EndTabBar()),imgui.Separator(),imgui.TreePop()),imgui.TreeNode("Advanced & Close Button")){null==this.T_tab_bar_flags&&(this.T_tab_bar_flags=TabBarFlags.Reorderable),imgui.CheckboxFlags("TabBarFlags.Reorderable",this.T_tab_bar_flags,TabBarFlags.Reorderable,newval=>this.T_tab_bar_flags=newval),imgui.CheckboxFlags("TabBarFlags.AutoSelectNewTabs",this.T_tab_bar_flags,TabBarFlags.AutoSelectNewTabs,newval=>this.T_tab_bar_flags=newval),imgui.CheckboxFlags("TabBarFlags.TabListPopupButton",this.T_tab_bar_flags,TabBarFlags.TabListPopupButton,newval=>this.T_tab_bar_flags=newval),imgui.CheckboxFlags("TabBarFlags.NoCloseWithMiddleMouseButton",this.T_tab_bar_flags,TabBarFlags.NoCloseWithMiddleMouseButton,newval=>this.T_tab_bar_flags=newval),0==(this.T_tab_bar_flags&TabBarFlags.FittingPolicyMask_)&&(this.T_tab_bar_flags|=TabBarFlags.FittingPolicyDefault_),imgui.CheckboxFlags("TabBarFlags.FittingPolicyResizeDown",this.T_tab_bar_flags,TabBarFlags.FittingPolicyResizeDown,newval=>this.T_tab_bar_flags=newval)&&(this.T_tab_bar_flags&=~(TabBarFlags.FittingPolicyMask_^TabBarFlags.FittingPolicyResizeDown)),imgui.CheckboxFlags("TabBarFlags.FittingPolicyScroll",this.T_tab_bar_flags,TabBarFlags.FittingPolicyScroll,newval=>this.T_tab_bar_flags=newval)&&(this.T_tab_bar_flags&=~(TabBarFlags.FittingPolicyMask_^TabBarFlags.FittingPolicyScroll)),null==this.T_names&&(this.T_names=["Artichoke","Beetroot","Celery","Daikon"],this.T_opened=[new ValRef(!0),new ValRef(!0),new ValRef(!0),new ValRef(!0)]);for(let n=0;n<this.T_opened.length;n++)0<n&&imgui.SameLine(),imgui.Checkbox(this.T_names[n],this.T_opened[n]);if(imgui.BeginTabBar("MyTabBar",this.T_tab_bar_flags)){for(let n=0;n<this.T_opened.length;n++)this.T_opened[n].get()&&imgui.BeginTabItem(this.T_names[n],this.T_opened[n])&&(imgui.Text("This is the %s tab!",this.T_names[n]),1&n&&imgui.Text("I am an odd tab."),imgui.EndTabItem());imgui.EndTabBar()}imgui.Separator(),imgui.TreePop()}imgui.TreePop()}var bwidth;if(imgui.TreeNode("Groups")&&(imgui.Tooltip("Using imgui.BeginGroup()/EndGroup() to layout items. BeginGroup() basically locks the horizontal position. EndGroup() bundles the whole group so that you can use functions such as IsItemHovered() on it."),imgui.BeginGroup(),imgui.BeginGroup(),imgui.Button("AAA"),imgui.SameLine(),imgui.Button("BBB"),imgui.SameLine(),imgui.BeginGroup(),imgui.Button("CCC"),imgui.Button("DDD"),imgui.EndGroup(),imgui.SameLine(),imgui.Button("EEE"),imgui.EndGroup(),imgui.IsItemHovered()&&imgui.SetTooltip("First group hovered"),null==this.G_values&&(this.G_values=[.5,.2,.8,.6,.25]),bwidth=.5*((bg=imgui.GetItemRectSize()).x-imgui.GetStyle().ItemSpacing.x),imgui.PlotHistogram("##values",this.G_values,0,null,0,1,bg),imgui.Button("ACTION",new Vec2(bwidth,bg.y)),imgui.SameLine(),imgui.Button("REACTION",new Vec2(bwidth,bg.y)),imgui.EndGroup(),imgui.SameLine(),imgui.Button("LEVERAGE\nBUZZWORD",bg),imgui.SameLine(),imgui.ListBoxHeader("List",bg)&&(imgui.Selectable("Selected",!0),imgui.Selectable("Not Selected",!1),imgui.ListBoxFooter()),imgui.TreePop()),imgui.TreeNode("Text Baseline Alignment")){imgui.Tooltip('This is testing the vertical alignment that gets applied on text to keep it aligned with widgets. Lines only composed of text or "small" widgets fit in less vertical spaces than lines with normal widgets.'),imgui.Text("One\nTwo\nThree"),imgui.SameLine(),imgui.Text("Hello\nWorld"),imgui.SameLine(),imgui.Text("Banana"),imgui.Text("Banana"),imgui.SameLine(),imgui.Text("Hello\nWorld"),imgui.SameLine(),imgui.Text("One\nTwo\nThree"),imgui.Button("HOP##1"),imgui.SameLine(),imgui.Text("Banana"),imgui.SameLine(),imgui.Text("Hello\nWorld"),imgui.SameLine(),imgui.Text("Banana"),imgui.Button("HOP##2"),imgui.SameLine(),imgui.Text("Hello\nWorld"),imgui.SameLine(),imgui.Text("Banana"),imgui.Button("TEST##1"),imgui.SameLine(),imgui.Text("TEST"),imgui.SameLine(),imgui.SmallButton("TEST##2"),imgui.AlignTextToFramePadding(),imgui.Text("Text aligned to Widget"),imgui.SameLine(),imgui.Button("Widget##1"),imgui.SameLine(),imgui.Text("Widget"),imgui.SameLine(),imgui.SmallButton("Widget##2"),imgui.SameLine(),imgui.Button("Widget##3");var bigfont=imgui.GetStyle().ItemInnerSpacing.x;if(imgui.Button("Button##1"),imgui.SameLine(0,bigfont),imgui.TreeNode("Node##1")){for(let i=0;i<6;i++)imgui.BulletText("Item %d..",i);imgui.TreePop()}imgui.AlignTextToFramePadding();var fg=imgui.TreeNode("Node##2");if(imgui.SameLine(0,bigfont),imgui.Button("Button##2"),fg){for(let i=0;i<6;i++)imgui.BulletText("Item %d..",i);imgui.TreePop()}imgui.Button("Button##3"),imgui.SameLine(0,bigfont),imgui.BulletText("Bullet text"),imgui.AlignTextToFramePadding(),imgui.BulletText("Node"),imgui.SameLine(0,bigfont),imgui.Button("Button##4"),imgui.TreePop()}if(imgui.TreeNode("Scrolling")){imgui.Tooltip("Use SetScrollHereY() or SetScrollFromPosY() to scroll to a given position."),null==this.S_track&&(this.S_track=!0,this.S_track_line=50,this.S_scroll_to_px=200),imgui.Checkbox("Track",this.S_track)&&(this.S_track^=1),imgui.PushItemWidth(100),imgui.SameLine(130),this.S_track|=imgui.DragInt("##line",this.S_track_line,.25,0,99,"Line = %d",newval=>this.S_track_line=newval);var scroll_to=imgui.Button("Scroll To Pos");imgui.SameLine(130),scroll_to|=imgui.DragInt("##pos_y",this.S_scroll_to_px,1,0,9999,"Y = %d px",newval=>this.S_scroll_to_px=newval),imgui.PopItemWidth(),scroll_to&&(this.S_track=!1);for(let i=0;i<5;i++){0<i&&imgui.SameLine(),imgui.BeginGroup(),imgui.Text("%s",["Top","25%","Center","75%","Bottom"][i]),imgui.BeginChild(`chd${i}`,new Vec2(.17*imgui.GetWindowWidth(),200),!0),scroll_to&&imgui.SetScrollFromPosY(imgui.GetCursorStartPos().y+this.S_scroll_to_px,.25*i);for(let line=0;line<100;line++)this.S_track&&line==this.S_track_line?(imgui.TextColored(Colors.yellow,"Line %d",line),imgui.SetScrollHereY(.25*i)):imgui.Text("Line %d",line);var scroll_y=imgui.GetScrollY(),scroll_max_y=imgui.GetScrollMaxY();imgui.EndChild(),imgui.Text("%d/%d",scroll_y,scroll_max_y),imgui.EndGroup()}imgui.TreePop()}if(imgui.TreeNode("Horizontal Scrolling")){imgui.Tooltip("Horizontal scrolling for a window has to be enabled explicitly via the WindowFlags.HorizontalScrollbar flag.\n\nYou may want to explicitly specify content width by calling SetNextWindowContentWidth() before Begin()."),null==this.H_lines&&(this.H_lines=7),imgui.SliderInt("Lines",this.H_lines,1,15,null,newval=>this.H_lines=newval),imgui.PushStyleVar("FrameRounding",3),imgui.PushStyleVar("FramePadding",new Vec2(2,1)),imgui.BeginChild("scrolling",new Vec2(0,7*imgui.GetFrameHeightWithSpacing()+30),!0,WindowFlags.HorizontalScrollbar);for(let line=0;line<this.H_lines;line++){var num_buttons=10+(1&line?9*line:3*line);for(let n=0;n<num_buttons;n++){0<n&&imgui.SameLine(),imgui.PushID("b"+(n+1e3*line));var label=n%15?n%3?n%5?n.toString():"Buzz":"Fizz":"FizzBuzz",w=.05*n;imgui.PushStyleColor("Button",Color.hsv(w,.6,.6)),imgui.PushStyleColor("ButtonHovered",Color.hsv(w,.7,.7)),imgui.PushStyleColor("ButtonActive",Color.hsv(w,.8,.8));w=40+20*Math.sin(line+n);imgui.Button(label,new Vec2(w,0)),imgui.PopStyleColor(3),imgui.PopID()}}var pos=imgui.GetScrollX(),clip_rect=imgui.GetScrollMaxX();imgui.EndChild(),imgui.PopStyleVar(2);let scroll_x_delta=0;imgui.SmallButton("<<"),imgui.IsItemActive()&&(scroll_x_delta=1e3*-imgui.GetIO().DeltaTime),imgui.SameLine(),imgui.Text("Scroll from code"),imgui.SameLine(),imgui.SmallButton(">>"),imgui.IsItemActive()&&(scroll_x_delta=1e3*+imgui.GetIO().DeltaTime),imgui.SameLine(),imgui.Text("%d/%d",pos,clip_rect),0!=scroll_x_delta&&(imgui.BeginChild("scrolling"),imgui.SetScrollX(imgui.GetScrollX()+scroll_x_delta),imgui.EndChild()),imgui.TreePop()}if(imgui.TreeNode("Clipping")){let dl=imgui.GetWindowDrawList();var bg=Colors.gray,fg=Colors.white,bigfont=imgui.GetFont(null,2);null==this.C_size&&(this.C_size=new Vec2(100,100),this.C_offset=new Vec2(50,20)),imgui.TextWrapped("On a per-widget basis we are occasionally clipping text CPU-side if it won't fit in its frame. Otherwise we are doing coarser clipping + passing a scissor rectangle to the renderer. The system is designed to try minimizing both execution and CPU/GPU rendering cost."),imgui.DragVec2("size",this.C_size,.5,1,200,"%d"),imgui.TextWrapped("(Click and drag)");pos=imgui.GetCursorScreenPos(),clip_rect=new Rect(pos.x,pos.y,pos.x+this.C_size.x,pos.y+this.C_size.y);imgui.InvisibleButton("##dummy",this.C_size),imgui.IsItemActive()&&imgui.IsMouseDragging()&&(this.C_offset.x+=imgui.GetIO().MouseDelta.x,this.C_offset.y+=imgui.GetIO().MouseDelta.y),dl.AddRectFilled(pos,new Vec2(pos.x+this.C_size.x,pos.y+this.C_size.y),bg),dl.AddText("Line 1 hello\nLine 2 clip me!",new Vec2(pos.x+this.C_offset.x,pos.y+this.C_offset.y),bigfont,2*imgui.GetLineHeight(),fg,0,clip_rect),imgui.TreePop()}}}}class DemoWidgets{constructor(imgui){this.imgui=imgui,this.clicked=0,this.check=!0,this.e=0,this.counter=0,this.arr=[.6,.1,1,.5,.92,.1,.2],this.items=["AAAA","BBBB","CCCC","DDDD","EEEE","FFFF","GGGG","HHHH","IIII","JJJJ","KKKK","LLLLLLL","MMMM","OOOOOOO"],this.item_current=0,this.str0=new MutableString("Hello, world!"),this.str1=new MutableString(""),this.i0=123,this.i1=50,this.i2=42,this.i3=0,this.f0=.001,this.f1=1e10,this.f2=1,this.f3=.0067,this.f4=.123,this.f5=0,this.d0=999999.00000001,this.vec4a=[.1,.2,.3,.44],this.angle=0,this.col1=Color.rgb(1,0,.2),this.col2=Color.rgb(.4,.7,0,.5),this.listbox_items=["Apple","Banana","Cherry","Kiwi","Mango","Orange","Pineapple","Strawberry","Watermelon"],this.listbox_item_current=1,this.align_label_with_current_x_position=!1,this.selection_mask=4,this.node_clicked=-1,this.plot_animate=!1,this.plot_arr=[.6,.1,1,.5,.92,.1,.2]}Show(){let imgui=this.imgui;if(imgui.CollapsingHeader("Widgets")){if(imgui.TreeNode("Basic")){imgui.Button("Button")&&this.clicked++,1&this.clicked&&(imgui.SameLine(),imgui.Text("Thanks for clicking me!")),imgui.Checkbox("checkbox",this.check)&&(this.check=!this.check),imgui.RadioButton("radio a",0==this.e)&&(this.e=0),imgui.SameLine(),imgui.RadioButton("radio b",1==this.e)&&(this.e=1),imgui.SameLine(),imgui.RadioButton("radio c",2==this.e)&&(this.e=2);for(let i=0;i<7;i++)0<i&&imgui.SameLine(),imgui.PushID(i),imgui.PushStyleColor("Button",Color.hsv(i/7,.6,.6)),imgui.PushStyleColor("ButtonHovered",Color.hsv(i/7,.7,.7)),imgui.PushStyleColor("ButtonActive",Color.hsv(i/7,.8,.8)),imgui.Button("Click"),imgui.PopStyleColor(3),imgui.PopID();imgui.AlignTextToFramePadding(),imgui.Text("Hold to repeat:"),imgui.SameLine();var imgSz=imgui.GetStyle().ItemInnerSpacing.x;imgui.PushButtonRepeat(!0),imgui.ArrowButton("##left",Dir.Left)&&this.counter--,imgui.SameLine(0,imgSz),imgui.ArrowButton("##right",Dir.Right)&&this.counter++,imgui.PopButtonRepeat(),imgui.SameLine(),imgui.Text("%d",this.counter),imgui.Text("Hover over me"),imgui.IsItemHovered()&&imgui.SetTooltip("I am a tooltip"),imgui.SameLine(),imgui.Text("- or me"),imgui.IsItemHovered()&&(imgui.BeginTooltip(),imgui.Text("I am a fancy tooltip"),imgui.PlotLines("Curve",this.arr),imgui.EndTooltip()),imgui.Separator(),imgui.LabelText("label","Value"),imgui.Combo("combo",this.item_current,this.items,-1,newval=>this.item_current=newval),imgui.SameLine(),imgui.Tooltip('Refer to the "Combo" section below for an explanation of the full BeginCombo/EndCombo API, and demonstration of various flags.\n'),imgui.InputText("input text",this.str0),imgui.SameLine(),imgui.Tooltip("USER:\nHold SHIFT or use mouse to select text.\nCTRL+Left/Right to word jump.\nCTRL+A or double-click to select all.\nCTRL+X,CTRL+C,CTRL+V clipboard.\nCTRL+Z,CTRL+Y undo/redo.\nESCAPE to revert.\n\nPROGRAMMER:\nYou can use the InputTextFlags.CallbackResize facility if you need to wire InputText() to a dynamic string type. See misc/cpp/imgui_stdlib.h for an example (this is not demonstrated in imgui_demo.cpp)."),imgui.InputTextWithHint("input text (w/ hint)","enter text here",this.str1),imgui.InputInt("input int",this.i0,1,100,0,newval=>this.i0=newval),imgui.SameLine(),imgui.Tooltip("You can apply arithmetic operators +,*,/ on numerical values.\n  e.g. [ 100 ], input '*2', result becomes [ 200 ]\nUse +- to subtract.\n"),imgui.InputFloat("input float",this.f0,.01,1,"%.3f",0,newval=>this.f0=newval),imgui.InputDouble("input double",this.d0,.01,1,"%.8f",0,newval=>this.d0=newval),imgui.InputFloat("input scientific",this.f1,0,0,"%e",0,newval=>this.f1=newval),imgui.SameLine(),imgui.Tooltip('You can input value using the scientific notation,\n  e.g. "1e+8" becomes "100000000".\n'),imgui.InputFloat3("input float3",this.vec4a),imgui.DragInt("drag int",this.i1,1,0,0,"%d",newval=>this.i1=newval),imgui.SameLine(),imgui.Tooltip("Click and drag to edit value.\nHold SHIFT/ALT for faster/slower edit.\nDouble-click or CTRL+click to input value."),imgui.DragInt("drag int 0..100",this.i2,1,0,100,"%d%",newval=>this.i2=newval),imgui.DragFloat("drag float",this.f2,.005,0,0,"%.3f",1,newval=>this.f2=newval),imgui.DragFloat("drag small float",this.f3,1e-4,0,0,"%.6f ns",1,newval=>this.f3=newval),imgui.SliderInt("slider int",this.i3,-1,3,null,newval=>this.i3=newval),imgui.SameLine(),imgui.Tooltip("CTRL+click to input value."),imgui.SliderFloat("slider float",this.f4,0,1,"ratio = %.3f",1,newval=>this.f4=newval),imgui.SliderFloat("slider float (curve)",this.f5,-10,10,"%.4f",2,newval=>this.f5=newval),imgui.SliderAngle("slider angle",this.angle,-360,360,"%d deg",newval=>this.angle=newval),imgui.ColorEdit3("color 1",this.col1),imgui.SameLine(),imgui.Tooltip("Click on the colored square to open a color picker.\nClick and hold to use drag and drop.\nRight-click on the colored square to show options.\nCTRL+click on individual component to input value.\n"),imgui.ColorEdit4("color 2",this.col2),imgui.ListBox("listbox\n(single select)",this.listbox_item_current,this.listbox_items,4,newsel=>this.listbox_item_current=newsel),imgui.TreePop()}if(imgui.TreeNode("Trees")){if(imgui.TreeNode("Basic trees")){for(let i=0;i<5;i++)imgui.TreeNode("Child "+i)&&(imgui.Text("blah blah"),imgui.SameLine(),imgui.SmallButton("button"),imgui.TreePop());imgui.TreePop()}if(imgui.TreeNode("Advanced, with Selectable nodes")){imgui.Tooltip("This is a more typical looking tree with selectable nodes.\nClick to select, CTRL+Click to toggle, click on arrows or double-click to open."),imgui.Checkbox("Align label with current X position)",this.align_label_with_current_x_position)&&(this.align_label_with_current_x_position=!this.align_label_with_current_x_position),imgui.Text("Hello!"),this.align_label_with_current_x_position&&imgui.Unindent(imgui.GetTreeNodeToLabelSpacing()),imgui.PushStyleVar("IndentSpacing",3*imgui.GetFontSize());for(let i=0;i<6;i++){let node_flags=TreeNodeFlags.OpenOnArrow|TreeNodeFlags.OpenOnDoubleClick;var node_open;this.selection_mask&1<<i&&(node_flags|=TreeNodeFlags.Selected),i<3?(node_open=imgui.TreeNodeEx("Selectable Node "+i,node_flags),imgui.IsItemClicked()&&(this.node_clicked=i),node_open&&(imgui.Text("Blah blah\nBlah Blah"),imgui.TreePop())):(node_flags|=TreeNodeFlags.Leaf|TreeNodeFlags.NoTreePushOnOpen,imgui.TreeNodeEx("Selectable Leaf "+i,node_flags),imgui.IsItemClicked()&&(this.node_clicked=i))}-1!=this.node_clicked&&(imgui.GetIO().KeyCtrl?this.selection_mask^=1<<this.node_clicked:this.selection_mask=1<<this.node_clicked),imgui.PopStyleVar(),this.align_label_with_current_x_position&&imgui.Indent(imgui.GetTreeNodeToLabelSpacing()),imgui.TreePop()}imgui.TreePop()}if(imgui.TreeNode("Collapsing Headers")){if(null==this.closable_group&&(this.closable_group=new ValRef(!0)),imgui.Checkbox("Show 2nd header",this.closable_group.get())&&this.closable_group.toggle(),imgui.CollapsingHeader("Header")){imgui.Text("IsItemHovered: %s",imgui.IsItemHovered());for(let i=0;i<5;i++)imgui.Text("Some content %d",i)}if(imgui.CollapsingHeaderO("Header with a close button",this.closable_group)){imgui.Text("IsItemHovered: %s",imgui.IsItemHovered());for(let i=0;i<5;i++)imgui.Text("More content %d",i)}imgui.TreePop()}var x,y;if(imgui.TreeNode("Bullets")&&(imgui.BulletText("Bullet point 1"),imgui.BulletText("Bullet point 2\nOn multiple lines"),imgui.Bullet(),imgui.Text("Bullet point 3 (two calls)"),imgui.Bullet(),imgui.SmallButton("Button"),imgui.TreePop()),imgui.TreeNode("Text")&&(imgui.TreeNode("Colored Text")&&(imgui.TextColored(Color.rgba(1,0,1,1),"Pink"),imgui.TextColored(Color.rgba(1,1,0,1),"Yellow"),imgui.TextDisabled("Disabled"),imgui.SameLine(),imgui.Tooltip("The TextDisabled color is stored in ImGuiStyle."),imgui.TreePop()),imgui.TreeNode("Word Wrapping")&&(imgui.TextWrapped("This text should automatically wrap on the edge of the window. The current implementation for text wrapping follows simple rules suitable for English and possibly other languages."),imgui.Spacing(),null==this.wrap_width&&(this.wrap_width=200),imgui.SliderFloat("Wrap width",this.wrap_width,-20,600,"%d",1,newval=>this.wrap_width=newval),imgui.Text("Test paragraph 1:"),region_x=imgui.GetCursorScreenPos(),imgui.GetWindowDrawList().AddRectFilled(new Vec2(region_x.x+this.wrap_width,region_x.y),new Vec2(region_x.x+this.wrap_width+10,region_x.y+imgui.GetTextLineHeight()),Color.rgba(1,0,1,1)),imgui.PushTextWrapPos(imgui.GetCursorPos().x+this.wrap_width),imgui.Text("The lazy dog is a good dog. This paragraph is made to fit within %d pixels. Testing a 1 character word. The quick brown fox jumps over the lazy dog.",this.wrap_width),imgui.GetWindowDrawList().AddRect(imgui.GetItemRectMin(),imgui.GetItemRectMax(),Color.rgba(1,1,0,1)),imgui.PopTextWrapPos(),imgui.Text("Test paragraph 2:"),region_x=imgui.GetCursorScreenPos(),imgui.GetWindowDrawList().AddRectFilled(new Vec2(region_x.x+this.wrap_width,region_x.y),new Vec2(region_x.x+this.wrap_width+10,region_x.y+imgui.GetTextLineHeight()),Color.rgba(1,0,1,1)),imgui.PushTextWrapPos(imgui.GetCursorPos().x+this.wrap_width),imgui.Text("aaaaaaaa bbbbbbbb, c cccccccc,dddddddd. d eeeeeeee   ffffffff. gggggggg!hhhhhhhh"),imgui.GetWindowDrawList().AddRect(imgui.GetItemRectMin(),imgui.GetItemRectMax(),Color.rgba(1,1,0,1)),imgui.PopTextWrapPos(),imgui.TreePop()),imgui.TreeNode("Unicode Text")&&(imgui.Tooltip("Japanese characters must be present in selected font"),imgui.Text("Hiragana: "+String.fromCharCode.apply(null,[12363,12365,12367,12369,12371])+" (kakikukeko)"),imgui.Text("Kanjis: "+String.fromCharCode.apply(null,[20239,20656,21248,22240])+" (random)"),imgui.TreePop()),imgui.TreePop()),imgui.TreeNode("Images")){var region_x,uv0=imgui.GetIO(),url="/img/imgui-njs/logo.png",imgSz=new Vec2(200,100);imgui.Text("Display Size: %d,%d",imgSz.x,imgSz.y);let pos=imgui.GetCursorScreenPos();imgui.Image(url,imgSz,null,null,null,Color.rgba(.3,.8,1,.5)),imgui.IsItemHovered()&&(imgui.BeginTooltip(),region_x=uv0.MousePos.x-pos.x-16,region_x=Vec1.Clamp(region_x,0,imgSz.x-32),getter=uv0.MousePos.y-pos.y-16,getter=Vec1.Clamp(getter,0,imgSz.y-32),imgui.Text("Min: (%3d, %3d)",region_x,getter),imgui.Text("Max: (%3d, %3d)",region_x+32,getter+32),uv0=new Vec2(region_x/imgSz.x,getter/imgSz.y),getter=new Vec2((region_x+32)/imgSz.x,(getter+32)/imgSz.y),imgui.Image(url,new Vec2(128,128),uv0,getter,null,Color.rgba(1,1,1,.5)),imgui.EndTooltip()),imgui.TextWrapped("And now some textured buttons.."),null==this.imgPressCount&&(this.imgPressCount=0);var bsize=new Vec2(64,32);for(let i=0;i<8;i++){imgui.PushID(i);var frame_padding=-1+i;imgui.ImageButton(url,bsize,null,null,frame_padding,Color.rgba(0,0,0,1))&&this.imgPressCount++,imgui.PopID(),imgui.SameLine()}imgui.NewLine(),imgui.Text("Pressed %d times.",this.imgPressCount),imgui.TreePop()}if(imgui.TreeNode("Combo")){if(null==this.comboflags&&(this.comboflags=0),imgui.CheckboxFlags("ComboFlags.PopupAlignLeft",this.comboflags,ComboFlags.PopupAlignLeft,newval=>this.comboflags=newval),imgui.SameLine(),imgui.Tooltip("Only makes a difference if the popup is larger than the combo"),imgui.CheckboxFlags("ComboFlags.NoArrowButton",this.comboflags,ComboFlags.NoArrowButton,newval=>{this.comboflags=newval&~ComboFlags.NoPreview}),imgui.CheckboxFlags("ComboFlags.NoPreview",this.comboflags,ComboFlags.NoPreview,newval=>{this.comboflags=newval&=~ComboFlags.NoArrowButton}),null==this.item_current_1&&(this.item_current_1=""),imgui.BeginCombo("combo 1",this.item_current_1,this.comboflags)){for(let n=0;n<this.items.length;n++){var is_selected=this.item_current_1==this.items[n];imgui.Selectable(this.items[n],is_selected)&&(this.item_current_1=this.items[n]),is_selected&&imgui.SetItemDefaultFocus()}imgui.EndCombo()}null==this.item_current_2&&(this.item_current_2=0),imgui.Combo("combo 2 (one-liner)",this.item_current_2,["aaaa","bbbb","cccc","dddd","eeee"],-1,newval=>this.item_current_2=newval),null==this.item_current_3&&(this.item_current_3=-1),imgui.Combo("combo 3 (array)",this.item_current_3,this.items,-1,newval=>this.item_current_3=newval),null==this.item_current_4&&(this.item_current_4=0);var getter=function(i){return this.items[i]}.bind(this);imgui.ComboCB("combo 4 (function)",this.item_current_4,getter,this.items.length,-1,newval=>this.item_current_4=newval),imgui.TreePop()}if(imgui.TreeNode("Selectables")){if(null==this.S_selection&&(this.S_selection=[!1,!0,!1,!1,!1],this.S_selected=-1,this.S_mselection=[!1,!1,!1,!1,!1],this.S_selected2=[!1,!1,!1],this.S_selected3=[],this.S_selected3.length=16,this.S_selected3.fill(0),this.S_selected4=[!0,!1,!1,!1,!1,!0,!1,!1,!1,!1,!0,!1,!1,!1,!1,!0],this.S_selected5=[!0,!1,!0,!1,!0,!1,!0,!1,!0]),imgui.TreeNode("Basic")&&(imgui.Selectable("1. I am selectable",this.S_selection[0])&&(this.S_selection[0]=!this.S_selection[0]),imgui.Selectable("2. I am selectable",this.S_selection[1])&&(this.S_selection[1]=!this.S_selection[1]),imgui.Text("3. I am not selectable"),imgui.Selectable("4. I am selectable",this.S_selection[3])&&(this.S_selection[3]=!this.S_selection[3]),imgui.Selectable("5. I am double clickable",this.S_selection[4],SelectableFlags.AllowDoubleClick)&&imgui.IsMouseDoubleClicked(0)&&(this.S_selection[4]=!this.S_selection[4]),imgui.TreePop()),imgui.TreeNode("Selection State: Single Selection")){for(let n=0;n<5;n++)imgui.Selectable("Object "+n,this.S_selected==n)&&(this.S_selected=n);imgui.TreePop()}if(imgui.TreeNode("Selection State: Multiple Selection")){imgui.Tooltip("Hold CTRL and click to select multiple items.");for(let n=0;n<5;n++)imgui.Selectable("Object "+n,this.S_mselection[n])&&(imgui.GetIO().KeyCtrl||this.S_mselection.fill(!1),this.S_mselection[n]^=1);imgui.TreePop()}if(imgui.TreeNode("Rendering more text into the same line")&&(imgui.Selectable("main.c",this.S_selected2[0])&&(this.S_selected2[0]^=1),imgui.SameLine(300),imgui.Text(" 2,345 bytes"),imgui.Selectable("Hello.cpp",this.S_selected2[1])&&(this.S_selected2[1]^=1),imgui.SameLine(300),imgui.Text("12,345 bytes"),imgui.Selectable("Hello.h",this.S_selected2[2])&&(this.S_selected2[2]^=1),imgui.SameLine(300),imgui.Text(" 2,345 bytes"),imgui.TreePop()),imgui.TreeNode("In columns")){imgui.Columns(3,null,!1);for(let i=0;i<this.S_selected3.length;i++)imgui.Selectable("Item "+i,this.S_selected3[i])&&(this.S_selected3[i]^=1),imgui.NextColumn();imgui.Columns(1),imgui.TreePop()}if(imgui.TreeNode("Grid")){for(let i=0;i<this.S_selected4.length;i++)imgui.PushID(i),imgui.Selectable("Sailor",this.S_selected4[i],0,new Vec2(50,50))&&(x=i%4,y=i/4,0<x&&(this.S_selected4[i-1]^=1),x<3&&i<15&&(this.S_selected4[i+1]^=1),0<y&&3<i&&(this.S_selected4[i-4]^=1),y<3&&i<12&&(this.S_selected4[i+4]^=1)),i%4<3&&imgui.SameLine(),imgui.PopID();imgui.TreePop()}if(imgui.TreeNode("Alignment")){var sz=new Vec2(80,80);imgui.Tooltip("Alignment applies when a selectable is larger than its text content.\nBy default, Selectables uses style.SelectableTextAlign but it can be overriden on a per-item basis using PushStyleVar().");for(let y=0;y<3;y++)for(let x=0;x<3;x++){0<x&&imgui.SameLine();let alignment=new Vec2(x/2,y/2);var name=`(${alignment.x.toFixed(1)},${alignment.y.toFixed(1)})`;imgui.PushStyleVar("SelectableTextAlign",alignment);var j=3*y+x;imgui.Selectable(name,this.S_selected5[j],SelectableFlags.None,sz)&&(this.S_selected5[j]^=1),imgui.PopStyleVar()}imgui.TreePop()}imgui.TreePop()}if(imgui.TreeNode("Text Input")&&(imgui.TreeNode("Multi-line Text Input")&&(null==this.T_text&&(this.T_text=new MutableString("**\nThe Pentium F00F bug, shorthand for F0 0F C7 C8,\nthe hexadecimal encoding of one offending instruction,\nmore formally, the invalid operand with locked CMPXCHG8B\ninstruction bug, is a design flaw in the majority of\nIntel Pentium, Pentium MMX, and Pentium OverDrive\nprocessors (all in the P5 microarchitecture).\n**\n\nlabel:\n\tlock cmpxchg8b eax\n"),this.T_flags=InputTextFlags.AllowTabInput),imgui.Tooltip("You can use the InputTextFlags.CallbackResize facility if you need to wire InputTextMultiline() to a dynamic string type. See misc/cpp/imgui_stdlib.h for an example. (This is not demonstrated in imgui_demo.cpp)"),imgui.CheckboxFlags("InputTextFlags.ReadOnly",this.T_flags,InputTextFlags.ReadOnly,newval=>this.T_flags=newval),imgui.CheckboxFlags("InputTextFlags.AllowTabInput",this.T_flags,InputTextFlags.AllowTabInput,newval=>this.T_flags=newval),imgui.CheckboxFlags("InputTextFlags.CtrlEnterForNewLine",this.T_flags,InputTextFlags.CtrlEnterForNewLine,newval=>this.T_flags=newval),imgui.InputTextMultiline("##source",this.T_text,new Vec2(-1,16*imgui.GetTextLineHeight()),this.T_flags),imgui.TreePop()),imgui.TreeNode("Filtered Text Input")&&(this.FT_buf1||(this.FT_buf1=new MutableString(""),this.FT_buf2=new MutableString(""),this.FT_buf3=new MutableString(""),this.FT_buf4=new MutableString(""),this.FT_buf5=new MutableString(""),this.FT_buf6=new MutableString(""),this.FT_customFilter=function(filterCtx){return/[imgui]/.test(filterCtx.EventChar)?0:1}),imgui.InputText("default",this.FT_buf1),imgui.InputText("decimal",this.FT_buf2,InputTextFlags.CharsDecimal),imgui.InputText("hexadecimal",this.FT_buf3,InputTextFlags.CharsHexadecimal|InputTextFlags.CharsUppercase),imgui.InputText("uppercase",this.FT_buf4,InputTextFlags.CharsUppercase),imgui.InputText("no blank",this.FT_buf5,InputTextFlags.CharsNoBlank),imgui.InputText('"imgui" letters',this.FT_buf6,InputTextFlags.CallbackCharFilter,this.FT_customFilter),imgui.TreePop()),imgui.TreeNode("Resize Callback")&&(imgui.Text("resizable strings probably not useful in javascript?"),imgui.TreePop()),imgui.TreePop()),imgui.TreeNode("Plots Widgets")){if(imgui.Checkbox("Animate",this.plot_animate)&&(this.plot_animate=!this.plot_animate),imgui.PlotLines("Frame Times",this.plot_arr),null==this.plot_values||this.plot_refresh_time<imgui.GetTime())for(null==this.plot_values&&(this.plot_values=[],this.plot_values.length=90,this.plot_values.fill(0),this.plot_values_offset=0,this.plot_refresh_time=0,this.plot_phase=0),this.plot_animate&&0!=this.plot_refresh_time||(this.plot_refresh_time=imgui.GetTime());this.plot_refresh_time<imgui.GetTime();)this.plot_values[this.plot_values_offset]=Math.cos(this.plot_phase),this.plot_values_offset=(this.plot_values_offset+1)%this.plot_values.length,this.plot_phase+=.1*this.plot_values_offset,this.plot_refresh_time+=1/60;let sz=new Vec2(0,80);imgui.PlotLines("Lines",this.plot_values,this.plot_values_offset,"avg 0.0",-1,1,sz),imgui.PlotHistogram("Histogram",this.plot_arr,0,null,0,1,sz),null==this.plot_func_type&&(this.plot_func_type=0,this.plot_display_count=70,this.plot_funcs=[function(i){return Math.sin(.1*i)},function(i){return 1&i?1:-1}]),imgui.Separator(),imgui.SetNextItemWidth(100),imgui.Combo("func",this.plot_func_type,["Sin","Saw"],-1,newval=>this.plot_func_type=newval),imgui.SameLine(),imgui.SliderInt("Sample count",this.plot_display_count,1,400,null,newval=>this.plot_display_count=newval);var open_popup=this.plot_funcs[this.plot_func_type];imgui.PlotLinesCB("Lines",open_popup,this.plot_display_count,0,null,-1,1,sz),imgui.PlotHistogramCB("Histogram",open_popup,this.plot_display_count,0,null,-1,1,sz),imgui.Separator(),null==this.plot_progress&&(this.plot_progress=0,this.plot_progress_dir=1),this.plot_animate&&(this.plot_progress+=.4*this.plot_progress_dir*imgui.GetIO().DeltaTime,1.1<=this.plot_progress&&(this.plot_progress=1.1,this.plot_progress_dir*=-1),this.plot_progress<=-.1&&(this.plot_progress=-.1,this.plot_progress_dir*=-1)),imgui.ProgressBar(this.plot_progress,Vec2.Zero()),imgui.SameLine(0,imgui.GetStyle().ItemInnerSpacing.x),imgui.Text("Progress Bar");var misc_flags=Vec1.Saturate(this.plot_progress),open_popup=`${Math.floor(1753*misc_flags)}/1753`;imgui.ProgressBar(this.plot_progress,Vec2.Zero(),open_popup),imgui.TreePop()}if(imgui.TreeNode("Color/Picker Widgets")){null==this.CP_color&&(this.CP_color=Color.rgba(114/255,144/255,154/255,200/255),this.CP_alpha_preview=!0,this.CP_alpha_half_preview=!1,this.CP_drag_and_drop=!0,this.CP_options_menu=!0,this.CP_hdr=!1),imgui.Checkbox("With Alpha Preview",this.CP_alpha_preview)&&(this.CP_alpha_preview^=1),imgui.Checkbox("With Half Alpha Preview",this.CP_alpha_half_preview)&&(this.CP_alpha_half_preview^=1),imgui.Checkbox("With Drag and Drop",this.CP_drag_and_drop)&&(this.CP_drag_and_drop^=1),imgui.Checkbox("With Options Menu",this.CP_options_menu)&&(this.CP_options_menu^=1),imgui.SameLine(),imgui.Tooltip("Right-click on the individual color widget to show options."),imgui.Checkbox("With HDR",this.CP_hdr)&&(this.CP_hdr^=1),imgui.SameLine(),imgui.Tooltip("Currently all this does is to lift the 0..1 limits on dragging widgets.");misc_flags=(this.CP_hdr?ColorEditFlags.HDR:0)|(this.CP_drag_and_drop?0:ColorEditFlags.NoDragDrop)|(this.CP_alpha_half_preview?ColorEditFlags.AlphaPreviewHalf:this.CP_alpha_preview?ColorEditFlags.AlphaPreview:0)|(this.CP_options_menu?0:ColorEditFlags.NoOptions);if(imgui.Text("Color widget:"),imgui.SameLine(),imgui.Tooltip("Click on the colored square to open a color picker.\nCTRL+click on individual component to input value.\n"),imgui.ColorEdit3("MyColor##1",this.CP_color,misc_flags),imgui.Text("Color widget HSV with Alpha:"),imgui.ColorEdit4("MyColor##2",this.CP_color,ColorEditFlags.DisplayHSV|misc_flags),imgui.Text("Color widget with Float Display:"),imgui.ColorEdit4("MyColor##2",this.CP_color,ColorEditFlags.Float|misc_flags),imgui.Text("Color button with Picker:"),imgui.SameLine(),imgui.Tooltip("With the ColorEditFlags.NoInputs flag you can hide all the slider/text inputs.\nWith the ColorEditFlags.NoLabel flag you can pass a non-empty label which will only be used for the tooltip and picker popup."),imgui.ColorEdit4("MyColor##3",this.CP_color,ColorEditFlags.NoInputs|ColorEditFlags.NoLabel|misc_flags),imgui.Text("Color button with Custom Picker Popup:"),null==this.CP_saved_palette){this.CP_saved_palette=[],this.CP_saved_palette.length=32;for(let n=0;n<this.CP_saved_palette.length;n++)this.CP_saved_palette[n]=Color.hsv(n/31,.8,.8);this.CP_backup_color=Color.rgb(0,0,0)}var a,open_popup=imgui.ColorButton("MyColor##3b",this.CP_color,misc_flags);if(imgui.SameLine(),(open_popup|=imgui.Button("Palette"))&&(imgui.OpenPopup("mypicker"),this.CP_backup_color.Copy(this.CP_color)),imgui.BeginPopup("mypicker")){imgui.Text("MY CUSTOM COLOR PICKER WITH AN AMAZING PALETTE!"),imgui.Separator(),imgui.ColorPicker4("##picker",this.CP_color,misc_flags|ColorEditFlags.NoSidePreview|ColorEditFlags.NoSmallPreview),imgui.SameLine(),imgui.BeginGroup(),imgui.Text("Current"),imgui.ColorButton("##current",this.CP_color,ColorEditFlags.NoPicker|ColorEditFlags.AlphaPreviewHalf,new Vec2(60,40)),imgui.Text("Previous"),imgui.ColorButton("##previous",this.CP_backup_color,ColorEditFlags.NoPicker|ColorEditFlags.AlphaPreviewHalf,new Vec2(60,40))&&this.CP_color.Copy(this.CP_backup_color),imgui.Separator(),imgui.Text("Palette");for(let n=0;n<this.CP_saved_palette.length;n++)imgui.PushID(n),n%8!=0&&imgui.SameLine(0,imgui.GetStyle().ItemSpacing.y),imgui.ColorButton("##palette",this.CP_saved_palette[n],ColorEditFlags.NoAlpha|ColorEditFlags.NoPicker|ColorEditFlags.NoTooltip,new Vec2(20,20))&&(a=this.CP_color.a,this.CP_color.Copy(this.CP_saved_palette[n]),this.CP_color.a=a),imgui.BeginDragDropTarget()&&(console.log("begin dragdrop target"),imgui.EndDragDropTarget()),imgui.PopID();imgui.EndGroup(),imgui.EndPopup()}imgui.Text("Color button only:"),imgui.ColorButton("MyColor##3c",this.CP_color,misc_flags,new Vec2(80,80)),imgui.Text("Color picker:"),null==this.CP_alpha&&(this.CP_alpha=!0,this.CP_alpha_bar=!0,this.CP_side_preview=!0,this.CP_ref_color=!1,this.CP_ref_color_v=Color.rgba(1,0,1,.5),this.CP_display_mode=0,this.CP_picker_mode=0),imgui.Checkbox("With Alpha",this.CP_alpha)&&(this.CP_alpha^=1),imgui.Checkbox("With Alpha Bar",this.CP_alpha_bar)&&(this.CP_alpha_bar^=1),imgui.Checkbox("With Side Preview",this.CP_side_preview)&&(this.CP_side_preview^=1),this.CP_side_preview&&(imgui.SameLine(),imgui.Checkbox("With Ref Color",this.CP_ref_color)&&(this.CP_ref_color^=1),this.CP_ref_color&&(imgui.SameLine(),imgui.ColorEdit4("##RefColor",this.CP_ref_color_v,ColorEditFlags.NoInputs|misc_flags))),imgui.Combo("Display Mode",this.CP_display_mode,["Auto/Current","None","RGB Only","HSV Only","Hex Only"],newval=>this.CP_display_mode=newval),imgui.SameLine(),imgui.Tooltip("ColorEdit defaults to displaying RGB inputs if you don't specify a display mode, but the user can change it with a right-click.\n\nColorPicker defaults to displaying RGB+HSV+Hex if you don't specify a display mode.\n\nYou can change the defaults using SetColorEditOptions()."),imgui.Combo("Picker Mode",this.CP_picker_mode,["Auto/Current","Hue bar + SV rect","Hue wheel + SV triangle"],newval=>this.CP_picker_mode=newval),imgui.SameLine(),imgui.Tooltip("User can right-click the picker to change mode.");let flags=misc_flags;this.CP_alpha||(flags|=ColorEditFlags.NoAlpha),this.CP_alpha_bar&&(flags|=ColorEditFlags.AlphaBar),this.CP_side_preview||(flags|=ColorEditFlags.NoSidePreview),1==this.CP_picker_mode&&(flags|=ColorEditFlags.PickerHueBar),2==this.CP_picker_mode&&(flags|=ColorEditFlags.PickerHueWheel),1==this.CP_display_mode&&(flags|=ColorEditFlags.NoInputs),2==this.CP_display_mode&&(flags|=ColorEditFlags.DisplayRGB),3==this.CP_display_mode&&(flags|=ColorEditFlags.DisplayHSV),4==this.CP_display_mode&&(flags|=ColorEditFlags.DisplayHex),imgui.ColorPicker4("MyColor##4",this.CP_color,flags,this.CP_ref_color?this.CP_ref_color_v:null),imgui.Text("Programmatically set defaults:"),imgui.SameLine(),imgui.Tooltip("SetColorEditOptions() is designed to allow you to set boot-time default.\nWe don't have Push/Pop functions because you can force options on a per-widget basis if needed, and the user can change non-forced ones with the options menu.\nWe don't have a getter to avoid encouraging you to persistently save values that aren't forward-compatible."),imgui.Button("Default: Uint8 + HSV + Hue Bar")&&imgui.SetColorEditOptions(ColorEditFlags.Uint8|ColorEditFlags.DisplayHSV|ColorEditFlags.PickerHueBar),imgui.Button("Default: Float + HDR + Hue Wheel")&&imgui.SetColorEditOptions(ColorEditFlags.Float|ColorEditFlags.HDR|ColorEditFlags.PickerHueWheel),null==this.CP_color_stored_as_hsv&&(this.CP_color_stored_as_hsv=Color.rgba(.23,1,1,1)),imgui.Spacing(),imgui.Text("HSV encoded colors"),imgui.SameLine(),imgui.Tooltip("By default, colors are given to ColorEdit and ColorPicker in RGB, but ColorEditFlags.InputHSV allows you to store colors as HSV and pass them to ColorEdit and ColorPicker as HSV. This comes with the added benefit that you can manipulate hue values with the picker even when saturation or value are zero."),imgui.Text("Color widget with InputHSV:"),imgui.ColorEdit4("HSV shown as HSV##1",this.CP_color_stored_as_hsv,ColorEditFlags.DisplayRGB|ColorEditFlags.InputHSV|ColorEditFlags.Float),imgui.ColorEdit4("HSV shown as RGB##1",this.CP_color_stored_as_hsv,ColorEditFlags.DisplayHSV|ColorEditFlags.InputHSV|ColorEditFlags.Float),imgui.DragFloat4("Raw HSV values",this.CP_color_stored_as_hsv,.01,0,1),imgui.TreePop()}if(imgui.TreeNode("Range Widgets")&&(null==this.RW_begin&&(this.RW_begin=10,this.RW_end=90,this.RW_begin_i=100,this.RW_end_i=1e3),imgui.DragFloatRange2("range",this.RW_begin,this.RW_end,.25,0,100,"Min: %.1f %","Max: %.1f %",1,(min,max)=>{this.RW_begin=min,this.RW_end=max}),imgui.DragIntRange2("range int (no bounds)",this.RW_begin_i,this.RW_end_i,5,0,0,"Min: %d units","Max: %d units",(min,max)=>{this.RW_begin_i=min,this.RW_end_i=max}),imgui.TreePop()),imgui.TreeNode("Data Types")&&(imgui.Text("javascript only has one number type"),imgui.TreePop()),imgui.TreeNode("Multi-component Widgets")&&(null==this.MC_vec4&&(this.MC_vec4=[.1,.2,.3,.44],this.MC_vec4i=[1,5,100,255]),imgui.Text("warning: more work needed here"),imgui.InputFloat2("input float2",this.MC_vec4),imgui.DragFloat2("drag float2",this.MC_vec4,.01,0,1),imgui.SliderFloat2("slider float2",this.MC_vec4,0,1),imgui.InputInt2("input int2",this.MC_vec4i),imgui.DragInt2("drag int2",this.MC_vec4i,1,0,255),imgui.SliderInt2("slider int2",this.MC_vec4i,0,255),imgui.Spacing(),imgui.InputFloat3("input float3",this.MC_vec4),imgui.DragFloat3("drag float3",this.MC_vec4,.01,0,1),imgui.SliderFloat3("slider float3",this.MC_vec4,0,1),imgui.InputInt3("input int3",this.MC_vec4i),imgui.DragInt3("drag int3",this.MC_vec4i,1,0,255),imgui.SliderInt3("slider int3",this.MC_vec4i,0,255),imgui.Spacing(),imgui.InputFloat4("input float4",this.MC_vec4),imgui.DragFloat4("drag float4",this.MC_vec4,.01,0,1),imgui.SliderFloat4("slider float4",this.MC_vec4,0,1),imgui.InputInt4("input int4",this.MC_vec4i),imgui.DragInt4("drag int4",this.MC_vec4i,1,0,255),imgui.SliderInt4("slider int4",this.MC_vec4i,0,255),imgui.TreePop()),imgui.TreeNode("Vertical Sliders")){null==this.VS_spacing&&(this.VS_spacing=4,this.VS_int_value=0,this.VS_values=[0,.6,.35,.9,.7,.2,.5],this.VS_values2=[.2,.8,.4,.25],this.VS_rows=3),imgui.PushStyleVar("ItemSpacing",new Vec2(this.VS_spacing,this.VS_spacing)),imgui.VSliderInt("##int",new Vec2(18,160),this.VS_int_value,0,5,null,newval=>this.VS_int_value=newval),imgui.SameLine();for(let i=0;i<7;i++)0<i&&imgui.SameLine(),imgui.PushID("set1"+i),imgui.PushStyleColor("FrameBg",Color.hsv(i/7,.5,.5)),imgui.PushStyleColor("FrameBgHovered",Color.hsv(i/7,.6,.5)),imgui.PushStyleColor("FrameBgActive",Color.hsv(i/7,.7,.5)),imgui.PushStyleColor("SliderGrab",Color.hsv(i/7,.9,.9)),imgui.VSliderFloat("##v",new Vec2(18,160),this.VS_values[i],0,1,"",1,newval=>this.VS_values[i]=newval),(imgui.IsItemActive()||imgui.IsItemHovered())&&imgui.SetTooltip("%.3f",this.VS_values[i]),imgui.PopStyleColor(4),imgui.PopID();imgui.SameLine();var small_slider_size=new Vec2(18,(160-(this.VS_rows-1)*this.VS_spacing)/this.VS_rows);for(let nx=0;nx<4;nx++){0<nx&&imgui.SameLine(),imgui.BeginGroup();for(let ny=0;ny<this.VS_rows;ny++)imgui.PushID("set2_"+nx*this.VS_rows+ny),imgui.VSliderFloat("##v",small_slider_size,this.VS_values2[nx],0,1,"",1,newval=>this.VS_values2[nx]=newval),(imgui.IsItemActive()||imgui.IsItemHovered())&&imgui.SetTooltip("%.3f",this.VS_values2[nx]),imgui.PopID();imgui.EndGroup()}imgui.SameLine();for(let i=0;i<4;i++)0<i&&imgui.SameLine(),imgui.PushID("set3_"+i),imgui.PushStyleVar("GrabMinSize",40),imgui.VSliderFloat("##v",new Vec2(40,160),this.VS_values[i],0,1,"%.2f\nsec",1,newval=>this.VS_values[i]=newval),imgui.PopStyleVar(),imgui.PopID();imgui.PopStyleVar(),imgui.TreePop()}if(imgui.TreeNode("Drag and Drop")){null==this.DD_col1&&(this.DD_col1=Color.rgb(1,0,.2),this.DD_col2=Color.rgba(.4,.7,0,.5),this.DD_mode="copy",this.DD_names=["Bobby","Beatrice","Betty","Brianna","Barry","Bernard","Bibi","Blaine","Bryn"]),imgui.BulletText("Drag and drop in standard widgets"),imgui.Indent(),imgui.ColorEdit3("color 1",this.DD_col1),imgui.ColorEdit4("color 2",this.DD_col2),imgui.Unindent(),imgui.BulletText("Drag and drop to copy/swap items"),imgui.Indent(),imgui.RadioButton("Copy","copy"==this.DD_mode)&&(this.DD_mode="copy"),imgui.SameLine(),imgui.RadioButton("Move","move"==this.DD_mode)&&(this.DD_mode="move"),imgui.SameLine(),imgui.RadioButton("Swap","swap"==this.DD_mode)&&(this.DD_mode="swap");for(let n=0;n<this.DD_names.length;n++){if(imgui.PushID(n),n%3!=0&&imgui.SameLine(),imgui.Button(this.DD_names[n],new Vec2(60,60)),imgui.BeginDragDropSource(DragDropFlags.None)&&(imgui.SetDragDropPayload("DND_DEMO_CELL",n),imgui.Text(`${this.DD_mode} ${this.DD_names[n]}`),imgui.EndDragDropSource()),imgui.BeginDragDropTarget()){var payload=imgui.AcceptDragDropPayload("DND_DEMO_CELL");if(null!=payload){var payload_n=payload.Data;switch(this.DD_mode){case"copy":this.DD_names[n]=this.DD_names[payload_n];break;case"move":this.DD_names[n]=this.DD_names[payload_n],this.DD_names[payload_n]="";break;case"swap":var tmp=this.DD_names[n];this.DD_names[n]=this.DD_names[payload_n],this.DD_names[payload_n]=tmp}}imgui.EndDragDropTarget()}imgui.PopID()}imgui.Unindent(),imgui.TreePop()}if(imgui.TreeNode("Querying Status (Active/Focused/Hovered etc.)")){null==this.Q_item_type&&(this.Q_item_type=1,this.Q_b=!1,this.Q_col=Color.rgba(1,.2,.4,1),this.Q_mstr=new MutableString,this.Q_sel=0,this.Q_embed=!1,this.Q_testwin=new ValRef(!1)),imgui.RadioButton("Text ",0==this.Q_item_type)&&(this.Q_item_type=0),imgui.RadioButton("Button",1==this.Q_item_type)&&(this.Q_item_type=1),imgui.RadioButton("Checkbox",2==this.Q_item_type)&&(this.Q_item_type=2),imgui.RadioButton("SliderFloat",3==this.Q_item_type)&&(this.Q_item_type=3),imgui.RadioButton("InputText",4==this.Q_item_type)&&(this.Q_item_type=4),imgui.RadioButton("ColorEdit4",5==this.Q_item_type)&&(this.Q_item_type=5),imgui.RadioButton("MenuItem",6==this.Q_item_type)&&(this.Q_item_type=6),imgui.RadioButton("TreeNode (w/ double-click)",7==this.Q_item_type)&&(this.Q_item_type=7),imgui.RadioButton("ListBox",8==this.Q_item_type)&&(this.Q_item_type=8),imgui.Separator();let ret=!1;switch(this.Q_item_type){case 0:imgui.Text("ITEM: Text");break;case 1:ret=imgui.Button("ITEM: Button");break;case 2:ret=imgui.Checkbox("ITEM: Checkbox",this.Q_b);break;case 3:ret=imgui.SliderFloat("ITEM: SliderFloat",this.Q_col.x,0,1,"%.3f",1,newval=>this.Q_col.x=newval);break;case 4:ret=imgui.InputText("ITEM: InputText",this.Q_mstr);break;case 5:ret=imgui.ColorEdit4("ITEM: ColorEdit4",this.Q_col);break;case 6:ret=imgui.MenuItem("ITEM: MenuItem");break;case 7:ret=imgui.TreeNodeEx("ITEM: TreeNode w/ TreeNodeFlags.OpenOnDoubleClick",TreeNodeFlags.OpenOnDoubleClick|TreeNodeFlags.NoTreePushOnOpen);break;case 8:ret=imgui.ListBox("ITEM: ListBox",this.Q_sel,["Apple","Banana","Cherry","Kiwi"],-1,newval=>this.Q_sel=newval)}imgui.BulletText("Return value = %d\nIsItemFocused() = %d\nIsItemHovered() = %d\nIsItemHovered(_AllowWhenBlockedByPopup) = %d\nIsItemHovered(_AllowWhenBlockedByActiveItem) = %d\nIsItemHovered(_AllowWhenOverlapped) = %d\nIsItemHovered(_RectOnly) = %d\nIsItemActive() = %d\nIsItemEdited() = %d\nIsItemActivated() = %d\nIsItemDeactivated() = %d\nIsItemDeactivatedAfterEdit() = %d\nIsItemVisible() = %d\nIsItemClicked() = %d\nGetItemRectMin() = (%.1f, %.1f)\nGetItemRectMax() = (%.1f, %.1f)\nGetItemRectSize() = (%.1f, %.1f)",ret,imgui.IsItemFocused(),imgui.IsItemHovered(),imgui.IsItemHovered(HoveredFlags.AllowWhenBlockedByPopup),imgui.IsItemHovered(HoveredFlags.AllowWhenBlockedByActiveItem),imgui.IsItemHovered(HoveredFlags.AllowWhenOverlapped),imgui.IsItemHovered(HoveredFlags.RectOnly),imgui.IsItemActive(),imgui.IsItemEdited(),imgui.IsItemActivated(),imgui.IsItemDeactivated(),imgui.IsItemDeactivatedAfterEdit(),imgui.IsItemVisible(),imgui.IsItemClicked(),imgui.GetItemRectMin().x,imgui.GetItemRectMin().y,imgui.GetItemRectMax().x,imgui.GetItemRectMax().y,imgui.GetItemRectSize().x,imgui.GetItemRectSize().y),imgui.Checkbox("Embed everything inside a child window (for additional testing)",this.Q_embed)&&(this.Q_embed=!this.Q_embed),this.Q_embed&&imgui.BeginChild("outer_child",new Vec2(0,20*imgui.GetFontSize()),!0),imgui.BulletText("IsWindowFocused() = %d\nIsWindowFocused(ChildWindows) = %d\nIsWindowFocused(ChildWindows|_RootWindow) = %d\nIsWindowFocused(RootWindow) = %d\nIsWindowFocused(AnyWindow) = %d\n",imgui.IsWindowFocused(),imgui.IsWindowFocused(FocusedFlags.ChildWindows),imgui.IsWindowFocused(FocusedFlags.ChildWindows|FocusedFlags.RootWindow),imgui.IsWindowFocused(FocusedFlags.RootWindow),imgui.IsWindowFocused(FocusedFlags.AnyWindow)),imgui.BulletText("IsWindowHovered() = %d\nIsWindowHovered(AllowWhenBlockedByPopup) = %d\nIsWindowHovered(AllowWhenBlockedByActiveItem) = %d\nIsWindowHovered(ChildWindows) = %d\nIsWindowHovered(ChildWindows|RootWindow) = %d\nIsWindowHovered(ChildWindows|AllowWhenBlockedByPopup) = %d\nIsWindowHovered(RootWindow) = %d\nIsWindowHovered(AnyWindow) = %d\n",imgui.IsWindowHovered(),imgui.IsWindowHovered(HoveredFlags.AllowWhenBlockedByPopup),imgui.IsWindowHovered(HoveredFlags.AllowWhenBlockedByActiveItem),imgui.IsWindowHovered(HoveredFlags.ChildWindows),imgui.IsWindowHovered(HoveredFlags.ChildWindows|HoveredFlags.RootWindow),imgui.IsWindowHovered(HoveredFlags.ChildWindows|HoveredFlags.AllowWhenBlockedByPopup),imgui.IsWindowHovered(HoveredFlags.RootWindow),imgui.IsWindowHovered(HoveredFlags.AnyWindow)),imgui.BeginChild("child",new Vec2(0,50),!0),imgui.Text("This is another child window for testing the ChildWindows flag."),imgui.EndChild(),this.Q_embed&&imgui.EndChild(),imgui.Checkbox("Hovered/Active tests after Begin() for title bar testing",this.Q_testwin.get())&&this.Q_testwin.toggle(),this.Q_testwin.get()&&(imgui.Begin("Title bar Hovered/Active tests",this.Q_testwin),imgui.BeginPopupContextItem()&&(imgui.MenuItem("Close")&&this.Q_testwin.set(!1),imgui.EndPopup()),imgui.Text("IsItemHovered() after begin = %d (== is title bar hovered)\nIsItemActive() after begin = %d (== is window being clicked/moved)\n",imgui.IsItemHovered(),imgui.IsItemActive()),imgui.End()),imgui.TreePop()}}}}class StyleEditorWindow{constructor(imgui){this.styleEditor=null}Show(imgui,winname,isOpen){isOpen.get()&&(imgui.SetNextWindowPos(new Vec2(40,40),CondFlags.FirstUseEver),imgui.SetNextWindowSize(new Vec2(500,700),CondFlags.FirstUseEver),imgui.Begin(winname,isOpen,0)&&(this.styleEditor||(this.styleEditor=new StyleEditor(imgui)),this.styleEditor.Show()),imgui.End())}}class StyleEditor{constructor(imgui){this.imgui=imgui,this.colorTextFilter=new TextFilter(imgui),this.outputTarget=0,this.outputModifiedOnly=!1,this.colorAlphaFlags=0,this.refStyle=imgui.guictx.Style.Clone()}Show(){let imgui=this.imgui,style=imgui.GetStyle(),dirty=!1;imgui.PushItemWidth(.5*imgui.GetWindowWidth()),this.showStyleSelector("Colors##Selector")&&(this.refStyle=style.Clone());let ref=this.refStyle;imgui.SliderFloat("FrameRounding",style.FrameRounding,0,12,"%.0f",1,v=>style.FrameRounding=v)&&(style.GrabRounding=style.FrameRounding,dirty=!0);var popup_border=0<style.WindowBorderSize;imgui.Checkbox("WindowBorder",popup_border)&&(style.WindowBorderSize=popup_border?0:1,dirty=!0),imgui.SameLine();popup_border=0<style.FrameBorderSize;imgui.Checkbox("FrameBorder",popup_border)&&(style.FrameBorderSize=popup_border?0:1,dirty=!0),imgui.SameLine();var value,popup_border=0<style.PopupBorderSize;if(imgui.Checkbox("PopupBorder",popup_border)&&(style.PopupBorderSize=popup_border?0:1,dirty=!0),imgui.Button("Save Ref")&&(this.refStyle=style.Clone(),ref=this.refStyle),imgui.SameLine(),imgui.Button("Revert Ref")&&(this.guictx.Style=this.refStyle.Clone(),dirty=!0),imgui.Separator(),imgui.BeginTabBar("##tabs",TabBarFlags.None)){if(imgui.BeginTabItem("Sizes")){imgui.Text("Fonts");for(let fs in style.FontSizes)imgui.SliderInt(fs,style.FontSizes[fs],8,32,null,newval=>{style.FontSizes[fs]=newval,dirty=!0});imgui.Text("Main"),imgui.SliderFloat("TextLineHeightPct",style.TextLineHeightPct,.4,2,"%.2f",1,newval=>style.TextLineHeightPct=newval),imgui.SliderInt2("WindowPadding",style.WindowPadding,0,20),imgui.SliderInt2("FramePadding",style.FramePadding,0,20),imgui.SliderInt2("ItemSpacing",style.ItemSpacing,0,20),imgui.SliderInt2("ItemInnerSpacing",style.ItemInnerSpacing,0,20),imgui.SliderInt2("TouchExtraPadding",style.TouchExtraPadding,0,10),imgui.SliderInt("IndentSpacing",style.IndentSpacing,0,30,null,newval=>style.IndentSpacing=newval),imgui.SliderInt("ScrollbarSize",style.ScrollbarSize,1,20,null,newval=>style.ScrollbarSize=newval),imgui.SliderInt("GrabMinSize",style.GrabMinSize,1,20,null,newval=>style.GrabMinSize=newval),imgui.Text("Borders"),imgui.SliderFloat("WindowBorderSize",style.WindowBorderSize,0,1,"%.0f",1,newval=>style.WindowBorderSize=newval),imgui.SliderFloat("ChildBorderSize",style.ChildBorderSize,0,1,"%.0f",1,newval=>style.ChildBorderSize=newval),imgui.SliderFloat("PopupBorderSize",style.PopupBorderSize,0,1,"%.0f",1,newval=>style.PopupBorderSize=newval),imgui.SliderFloat("FrameBorderSize",style.FrameBorderSize,0,1,"%.0f",1,newval=>style.FrameBorderSize=newval),imgui.SliderFloat("TabBorderSize",style.TabBorderSize,0,1,"%.0f",1,newval=>style.TabBorderSize=newval),imgui.Text("Rounding"),imgui.SliderFloat("WindowRounding",style.WindowRounding,0,12,"%.0f",1,newval=>style.WindowRounding=newval),imgui.SliderFloat("ChildRounding",style.ChildRounding,0,12,"%.0f",1,newval=>style.ChildRounding=newval),imgui.SliderFloat("FrameRounding",style.FrameRounding,0,12,"%.0f",1,newval=>style.FrameRounding=newval),imgui.SliderFloat("PopupRounding",style.PopupRounding,0,12,"%.0f",1,newval=>style.PopupRounding=newval),imgui.SliderFloat("ScrollbarRounding",style.ScrollbarRounding,0,12,"%.0f",1,newval=>style.ScrollbarRounding=newval),imgui.SliderFloat("GrabRounding",style.GrabRounding,0,12,"%.0f",1,newval=>style.GrabRounding=newval),imgui.SliderFloat("TabRounding",style.TabRounding,0,12,"%.0f",1,newval=>style.TabRounding=newval),imgui.Text("Alignment"),imgui.SliderFloat2("WindowTitleAlign",style.WindowTitleAlign,0,1,"%.2f"),imgui.SliderFloat2("ButtonTextAlign",style.ButtonTextAlign,0,1,"%.2f"),imgui.Tooltip("Alignment applies when a button is larger than its text content."),imgui.SliderFloat2("SelectableTextAlign",style.SelectableTextAlign,0,1,"%.2f"),imgui.Tooltip("Alignment applies when a selectable is larger than its text content."),imgui.Text("Safe Area Padding"),imgui.Tooltip("Adjust if you cannot see the edges of your screen (e.g. on a TV where scaling has not been configured)."),imgui.SliderFloat2("DisplaySafeAreaPadding",style.DisplaySafeAreaPadding,0,30,"%.0f"),imgui.EndTabItem()}if(imgui.BeginTabItem("Colors")){if(imgui.Button("Export Unsaved")){for(var key in 0==this.outputTarget?imgui.LogToClipboard():imgui.LogToTTY(),imgui.LogText("{\nstyle.Colors: {"),style.Colors){let c=ref.Colors[key];this.outputModifiedOnly&&style.Colors[key]==c||(value=c.AsStr(),imgui.LogText(`${key}: ${value}\n`))}imgui.LogText("\n}\n}"),imgui.LogFinish()}imgui.SameLine(),imgui.PushItemWidth(120),imgui.Combo("##output_type",this.outputTarget,["To Clipboard","To TTY"]),imgui.PopItemWidth(),imgui.SameLine(),imgui.Checkbox("Only Modified Colors",this.outputModifiedOnly)&&(this.outputModifiedOnly=!this.outputModifiedOnly),this.colorTextFilter.Draw("Filter colors",16*imgui.GetFontSize()),imgui.RadioButton("Opaque",0==this.colorAlphaFlags)&&(this.colorAlphaFlags=0),imgui.SameLine(),imgui.RadioButton("Alpha",this.colorAlphaFlags==ColorEditFlags.AlphaPreview)&&(this.colorAlphaFlags=ColorEditFlags.AlphaPreview),imgui.SameLine(),imgui.RadioButton("Both",this.colorAlphaFlags==ColorEditFlags.AlphaPreviewHalf)&&(this.colorAlphaFlags=ColorEditFlags.AlphaPreviewHalf),imgui.Tooltip("In the color list:\n\nLeft-click on colored square to open color picker,\n\nRight-click to open edit options menu."),imgui.BeginChild("##colors",Vec2.Zero(),!0,WindowFlags.AlwaysVerticalScrollbar|WindowFlags.AlwaysHorizontalScrollbar|WindowFlags.NavFlattened),imgui.PushItemWidth(-160);for(let key of style.GetSchemeColorNames())this.colorTextFilter.PassFilter(key)&&(imgui.PushID(key),imgui.ColorEdit4("##color",style.Colors[key],ColorEditFlags.AlphaBar|this.colorAlphaFlags),style.Colors[key].Equals(ref.Colors[key])||(imgui.SameLine(0,style.ItemInnerSpacing.x),imgui.Button("Save")&&ref.Colors[key].Copy(style.Colors[key]),imgui.SameLine(0,style.ItemInnerSpacing.x),imgui.Button("Revert")&&style.Colors[key].Copy(ref.Colors[key])),imgui.SameLine(0,style.ItemInnerSpacing.x),imgui.TextUnformatted(key),imgui.PopID());imgui.PopItemWidth(),imgui.EndChild(),imgui.EndTabItem()}if(imgui.BeginTabItem("Fonts")){let io=imgui.GetIO();var fontlist=io.Fonts.EnumerateFonts();imgui.PushItemWidth(120);for(let i=0;i<fontlist.length;i++){var fontname=fontlist[i];imgui.PushID(fontname);var fontDetailsOpen=imgui.TreeNode(fontname);imgui.SameLine();var fsz=style.GetFontSize("Std");let font=io.Fonts.GetFont(fontname,fsz);if(imgui.SmallButton("Set as default")&&style.SetFont("Default",font),fontDetailsOpen){null==this._fontvscale&&(this._fontvscale=1),imgui.SliderFloat("Scale",this._fontvscale,.2,5,"%.1f",1,v=>this._fontvscale=v);var bigfont=io.Fonts.GetFont(fontname,56);let visfont=io.Fonts.GetFont(fontname,fsz*this._fontvscale);imgui.PushFont(visfont),imgui.Text("The quick brown fox jumps over the lazy dog"),imgui.PopFont(),imgui.Text(`Ascent: ${visfont.Ascent.toFixed(1)}, `+`Descent: ${visfont.Descent.toFixed(1)}, `+`Baseline: ${visfont.Baseline.toFixed(1)}, `+`Height: ${(visfont.Descent-font.Ascent).toFixed(1)}`);let cell_p1=new Vec2,cell_p2=new Vec2;var txtcol=imgui.GetStyleColor("Text"),rcol=imgui.GetStyleColor("TextDisabled"),codes=font.GetKnownCodes(),cell_size=visfont.Size,cell_spacing=style.ItemSpacing.y;const dl=imgui.GetWindowDrawList();for(let g=0;g<codes.length;g+=256)if(imgui.TreeNode(`Glyphs${Math.floor(g/256)}`)){var char,nm,base_pos=imgui.GetCursorScreenPos();for(let n=0;n<256;n++){cell_p1.x=base_pos.x+n%16*(cell_size+cell_spacing),cell_p1.y=base_pos.y+Math.floor(n/16)*(cell_size+cell_spacing),cell_p2.x=cell_p1.x+cell_size,cell_p2.y=cell_p1.y+cell_size,dl.AddRect(cell_p1,cell_p2,rcol,0,CornerFlags.All,.5);let code=codes[g+n];null!=code&&(char=String.fromCharCode(code),dl.AddText(char,cell_p1,visfont,font.Size,txtcol),imgui.IsMouseHoveringRect(cell_p1,cell_p2)&&(imgui.BeginTooltip(),imgui.Text("code: "+code.toString(16)),(nm=visfont.GetCodeName(code))&&imgui.Text("name: "+nm),imgui.Separator(),imgui.PushFont(bigfont),imgui.Text(char),imgui.PopFont(),imgui.EndTooltip()))}imgui.Dummy(new Vec2(16*(cell_size+cell_spacing),16*(cell_size+cell_spacing))),imgui.TreePop()}imgui.TreePop()}imgui.PopID()}imgui.DragFloat("this window scale",1,.005,.3,2,"%.2f")&&imgui.SetWindowFontScale(1),imgui.DragFloat("global scale",io.FontGlobalScale,.005,.3,2,"%.2f")&&imgui.SetWindowFontScale(io.FontGlobalScale),imgui.PopItemWidth(),imgui.EndTabItem()}imgui.BeginTabItem("Rendering")&&(imgui.DragFloat("Global Alpha",style.Alpha,.005,.2,1,"%.2f"),imgui.PopItemWidth(),imgui.EndTabItem()),imgui.EndTabBar()}imgui.PopItemWidth()}showStyleSelector(label){}showFontSelector(label){}}class DemoPopups{constructor(imgui){this.imgui=imgui}Show(){let imgui=this.imgui;if(imgui.CollapsingHeader("Popups & Modal windows")){if(imgui.TreeNode("Popups")){if(null==this._P&&(this._P={},this._P.selected_fish=-1,this._P.names=["Bream","Haddock","Mackerel","Pollock","Tilefish"],this._P.toggles=[!0,!1,!1,!1,!1]),imgui.TextWrapped("When a popup is active, it inhibits interacting with windows that are behind the popup. Clicking outside the popup closes it."),imgui.Button("Select..")&&imgui.OpenPopup("my_select_popup"),imgui.SameLine(),imgui.TextUnformatted(-1==this._P.selected_fish?"<None>":this._P.names[this._P.selected_fish]),imgui.BeginPopup("my_select_popup")){imgui.Text("Aquarium"),imgui.Separator();for(let i=0;i<this._P.names.length;i++)imgui.Selectable(this._P.names[i])&&(this._P.selected_fish=i);imgui.EndPopup()}if(imgui.Button("Toggle..")&&imgui.OpenPopup("my_toggle_popup"),imgui.BeginPopup("my_toggle_popup")){for(let i=0;i<this._P.names.length;i++)imgui.MenuItem(this._P.names[i],"",this._P.toggles[i])&&(this._P.toggles[i]=!this._P.toggles[i]);if(imgui.BeginMenu("Sub-menu")&&(imgui.MenuItem("Click me"),imgui.EndMenu()),imgui.Separator(),imgui.Text("Tooltip here"),imgui.IsItemHovered()&&imgui.SetTooltip("I am a tooltip over a popup"),imgui.Button("Stacked Popup")&&imgui.OpenPopup("another popup"),imgui.BeginPopup("another popup")){for(let i=0;i<this._P.names.length;i++)imgui.MenuItem(this._P.names[i],"",this._P.toggles[i]);imgui.BeginMenu("Sub-menu")&&(imgui.MenuItem("Click me"),imgui.EndMenu()),imgui.EndPopup()}imgui.EndPopup()}imgui.Button("File Menu..")&&imgui.OpenPopup("my_file_popup"),imgui.BeginPopup("my_file_popup")&&(ExampleFileMenu(imgui),imgui.EndPopup()),imgui.TreePop()}imgui.TreeNode("Context Menus")&&(null==this._C&&(this._C={},this._C.value=.5,this._C.name=new MutableString("Label1")),imgui.Text("Value = %.3f (<-- right-click here)",this._C.value),imgui.BeginPopupContextItem("item context menu")&&(imgui.Selectable("Set to zero")&&(this._C.value=0),imgui.Selectable("Set to PI")&&(this._C.value=3.1415),imgui.SetNextItemWidth(-1),imgui.DragFloat("##Value",this._C.value,.1,0,0,null,1,newval=>this.C_value=newval),imgui.EndPopup()),imgui.Text("(You can also right-click me to open the same popup as above.)"),imgui.OpenPopupOnItemClick("item context menu",1),imgui.Button(this._C.name+"###Button"),imgui.BeginPopupContextItem()&&(imgui.Text("Edit name:"),imgui.InputText("##edit",this._C.name),imgui.Button("Close")&&imgui.CloseCurrentPopup(),imgui.EndPopup()),imgui.SameLine(),imgui.Text("(<-- right-click here)"),imgui.TreePop()),imgui.TreeNode("Modals")&&(null==this._M&&(this._M={},this._M.dont_ask_me_next_time=new ValRef(!1),this._M.item=1,this._M.color=Color.rgba(.4,.7,0,.5),this._M.dummy_open=new ValRef(!0)),imgui.TextWrapped("Modal windows are like popups but the user cannot close them by clicking outside the window."),imgui.Button("Delete..")&&imgui.OpenPopup("Delete?"),imgui.BeginPopupModal("Delete?",null,WindowFlags.AlwaysAutoResize)&&(imgui.Text("All those beautiful files will be deleted.\nThis operation cannot be undone!\n\n"),imgui.Separator(),imgui.PushStyleVar("FramePadding",Vec2.Zero(!1)),imgui.Checkbox("Don't ask me next time",this._M.dont_ask_me_next_time),imgui.PopStyleVar(),imgui.Button("OK",new Vec2(120,0))&&imgui.CloseCurrentPopup(),imgui.SetItemDefaultFocus(),imgui.SameLine(),imgui.Button("Cancel",new Vec2(120,0))&&imgui.CloseCurrentPopup(),imgui.EndPopup()),imgui.Button("Stacked modals..")&&imgui.OpenPopup("Stacked 1"),imgui.BeginPopupModal("Stacked 1",null,WindowFlags.MenuBar)&&(imgui.BeginMenuBar()&&(imgui.BeginMenu("File")&&(imgui.MenuItem("Dummy menu item"),imgui.EndMenu()),imgui.EndMenuBar()),imgui.Text("Hello from Stacked The First\nUsing style.Colors.ModalWindowDimBg behind it."),imgui.Combo("Combo",this._M.item,["aaaa","bbbb","cccc","dddd","eeee"],newval=>this._M.item=newval),imgui.ColorEdit4("color",this._M.color),imgui.Button("Add another modal..")&&imgui.OpenPopup("Stacked 2"),imgui.BeginPopupModal("Stacked 2",this._M.dummy_open)&&(imgui.Text("Hello from Stacked The Second!"),imgui.Button("Close")&&imgui.CloseCurrentPopup(),imgui.EndPopup()),imgui.Button("Close")&&imgui.CloseCurrentPopup(),imgui.EndPopup()),imgui.TreePop()),imgui.TreeNode("Menus inside a regular window")&&(imgui.TextWrapped("Below we are testing adding menu items to a regular window. It's rather unusual but should work!"),imgui.Separator(),imgui.PushID("foo"),imgui.MenuItem("Menu item","CTRL+M"),imgui.BeginMenu("Menu inside a regular window")&&(ExampleFileMenu(imgui),imgui.EndMenu()),imgui.PopID(),imgui.Separator(),imgui.TreePop())}}}function ExampleFileMenu(imgui){let done=!1;return imgui.MenuItem("(dummy menu)",null,!1,!1),imgui.MenuItem("New"),imgui.MenuItem("Open","Ctrl+O"),imgui.BeginMenu("Open Recent")&&(imgui.MenuItem("fish_hat.c"),imgui.MenuItem("fish_hat.inl"),imgui.MenuItem("fish_hat.h"),imgui.BeginMenu("More..")&&(imgui.MenuItem("Hello"),imgui.MenuItem("Sailor"),imgui.BeginMenu("Recurse..")&&(ExampleFileMenu(imgui),imgui.EndMenu()),imgui.EndMenu()),imgui.EndMenu()),imgui.MenuItem("Save","Ctrl+S"),imgui.MenuItem("Save As.."),imgui.Separator(),imgui.BeginMenu("Disabled",!1)&&console.assert(0),imgui.MenuItem("Checked",null,!0),imgui.MenuItem("Quit","Alt+F4")&&(done=!0),done}let selected=0;function DemoSimpleLayout(imgui,p_open){if(imgui.SetNextWindowSize(new Vec2(500,440),CondFlags.FirstUseEver),imgui.Begin("Example: Simple layout",p_open,WindowFlags.MenuBar)){imgui.BeginMenuBar()&&(imgui.BeginMenu("File")&&(imgui.MenuItem("Close")&&p_open.set(!1),imgui.EndMenu()),imgui.EndMenuBar()),imgui.BeginChild("left pane",new Vec2(150,0),!0);for(let i=0;i<100;i++)imgui.Selectable("MyObject "+i,selected==i)&&(selected=i);imgui.EndChild(),imgui.SameLine(),imgui.BeginGroup(),imgui.BeginChild("item view",new Vec2(0,-imgui.GetFrameHeightWithSpacing())),imgui.Text("MyObject: %d",selected),imgui.Separator(),imgui.BeginTabBar("##Tabs",TabBarFlags.None)&&(imgui.BeginTabItem("Description")&&(imgui.TextWrapped("Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. "),imgui.EndTabItem()),imgui.BeginTabItem("Details")&&(imgui.Text("ID: 0123456789"),imgui.EndTabItem()),imgui.EndTabBar()),imgui.EndChild(),imgui.Button("Revert"),imgui.SameLine(),imgui.Button("Save"),imgui.EndGroup()}imgui.End()}var Singleton=null;function GetLog(){return Singleton}const MaxEntries=2e3,EntryCullSize=100,sLevelShorten={ERROR:"err",WARNING:"warn",NOTICE:"note",INFO:"info",DEBUG:"dbg"};class LogWindow{constructor(app){this.app=app,this.IsShowing=new ValRef(!1),this.entries=[],this.scrollToBottom=!0,this.filter=null,this.lastError="",this.lastErrorLevel=null,this.lastMsg="",this.lastMsgLevel="",this.console={debug:console.debug,log:console.log,info:console.info,warn:console.warn,error:console.error,alert:window.alert},Singleton=Singleton||this,console.debug("Starting Log")}bindConsole(override){override?(console.debug=this.Debug.bind(this),console.info=this.Info.bind(this),console.log=this.Notice.bind(this),console.warn=this.Warning.bind(this),console.error=this.Error.bind(this),window.alert=this.Alert.bind(this)):(console.debug=this.console.debug,console.info=this.console.info,console.log=this.console.log,console.warn=this.console.warn,console.error=this.console.error,window.alert=this.console.alert)}Debug(msg,...args){let d=new Date;var h=("0"+d.getHours()).slice(-2),m=("0"+d.getMinutes()).slice(-2);this.console.log(`${h}:${m} DEBUG `+msg+args.join(" "))}Info(msg,...args){this.log(msg,"INFO",args)}Notice(msg,...args){this.log(msg,"NOTICE",args)}Warning(msg,...args){this.log(msg,"WARNING",args)}Error(msg,...args){this.log(msg,"ERROR",args)}Alert(msg,...args){var x=document.getElementById("Alert");x?(x.className="show",x.innerHTML=`<span>${msg}${args}</span>`,setTimeout(()=>{x.className="",x.innerHTML=""},3e3)):this.log(msg,"ALERT",args)}GetLastMsg(maxLength=0){return 0==maxLength?this.lastMsg:this.lastMsg.slice(0,maxLength)}GetLastMsgColor(imgui){var lev=this.lastMsgLevel;return lev?imgui.guictx.Style.GetColor(lev):imgui.guictx.Style.GetColor("TextDisabled")}GetLastMsgLevel(){return this.lastMsgLevel}GetLastError(maxLength=24){return 0==maxLength?this.lastError:this.lastError.slice(0,maxLength)}GetLastErrorLevel(){return this.lastErrorLevel}GetLastErrorColor(imgui){let lev=this.lastErrorLevel;return lev=lev||"DEBUG",imgui.guictx.Style.GetColor(lev)}log(msg,level="INFO",now){"object"==typeof(msg=msg.message?msg.message:msg)&&(msg=JSON.stringify(msg)),now&&0<now.length&&(msg+=", ",msg+=now.join(", ")),this.lastMsg=msg,"WARNING"!=(this.lastMsgLevel=level)&&"ERROR"!=level&&"ALERT"!=level||(this.lastErrorLevel=level,this.lastError=msg);now=Date.now();this.entries.push({m:msg,l:level,ts:now}),this.entries.length>MaxEntries&&(this.entries=this.entries.slice(EntryCullSize),this.entries.push({m:"log culled",l:"INFO",ts:now})),this.dirty=!0,this.app.OnLogActivity(this.lastMsg,this.lastMsgLevel)}Clear(doClose=!0){this.entries=[],this.lastMsg="",this.lastError="",this.lastMsgLevel="",doClose&&this.IsShowing.set(!1),this.app.OnLogActivity(this.lastMsg,this.lastMsgLevel)}FilterEntries(filter){this.entries=this.entries.filter(filter)}Raise(){this.IsShowing.set(!0),this.raiseRequested=!0,this.lastMsg="",this.lastMsgLevel=""}Begin(imgui){}Show(imgui,open="Log"){if(this.IsShowing.get()){this.filter||(this.filter=new TextFilter(imgui)),this.app.IsMobileDevice()?(imgui.SetNextWindowPos(new Vec2(0,0)),imgui.SetNextWindowSize(imgui.guictx.IO.DisplaySize)):(imgui.SetNextWindowPos(new Vec2(10,10),CondFlags.FirstUseEver),imgui.SetNextWindowSize(new Vec2(580,200),CondFlags.FirstUseEver)),this.raiseRequested&&(imgui.SetNextWindowCollapsed(!1,CondFlags.Always),imgui.SetNextWindowFocus(),this.raiseRequested=!1);open=`Log ${this.lastError}##${open}`,open=imgui.Begin(open,this.IsShowing);if(imgui.IsWindowCollapsed()||(this.lastError="",this.lastErrorLevel=null),open){let toClipboard=null;if(this.lastError="",imgui.Button("Clear")&&this.Clear(),imgui.SameLine(),imgui.Button("Copy")&&(toClipboard=[]),imgui.SameLine(),this.filter.Draw("Filter",100),imgui.Separator(),imgui.BeginChild("scrolling",new Vec2(0,0),!1,WindowFlags.HorizontalScrollbar),this.entries.length){let font=imgui.PushFont("Small");var offset=font.MeasureWidth("MMMMMMM");for(let i=0;i<this.entries.length;i++){var head=this.entries[i],msg=null!=head.m?head.m:head,c=null!=head.l?head.l:"INFO";(this.filter.PassFilter(msg)||this.filter.PassFilter(c))&&((c=imgui.guictx.Style.GetColor(head.l))&&imgui.PushStyleColor("Text",c),head=this.formatEntryHead(head),imgui.Text(head),c&&imgui.PopStyleColor(),imgui.SameLine(offset),imgui.Text(msg),toClipboard&&toClipboard.push(`${head} . ${msg}`))}imgui.PopFont(),toClipboard&&imgui.SetClipboardText(toClipboard.join("\n"))}this.dirty&&(imgui.SetScrollHereY(1),this.dirty=!1),imgui.EndChild()}imgui.End()}}GetLevelColor(imgui,lev){let c;if(imgui)if(""==lev)c="#222";else{let imc=imgui.guictx.Style.GetColor(lev);c=imc.AsStr()}else c={"":"#222",INFO:"#448",NOTICE:"#24a",WARNING:"#942",ERROR:"#a42"}[lev];return c}formatEntryHead(entry){let d=new Date(entry.ts);return`${("0"+d.getHours()).slice(-2)}:${("0"+d.getMinutes()).slice(-2)} ${sLevelShorten[entry.l]}`}}class DemoColumns{constructor(imgui){this.imgui=imgui,this.names=["One","Two","Three"],this.paths=["/path/one","/path/two","/path/three"],this.selected=-1,this.foo=-1,this.bar=1,this.h_borders=!0,this.v_borders=!0}Show(){let imgui=this.imgui;if(imgui.CollapsingHeader("Columns")){if(imgui.PushID("Columns"),imgui.TreeNode("Basic")){imgui.Text("Without border:"),imgui.Columns(3,"mycolumns3",!1),imgui.Separator();for(let n=0;n<14;n++){var label="Item "+n;imgui.Selectable(label),imgui.NextColumn()}imgui.Columns(1),imgui.Separator(),imgui.Text("With border:"),imgui.Columns(4,"mycolumns"),imgui.Separator(),imgui.Text("ID"),imgui.NextColumn(),imgui.Text("Name"),imgui.NextColumn(),imgui.Text("Path"),imgui.NextColumn(),imgui.Text("Hovered"),imgui.NextColumn(),imgui.Separator();for(let i=0;i<3;i++){let label="000"+i;imgui.Selectable(label,this.selected==i,SelectableFlags.SpanAllColumns)&&(this.selected=i);var hovered=imgui.IsItemHovered();imgui.NextColumn(),imgui.Text(this.names[i]),imgui.NextColumn(),imgui.Text(this.paths[i]),imgui.NextColumn(),imgui.Text("%d",hovered),imgui.NextColumn()}imgui.Columns(1),imgui.Separator(),imgui.TreePop()}if(imgui.TreeNode("Mixed items")&&(imgui.Columns(3,"mixed"),imgui.Separator(),imgui.Text("Hello"),imgui.Button("Banana"),imgui.NextColumn(),imgui.Text("ImGui"),imgui.Button("Apple"),imgui.InputFloat("red",this.foo,.05,0,"%.3f",1,newval=>this.foo=newval),imgui.Text("An extra line here."),imgui.NextColumn(),imgui.Text("Sailor"),imgui.Button("Corniflower"),imgui.InputFloat("blue",this.bar,.05,0,"%.3f",1,newval=>this.bar=newval),imgui.NextColumn(),imgui.CollapsingHeader("Category A")&&imgui.Text("Blah blah blah"),imgui.NextColumn(),imgui.CollapsingHeader("Category B")&&imgui.Text("Blah blah blah"),imgui.NextColumn(),imgui.CollapsingHeader("Category C")&&imgui.Text("Blah blah blah"),imgui.NextColumn(),imgui.Columns(1),imgui.Separator(),imgui.TreePop()),imgui.TreeNode("Word-wrapping")&&(imgui.Columns(2,"word-wrapping"),imgui.Separator(),imgui.TextWrapped("The quick brown fox jumps over the lazy dog."),imgui.TextWrapped("Hello Left"),imgui.NextColumn(),imgui.TextWrapped("The quick brown fox jumps over the lazy dog."),imgui.TextWrapped("Hello Right"),imgui.Columns(1),imgui.Separator(),imgui.TreePop()),imgui.TreeNode("Borders")){imgui.Checkbox("horizontal",this.h_borders)&&(this.h_borders=!this.h_borders),imgui.SameLine(),imgui.Checkbox("vertical",this.v_borders)&&(this.v_borders=!this.v_borders),imgui.Columns(4,null,this.v_borders);for(let i=0;i<12;i++){this.h_borders&&0==imgui.GetColumnIndex()&&imgui.Separator();var t=String.fromCharCode("a".charCodeAt(0)+i);imgui.Text(t,t,t),imgui.Text("Width %.2f\nOffset %.2f",imgui.GetColumnWidth(),imgui.GetColumnOffset()),imgui.NextColumn()}imgui.Columns(1),this.h_borders&&imgui.Separator(),imgui.TreePop()}if(imgui.TreeNode("Horizontal Scrolling")){imgui.SetNextWindowContentSize(new Vec2(1500,0)),imgui.BeginChild("##ScrollingRegion",new Vec2(0,20*imgui.GetFontSize()),!1,WindowFlags.HorizontalScrollbar),imgui.Columns(10);let clipper=new ListClipper(imgui,2e3);for(;clipper.Step();)for(let i=clipper.DisplayStart;i<clipper.DisplayEnd;i++)for(let j=0;j<10;j++)imgui.Text("Line %d Column %d...",i,j),imgui.NextColumn();imgui.Columns(1),imgui.EndChild(),imgui.TreePop()}var node_open=imgui.TreeNode("Tree within single cell");imgui.SameLine(),imgui.Tooltip("NB: Tree node must be poped before ending the cell. There's no storage of state per-cell."),node_open&&(imgui.Columns(2,"tree items"),imgui.Separator(),imgui.TreeNode("Hello")&&(imgui.BulletText("Sailor"),imgui.TreePop()),imgui.NextColumn(),imgui.TreeNode("Bonjour")&&(imgui.BulletText("Marin"),imgui.TreePop()),imgui.NextColumn(),imgui.Columns(1),imgui.Separator(),imgui.TreePop()),imgui.PopID()}}}class DemoWindow{constructor(){this.showAppDocuments=new ValRef(!1),this.showAppMainMenuBar=new ValRef(!1),this.showAppConsole=new ValRef(!1),this.showAppLayout=new ValRef(!1),this.showAppPropertyEditor=new ValRef(!1),this.showAppLongText=new ValRef(!1),this.showAppAutoResize=new ValRef(!1),this.showAppConstrainedResize=new ValRef(!1),this.showAppSimpleOverlay=new ValRef(!1),this.showAppWindowTitles=new ValRef(!1),this.showAppCustomRendering=new ValRef(!1),this.showAppStyleEditor=new ValRef(!1),this.showAppMetrics=new ValRef(!1),this.showAppAbout=new ValRef(!1),this.noTitleBar=new ValRef(!1),this.noScrollBar=new ValRef(!1),this.noMenu=new ValRef(!1),this.noMove=new ValRef(!1),this.noResize=new ValRef(!1),this.noCollapse=new ValRef(!1),this.noNav=new ValRef(!1),this.noBgd=new ValRef(!1),this.noBringToFront=new ValRef(!1),this.noClose=new ValRef(!1),this.counter=0}Show(imgui,winname="imgui demo",isOpen=null){if(null==isOpen||isOpen.get()){let done=!1;var mouse=this.getWinFlags();if(this.imgui=imgui,this.log=GetLog(imgui),this.styleEditor||(this.styleEditor=new StyleEditor(imgui),this.demoWidgets=new DemoWidgets(imgui),this.demoLayout=new DemoLayout(imgui),this.demoPopups=new DemoPopups(imgui),this.demoColumns=new DemoColumns(imgui),this.customRendering=new DemoCustomRendering(imgui)),this.noClose.get()&&(isOpen=null),this.showAppWindows(imgui),imgui.SetNextWindowPos(new Vec2(40,40),CondFlags.FirstUseEver),imgui.SetNextWindowSize(new Vec2(500,700),CondFlags.FirstUseEver),!imgui.Begin(winname,isOpen,mouse))return imgui.End(),done;imgui.PushItemWidth(-12*imgui.GetFontSize()),imgui.Button("Button")&&this.counter++,imgui.SameLine(),imgui.PushFont("monospace"),imgui.Text(`counter=${this.counter}`),imgui.SameLine();let fps=imgui.GetIO().Framerate;mouse=(1e3/fps).toFixed(1);imgui.Text(`${fps.toFixed(0)} fps, ${mouse} mspf`);var backend_flags,mouse=imgui.GetIO().MousePos;if(mouse.x!=-Number.MAX_VALUE&&(imgui.SameLine(),imgui.Text(`mouse: ${mouse.x}, ${mouse.y}`)),imgui.PopFont(),imgui.BeginMenuBar()&&(imgui.BeginMenu("File")&&(done=ExampleFileMenu(imgui),imgui.EndMenu()),imgui.BeginMenu("Examples")&&(imgui.MenuItem("Main menu bar",null,this.showAppMainMenuBar),imgui.MenuItem("Console",null,this.showAppConsole),imgui.MenuItem("Simple layout",null,this.showAppLayout),imgui.MenuItem("Property editor",null,this.showAppPropertyEditor),imgui.MenuItem("Long text display",null,this.showAppLongText),imgui.MenuItem("Auto-resizing window",null,this.showAppAutoResize),imgui.MenuItem("Constrained-resizing window",null,this.showAppConstrainedResize),imgui.MenuItem("Simple overlay",null,this.showAppSimpleOverlay),imgui.MenuItem("Manipulating window titles",null,this.showAppWindowTitles),imgui.MenuItem("Custom rendering",null,this.showAppCustomRendering),imgui.MenuItem("Documents",null,this.showAppDocuments),imgui.EndMenu()),imgui.BeginMenu("Help")&&(imgui.MenuItem("Metrics",null,this.showAppMetrics),imgui.MenuItem("Style Editor",null,this.showAppStyleEditor),imgui.MenuItem("About imgui-njs",null,this.showAppAbout),imgui.EndMenu()),imgui.EndMenuBar()),imgui.Spacing(),imgui.CollapsingHeader("Help")&&(imgui.Indent(),imgui.Text("PROGRAMMER GUIDE:"),imgui.BulletText("make sure this is the right approach for you"),imgui.BulletText("make sure it scales well enough"),imgui.Unindent()),imgui.CollapsingHeader("Configuration")){const io=imgui.GetIO();imgui.TreeNode("Configuration##2")&&(backend_flags=function(flags){io.ConfigFlags=flags},imgui.CheckboxFlags("io.ConfigFlags: NavEnableKeyboard",io.ConfigFlags,ConfigFlags.NavEnableKeyboard,backend_flags),imgui.CheckboxFlags("io.ConfigFlags: NavEnableGamepad",io.ConfigFlags,ConfigFlags.NavEnableGamepad,backend_flags),imgui.Tooltip("Required back-end to feed in gamepad inputs in io.NavInputs[] and set io.BackendFlags |= BackendFlags.HasGamepad.\n\nRead instructions in imgui.cpp for details."),imgui.CheckboxFlags("io.ConfigFlags: NavEnableSetMousePos",io.ConfigFlags,ConfigFlags.NavEnableSetMousePos,backend_flags),imgui.Tooltip("Instruct navigation to move the mouse cursor. See comment for ImGuiConfigFlags_NavEnableSetMousePos."),imgui.CheckboxFlags("io.ConfigFlags: NoMouse",io.ConfigFlags,ConfigFlags.NoMouse,backend_flags),io.ConfigFlags&ConfigFlags.NoMouse&&(imgui.GetTime()%.4<.2&&(imgui.SameLine(),imgui.Text("<<PRESS SPACE TO DISABLE>>")),imgui.IsKeyPressed(imgui.GetKeyIndex(Key.Space))&&(io.ConfigFlags&=~ConfigFlags.NoMouse)),imgui.CheckboxFlags("io.ConfigFlags: NoMouseCursorChange",io.ConfigFlags,ConfigFlags.NoMouseCursorChange,backend_flags),imgui.Tooltip("Instruct back-end to not alter mouse cursor shape and visibility."),imgui.Checkbox("io.ConfigInputTextCursorBlink",io.ConfigInputTextCursorBlink,v=>io.ConfigInputTextCursorBlink=v),imgui.Tooltip("Set to false to disable blinking cursor, for users who consider it distracting"),imgui.Checkbox("io.ConfigWindowsResizeFromEdges [beta]",io.ConfigWindowsResizeFromEdges,v=>io.ConfigWindowsResizeFromEdges=v),imgui.Tooltip("Enable resizing of windows from their edges and from the lower-left corner.\nThis requires (io.BackendFlags & ImGuiBackendFlags_HasMouseCursors) because it needs mouse cursor feedback."),imgui.Checkbox("io.ConfigWindowsMoveFromTitleBarOnly",io.ConfigWindowsMoveFromTitleBarOnly,v=>io.ConfigWindowsMoveFromTitleBarOnly=v),imgui.Checkbox("io.MouseDrawCursor",io.MouseDrawCursor,v=>io.MouseDrawCursor=v),imgui.Tooltip("Instruct Dear ImGui to render a mouse cursor for you. Note that a mouse cursor rendered via your application GPU rendering path will feel more laggy than hardware cursor, but will be more in sync with your other visuals.\n\nSome desktop applications may use both kinds of cursors (e.g. enable software cursor only when resizing/dragging something)."),imgui.TreePop(),imgui.Separator()),imgui.TreeNode("Backend Flags")&&(backend_flags=io.BackendFlags,imgui.CheckboxFlags("io.BackendFlags: HasGamepad",backend_flags,BackendFlags.HasGamepad,v=>io.BackendFlags=v),imgui.CheckboxFlags("io.BackendFlags: HasMouseCursors",backend_flags,BackendFlags.HasMouseCursors,v=>io.BackendFlags=v),imgui.CheckboxFlags("io.BackendFlags: HasSetMousePos",backend_flags,BackendFlags.HasSetMousePos,v=>io.BackendFlags=v),imgui.TreePop(),imgui.Separator()),imgui.TreeNode("Style")&&(this.styleEditor.Show(),imgui.TreePop(),imgui.Separator()),imgui.TreeNode("Capture/Logging")&&(imgui.TextWrapped("The logging API redirects all text output so you can easily capture the content of a window or a block. Tree nodes can be automatically expanded."),imgui.Tooltip('Try opening any of the contents below in this window and then click one of the "Log To" button.'),imgui.LogButtons(),imgui.TextWrapped("You can also call ImGui.LogText() to output directly to the log without a visual output."),imgui.Button('Copy "Hello, world!" to clipboard')&&(imgui.LogToClipboard(),imgui.LogText("Hello, world!"),imgui.LogFinish()),imgui.TreePop())}return imgui.CollapsingHeader("Window options")&&(imgui.Checkbox("No titlebar",this.noTitleBar),imgui.SameLine(150),imgui.Checkbox("No scrollbar",this.noScrollBar),imgui.SameLine(300),imgui.Checkbox("No menu",this.noMenu),imgui.Checkbox("No move",this.noMove),imgui.SameLine(150),imgui.Checkbox("No resize",this.noResize),imgui.SameLine(300),imgui.Checkbox("No collapse",this.noCollapse),imgui.Checkbox("No close",this.noClose),imgui.SameLine(150),imgui.Checkbox("No nav",this.noNav),imgui.SameLine(300),imgui.Checkbox("No background",this.noBgd),imgui.Checkbox("No bring to front",this.noBringToFront)),this.demoWidgets.Show(),this.demoLayout.Show(),this.demoPopups.Show(),this.demoColumns.Show(),imgui.End(),done}}showAppWindows(imgui){this.showAppDocuments.get(),this.showAppMainMenuBar.get(),this.showAppConsole.get(),this.showAppLayout.get()&&DemoSimpleLayout(imgui,this.showAppLayout),this.showAppPropertyEditor.get()&&DemoPropertyEditor(imgui,this.showAppPropertyEditor),this.showAppLongText.get(),this.showAppAutoResize.get(),this.showAppConstrainedResize.get(),this.showAppSimpleOverlay.get()&&this.showSimpleOverlay(this.showAppSimpleOverlay),this.showAppWindowTitles.get(),this.showAppCustomRendering.get()&&this.customRendering.Show(this.showAppCustomRendering),this.showAppStyleEditor.get(),this.showAppMetrics.get(),this.showAppAbout.get()&&this.showAboutWindow()}getWinFlags(){let winflags=0;return this.noTitleBar.get()&&(winflags|=WindowFlags.NoTitleBar),this.noScrollBar.get()&&(winflags|=WindowFlags.NoScrollbar),this.noMenu.get()||(winflags|=WindowFlags.MenuBar),this.noResize.get()&&(winflags|=WindowFlags.NoResize),this.noCollapse.get()&&(winflags|=WindowFlags.NoCollapse),this.noNav.get()&&(winflags|=WindowFlags.NoNav),this.noBgd.get()&&(winflags|=WindowFlags.NoBackground),this.noBringToFront.get()&&(winflags|=WindowFlags.NoBringToFrontOnFocus),winflags}showAboutWindow(){let imgui=this.imgui;imgui.Begin("About imgui-njs",this.showAppAbout,WindowFlags.AlwaysAutoResize|WindowFlags.NoCollapse)&&(imgui.Text(imgui.GetVersion()),imgui.Separator(),imgui.Text("imgui-njs by Dana Batali, built atop:"),imgui.Text("dear-imgui by Omar Cornut and all dear imgui contributors."),imgui.Text("Both are licensed under the MIT License.")),imgui.End()}showSimpleOverlay(p_open){this._corner||(this._corner=0);const imgui=this.imgui;var window_pos,window_pos_pivot,io=imgui.GetIO();-1!=this._corner&&(window_pos=new Vec2(1&this._corner?io.DisplaySize.x-10:10,2&this._corner?io.DisplaySize.y-10:10),window_pos_pivot=new Vec2(1&this._corner?1:0,2&this._corner?1:0),imgui.SetNextWindowPos(window_pos,CondFlags.Always,window_pos_pivot)),imgui.SetNextWindowBgAlpha(.35),imgui.Begin("Example: Simple overlay",p_open,(-1!=this._corner?WindowFlags.NoMove:0)|WindowFlags.NoDecoration|WindowFlags.AlwaysAutoResize|WindowFlags.NoSavedSettings|WindowFlags.NoFocusOnAppearing|WindowFlags.NoNav)&&(imgui.Text("Simple overlay\nin the corner of the screen.\n(right-click to change position)"),imgui.Separator(),imgui.IsMousePosValid()?imgui.Text("Mouse Position: (%.1f,%.1f)",io.MousePos.x,io.MousePos.y):imgui.Text("Mouse Position: <invalid>"),imgui.BeginPopupContextWindow()&&(imgui.MenuItem("Custom",null,-1==this._corner)&&(this._corner=-1),imgui.MenuItem("Top-left",null,0==this._corner)&&(this._corner=0),imgui.MenuItem("Top-right",null,1==this._corner)&&(this._corner=1),imgui.MenuItem("Bottom-left",null,2==this._corner)&&(this._corner=2),imgui.MenuItem("Bottom-right",null,3==this._corner)&&(this._corner=3),p_open.get()&&imgui.MenuItem("Close")&&p_open.set(!1),imgui.EndPopup())),imgui.End()}}let dummy_members=[0,0,1,3.1416,100,999,0,0];function DemoPropertyEditor(imgui,p_open=null){if(imgui.SetNextWindowSize(new Vec2(430,450),CondFlags.FirstUseEver),imgui.Begin("Example: Property editor",p_open)){imgui.Tooltip("This example shows how you may implement a property editor using two columns.\nAll objects/fields data are dummies here.\nRemember that in many simple cases, you can use imgui.SameLine(xxx) to position\nyour cursor horizontally instead of using the Columns() API."),imgui.PushStyleVar("FramePadding",new Vec2(2,2)),imgui.Columns(2),imgui.Separator();let ShowDummyObject=function(prefix,node_open){imgui.PushID(node_open),imgui.AlignTextToFramePadding();node_open=imgui.TreeNode("Object","%s_%u",prefix,node_open);if(imgui.NextColumn(),imgui.AlignTextToFramePadding(),imgui.Text("my sailor is rich"),imgui.NextColumn(),node_open){for(let i=0;i<8;i++)imgui.PushID(i),i<2?ShowDummyObject("Child",424242):(imgui.AlignTextToFramePadding(),imgui.TreeNodeEx("Field",TreeNodeFlags.Leaf|TreeNodeFlags.NoTreePushOnOpen|TreeNodeFlags.Bullet,"Field_%d",i),imgui.NextColumn(),imgui.SetNextItemWidth(-1),5<=i?imgui.InputFloat("##value",dummy_members[i],1,1,null,0,newval=>dummy_members[i]=newval):imgui.DragFloat("##value",dummy_members[i],.01,0,0,null,1,newval=>dummy_members[i]=newval),imgui.NextColumn()),imgui.PopID();imgui.TreePop()}imgui.PopID()};for(let obj_i=0;obj_i<3;obj_i++)ShowDummyObject("Object",obj_i);imgui.Columns(1),imgui.Separator(),imgui.PopStyleVar(),imgui.End()}else imgui.End()}class DemoCustomRendering{constructor(imgui){this.imgui=imgui}Show(mouse_pos_in_canvas=null){let imgui=this.imgui;if(imgui.SetNextWindowSize(new Vec2(350,560),CondFlags.FirstUseEver),imgui.Begin("Example: Custom rendering",mouse_pos_in_canvas)){let drawlist=imgui.GetWindowDrawList();if(imgui.BeginTabBar("##TabBar")){if(null==this._sz&&(this._sz=36,this._thickness=4,this._col=Color.rgba(1,1,.4,1),this._points=new ArrayEx,this._addingLine=!1),imgui.BeginTabItem("Primitives")){imgui.DragFloat("Size",this._sz,.2,2,100,"%f",1,newval=>this._sz=newval),imgui.DragFloat("Thickness",this._thickness,.05,1,8,"%.2f",1,newval=>this._thickness=newval),imgui.ColorEdit4("Color",this._col);var p=imgui.GetCursorScreenPos();let x=p.x+4,y=p.y+4;var sz=this._sz;for(let n=0;n<2;n++){var th=0==n?1:this._thickness;drawlist.AddCircle(new Vec2(x+.5*sz,y+.5*sz),.5*sz,this._col,th),x+=sz+8,drawlist.AddCircle(new Vec2(x+.5*sz,y+.5*sz),.5*sz,this._col,th),x+=sz+8,drawlist.AddRect(new Vec2(x,y),new Vec2(x+sz,y+sz),this._col,0,CornerFlags.All,th),x+=sz+8,drawlist.AddRect(new Vec2(x,y),new Vec2(x+sz,y+sz),this._col,10,CornerFlags.All,th),x+=sz+8,drawlist.AddRect(new Vec2(x,y),new Vec2(x+sz,y+sz),this._col,10,CornerFlags.TopLeft|CornerFlags.BotRight,th),x+=sz+8,drawlist.AddTriangle(new Vec2(x+.5*sz,y),new Vec2(x+sz,y+sz-.5),new Vec2(x,y+sz-.5),this._col,th),x+=sz+8,drawlist.AddLine(new Vec2(x,y),new Vec2(x+sz,y),this._col,th),x+=sz+8,drawlist.AddLine(new Vec2(x,y),new Vec2(x,y+sz),this._col,th),x+=8,drawlist.AddLine(new Vec2(x,y),new Vec2(x+sz,y+sz),this._col,th),x+=sz+8,drawlist.AddBezierCurve(new Vec2(x,y),new Vec2(x+1.3*sz,y+.3*sz),new Vec2(x+sz-1.3*sz,y+sz-.3*sz),new Vec2(x+sz,y+sz),this._col,th),x=p.x+4,y+=sz+8}drawlist.AddCircleFilled(new Vec2(x+.5*sz,y+.5*sz),.5*sz,this._col,6),x+=sz+8,drawlist.AddCircleFilled(new Vec2(x+.5*sz,y+.5*sz),.5*sz,this._col,32),x+=sz+8,drawlist.AddRectFilled(new Vec2(x,y),new Vec2(x+sz,y+sz),this._col),x+=sz+8,drawlist.AddRectFilled(new Vec2(x,y),new Vec2(x+sz,y+sz),this._col,10),x+=sz+8,drawlist.AddRectFilled(new Vec2(x,y),new Vec2(x+sz,y+sz),this._col,10,CornerFlags.TopLeft|CornerFlags.BotRight),x+=sz+8,drawlist.AddTriangleFilled(new Vec2(x+.5*sz,y),new Vec2(x+sz,y+sz-.5),new Vec2(x,y+sz-.5),this._col),x+=sz+8,drawlist.AddRectFilled(new Vec2(x,y),new Vec2(x+sz,y+this._thickness),this._col),x+=sz+8,drawlist.AddRectFilled(new Vec2(x,y),new Vec2(x+this._thickness,y+sz),this._col),x+=16,drawlist.AddRectFilled(new Vec2(x,y),new Vec2(x+1,y+1),this._col),x+=sz,drawlist.AddRectFilledMultiColor(new Vec2(x,y),new Vec2(x+sz,y+sz),Color.rgbi(0,0,0),Color.rgbi(255,0,0),Color.rgbi(255,0,0),Color.rgbi(0,0,0)),imgui.Dummy(new Vec2(9.5*(sz+8),3*(sz+8))),imgui.EndTabItem()}if(imgui.BeginTabItem("Canvas")){imgui.Button("Clear")&&this._points.clear(),2<=this._points.length&&(imgui.SameLine(),imgui.Button("Undo")&&(this._points.pop_back(),this._points.pop_back())),imgui.Text("Left-click and drag to add lines,\nRight-click to undo");var canvas_pos=imgui.GetCursorScreenPos();let canvas_size=imgui.GetContentRegionAvail().Clone();canvas_size.x<50&&(canvas_size.x=50),canvas_size.y<50&&(canvas_size.y=50),drawlist.AddRectFilledMultiColor(canvas_pos,new Vec2(canvas_pos.x+canvas_size.x,canvas_pos.y+canvas_size.y),Color.rgbi(50,50,50),Color.rgbi(50,50,50),Color.rgbi(60,60,80),Color.rgbi(60,60,80)),drawlist.AddRect(canvas_pos,new Vec2(canvas_pos.x+canvas_size.x,canvas_pos.y+canvas_size.y),Colors.gray);let adding_preview=!1;imgui.InvisibleButton("canvas",canvas_size);mouse_pos_in_canvas=new Vec2(imgui.GetIO().MousePos.x-canvas_pos.x,imgui.GetIO().MousePos.y-canvas_pos.y);this._addingLine&&(adding_preview=!0,this._points.push_back(mouse_pos_in_canvas),imgui.IsMouseDown(0)||(this._addingLine=adding_preview=!1)),imgui.IsItemHovered()&&(!this._addingLine&&imgui.IsMouseClicked(0)&&(this._points.push_back(mouse_pos_in_canvas),this._addingLine=!0),imgui.IsMouseClicked(1)&&!this._points.empty()&&(this._addingLine=adding_preview=!1,this._points.pop_back(),this._points.pop_back())),drawlist.PushClipRect(canvas_pos,new Vec2(canvas_pos.x+canvas_size.x,canvas_pos.y+canvas_size.y),!0);for(let i=0;i<this._points.length-1;i+=2)drawlist.AddLine(new Vec2(canvas_pos.x+this._points[i].x,canvas_pos.y+this._points[i].y),new Vec2(canvas_pos.x+this._points[i+1].x,canvas_pos.y+this._points[i+1].y),this._col,this._thickness);drawlist.PopClipRect(),adding_preview&&this._points.pop_back(),imgui.EndTabItem()}imgui.BeginTabItem("BG/FG draw lists")&&(imgui.Text("currently unimplemented"),imgui.EndTabItem()),imgui.EndTabBar()}imgui.End()}else imgui.End()}}class ImguiMixins{constructor(){}}let mixins=[ImguiDragDropMixin,ImguiLoggingMixin,ImguiMiscMixin,ImguiNavMixin,ImguiRenderMixin,ImguiSettingsMixin,ImguiWinMgrMixin,ImguiButtonMixin,ImguiColorEditMixin,ImguiColorPickerMixin,ImguiColumnMixin,ImguiComboMixin,ImguiDragMixin,ImguiInputMixin,ImguiLayoutMixin,ImguiListboxMixin,ImguiMenuMixin,ImguiPopupMixin,ImguiPlotMixin,ImguiScrollbarMixin,ImguiSelectableMixin,ImguiSliderMixin,ImguiTabBarMixin,ImguiTextMixin,ImguiTooltipMixin,ImguiTreeMixin];for(let m of mixins)Object.assign(ImguiMixins.prototype,m);class Imgui extends ImguiMixins{constructor(canvas,appname="imgui-njs",appServices=navigator){super(),this.debug=!0,this.debug||(console.assert=function(){}),this.version="0.1.0",this.version_imgui="1.70 WIP",this.about=`imgui-njs: ${this.version}, dear-imgui: ${this.version_imgui}`,this.canvas=canvas,this.guictx=new GuiContext(this,canvas,appname),this.appServices=appServices,this.Initialized=!0}GetIO(){return this.guictx.IO}GetStyle(){return this.guictx.Style}GetStyleFont(nm){return this.guictx.Style.GetFont(nm)}NewFrame(win){let g=this.guictx;if(g.NewFrame(win),this.debug){console.assert(g.Initialized),console.assert(0<g.IO.DeltaTime||0==g.FrameCount),console.assert(0==g.FrameCount||g.FrameCountEnded==g.FrameCount),console.assert(0<=g.IO.DisplaySize.x&&0<=g.IO.DisplaySize.y),console.assert(0<g.IO.Fonts.Size()),console.assert(0<g.Style.CurveTessellationTol),console.assert(0<=g.Style.Alpha&&g.Style.Alpha<=1),console.assert(1<=g.Style.WindowMinSize.x&&1<=g.Style.WindowMinSize.y);for(let n=0;n<g.IO.KeyMap.length;n++)console.assert(-1<=g.IO.KeyMap[n]&&g.IO.KeyMap[n]<g.IO.KeysDown.length);g.IO.ConfigFlags&ConfigFlags.NavEnableKeyboard&&console.assert(g.IO.KeyMap[Key.Space])}!g.IO.ConfigWindowsResizeFromEdges||g.IO.BackendFlags&BackendFlags.HasMouseCursors||(g.IO.ConfigWindowsResizeFromEdges=!1),g.SettingsLoaded||(console.assert(0==g.SettingsWindows.length),g.IO.IniFilename&&this.LoadIniSettingsFromDisk(g.IO.IniFilename),g.SettingsLoaded=!0),0<g.SettingsDirtyTimer&&(g.SettingsDirtyTimer-=g.IO.DeltaTime,g.SettingsDirtyTimer<=0&&(g.IO.IniFilename?this.SaveIniSettingsToDisk(g.IO.IniFilename):g.IO.WantSaveIniSettings=!0,g.SettingsDirtyTimer=0)),g.Time+=g.IO.DeltaTime,g.FrameScopeActive=!0,g.FrameCount+=1,g.TooltipOverrideCount=0,g.WindowsActiveCount=0,g.IO.Fonts.Locked=!0,this.SetFont(this.getDefaultFont()),console.assert(g.Font.IsLoaded()),g.DragDropActive&&g.DragDropPayload.SourceId==g.ActiveId&&this.keepAliveID(g.DragDropPayload.SourceId),g.HoveredIdPreviousFrame||(g.HoveredIdTimer=0),(!g.HoveredIdPreviousFrame||g.HoveredId&&g.ActiveId==g.HoveredId)&&(g.HoveredIdNotActiveTimer=0),g.HoveredId&&(g.HoveredIdTimer+=g.IO.DeltaTime),g.HoveredId&&g.ActiveId!=g.HoveredId&&(g.HoveredIdNotActiveTimer+=g.IO.DeltaTime),g.HoveredIdPreviousFrame=g.HoveredId,g.HoveredId=0,g.HoveredIdAllowOverlap=!1,g.ActiveIdIsAlive!=g.ActiveId&&g.ActiveIdPreviousFrame==g.ActiveId&&0!=g.ActiveId&&this.clearActiveID(),g.ActiveId&&(g.ActiveIdTimer+=g.IO.DeltaTime),g.LastActiveIdTimer+=g.IO.DeltaTime,g.ActiveIdPreviousFrame=g.ActiveId,g.ActiveIdPreviousFrameWindow=g.ActiveIdWindow,g.ActiveIdPreviousFrameHasBeenEdited=g.ActiveIdHasBeenEdited,g.ActiveIdIsAlive=0,g.ActiveIdPreviousFrameIsAlive=!1,g.ActiveIdIsJustActivated=!1,g.ScalarAsInputTextId&&g.ActiveId!=g.ScalarAsInputTextId&&(g.ScalarAsInputTextId=0),g.DragDropAcceptIdPrev=g.DragDropAcceptIdCurr,g.DragDropAcceptIdCurr=0,g.DragDropAcceptIdCurrRectSurface=Number.MAX_VALUE,g.DragDropWithinSourceOrTarget=!1,g.IO.KeysDownDurationPrev=g.IO.KeysDownDuration.slice();for(let i=0;i<g.IO.KeysDown.length;i++)g.IO.KeysDownDuration[i]=g.IO.KeysDown[i]?g.IO.KeysDownDuration[i]<0?0:g.IO.KeysDownDuration[i]+g.IO.DeltaTime:-1;this.navUpdate(),g.FramerateSecPerFrameAccum+=g.IO.DeltaTime-g.FramerateSecPerFrame[g.FramerateSecPerFrameIdx],g.FramerateSecPerFrame[g.FramerateSecPerFrameIdx]=g.IO.DeltaTime,g.FramerateSecPerFrameIdx=(g.FramerateSecPerFrameIdx+1)%g.FramerateSecPerFrame.length,g.IO.Framerate=0<g.FramerateSecPerFrameAccum?1/(g.FramerateSecPerFrameAccum/g.FramerateSecPerFrame.length):Number.MAX_VALUE,this.updateMouseMovingWindowNewFrame(),this.updateHoveredWindowAndCaptureFlags(),this.getFrontMostPopupModal()||g.NavWindowingTarget&&0<g.NavWindowingHighlightAlpha?g.DimBgRatio=Math.min(g.DimBgRatio+6*g.IO.DeltaTime,1):g.DimBgRatio=Math.max(g.DimBgRatio-10*g.IO.DeltaTime,0),g.MouseCursor=MouseCursor.Arrow,g.WantCaptureMouseNextFrame=-1,g.WantCaptureKeyboardNextFrame=-1,g.WantTextInputNextFrame=-1,g.PlatformImePos=new Vec2(1,1),this.updateMouseWheel(),g.FocusTabPressed=g.NavWindow&&g.NavWindow.Active&&!(g.NavWindow.Flags&WindowFlags.NoNavInputs)&&!g.IO.KeyCtrl&&this.isKeyPressedMap(Key.Tab),0==g.ActiveId&&g.FocusTabPressed&&(g.FocusRequestNextWindow=g.NavWindow,g.FocusRequestNextCounterAll=Number.MAX_SAFE_INTEGER,0!=g.NavId&&g.NavIdTabCounter!=Number.MAX_SAFE_INTEGER?g.FocusRequestNextCounterTab=g.NavIdTabCounter+1+(g.IO.KeyShift?-1:1):g.FocusRequestNextCounterTab=g.IO.KeyShift?-1:0),g.FocusRequestCurrWindow=null,g.FocusRequestCurrCounterAll=Number.MAX_SAFE_INTEGER,g.FocusRequestCurrCounterTab=Number.MAX_SAFE_INTEGER,null!=g.FocusRequestNextWindow&&(win=g.FocusRequestNextWindow,g.FocusRequestCurrWindow=win,g.FocusRequestNextCounterAll!=Number.MAX_SAFE_INTEGER&&-1!=win.DC.FocusCounterAll&&(g.FocusRequestCurrCounterAll=this.modPositive(g.FocusRequestNextCounterAll,win.DC.FocusCounterAll+1)),g.FocusRequestNextCounterTab!=Number.MAX_SAFE_INTEGER&&-1!=win.DC.FocusCounterTab&&(g.FocusRequestCurrCounterTab=this.modPositive(g.FocusRequestNextCounterTab,win.DC.FocusCounterTab+1)),g.FocusRequestNextWindow=null,g.FocusRequestNextCounterAll=Number.MAX_SAFE_INTEGER,g.FocusRequestNextCounterTab=Number.MAX_SAFE_INTEGER),g.NavIdTabCounter=Number.MAX_SAFE_INTEGER,console.assert(g.WindowsFocusOrder.Size==g.Windows.Size);for(let i=0;i<g.Windows.length;i++){let win=g.Windows[i];win.WasActive=win.Active,win.BeginCount=0,win.Active=!1,win.WriteAccessed=!1}return g.NavWindow&&!g.NavWindow.WasActive&&this.focusPreviousWindowIgnoringOne(null),g.CurrentWindowStack.resize(0),g.BeginPopupStack.resize(0),this.closePopupsOverWindow(g.NavWindow),this.SetNextWindowSize(new Vec2(400,400),CondFlags.FirstUseEver),this.Begin("Debug##Default",null,WindowFlags.NoSavedSettings),g.FrameScopePushedImplicitWindow=!0,this.GetIO().Dirty}EndFrame(){let g=this.guictx;if(console.assert(g.Initialized),g.FrameCountEnded!=g.FrameCount){if(console.assert(g.FrameScopeActive),g.IO.ImeSetInputScreenPosFn&&(g.PlatformImeLastPos.x==Number.MAX_VALUE||1e-4<Vec2.Subtract(g.PlatformImeLastPos,g.PlatformImePos).LengthSq())&&(g.IO.ImeSetInputScreenPosFn(Math.floor(g.PlatformImePos.x),Math.floor(g.PlatformImePos.y)),g.PlatformImeLastPos=g.PlatformImePos),1!=g.CurrentWindowStack.length)if(1<g.CurrentWindowStack.length)for(console.assert(1==g.CurrentWindowStack.length,"Mismatched Begin/BeginChild vs End/EndChild calls: did you forget to call End/EndChild?");1<g.CurrentWindowStack.length;)this.End();else console.assert(1==g.CurrentWindowStack.length,"Mismatched Begin/BeginChild vs End/EndChild calls: did you overcall End/EndChild?");var is_delivered;g.FrameScopePushedImplicitWindow=!1,g.CurrentWindow&&!g.CurrentWindow.WriteAccessed&&(g.CurrentWindow.Active=!1),this.End(),g.NavWindowingTarget&&this.NavUpdateWindowingList(),g.DragDropActive&&(is_delivered=g.DragDropPayload.Delivery,tmp=g.DragDropPayload.DataFrameCount+1<g.FrameCount&&(g.DragDropSourceFlags&DragDropFlags.SourceAutoExpirePayload||!this.IsMouseDown(g.DragDropMouseButton)),(is_delivered||tmp)&&this.ClearDragDrop()),g.DragDropActive&&g.DragDropSourceFrameCount<g.FrameCount&&(g.DragDropWithinSourceOrTarget=!0,this.SetTooltip("..."),g.DragDropWithinSourceOrTarget=!1),g.FrameScopeActive=!1,g.FrameCountEnded=g.FrameCount,this.updateMouseMovingWindowEndFrame(),this.zsortWindows(),g.WindowsSortBuffer.resize(0);for(let i=0;i!=g.Windows.length;i++){var win=g.Windows[i];win.Active&&win.Flags&WindowFlags.ChildWindow||this.addWindowToSortBuffer(g.WindowsSortBuffer,win)}console.assert(g.Windows.length==g.WindowsSortBuffer.length);var tmp=g.Windows;g.Windows=g.WindowsSortBuffer,g.WindowsSortBuffer=tmp,g.IO.MetricsActiveWindows=g.WindowsActiveCount,g.IO.Fonts.Locked=!1,g.IO.MouseWheel=g.IO.MouseWheelH=0,g.IO.ClearInputCharacters(),g.IO.NavInputs.fill(0),this.guictx.EndFrame()}}Render(){let g=this.guictx;console.assert(g.Initialized),g.FrameCountEnded!=g.FrameCount&&this.EndFrame(),g.FrameCountRendered=g.FrameCount,g.IO.MetricsRenderWindows=0;var w=g.canvas.getAttribute("width"),h=g.canvas.getAttribute("height");let ctx=g.canvas.getContext("2d");ctx.clearRect(0,0,w,h),ctx.save(),ctx.scale(window.devicePixelRatio,window.devicePixelRatio);let frontWins=[null,null];!g.NavWindowingTarget||g.NavWindowingTarget.Flags&WindowFlags.NoBringToFrontOnFocus||(frontWins[0]=g.NavWindowingTarget.RootWindow),g.NavWindowingTarget&&(frontWins[1]=g.NavWindowingList);for(let l=0;l<2;l++)for(let n=0;n<g.Windows.length;n++){let win=g.Windows[n];win.IsActiveAndVisible()&&win!=frontWins[0]&&win!=frontWins[1]&&(g.IO.MetricsRenderWindows++,win.Render(l))}for(let n=0;n<frontWins.length;n++)frontWins[n]&&frontWins[n].IsWindowActiveAndVisible()&&(g.IO.MetricsRenderWindows++,frontWins[n].Render());ctx.restore()}GetVersion(variant="about"){switch(variant){case"imgui-njs":return this.version;case"imgui":return this.version_imgui;case"about":default:return this.about}}StyleColorsDark(){this.guictx.Style.SetColorScheme("DarkColors")}StyleColorsClassic(){this.guictx.Style.SetColorScheme("ClassColors")}StyleColorsLight(){this.guictx.Style.SetColorScheme("LightColors")}PushStyleColor(stylid,col){let g=this.guictx;var backup=new ColorMod(stylid,g.Style.Colors[stylid]);g.ColorModifiers.push(backup),g.Style.Colors[stylid]=col}PopStyleColor(count=1){let g=this.guictx;for(;0<count;){var backup=g.ColorModifiers.pop();g.Style.Colors[backup.Field]=backup.BackupValue,count--}}GetStyleColor(stylid,alphaMult=1){let c=this.guictx.Style.Colors[stylid];return console.assert(c,stylid),c.AsRGB(alphaMult)}PushStyleVar(field,val){let g=this.guictx;var backup=new StyleMod(field,g.Style[field]);g.StyleModifiers.push(backup),g.Style[field]=val}PopStyleVar(count=1){let g=this.guictx;for(;0<count;){var backup=g.StyleModifiers.pop();g.Style[backup.Field]=backup.Value,count--}}GetFont(name=null,size=1,weight=null,style=null){if(null==name&&1==size)return this.guictx.Font;null==name&&(name=this.guictx.Font.Family);size=this.guictx.FontSize*size;return this.guictx.IO.Fonts.GetFont(name,size,weight,style)}SetFont(font){let g=this.guictx;g.Font=font,g.FontSize=font.Size,g.FontMidline=font.Baseline/2,g.FontLineHeight=font.Size*this.GetLineHeightPct()}GetFontSize(){return this.guictx.FontSize}GetFontMidline(){return this.guictx.FontMidline}GetLineHeight(){return this.guictx.FontLineHeight}GetLineHeightPct(){return this.guictx.Style.TextLineHeightPct}PushFont(font){return font=(font="string"==typeof font?this.guictx.Style.GetFont(font):font)||this.getDefaultFont(),this.guictx.FontStack.push(font),this.SetFont(font),font}PopFont(){this.guictx.FontStack.pop();let font=this.guictx.FontStack[this.guictx.FontStack.length-1];return font=font||this.getDefaultFont(),this.SetFont(font),font}getDefaultFont(){let g=this.guictx;return g.Style.GetFont("Default")}setCurrentFontName(fontnm){this.guictx;this.SetFont(this.GetFont(name))}SetNextItemWidth(item_width){this.getCurrentWindow().DC.NextItemWidth=item_width}GetLastItemWidth(){var w=this.getCurrentWindow();return w.DC.LastItemRect.Max.x-w.DC.LastItemRect.Min.x}PushItemWidth(item_width){let win=this.getCurrentWindow();win.DC.ItemWidth=0==item_width?win.ItemWidthDefault:item_width,win.DC.ItemWidthStack.push(win.DC.ItemWidth)}PushMultiItemsWidths(ncomp,w_full){let win=this.getCurrentWindow();var w_item_last=this.guictx.Style,w_item_one=Math.max(1,Math.floor((w_full-w_item_last.ItemInnerSpacing.x*(ncomp-1))/ncomp)),w_item_last=Math.max(1,Math.floor(w_full-(w_item_one+w_item_last.ItemInnerSpacing.x)*(ncomp-1)));win.DC.ItemWidthStack.push_back(w_item_last);for(let i=0;i<ncomp-1;i++)win.DC.ItemWidthStack.push_back(w_item_one);win.DC.ItemWidth=win.DC.ItemWidthStack.back()}PopItemWidth(){let win=this.getCurrentWindow();win.DC.ItemWidthStack.pop(),win.DC.ItemWidth=win.DC.ItemWidthStack.empty()?win.ItemWidthDefault:win.DC.ItemWidthStack.back()}getNextItemWidth(){let win=this.guictx.CurrentWindow,w;var region_max_x;return win.DC.NextItemWidth!=Number.MAX_VALUE?(w=win.DC.NextItemWidth,win.DC.NextItemWidth=Number.MAX_VALUE):w=win.DC.ItemWidth,w<0&&(region_max_x=this.getContentRegionMaxScreen().x,w=Math.max(1,region_max_x-win.DC.CursorPos.x+w)),w=Math.floor(w),w}CalcItemWidth(){let win=this.guictx.CurrentWindow;var backup_next_item_width=win.DC.NextItemWidth,w=this.getNextItemWidth();return win.DC.NextItemWidth=backup_next_item_width,w}calcItemSize(size,default_w,default_h){var win=this.guictx.CurrentWindow;let region_max;return(size.x<0||size.y<0)&&(region_max=this.getContentRegionMaxScreen()),0==size.x?size.x=default_w:size.x<0&&(size.x=Math.max(4,region_max.x-win.DC.CursorPos.x+size.x)),0==size.y?size.y=default_h:size.y<0&&(size.y=Math.max(4,region_max.y-win.DC.CursorPos.y+size.y)),size}calcWrapWidthForPos(pos,wrap_pos_x){if(wrap_pos_x<0)return 0;var win=this.guictx.CurrentWindow;return 0==wrap_pos_x?wrap_pos_x=this.GetContentRegionMax().x+win.Pos.x:0<wrap_pos_x&&(wrap_pos_x+=win.Pos.x-win.Scroll.x),Math.max(wrap_pos_x-pos.x,1)}pushMultiItemsWidths(components,w_full=0){let win=this.getCurrentWindow();var w_item_last=this.guictx.Style,w=((w_full=w_full<=0?this.CalcItemWidth():w_full)-w_item_last.ItemInnerSpacing.x*(components-1))/components,w_item_one=Math.max(1,Math.floor(w)),w_item_last=w_full-(w_item_one+w_item_last.ItemInnerSpacing.x)*(components-1),w_item_last=Math.max(1,Math.floor(w_item_last));win.DC.ItemWidthStack.push(w_item_last);for(let i=0;i<components-1;i++)win.DC.ItemWidthStack.push(w_item_one);win.DC.ItemWidth=win.DC.ItemWidthStack[win.DC.ItemWidthStack.length-1]}PushItemFlag(flag,val){let win=this.guictx.CurrentWindow;val?win.DC.ItemFlags|=flag:win.DC.ItemFlags&=~flag,win.DC.ItemFlagsStack.push(win.DC.ItemFlags)}PopItemFlag(){let win=this.guictx.CurrentWindow,stack=win.DC.ItemFlagsStack;stack.pop(),win.DC.ItemFlags=stack[stack.length-1],null==win.DC.ItemFlags&&(win.DC.ItemFlags=ItemFlags.Default)}isWindowContentHoverable(win,flags){var froot=this.guictx;if(froot.NavWindow){froot=froot.NavWindow.RootWindow;if(froot&&froot.WasActive&&froot!=win.RootWindow){if(froot.Flags&WindowFlags.Modal)return!1;if(froot.Flags&WindowFlags.Popup&&!(flags&HoveredFlags.AllowWhenBlockedByPopup))return!1}}return!0}PushTextWrapPos(wrap_pos_x=0){let win=this.guictx.CurrentWindow;win.DC.TextWrapPos=wrap_pos_x,win.DC.TextWrapPosStack.push(wrap_pos_x)}PopTextWrapPos(){let win=this.guictx.CurrentWindow,stack=win.DC.TextWrapPosStack;stack.pop(),win.DC.TextWrapPos=stack[stack.length-1],null==win.DC.TextWrapPos&&(win.DC.TextWrapPos=-1)}PushAllowKeyboardFocus(allow_keyboard_focus){this.PushItemFlag(ItemFlags.NoTabStop,!allow_keyboard_focus)}PopAllowKeyboardFocus(){this.PopItemFlag()}PushButtonRepeat(repeat){this.PushItemFlag(ItemFlags.ButtonRepeat,repeat)}PopButtonRepeat(){this.PopItemFlag()}GetFrameHeight(){var g=this.guictx;return g.FontSize+2*g.Style.FramePadding.y}GetFrameHeightWithSpacing(){var g=this.guictx;return this.GetFrameHeight()+g.Style.ItemSpacing.y}PushID(str_id){this.guictx.CurrentWindow.PushID(str_id)}PopID(){this.guictx.CurrentWindow.PopID()}GetID(str_id){return this.guictx.CurrentWindow.GetID(str_id)}Value(prefix,val){console.assert(0,"unimplemented")}PushClipRect(clip_rect_min,clip_rect_max,intersect_with_current_clip_rect){let win=this.getCurrentWindow();win.DrawList.PushClipRect(clip_rect_min,clip_rect_max,intersect_with_current_clip_rect),win.ClipRect=win.DrawList.GetClipRect()}PopClipRect(){let win=this.getCurrentWindow();win.DrawList.PopClipRect(),win.ClipRect=win.DrawList.GetClipRect()}SetItemDefaultFocus(){let g=this.guictx;var win=g.CurrentWindow;win.Appearing||g.NavWindow!=win.RootWindowForNav||!g.NavInitRequest&&0==g.NavInitResultId||g.NavLayer!=g.NavWindow.DC.NavLayerCurrent||(g.NavInitRequest=!1,g.NavInitResultId=g.NavWindow.DC.LastItemId,g.NavInitResultRectRel=new Rect(Vec2.Subtract(g.NavWindow.DC.LastItemRect.Min,g.NavWindow.Pos),Vec2.Subtract(g.NavWindow.DC.LastItemRect.Max,g.NavWindow.Pos)),this.navUpdateAnyRequestFlag(),this.IsItemVisible()||this.SetScrollHereY())}SetKeyboardFocusHere(offset=0){console.assert(-1<=offset);let g=this.guictx;var win=g.CurrentWindow;g.FocusRequestNextWindow=win,g.FocusRequestNextCounterAll=win.DC.FocusCounterAll+1+offset,g.FocusRequestNextCounterTab=Number.MAX_SAFE_INTEGER}IsItemHovered(flags=0,delay=0){var g=this.guictx,win=g.CurrentWindow;return g.NavDisableMouseHover&&!g.NavDisableHighlight?this.IsItemFocused():!!(win.DC.LastItemStatusFlags&ItemStatusFlags.HoveredRect)&&(console.assert(0==(flags&(HoveredFlags.RootWindow|HoveredFlags.ChildWindows))),!!(g.HoveredRootWindow==win.RootWindow||flags&HoveredFlags.AllowWhenOverlapped)&&(!!(flags&HoveredFlags.AllowWhenBlockedByActiveItem||0==g.ActiveId||g.ActiveId==win.DC.LastItemId||g.ActiveIdAllowOverlap||g.ActiveId==win.MoveId)&&(!!this.isWindowContentHoverable(win,flags)&&(!(win.DC.ItemFlags&ItemFlags.Disabled&&!(flags&HoveredFlags.AllowWhenDisabled))&&((win.DC.LastItemId!=win.MoveId||!win.WriteAccessed)&&!(0!=delay&&g.HoveredIdTimer<delay))))))}IsItemActive(){var g=this.guictx;if(g.ActiveId){var win=g.CurrentWindow;return g.ActiveId==win.DC.LastItemId}return!1}IsItemFocused(){var g=this.guictx,win=g.CurrentWindow;return 0!=g.NavId&&!g.NavDisableHighlight&&g.NavId==win.DC.LastItemId}IsItemClicked(mouse_button=0){return this.IsMouseClicked(mouse_button)&&this.IsItemHovered(HoveredFlags.None)}IsItemVisible(){let win=this.getCurrentWindowRead();return win.ClipRect.Overlaps(win.DC.LastItemRect)}IsItemEdited(){return 0!=(this.getCurrentWindowRead().DC.LastItemStatusFlags&ItemStatusFlags.Edited)}IsItemActivated(){var g=this.guictx;if(g.ActiveId){var win=g.CurrentWindow;if(g.ActiveId==win.DC.LastItemId&&g.ActiveIdPreviousFrame!=win.DC.LastItemId)return!0}return!1}IsItemDeactivated(){var g=this.guictx,win=g.CurrentWindow;return g.ActiveIdPreviousFrame==win.DC.LastItemId&&0!=g.ActiveIdPreviousFrame&&g.ActiveId!=win.DC.LastItemId}IsItemDeactivatedAfterEdit(){var g=this.guictx;return this.IsItemDeactivated()&&(g.ActiveIdPreviousFrameHasBeenEdited||0==g.ActiveId&&g.ActiveIdHasBeenEdited)}IsAnyItemHovered(){var g=this.guictx;return 0!=g.HoveredId||0!=g.HoveredIdPreviousFrame}IsAnyItemActive(){return 0!=this.guictx.ActiveId}IsAnyItemFocused(){var g=this.guictx;return 0!=g.NavId&&!g.NavDisableHighlight}GetItemRectMin(){return this.getCurrentWindowRead().DC.LastItemRect.Min}GetItemRectMax(){return this.getCurrentWindowRead().DC.LastItemRect.Max}GetItemRectSize(){let win=this.getCurrentWindowRead();return win.DC.LastItemRect.GetSize()}SetItemAllowOverlap(){let g=this.guictx;g.HoveredId==g.CurrentWindow.DC.LastItemId&&(g.HoveredIdAllowOverlap=!0),g.ActiveId==g.CurrentWindow.DC.LastItemId&&(g.ActiveIdAllowOverlap=!0)}IsRectVisible(a,b){let win=this.guictx.CurrentWindow;return null==b?win.ClipRect.Overlaps(new Rect(win.DC.CursorPos,Vec2.Add(win.DC.CursorPos,a))):win.ClipRect.Overlaps(new Rect(a,b))}GetTime(){return this.guictx.Time}GetFrameCount(){return this.guictx.FrameCount}GetBackgroundDrawList(){return null}GetForegroundDrawList(){return null}GetDrawListSharedData(){return null}GetStyleColorName(idx){return idx}SetStateStorage(storage){}GetStateStorage(){return null}CalcTextSize(text,hide_text_after_double_hash=!1,wrap_width=-1){var g=this.guictx;hide_text_after_double_hash&&(text=text.split("##")[0]);let font=g.Font;if(0==text.length)return new Vec2(0,g.FontLineHeight);let text_size=font.CalcTextSizeA(Number.MAX_VALUE,wrap_width,text,g.FontLineHeight);return text_size.x=Math.floor(text_size.x+.95),text_size}GetKeyIndex(guikey){return console.assert(0<=guikey&&guikey<Key.COUNT),this.guictx.IO.KeyMap[guikey]}IsKeyDown(user_key_index){return!(user_key_index<0)&&(console.assert(0<=user_key_index&&user_key_index<this.guictx.IO.KeysDown.length),this.guictx.IO.KeysDown[user_key_index])}IsKeyPressed(user_key_index,repeat=!0){if(user_key_index<0)return!1;var g=this.guictx;console.assert(0<=user_key_index&&user_key_index<g.IO.KeysDown.length);var t=g.IO.KeysDownDuration[user_key_index];return 0==t||!!(repeat&&t>g.IO.KeyRepeatDelay)&&0<this.GetKeyPressedAmount(user_key_index,g.IO.KeyRepeatDelay,g.IO.KeyRepeatRate)}isKeyPressedMap(key_index,repeat=!0){key_index=this.guictx.IO.KeyMap[key_index];return 0<=key_index&&this.IsKeyPressed(key_index,repeat)}IsKeyReleased(user_key_index){if(user_key_index<0)return!1;var g=this.guictx;return console.assert(0<=user_key_index&&user_key_index<g.IO.KeysDown.length),0<=g.IO.KeysDownDurationPrev[user_key_index]&&!g.IO.KeysDown[user_key_index]}GetKeyPressedAmount(t,repeat_delay,repeat_rate){if(t<0)return 0;var g=this.guictx;console.assert(0<=t&&t<g.IO.KeysDown.length);t=g.IO.KeysDownDuration[t];return this.calcTypematicPressedRepeatAmount(t,t-g.IO.DeltaTime,repeat_delay,repeat_rate)}IsTouchScreen(){return this.guictx.IO.ConfigFlags&ConfigFlags.IsTouchScreen}IsMouseDown(button){var g=this.guictx;return console.assert(0<=button&&button<g.IO.MouseDown.length),g.IO.MouseDown[button]}IsAnyMouseDown(){var g=this.guictx;for(let n=0;n<g.IO.MouseDown.length;n++)if(g.IO.MouseDown[n])return!0;return!1}IsMouseClicked(delay,rate=!1){var g=this.guictx;console.assert(0<=delay&&delay<g.IO.MouseDown.length);var t=g.IO.MouseDownDuration[delay];if(0==t)return!0;if(rate&&t>g.IO.KeyRepeatDelay){delay=g.IO.KeyRepeatDelay,rate=g.IO.KeyRepeatRate;if(.5*rate<(t-delay)%rate!=(t-delay-g.IO.DeltaTime)%rate>.5*rate)return!0}return!1}IsMouseDoubleClicked(button){var g=this.guictx;return console.assert(0<=button&&button<g.IO.MouseDown.length),g.IO.MouseDoubleClicked[button]}IsMouseReleased(button){var g=this.guictx;return console.assert(0<=button&&button<g.IO.MouseDown.length),g.IO.MouseReleased[button]}IsMouseDragging(button=0,lock_threshold=-1){var g=this.guictx;return console.assert(0<=button&&button<g.IO.MouseDown.length),!!g.IO.MouseDown[button]&&(lock_threshold<0&&(lock_threshold=g.IO.MouseDragThreshold),g.IO.MouseDragMaxDistanceSqr[button]>=lock_threshold*lock_threshold)}IsMouseHoveringRect(r_min,r_max,clip=!0){var g=this.guictx;let rect_clipped=new Rect(r_min,r_max);clip&&rect_clipped.ClipWith(g.CurrentWindow.ClipRect);const rect_for_touch=new Rect(Vec2.Subtract(rect_clipped.Min,g.Style.TouchExtraPadding),Vec2.Add(rect_clipped.Max,g.Style.TouchExtraPadding));return!!rect_for_touch.Contains(g.IO.MousePos)}IsMouseHoveringAnyWindow(){return this.IsWindowHovered(HoveredFlags.AnyWindow)}IsMouseHoveringWindow(){return this.IsWindowHovered(HoveredFlags.AllowWhenBlockedByPopup|HoveredFlags.AllowWhenBlockedByActiveItem)}IsMousePosValid(p=null){p=p||this.guictx.IO.MousePos;return-256e3<=p.x&&-256e3<=p.y}GetMousePos(){return this.guictx.IO.MousePos}GetMousePosOnOpeningCurrentPopup(){var g=this.guictx;return 0<g.BeginPopupStack.length?g.OpenPopupStack[g.BeginPopupStack.length-1].OpenMousePos:g.IO.MousePos}GetMouseDragDelta(button=0,lock_threshold=-1){var g=this.guictx;return console.assert(0<=button&&button<g.IO.MouseDown.length),lock_threshold<0&&(lock_threshold=g.IO.MouseDragThreshold),(g.IO.MouseDown[button]||g.IO.MouseReleased[button])&&g.IO.MouseDragMaxDistanceSqr[button]>=lock_threshold*lock_threshold&&this.IsMousePosValid(g.IO.MousePos)&&this.IsMousePosValid(g.IO.MouseClickedPos[button])?g.IO.MousePos-g.IO.MouseClickedPos[button]:Vec2.Zero()}ResetMouseDragDelta(button=0){let g=this.guictx;console.assert(0<=button&&button<g.IO.MouseDown.length),g.IO.MouseClickedPos[button]=g.IO.MousePos}GetMouseCursor(){return this.guictx.MouseCursor}SetMouseCursor(cursor_type){this.guictx.MouseCursor=cursor_type}CaptureKeyboardFromApp(capture=!0){this.guictx.WantCaptureKeyboardNextFrame=capture?1:0}CaptureMouseFromApp(capture=!0){this.guictx.WantCaptureMouseNextFrame=capture?1:0}async GetClipboardText(cb){this.appServices.clipboard.readText().then(txt=>(cb&&cb(txt),txt)).catch(err=>(cb&&cb(null),console.error("failed to read from clipboard: "+err),null))}SetClipboardText(tx){this.appServices.clipboard.writeText(tx).then(()=>{},()=>console.warn("clipboard write error"))}}class Prefs extends SettingsHandler{constructor(nmspace){super(),this.imgui=null,this.nmspace=nmspace,this.vals={}}Begin(imgui){this.imgui=imgui}GetTypeName(){return"Prefs"}Clear(val=null){val?delete this.vals[val]:this.vals={}}Encapsulate(){return this.vals}Instantiate(imgui,o){console.assert(this.imgui==imgui),this.vals=o}SetValue(nm,value){nm?this.vals[nm]!=value&&(this.vals[nm]=value,this.imgui&&this.imgui.MarkIniSettingsDirty()):console.assert(nm)}GetValue(nm,fallback){if(!nm)return console.assert(nm),fallback;let ret=this.vals[nm];return void 0===ret&&(ret=fallback),ret}}class FileSystem{constructor(runtime){let self=this;this.runtime=runtime,this.isWindows=!1,"browser"==runtime?null!=window.BrowserFS?(console.info("Installing BrowserFS"),this.fs=BrowserFS.BFSRequire("fs"),this.path=BrowserFS.BFSRequire("path"),BrowserFS.FileSystem.IndexedDB.Create(function(e,lsfs){BrowserFS.FileSystem.XmlHttpRequest.Create(function(e,http){BrowserFS.FileSystem.MountableFileSystem.Create({"/home":lsfs,"/net":http},function(e,mfs){BrowserFS.initialize(mfs),self.oninit()})})})):console.warn("No file-IO in browser mode"):"electron"==runtime?this.isWindows=navigator&&-1!=navigator.platform.indexOf("Win32"):(this.path=require("path"),this.fs=null)}oninit(){console.debug("FileSystem initialized")}stat(pathname,islstat,cb){this.fs.stat(pathname,islstat,cb)}statSync(pathname,islstat){return this.fs.statSync(pathname,islstat)}readFile(pathname,options,cb){this.fs.readFile(pathname,options,cb)}readFileSync(pathname,options=null){return this.fs.readFileSync(pathname,options)}writeFile(pathname,data,encoding=null,flag="w+",mode=null,cb){this.fs.writeFile(pathname,data,encoding,flag,mode,cb)}writeFileSync(pathname,contents,encoding=null,flag){return this.fs.writeFileSync(pathname,contents,encoding,flag)}listVolumes(cb){if(this.isWindows)this.filesys.readdir(this.cwd,{withFileTypes:!0},cb);else{var cp=window.require("child_process");if(cp){let spawn=cp.spawn;const list=spawn("wmic",["logicaldisk","get","name"]);list.stdout.on("data",data=>{const output=String(data),out=output.split("\r\n").map(e=>e.trim()).filter(e=>""!=e);if("Name"===out[0]){let ret=[];for(var vdir of out.slice(1))":"==vdir[1]&&(vdir=vdir.slice(0,2),-1==ret.indexOf(vdir)&&ret.push(vdir));cb(0,ret)}}),list.stderr.on("data",function(data){console.error("stderr: "+data)}),list.on("exit",function(code){0!==code&&(console.error("child process exited with code "+code),cb(code,[]))})}else console.error("listVolumes missing child_process module")}}readdir(pathname,opts,cb){this.fs.readdir(pathname,cb)}readdirSync(pathname){return this.fs.readdirSync(pathname)}mkdir(pathname,opts,cb){this.fs.mkdir(pathname,opts,cb)}mkdirSync(pathname,opts){this.fs.mkdirSync(pathname,opts)}rmdir(pathname,cb){this.fs.rmdir(pathname,cb)}unlink(pathname,cb){this.fs.unlink(pathname,cb)}test(){this.mkdir("/home/dana",{recursive:!0},err=>{if(err&&"EEXIST"!=err.code)console.error(err);else{let fn="/home/dana/test.txt";this.fs.writeFile(fn,"Cool, I can do this in the browser!",function(err){this.fs.readFile(fn,function(err,contents){console.log(contents.toString())})})}}),this.fs.readdir("/net/examples/orca",function(err,files){err&&console.error(err),console.log("/net/examples/orca: "+files)})}}class ImguiApp{constructor(canvas,appname="UntitledImguiApp",version="1.0.0",initLog){console.debug("App Init "+(new Date).toLocaleString()),this.appname=appname,this.version=version,this.prefs=new Prefs(this.appname),this.running=!0,this.runtime=window.process&&window.process.type?"electron":window.cordova?"cordova":"browser",this.filesystem=new FileSystem(this.runtime),this.canvas=canvas,this.canvas?(this.imgui=null,this.FileBrowser=null,this.Log=null,this.platform=navigator.platform,this.clipboard=navigator.clipboard,window.App=this):alert("Can't find canvas element named AppCanvas")}IsTouchScreen(){return this.imgui?this.imgui.guictx.IO.ConfigFlags&ConfigFlags.IsTouchScreen:this.IsMobileDevice()}OnLogActivity(msg,level){}IsMobileDevice(){return void 0!==window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")}GetRuntime(){return this.runtime}GetName(){return this.appname}OpenFile(filename,options,cb){this.filesystem.readFile(filename,options,cb)}SaveFile(filename,data,options,cb){this.filesystem.writeFile(filename,data,options,cb)}SetPref(name,value){this.prefs.SetValue(name,value)}GetPref(name,dflt){return this.prefs.GetValue(name,dflt)}Begin(onReady){this.canvas&&(this.imgui=new Imgui(this.canvas,this.appname,this),this.prefs.Begin(this.imgui),this.imgui.guictx.SettingsHandlers.push(this.prefs),this.imgui.LoadIniSettingsFromDisk(),this.Log=new LogWindow(this),this.Log.Begin(this.imgui),this.FileBrowser=new FileBrowser(this.filesystem,this.prefs),this.FileBrowser.Begin(this.imgui),console.debug(`${this.appname} Begin ${(new Date).toLocaleString()}`),console.debug(`  version: ${this.version}`),console.debug(`  ${this.imgui.GetVersion()}`),onReady(0))}End(){if(this.imgui.EndFrame(),"electron"==this.runtime){const remote=window.require("electron").remote;remote.getCurrentWindow().close()}}OnLoop(time){if(this.canvas)return this.imgui.NewFrame(time)?(this.ShowContextMenu(this.imgui),this.FileBrowser&&this.FileBrowser.Show(this.imgui),this.Log&&this.Log.Show(this.imgui,"Log"),this.OnFrame(this.imgui),this.imgui.Render()):this.imgui.EndFrame(),this.running}OnFrame(imgui){}OnLogActivity(lastMsg,lastLevel){}ShowContextMenu(imgui){imgui.BeginPopupContextVoid("ContextMenu",1)&&(this.Log&&imgui.MenuItem("Log",null,this.Log.IsShowing.get())&&this.Log.IsShowing.toggle(),this.AppendContextMenu(imgui),"electron"===this.runtime&&imgui.MenuItem("Quit")&&(this.running=!1),imgui.EndPopup())}AppendContextMenu(imgui){}ShowModalDialog(cfg,cb){var imgSz=cfg.id||"Modal?";if(this.imgui.BeginPopupModal(imgSz,null,WindowFlags.AlwaysAutoResize)){cfg.icon&&(imgSz=cfg.iconSize||new Vec2(200,100),this.imgui.Image(cfg.icon,imgSz,null,null,null,Colors.black),this.imgui.SameLine()),this.imgui.Text(cfg.msg),this.imgui.Separator(),"entry"==cfg.type&&(this.editText?this.editText.Set(""):this.editText=new MutableString(""),this.imgui.TextEntry(this.editText));for(let i=0;i<cfg.buttons.length;i++)if(this.imgui.Button(cfg.buttons[i])){if(cb){let extra=null;"entry"==cfg.type&&(extra=this.editText.Get()),cb(i,extra)}this.imgui.CloseCurrentPopup()}this.imgui.EndPopup()}}ShowOpenDialog(prompt,cb,extensions=[],closeOnSelect=!0,zIndex=-1){var mcb=function(err,path){closeOnSelect&&this.FileBrowser.IsOpen.set(!1),cb(err,[path])}.bind(this);this.FileBrowser.SetClient(prompt,mcb,"PickFile",extensions,!0,zIndex)}ShowSaveDialog(prompt,cb,extensions=[],closeOnSelect=!0,zIndex=-1){var mcb=function(err,path){closeOnSelect&&this.FileBrowser.IsOpen.set(!1),cb(err,path)}.bind(this);this.FileBrowser.SetClient(prompt,mcb,"SaveFile",extensions,!0,zIndex)}}